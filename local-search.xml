<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>clickhouse å®ç°æ•°æ®å¤‡ä»½åŠŸèƒ½</title>
    <link href="/2025/09/20/db-clickhouse-backup/"/>
    <url>/2025/09/20/db-clickhouse-backup/</url>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä»‹ç»ä¸¤ç§clickhouseçš„æ•°æ®å¤‡ä»½æ–¹å¼ï¼Œä¸€ç§æ˜¯å®˜æ–¹æä¾›çš„å¤‡ä»½ç­–ç•¥ï¼Œä¸€ç§æ˜¯é€šè¿‡å¼€æºæ’ä»¶å®ç°çš„å¤‡ä»½ç­–ç•¥</p><h2 id="å®˜æ–¹å¤‡ä»½ç­–ç•¥"><a href="#å®˜æ–¹å¤‡ä»½ç­–ç•¥" class="headerlink" title="å®˜æ–¹å¤‡ä»½ç­–ç•¥"></a>å®˜æ–¹å¤‡ä»½ç­–ç•¥</h2><p>clickhouseå®˜æ–¹ä¹Ÿæä¾›äº†æ•°æ®å¤‡ä»½çš„åŠŸèƒ½ï¼Œæ”¯æŒå°†æ•°æ®å¤‡ä»½åˆ°æœ¬åœ°ç£ç›˜æˆ–è€…S3å­˜å‚¨ã€‚</p><p>å®˜æ–¹çš„å¤‡ä»½ç­–ç•¥ï¼Œæœ¬è´¨ä¸Šæ˜¯é€šè¿‡BACKUP å’Œ RESTORE ä¸¤ä¸ªsqlå…³é”®å­—æ¥å®ç°çš„, è¿™å°±å¯¼è‡´ï¼Œæˆ‘ä»¬åœ¨é…ç½®clickhouseå¤‡ä»½ä»»åŠ¡çš„æ—¶å€™ï¼Œéœ€è¦ç™»å½•clickhouse æ‰è¡Œã€‚</p><blockquote><p>å¤‡ä»½å¯ä»¥æ˜¯å®Œæ•´çš„æˆ–å¢é‡çš„ï¼Œå¯ä»¥åŒ…å«è¡¨ï¼ˆåŒ…æ‹¬ç‰©åŒ–è§†å›¾ã€æŠ•å½±å’Œå­—å…¸ï¼‰å’Œæ•°æ®åº“ã€‚å¤‡ä»½å¯ä»¥æ˜¯åŒæ­¥çš„ï¼ˆé»˜è®¤ï¼‰æˆ–å¼‚æ­¥çš„ã€‚å¯ä»¥å‹ç¼©å¤‡ä»½ã€‚å¤‡ä»½å¯ä»¥è®¾æœ‰å¯†ç ä¿æŠ¤ã€‚</p></blockquote><h3 id="å¤‡ä»½åˆ°æœ¬åœ°ç¡¬ç›˜"><a href="#å¤‡ä»½åˆ°æœ¬åœ°ç¡¬ç›˜" class="headerlink" title="å¤‡ä»½åˆ°æœ¬åœ°ç¡¬ç›˜"></a>å¤‡ä»½åˆ°æœ¬åœ°ç¡¬ç›˜</h3><ol><li>åˆ›å»ºæ•°æ®å¤‡ä»½å­˜å‚¨ç›®å½•ï¼Œæ¯”å¦‚<code>/backup</code></li><li>æ·»åŠ <code>/etc/clickhouse-server/config.d/backup_disk.xml</code>æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">clickhouse</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">storage_configuration</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">disks</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">backups</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>local<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">path</span>&gt;</span>/backups/<span class="hljs-tag">&lt;/<span class="hljs-name">path</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">backups</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">disks</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">storage_configuration</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">backups</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">allowed_disk</span>&gt;</span>backups<span class="hljs-tag">&lt;/<span class="hljs-name">allowed_disk</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">allowed_path</span>&gt;</span>/backups/<span class="hljs-tag">&lt;/<span class="hljs-name">allowed_path</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">backups</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">clickhouse</span>&gt;</span><br></code></pre></td></tr></table></figure><ol start="3"><li>sqlå‘½ä»¤</li></ol><p>è¯­æ³•ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs sql">BACKUP<span class="hljs-operator">|</span>RESTORE<br> <span class="hljs-keyword">TABLE</span> [db.]table_name [<span class="hljs-keyword">AS</span> [db.]table_name_in_backup]<br>   [<span class="hljs-keyword">PARTITION</span>[S] partition_expr [,...]] <span class="hljs-operator">|</span><br> DICTIONARY [db.]dictionary_name [<span class="hljs-keyword">AS</span> [db.]name_in_backup] <span class="hljs-operator">|</span><br> DATABASE database_name [<span class="hljs-keyword">AS</span> database_name_in_backup]<br>   [<span class="hljs-keyword">EXCEPT</span> TABLES ...] <span class="hljs-operator">|</span><br> TEMPORARY <span class="hljs-keyword">TABLE</span> table_name [<span class="hljs-keyword">AS</span> table_name_in_backup] <span class="hljs-operator">|</span><br> <span class="hljs-keyword">VIEW</span> view_name [<span class="hljs-keyword">AS</span> view_name_in_backup] <span class="hljs-operator">|</span><br> <span class="hljs-keyword">ALL</span> [<span class="hljs-keyword">EXCEPT</span> &#123;TABLES<span class="hljs-operator">|</span>DATABASES&#125;...] &#125; [,...]<br> [<span class="hljs-keyword">ON</span> CLUSTER <span class="hljs-string">&#x27;cluster_name&#x27;</span>]<br> <span class="hljs-keyword">TO</span><span class="hljs-operator">|</span><span class="hljs-keyword">FROM</span> File(<span class="hljs-string">&#x27;&lt;path&gt;/&lt;filename&gt;&#x27;</span>) <span class="hljs-operator">|</span> Disk(<span class="hljs-string">&#x27;&lt;disk_name&gt;&#x27;</span>, <span class="hljs-string">&#x27;&lt;path&gt;/&#x27;</span>) <span class="hljs-operator">|</span> S3(<span class="hljs-string">&#x27;&lt;S3 endpoint&gt;/&lt;path&gt;&#x27;</span>, <span class="hljs-string">&#x27;&lt;Access key ID&gt;&#x27;</span>, <span class="hljs-string">&#x27;&lt;Secret access key&gt;&#x27;</span>)<br> [SETTINGS base_backup <span class="hljs-operator">=</span> File(<span class="hljs-string">&#x27;&lt;path&gt;/&lt;filename&gt;&#x27;</span>) <span class="hljs-operator">|</span> Disk(...) <span class="hljs-operator">|</span> S3(<span class="hljs-string">&#x27;&lt;S3 endpoint&gt;/&lt;path&gt;&#x27;</span>, <span class="hljs-string">&#x27;&lt;Access key ID&gt;&#x27;</span>, <span class="hljs-string">&#x27;&lt;Secret access key&gt;&#x27;</span>)]<br><br></code></pre></td></tr></table></figure><ul><li>BACKUP|RESTORE : å…³é”®å­—</li><li>TABLE|DICTIONARY|DATABASE|TEMPORARY TABLE|VIEW|ALL: å¤‡ä»½çš„å¯¹è±¡ç±»å‹, è¡¨|å­—å…¸|æ•°æ®åº“|ä¸´æ—¶è¡¨|è§†å›¾|æ‰€æœ‰</li><li>åœ¨ ClickHouse çš„ 23.4 ç‰ˆæœ¬ä¹‹å‰ï¼ŒALL åªèƒ½é€‚ç”¨äº RESTORE å‘½ä»¤ã€‚</li><li>SETTINGS:<ul><li>idï¼šå¤‡ä»½æˆ–æ¢å¤æ“ä½œçš„ idï¼Œéšæœºç”Ÿæˆ UUIDï¼Œè‹¥æœªæ‰‹åŠ¨æŒ‡å®šåˆ™ä½¿ç”¨ã€‚è‹¥å·²æœ‰åŒä¸€ id çš„æ“ä½œåœ¨è¿è¡Œï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</li><li>compression_method å’Œ compression_level</li><li>base_backupï¼šæ­¤æºçš„å‰ä¸€ä¸ªå¤‡ä»½çš„ç›®æ ‡ã€‚ä¾‹å¦‚ï¼ŒDisk(â€˜backupsâ€™, â€˜1.zipâ€™)</li><li>use_same_s3_credentials_for_base_backupï¼šåŸºç¡€å¤‡ä»½æ˜¯å¦åº”ä»æŸ¥è¯¢ä¸­ç»§æ‰¿å‡­æ®ã€‚ä»…å¯¹ S3 æœ‰æ•ˆã€‚</li><li>use_same_password_for_base_backupï¼šåŸºç¡€å¤‡ä»½å­˜æ¡£æ˜¯å¦åº”ä»æŸ¥è¯¢ä¸­ç»§æ‰¿å¯†ç ã€‚ </li><li>structure_onlyï¼šå¦‚æœå¯ç”¨ï¼Œä»…å…è®¸å¤‡ä»½æˆ–æ¢å¤ CREATE è¯­å¥ï¼Œè€Œä¸åŒ…æ‹¬è¡¨çš„æ•°æ®</li><li>s3_storage_classï¼šç”¨äº S3 å¤‡ä»½çš„å­˜å‚¨ç±»ã€‚ä¾‹å¦‚ï¼ŒSTANDARD</li></ul></li></ul><ol start="4"><li>demo</li></ol><ul><li>å¤‡ä»½è¡¨</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- å¤‡ä»½è¡¨, è¿™é‡Œçš„backups å°±æ˜¯é…ç½®æ–‡ä»¶é‡Œçš„ allowed_disk</span><br>BACKUP <span class="hljs-keyword">TABLE</span> test.table <span class="hljs-keyword">TO</span> Disk(<span class="hljs-string">&#x27;backups&#x27;</span>, <span class="hljs-string">&#x27;1.zip&#x27;</span>);<br><br><span class="hljs-comment">-- æ¢å¤è¡¨</span><br>RESTORE <span class="hljs-keyword">TABLE</span> test.table <span class="hljs-keyword">FROM</span> Disk(<span class="hljs-string">&#x27;backups&#x27;</span>, <span class="hljs-string">&#x27;1.zip&#x27;</span>)<br><span class="hljs-comment">-- æ¢å¤è¡¨ï¼Œå¹¶è¦†ç›–æ•°æ®</span><br>RESTORE <span class="hljs-keyword">TABLE</span> test.table <span class="hljs-keyword">FROM</span> Disk(<span class="hljs-string">&#x27;backups&#x27;</span>, <span class="hljs-string">&#x27;1.zip&#x27;</span>) SETTINGS allow_non_empty_tables<span class="hljs-operator">=</span><span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><ul><li>å¤‡ä»½å¹¶é‡å‘½åè¡¨</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- table3 é‡å‘½åä¸º table4 å¹¶å¤‡ä»½</span><br>BACKUP <span class="hljs-keyword">TABLE</span> test.table3 <span class="hljs-keyword">AS</span> test.table4 <span class="hljs-keyword">TO</span> Disk(<span class="hljs-string">&#x27;backups&#x27;</span>, <span class="hljs-string">&#x27;2.zip&#x27;</span>)<br><br><span class="hljs-operator">-</span> <span class="hljs-keyword">table</span> é‡å‘½åä¸º table2 å¹¶æ¢å¤<br>RESTORE <span class="hljs-keyword">TABLE</span> test.table <span class="hljs-keyword">AS</span> test.table2 <span class="hljs-keyword">FROM</span> Disk(<span class="hljs-string">&#x27;backups&#x27;</span>, <span class="hljs-string">&#x27;1.zip&#x27;</span>)<br></code></pre></td></tr></table></figure><ul><li>å¢é‡å¤‡ä»½<br>å¢é‡å¤‡ä»½éœ€è¦ä»ä¸€ä¸ªåŸºç¡€å¤‡ä»½æ¥å¼€å§‹</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">BACKUP <span class="hljs-keyword">TABLE</span> test.table <span class="hljs-keyword">TO</span> Disk(<span class="hljs-string">&#x27;backups&#x27;</span>, <span class="hljs-string">&#x27;incremental-a.zip&#x27;</span>) SETTINGS base_backup <span class="hljs-operator">=</span> Disk(<span class="hljs-string">&#x27;backups&#x27;</span>, <span class="hljs-string">&#x27;d.zip&#x27;</span>)<br><br><span class="hljs-operator">-</span> ä»å¢é‡å¤‡ä»½å’Œ base_backup æ¢å¤æ‰€æœ‰æ•°æ®åˆ°æ–°è¡¨ test.table2<br>RESTORE <span class="hljs-keyword">TABLE</span> test.table <span class="hljs-keyword">AS</span> test.table2 <span class="hljs-keyword">FROM</span> Disk(<span class="hljs-string">&#x27;backups&#x27;</span>, <span class="hljs-string">&#x27;incremental-a.zip&#x27;</span>);<br></code></pre></td></tr></table></figure><ul><li>å¤‡ä»½è®¾ç½®å¯†ç </li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql">BACKUP <span class="hljs-keyword">TABLE</span> test.table<br>  <span class="hljs-keyword">TO</span> Disk(<span class="hljs-string">&#x27;backups&#x27;</span>, <span class="hljs-string">&#x27;password-protected.zip&#x27;</span>)<br>  SETTINGS password<span class="hljs-operator">=</span><span class="hljs-string">&#x27;qwerty&#x27;</span>;<br>  <br>RESTORE <span class="hljs-keyword">TABLE</span> test.table<br>  <span class="hljs-keyword">FROM</span> Disk(<span class="hljs-string">&#x27;backups&#x27;</span>, <span class="hljs-string">&#x27;password-protected.zip&#x27;</span>)<br>  SETTINGS password<span class="hljs-operator">=</span><span class="hljs-string">&#x27;qwerty&#x27;</span><br></code></pre></td></tr></table></figure><ul><li>å‹ç¼©</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">BACKUP <span class="hljs-keyword">TABLE</span> test.table<br>  <span class="hljs-keyword">TO</span> Disk(<span class="hljs-string">&#x27;backups&#x27;</span>, <span class="hljs-string">&#x27;filename.zip&#x27;</span>)<br>  SETTINGS compression_method<span class="hljs-operator">=</span><span class="hljs-string">&#x27;lzma&#x27;</span>, compression_level<span class="hljs-operator">=</span><span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><ul><li>æ¢å¤ç‰¹å®šåˆ†åŒº<br>å¦‚æœéœ€è¦æ¢å¤ä¸è¡¨ç›¸å…³çš„ç‰¹å®šåˆ†åŒºï¼Œå¯ä»¥æŒ‡å®šè¿™äº›åˆ†åŒºã€‚è¦ä»å¤‡ä»½æ¢å¤åˆ†åŒº 1 å’Œ 4ï¼š</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">RESTORE <span class="hljs-keyword">TABLE</span> test.table PARTITIONS <span class="hljs-string">&#x27;2&#x27;</span>, <span class="hljs-string">&#x27;3&#x27;</span><br>  <span class="hljs-keyword">FROM</span> Disk(<span class="hljs-string">&#x27;backups&#x27;</span>, <span class="hljs-string">&#x27;filename.zip&#x27;</span>)<br></code></pre></td></tr></table></figure><ul><li>å¤‡ä»½ä¸º tar</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql">BACKUP <span class="hljs-keyword">TABLE</span> test.table <span class="hljs-keyword">TO</span> Disk(<span class="hljs-string">&#x27;backups&#x27;</span>, <span class="hljs-string">&#x27;1.tar&#x27;</span>)<br><br>RESTORE <span class="hljs-keyword">TABLE</span> test.table <span class="hljs-keyword">FROM</span> Disk(<span class="hljs-string">&#x27;backups&#x27;</span>, <span class="hljs-string">&#x27;1.tar&#x27;</span>)<br><br><span class="hljs-comment">-- ç”¨ gzip å‹ç¼© tar å­˜æ¡£</span><br><span class="hljs-comment">-- æ”¯æŒçš„å‹ç¼©æ–‡ä»¶åç¼€ä¸º tar.gzã€.tgzã€tar.bz2ã€tar.lzmaã€.tar.zstã€.tzst å’Œ .tar.xz</span><br>BACKUP <span class="hljs-keyword">TABLE</span> test.table <span class="hljs-keyword">TO</span> Disk(<span class="hljs-string">&#x27;backups&#x27;</span>, <span class="hljs-string">&#x27;1.tar.gz&#x27;</span>)<br></code></pre></td></tr></table></figure><ul><li>å¼‚æ­¥å¤‡ä»½</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">BACKUP <span class="hljs-keyword">TABLE</span> test.table <span class="hljs-keyword">TO</span> Disk(<span class="hljs-string">&#x27;backups&#x27;</span>, <span class="hljs-string">&#x27;1.tar&#x27;</span>) ASYNC<br></code></pre></td></tr></table></figure><ul><li>æ£€æŸ¥å¤‡ä»½çŠ¶æ€</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> system.backups <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-string">&#x27;7678b0b3-f519-4e6e-811f-5a0781a4eb52&#x27;</span> FORMAT Vertical<br><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> system.backup_log <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;7678b0b3-f519-4e6e-811f-5a0781a4eb52&#x27;</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> event_time_microseconds <span class="hljs-keyword">ASC</span> FORMAT Vertical<br></code></pre></td></tr></table></figure><h3 id="å¤‡ä»½åˆ°S3"><a href="#å¤‡ä»½åˆ°S3" class="headerlink" title="å¤‡ä»½åˆ°S3"></a>å¤‡ä»½åˆ°S3</h3><ol><li>è·å¾—S3 keyå’Œå¯†é’¥</li></ol><ul><li>S3 ç«¯ç‚¹ï¼Œ ä¾‹å¦‚ <a href="https://xxx.com/backup-S3/">https://xxx.com/backup-S3/</a></li><li>è®¿é—®å¯†é’¥ IDï¼Œ ä¾‹å¦‚ ABC123</li><li>ç§˜å¯†è®¿é—®å¯†é’¥ï¼Œ ä¾‹å¦‚ Abc+123</li></ul><ol start="2"><li>demo</li></ol><ul><li>å¤‡ä»½è¡¨</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">BACKUP <span class="hljs-keyword">TABLE</span> test.table <span class="hljs-keyword">TO</span> S3(<span class="hljs-string">&#x27;https://xxx.com/backup-S3/my_backup&#x27;</span>, <span class="hljs-string">&#x27;ABC123&#x27;</span>, <span class="hljs-string">&#x27;Abc+123&#x27;</span>) <br></code></pre></td></tr></table></figure><ul><li>å¢é‡å¤‡ä»½</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql">BACKUP <span class="hljs-keyword">TABLE</span> test.table <span class="hljs-keyword">TO</span> S3(<span class="hljs-string">&#x27;https://xxx.com/backup-S3/my_incremental&#x27;</span>, <span class="hljs-string">&#x27;ABC123&#x27;</span>, <span class="hljs-string">&#x27;Abc+123&#x27;</span>) SETTINGS base_backup <span class="hljs-operator">=</span> S3(<span class="hljs-string">&#x27;https://xxx.com/backup-S3/my_backup&#x27;</span>, <span class="hljs-string">&#x27;ABC123&#x27;</span>, <span class="hljs-string">&#x27;Abc+123&#x27;</span>) <br><br><span class="hljs-comment">-- æ¢å¤</span><br>RESTORE <span class="hljs-keyword">TABLE</span> test.table <span class="hljs-keyword">AS</span> data3 <span class="hljs-keyword">FROM</span> S3(<span class="hljs-string">&#x27;https://xxx.com/backup-S3/my_incremental&#x27;</span>, <span class="hljs-string">&#x27;ABC123&#x27;</span>, <span class="hljs-string">&#x27;Abc+123&#x27;</span>)<br></code></pre></td></tr></table></figure><ol start="3"><li>é…ç½®æ–‡ä»¶</li></ol><p>å¦‚æœè§‰å¾—æ¯æ¬¡éƒ½åœ¨sqlé‡Œå†™s3çš„é…ç½®ï¼Œæ—¢ç¹çï¼Œè¿˜ä¸å®‰å…¨ï¼Œå¯ä»¥å‚è€ƒä¸Šé¢é…ç½®æ–‡ä»¶ï¼Œå°†s3çš„é…ç½®å†™åˆ°é…ç½®æ–‡ä»¶é‡Œï¼Œç„¶åé€šè¿‡å‘½ä»¤è¡Œå‚æ•°æ¥æŒ‡å®šé…ç½®æ–‡ä»¶ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">clickhouse</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">storage_configuration</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">disks</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">s3_plain</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>s3_plain<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">endpoint</span>&gt;</span>https://xxx.com/backup-S3<span class="hljs-tag">&lt;/<span class="hljs-name">endpoint</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">access_key_id</span>&gt;</span>ABC123<span class="hljs-tag">&lt;/<span class="hljs-name">access_key_id</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">secret_access_key</span>&gt;</span>Abc+123<span class="hljs-tag">&lt;/<span class="hljs-name">secret_access_key</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">s3_plain</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">disks</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">policies</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">s3</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">volumes</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">main</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">disk</span>&gt;</span>s3_plain<span class="hljs-tag">&lt;/<span class="hljs-name">disk</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">volumes</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">s3</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">policies</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">storage_configuration</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">backups</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">allowed_disk</span>&gt;</span>s3_plain<span class="hljs-tag">&lt;/<span class="hljs-name">allowed_disk</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">backups</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">clickhouse</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ç„¶åå°±å¯ä»¥é€šè¿‡s3_plain æ¥å¤‡ä»½äº†</p><ul><li>å¤‡ä»½è¡¨</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">BACKUP <span class="hljs-keyword">TABLE</span> test.table <span class="hljs-keyword">TO</span> Disk(<span class="hljs-string">&#x27;s3_plain&#x27;</span>, <span class="hljs-string">&#x27;cloud_backup&#x27;</span>);<br><br>RESTORE <span class="hljs-keyword">TABLE</span> test.table <span class="hljs-keyword">FROM</span> Disk(<span class="hljs-string">&#x27;s3_plain&#x27;</span>, <span class="hljs-string">&#x27;cloud_backup&#x27;</span>);<br></code></pre></td></tr></table></figure><h2 id="clickhouse-backup"><a href="#clickhouse-backup" class="headerlink" title="clickhouse-backup"></a>clickhouse-backup</h2><p>å¦‚æœè§‰å¾—clickhouseå®˜æ–¹çš„sqlå¤‡ä»½æ–¹å¼ä¸æ–¹ä¾¿ï¼Œæˆ–è€…é…ç½®å®šæ—¶å¤‡ä»½æœºåˆ¶ä¸å®¹æ˜“ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨clickhouse-backupï¼Œå®ƒæ˜¯ä¸€ä¸ªå¼€æºçš„å¤‡ä»½å·¥å…·ï¼Œå¯ä»¥è‡ªåŠ¨å¤‡ä»½å’Œæ¢å¤ClickHouseæ•°æ®ï¼Œä¸”åŒæ ·æ”¯æŒæœ¬åœ°å¤‡ä»½å’ŒS3å¤‡ä»½,é™¤æ­¤ä¹‹å¤–è¿˜æ”¯æŒftp&#x2F;sftpã€gcsã€cosã€apiç­‰å¤‡ä»½æ–¹å¼</p><ol><li>å®‰è£…clickhouse-backup<br>ä»<a href="https://github.com/Altinity/clickhouse-backup/releases">å®˜æ–¹ä»“åº“</a>ä¸‹è½½å¹¶å®‰è£…clickhouse-backup</li></ol><p>å¦‚æœgithubè¿ä¸ä¸Šæˆ–è€…æ¯”è¾ƒæ…¢çš„è¯ï¼Œå¯ä»¥ä»<a href="">è¿™é‡Œ</a>ä¸‹è½½,è¿™æ˜¯æˆ‘ç”¨è¿‡çš„2.6.39ç‰ˆæœ¬</p><p>ä¸‹è½½å®Œæˆåï¼Œè§£å‹åˆ°ä½ å¸Œæœ›å®‰è£…çš„ç›®å½•ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">tar -zxvf clickhouse-backup.tar.gz<br></code></pre></td></tr></table></figure><p>ç„¶åæ·»åŠ é…ç½®æ–‡ä»¶&#x2F;etc&#x2F;clickhouse-backup&#x2F;config.ymlï¼ˆé»˜è®¤è·¯å¾„ï¼‰ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">clickhouse:</span><br>  <span class="hljs-attr">host:</span> <span class="hljs-string">localhost</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">9000</span><br>  <span class="hljs-attr">user:</span> <span class="hljs-string">default</span><br>  <span class="hljs-attr">password:</span> <span class="hljs-string">&quot;&quot;</span>  <span class="hljs-comment"># è‹¥æœ‰å¯†ç éœ€å¡«å†™</span><br>  <span class="hljs-attr">database:</span> <span class="hljs-string">&quot;&quot;</span>   <span class="hljs-comment"># ç•™ç©ºè¡¨ç¤ºæ‰€æœ‰åº“ï¼Œæˆ–æŒ‡å®šç›®æ ‡åº“my_db</span><br><br><span class="hljs-attr">backup:</span><br>  <span class="hljs-attr">dir:</span> <span class="hljs-string">&quot;/tmp/clickhouse-backup&quot;</span>  <span class="hljs-comment"># å¤‡ä»½å­˜å‚¨ç›®å½•</span><br>  <span class="hljs-attr">compression:</span> <span class="hljs-literal">true</span>  <span class="hljs-comment"># å¯ç”¨å‹ç¼©</span><br>  <span class="hljs-comment"># å¯é€‰ï¼šå¤‡ä»½åˆ°S3ï¼ˆéœ€é…ç½®aws_access_keyç­‰ï¼‰</span><br>  <span class="hljs-comment"># s3:</span><br>  <span class="hljs-comment">#   endpoint: &quot;s3.amazonaws.com&quot;</span><br>  <span class="hljs-comment">#   bucket: &quot;my-clickhouse-backups&quot;</span><br>  <span class="hljs-comment">#   access_key: &quot;&quot;</span><br>  <span class="hljs-comment">#   secret_key: &quot;&quot;</span><br></code></pre></td></tr></table></figure><p>å…·ä½“å‚è€ƒå®˜æ–¹é…ç½®</p><p>ç„¶åå°±å¯ä»¥ä½¿ç”¨clickhouse-backupè¿›è¡Œå¤‡ä»½äº†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># åˆ›å»ºå¤‡ä»½</span><br>clickhouse-backup create my_backup<br><span class="hljs-comment"># ä½¿ç”¨æŒ‡å®šé…ç½®åˆ›å»ºå¤‡ä»½</span><br>clickhouse-backup create --config ./config.yml  my_backup<br><br><span class="hljs-comment"># åˆ—å‡ºå¤‡ä»½</span><br>clickhouse-backup list<br><br><span class="hljs-comment"># æ¢å¤å¤‡ä»½</span><br>clickhouse-backup restore my_backup<br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://clickhouse.com/docs/zh/operations/backup#backup-to-a-local-disk">clickhouseå®˜æ–¹å¤‡ä»½ç­–ç•¥</a></p><p><a href="https://github.com/Altinity/clickhouse-backup">clickhouse-backupå®˜æ–¹é…ç½®</a></p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>clickhouse</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€é”®ç”ŸæˆTLSè¯ä¹¦</title>
    <link href="/2025/06/16/site-tls-tls-cert-create/"/>
    <url>/2025/06/16/site-tls-tls-cert-create/</url>
    
    <content type="html"><![CDATA[<p>TLS è¯ä¹¦ï¼ˆä¹Ÿç§°ä¸º SSL è¯ä¹¦ï¼‰æ˜¯ç”¨äºåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´å»ºç«‹å®‰å…¨åŠ å¯†é€šä¿¡çš„åŸºç¡€ç»„ä»¶ï¼Œå¹¿æ³›åº”ç”¨äº HTTPSã€API é€šä¿¡ã€é‚®ä»¶ä¼ è¾“ç­‰é¢†åŸŸ,æ˜¯ç°ä»£äº’è”ç½‘å®‰å…¨çš„åŸºç¡€ã€‚</p><p>æ¯”å¦‚HTTPSé‡Œçš„SæŒ‡çš„å°±æ˜¯TLSã€‚</p><h2 id="ğŸ”-TLS-è¯ä¹¦çš„æœ¬è´¨"><a href="#ğŸ”-TLS-è¯ä¹¦çš„æœ¬è´¨" class="headerlink" title="ğŸ” TLS è¯ä¹¦çš„æœ¬è´¨"></a>ğŸ” TLS è¯ä¹¦çš„æœ¬è´¨</h2><p>TLS è¯ä¹¦æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª X.509 æ ¼å¼çš„æ•°å­—æ–‡ä»¶ï¼ŒåŒ…å«ä»¥ä¸‹å…³é”®ä¿¡æ¯ï¼š</p><table><thead><tr><th>å†…å®¹</th><th>æè¿°</th></tr></thead><tbody><tr><td>å…¬é’¥ï¼ˆPublic Keyï¼‰</td><td>ç”¨äºåŠ å¯†æ•°æ®æˆ–éªŒè¯ç­¾å</td></tr><tr><td>ä¸»é¢˜ï¼ˆSubjectï¼‰</td><td>åŒ…æ‹¬è¯ä¹¦æŒæœ‰è€…çš„èº«ä»½ä¿¡æ¯ï¼Œå¦‚åŸŸåï¼ˆCNï¼‰ã€ç»„ç»‡åç§°ç­‰</td></tr><tr><td>é¢å‘è€…ï¼ˆIssuerï¼‰</td><td>ç­¾å‘è¯¥è¯ä¹¦çš„ CAï¼ˆè¯ä¹¦é¢å‘æœºæ„ï¼‰ä¿¡æ¯</td></tr><tr><td>æœ‰æ•ˆæœŸï¼ˆValidityï¼‰</td><td>è¯ä¹¦æœ‰æ•ˆèµ·æ­¢æ—¶é—´</td></tr><tr><td>ç­¾åç®—æ³•ï¼ˆSignature Algorithmï¼‰</td><td>ä½¿ç”¨çš„åŠ å¯†ç®—æ³•</td></tr><tr><td>æ‰©å±•å­—æ®µï¼ˆExtensionsï¼‰</td><td>å¦‚ SANï¼ˆsubjectAltNameï¼‰ã€EKUï¼ˆextendedKeyUsageï¼‰ç­‰</td></tr></tbody></table><h2 id="ğŸŒ-TLS-è¯ä¹¦çš„ä½œç”¨"><a href="#ğŸŒ-TLS-è¯ä¹¦çš„ä½œç”¨" class="headerlink" title="ğŸŒ TLS è¯ä¹¦çš„ä½œç”¨"></a>ğŸŒ TLS è¯ä¹¦çš„ä½œç”¨</h2><ol><li><strong>èº«ä»½è®¤è¯ï¼ˆAuthenticationï¼‰</strong><ul><li>å®¢æˆ·ç«¯å¯ä»¥éªŒè¯æœåŠ¡å™¨çš„èº«ä»½ï¼Œé˜²æ­¢è¿æ¥åˆ°å‡å†’çš„æœåŠ¡ã€‚</li><li>æ”¯æŒåŒå‘è®¤è¯ï¼ˆmTLSï¼‰ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¯ä»¥è¢«æœåŠ¡ç«¯éªŒè¯ã€‚</li></ul></li><li><strong>æ•°æ®åŠ å¯†ï¼ˆEncryptionï¼‰</strong><ul><li>å®¢æˆ·ç«¯ä½¿ç”¨æœåŠ¡å™¨çš„å…¬é’¥åŠ å¯†æ•°æ®ï¼Œåªæœ‰æ‹¥æœ‰ç§é’¥çš„æœåŠ¡å™¨æ‰èƒ½è§£å¯†ã€‚</li><li>å»ºç«‹è¿æ¥åä½¿ç”¨å¯¹ç§°åŠ å¯†æé«˜æ•ˆç‡ã€‚</li></ul></li><li><strong>å®Œæ•´æ€§ä¿æŠ¤ï¼ˆIntegrity Protectionï¼‰</strong><ul><li>ä½¿ç”¨æ¶ˆæ¯æ‘˜è¦æœºåˆ¶ï¼ˆå¦‚ HMACï¼‰ä¿è¯æ•°æ®æœªè¢«ç¯¡æ”¹ã€‚</li></ul></li><li><strong>æ”¯æŒå¤šåŸŸå&#x2F;IPï¼ˆé€šè¿‡ SANï¼‰</strong><ul><li>å¯åœ¨ä¸€ä¸ªè¯ä¹¦ä¸­é…ç½®å¤šä¸ªåŸŸåã€IP åœ°å€ç­‰è®¿é—®æ–¹å¼ã€‚</li></ul></li></ol><p>æ¯”å¦‚æˆ‘ä»¬æµè§ˆå™¨é‡Œå¸¸ç”¨çš„httpsåè®®ï¼Œå°±é€šè¿‡TLSçš„èº«ä»½è®¤è¯æœºåˆ¶ï¼Œæ„å»ºå‡ºäº†ä¸€å¥—å®Œæ•´çš„<code>ä¿¡ä»»é“¾</code>ä½“ç³»ï¼Œä»¥æ­¤æ¥ä¿æŠ¤æˆ‘ä»¬çš„ä¸Šç½‘å®‰å…¨ï¼Œåœ¨æˆ‘ä»¬è«åå¥‡å¦™çš„è¿›å…¥åˆ°ä¸€ä¸ªæœªç»è®¤è¯çš„é’“é±¼ç½‘ç«™æ—¶ï¼Œç»™å‡ºè­¦ç¤ºã€‚</p><p><img src="/../../../images/tech/safe/tls/google_https.png" alt="ç»è¿‡å®‰å…¨è®¤è¯çš„ç½‘ç«™"></p><h2 id="ğŸ—ï¸-TLSè¯ä¹¦è‡ªå®šä¹‰ç­¾å‘"><a href="#ğŸ—ï¸-TLSè¯ä¹¦è‡ªå®šä¹‰ç­¾å‘" class="headerlink" title="ğŸ—ï¸ TLSè¯ä¹¦è‡ªå®šä¹‰ç­¾å‘"></a>ğŸ—ï¸ TLSè¯ä¹¦è‡ªå®šä¹‰ç­¾å‘</h2><h3 id="å…ˆç”Ÿæˆæ ¹è¯ä¹¦åŠkey"><a href="#å…ˆç”Ÿæˆæ ¹è¯ä¹¦åŠkey" class="headerlink" title="å…ˆç”Ÿæˆæ ¹è¯ä¹¦åŠkey"></a>å…ˆç”Ÿæˆæ ¹è¯ä¹¦åŠkey</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># åˆ›å»ºè¯ä¹¦ç›®å½•</span><br><span class="hljs-built_in">mkdir</span> -p certs<br><br><span class="hljs-comment"># åœ¨å—ä¿¡ä»»çš„æœºå™¨ï¼ˆå¦‚ç®¡ç†å‘˜ç¬”è®°æœ¬æˆ–å—æ§è¿ç»´èŠ‚ç‚¹ï¼‰ä¸Šç”Ÿæˆ CA ç§é’¥ï¼Œå»ºè®®ä½¿ç”¨å¼ºåŠ å¯†å¹¶ä¿æŠ¤ç§é’¥æ–‡ä»¶æƒé™</span><br>openssl genrsa -aes256 -out ca-key.pem 4096<br></code></pre></td></tr></table></figure><ul><li>-aes256 è¡¨ç¤ºä½¿ç”¨ AES-256 åŠ å¯†ç§é’¥</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># ä½¿ç”¨ä¸Šä¸€æ­¥ç”Ÿæˆçš„ CA ç§é’¥ï¼Œåˆ›å»ºè‡ªç­¾å CA è¯ä¹¦ï¼Œè®¾å®šåˆé€‚çš„ CN å’Œæœ‰æ•ˆæœŸï¼š</span><br>openssl req -new -x509 -days 3650 -key ca-key.pem -sha256 -out ca.pem -subj <span class="hljs-string">&quot;/CN=docker.com/O=MyCompany&quot;</span><br><br></code></pre></td></tr></table></figure><ul><li>-x509 è¡¨ç¤ºç”Ÿæˆè‡ªç­¾åè¯ä¹¦</li><li>-days 3650 è¡¨ç¤ºè¯ä¹¦æœ‰æ•ˆæœŸ 10 å¹´</li><li>-subj â€œ&#x2F;CN&#x3D;docker-CAâ€ ä¸­CN (Common Name) ï¼Œå¯ä»¥æ ‡è¯†ä¸€äº›è¯ä¹¦çš„ä¿¡æ¯ã€ç”¨é€”ç­‰ï¼Œæ¯”å¦‚åŸŸåç­‰ &#x2F;Oç»„ç»‡ï¼Œè¯ä¹¦æ‰€å±ç»„ç»‡</li></ul><p>å¯é€‰çš„<code>subj</code>å­—æ®µå†…å®¹</p><table><thead><tr><th>å­—æ®µç¼©å†™</th><th>å…¨ç§°</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>CN</code></td><td>Common Name</td><td><code>/CN=example.com</code></td></tr><tr><td><code>O</code></td><td>Organization</td><td><code>/O=My Company</code></td></tr><tr><td><code>OU</code></td><td>Organizational Unit</td><td><code>/OU=IT Department</code></td></tr><tr><td><code>L</code></td><td>Locality</td><td><code>/L=Beijing</code></td></tr><tr><td><code>ST</code></td><td>State or Province</td><td><code>/ST=Beijing</code></td></tr><tr><td><code>C</code></td><td>Country</td><td><code>/C=CN</code></td></tr><tr><td><code>emailAddress</code></td><td>Email Address</td><td><code>/emailAddress=admin@example.com</code></td></tr></tbody></table><h3 id="æ ¹æ®æ ¹è¯ä¹¦åˆ›å»ºæœåŠ¡ç«¯è¯ä¹¦"><a href="#æ ¹æ®æ ¹è¯ä¹¦åˆ›å»ºæœåŠ¡ç«¯è¯ä¹¦" class="headerlink" title="æ ¹æ®æ ¹è¯ä¹¦åˆ›å»ºæœåŠ¡ç«¯è¯ä¹¦"></a>æ ¹æ®æ ¹è¯ä¹¦åˆ›å»ºæœåŠ¡ç«¯è¯ä¹¦</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># ç”ŸæˆæœåŠ¡ç«¯ç§é’¥å’Œè¯ä¹¦</span><br>openssl genrsa -out server-key.pem 4096<br>openssl req -subj <span class="hljs-string">&quot;/CN=&lt;æœåŠ¡å™¨IPæˆ–åŸŸå&gt;&quot;</span> -sha256 -new -key server-key.pem -out server.csr<br><span class="hljs-comment"># é…ç½®</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;subjectAltName = IP:&lt;æœåŠ¡å™¨IP&gt;,IP:127.0.0.1&quot;</span> &gt; extfile.cnf<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;extendedKeyUsage = serverAuth&quot;</span> &gt;&gt; extfile.cnf<br><br><span class="hljs-comment"># åˆ›å»ºè¯ä¹¦</span><br>openssl x509 -req -days 3650 -<span class="hljs-keyword">in</span> server.csr -CA ca.pem -CAkey ca-key.pem -CAcreateserial -out server-cert.pem -extfile extfile.cnf<br><span class="hljs-comment"># ç­¾å‘å®Œæˆåï¼Œå¯åˆ é™¤ CSR å’Œæ‰©å±•é…ç½®æ–‡ä»¶ä»¥å‡å°‘æ³„éœ²é£é™©</span><br><span class="hljs-comment"># rm server.csr extfile.cnf</span><br></code></pre></td></tr></table></figure><h3 id="æ ¹æ®æ ¹è¯ä¹¦åˆ›å»ºå®¢æˆ·ç«¯è¯ä¹¦"><a href="#æ ¹æ®æ ¹è¯ä¹¦åˆ›å»ºå®¢æˆ·ç«¯è¯ä¹¦" class="headerlink" title="æ ¹æ®æ ¹è¯ä¹¦åˆ›å»ºå®¢æˆ·ç«¯è¯ä¹¦"></a>æ ¹æ®æ ¹è¯ä¹¦åˆ›å»ºå®¢æˆ·ç«¯è¯ä¹¦</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># ç”Ÿæˆå®¢æˆ·ç«¯ç§é’¥å’Œè¯ä¹¦</span><br>openssl genrsa -out client-key.pem 4096<br>openssl req -subj <span class="hljs-string">&quot;/CN=client&quot;</span> -new -key client-key.pem -out client.csr<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;extendedKeyUsage = clientAuth&quot;</span> &gt; extfile-client.cnf<br>openssl x509 -req -days 3650 -<span class="hljs-keyword">in</span> client.csr -CA ca.pem -CAkey ca-key.pem -CAcreateserial -out client-cert.pem -extfile extfile-client.cnf<br></code></pre></td></tr></table></figure><h3 id="é…ç½®è¯ä¹¦æƒé™"><a href="#é…ç½®è¯ä¹¦æƒé™" class="headerlink" title="é…ç½®è¯ä¹¦æƒé™"></a>é…ç½®è¯ä¹¦æƒé™</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">chmod</span> -v 400 /etc/docker/certs/*key.pem   <span class="hljs-comment"># ç§é’¥ä»…å…è®¸ root è¯»å–</span><br><span class="hljs-built_in">chmod</span> -v 444 /etc/docker/certs/*.pem      <span class="hljs-comment"># è¯ä¹¦æ–‡ä»¶åªè¯»[8](@ref)</span><br></code></pre></td></tr></table></figure><h3 id="éªŒè¯è¯ä¹¦"><a href="#éªŒè¯è¯ä¹¦" class="headerlink" title="éªŒè¯è¯ä¹¦"></a>éªŒè¯è¯ä¹¦</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">openssl s_client -connect &lt;æœåŠ¡å™¨IP&gt;:&lt;ç«¯å£&gt; -CAfile ~/.docker/ca.pem -cert ~/.docker/client-cert.pem -key ~/.docker/client-key.pem<br></code></pre></td></tr></table></figure><p>å¦‚æœè¾“å‡ºä»¥ä¸‹å†…å®¹ï¼Œè¡¨åè¯ä¹¦æœ‰æ•ˆ</p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs lasso">CONNECTED(<span class="hljs-number">00000003</span>)<br><span class="hljs-params">...</span><br>SSL handshake has read XXX <span class="hljs-built_in">bytes</span> <span class="hljs-literal">and</span> written XXX <span class="hljs-built_in">bytes</span><br><span class="hljs-params">...</span><br>Verify <span class="hljs-keyword">return</span> code: <span class="hljs-number">0</span> (ok)<br></code></pre></td></tr></table></figure><h2 id="ä¸€é”®åˆ›å»ºè¯ä¹¦è„šæœ¬"><a href="#ä¸€é”®åˆ›å»ºè¯ä¹¦è„šæœ¬" class="headerlink" title="ä¸€é”®åˆ›å»ºè¯ä¹¦è„šæœ¬"></a>ä¸€é”®åˆ›å»ºè¯ä¹¦è„šæœ¬</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-comment"># è‡ªåŠ¨åˆ›å»ºtls å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯è¯ä¹¦</span><br><br><span class="hljs-comment"># é…ç½®å˜é‡</span><br>YOUR_COMPANY=<span class="hljs-string">&quot;your company&quot;</span>  <span class="hljs-comment"># å…¬å¸åç§°&quot;</span><br>SERVER_HOST=<span class="hljs-string">&quot;192.168.1.2&quot;</span>  <span class="hljs-comment"># æœåŠ¡åŸŸåæ›´å¥½</span><br>TIMEOUT_DAYS=365  <span class="hljs-comment"># è¯ä¹¦æœ‰æ•ˆæœŸ</span><br>PASSWORD=<span class="hljs-string">&quot;123456&quot;</span>  <span class="hljs-comment"># å¯†ç ä¿æŠ¤CAç§é’¥</span><br><br><span class="hljs-comment"># åˆ›å»ºè¯ä¹¦ç›®å½•</span><br><span class="hljs-built_in">mkdir</span> -p certs &amp;&amp; <span class="hljs-built_in">cd</span> certs<br><br><span class="hljs-comment"># åˆ›å»ºCAè¯ä¹¦</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ğŸ” æ­£åœ¨ç”ŸæˆåŠ å¯†çš„ RSA ç§é’¥...&quot;</span><br>openssl genrsa -aes256 -passout pass:<span class="hljs-variable">$PASSWORD</span>  -out ca-key.pem 4096<br>openssl req -new -x509 -days <span class="hljs-string">&quot;<span class="hljs-variable">$TIMEOUT_DAYS</span>&quot;</span> -key ca-key.pem -sha256 -passin pass:<span class="hljs-variable">$PASSWORD</span> -out ca.pem -subj <span class="hljs-string">&quot;/CN=<span class="hljs-variable">$SERVER_HOST</span>/O=<span class="hljs-variable">$YOUR_COMPANY</span>&quot;</span><br><br><span class="hljs-comment"># åˆ›å»ºæœåŠ¡ç«¯è¯ä¹¦</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ãŠ™ å¼€å§‹åˆ›å»ºæœåŠ¡ç«¯è¯ä¹¦...&quot;</span><br>openssl genrsa -out server-key.pem 4096<br>openssl req -subj <span class="hljs-string">&quot;/CN=<span class="hljs-variable">$SERVER_HOST</span>&quot;</span> -sha256 -new -key server-key.pem -out server.csr<br><span class="hljs-comment"># é…ç½®</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;subjectAltName = IP:<span class="hljs-variable">$SERVER_HOST</span>,IP:127.0.0.1&quot;</span> &gt; extfile.cnf<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;extendedKeyUsage = serverAuth&quot;</span> &gt;&gt; extfile.cnf<br><span class="hljs-comment"># åˆ›å»ºè¯ä¹¦</span><br>openssl x509 -req -days <span class="hljs-string">&quot;<span class="hljs-variable">$TIMEOUT_DAYS</span>&quot;</span> -<span class="hljs-keyword">in</span> server.csr -CA ca.pem -CAkey ca-key.pem -passin pass:<span class="hljs-variable">$PASSWORD</span> -CAcreateserial -out server-cert.pem -extfile extfile.cnf<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ãŠ™ æœåŠ¡ç«¯è¯ä¹¦åˆ›å»ºå®Œæˆï¼Œä¿å­˜ä¸º server-cert.pem, server-key.pem&quot;</span><br><br><span class="hljs-comment"># ç”Ÿæˆå®¢æˆ·ç«¯ç§é’¥å’Œè¯ä¹¦</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ğŸ”‘ å¼€å§‹åˆ›å»ºå®¢æˆ·ç«¯è¯ä¹¦...&quot;</span><br>openssl genrsa -out client-key.pem 4096<br>openssl req -subj <span class="hljs-string">&quot;/CN=client&quot;</span> -new -key client-key.pem -out client.csr<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;extendedKeyUsage = clientAuth&quot;</span> &gt; extfile-client.cnf<br>openssl x509 -req -days <span class="hljs-string">&quot;<span class="hljs-variable">$TIMEOUT_DAYS</span>&quot;</span> -<span class="hljs-keyword">in</span> client.csr -CA ca.pem -CAkey ca-key.pem -passin pass:<span class="hljs-variable">$PASSWORD</span> -CAcreateserial -out client-cert.pem -extfile extfile-client.cnf<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ğŸ”‘ å®¢æˆ·ç«¯è¯ä¹¦åˆ›å»ºå®Œæˆï¼Œä¿å­˜ä¸º client-cert.pem å’Œ client-key.pem&quot;</span><br><br><span class="hljs-comment"># æ¸…ç†ä¸´æ—¶æ–‡ä»¶</span><br><span class="hljs-comment"># ç­¾å‘å®Œæˆåï¼Œå¯åˆ é™¤ CSR å’Œæ‰©å±•é…ç½®æ–‡ä»¶ä»¥å‡å°‘æ³„éœ²é£é™©</span><br><span class="hljs-built_in">read</span> -p <span class="hljs-string">&quot;æ˜¯å¦åˆ é™¤ä¸´æ—¶æ–‡ä»¶ (server.csr, extfile.cnf, client.csr, extfile-client.cnf)? [y/n] &quot;</span> -r answer<br><span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$answer</span> =~ ^[Yy]$ ]]; <span class="hljs-keyword">then</span><br>    <span class="hljs-built_in">rm</span> server.csr extfile.cnf client.csr extfile-client.cnf<br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ä¸´æ—¶æ–‡ä»¶å·²åˆ é™¤ã€‚&quot;</span><br><span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ä¸´æ—¶æ–‡ä»¶ä¿ç•™ã€‚&quot;</span><br><span class="hljs-keyword">fi</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tls</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ™®ç½—ç±³ä¿®æ–¯è‡ªå®šä¹‰labelä½œä¸ºå˜é‡çš„æ˜¾ç¤ºå€¼å’Œå®é™…å€¼</title>
    <link href="/2025/05/27/frame-prometheus-select-label-var/"/>
    <url>/2025/05/27/frame-prometheus-select-label-var/</url>
    
    <content type="html"><![CDATA[<h2 id="ç°è±¡"><a href="#ç°è±¡" class="headerlink" title="ç°è±¡"></a>ç°è±¡</h2><p>å½“ä½¿ç”¨æ™®ç½—ç±³ä¿®æ–¯ç›‘æ§mysqlçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯dockeræ¥éƒ¨ç½²prometheusï¼Œä½¿ç”¨dockerç‰ˆçš„<code>mysqld-exporter</code>æ¥å®ç°å¯¹mysqlæŒ‡æ ‡çš„ç›‘æ§ã€‚</p><p>ç„¶åï¼Œé—®é¢˜æ¥äº†, åœ¨æ™®ç½—ç±³ä¿®æ–¯çš„æ¶æ„ä½“ç³»ä¸­ï¼Œæ™®ç½—ç±³ä¿®æ–¯è´Ÿè´£ä»<code>mysqld-exporter</code>æ¥æ‹‰å–æ•°æ®ï¼Œç„¶ååœ¨grafanaçœ‹æ¿é‡Œå±•ç¤ºç›‘æ§çš„æŒ‡æ ‡,è€Œæˆ‘ä»¬ä¸ºäº†èŠ‚çœæœºå™¨ï¼ˆå½“ç„¶ç¬¬ä¸€æ¬¡éƒ¨ç½²ä¹Ÿä¸ç†Ÿï¼‰ï¼Œå°†prometheuså’Œ<code>mysqld-exporter</code>éƒ¨ç½²åœ¨äº†ä¸€å°æœºå™¨ä¸Šï¼Œç„¶ååˆ©ç”¨<code>mysqld-exporter</code>è¿œç¨‹æŠ“å–çš„åŠŸèƒ½ä»mysqlæœåŠ¡å™¨é‡ŒæŠ“å–æ•°æ®ã€‚</p><p>ç†è®ºä¸Šï¼Œè¿™ä¹ˆè·‘ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œæˆ‘ä»¬ä¹ŸæˆåŠŸçš„å°†æ•°æ®æŠ“å–åˆ°äº†ã€‚</p><p>ä½†æ˜¯åœ¨æ˜¾ç¤ºçš„æ—¶å€™ï¼Œåœ¨hostä¸»æœºç­›é€‰æ¡†é‡Œï¼Œæ˜¾ç¤ºçš„æ˜¯<code>mysqld-exporter</code>æ‰€åœ¨çš„ä¸»æœºçš„ipåœ°å€ï¼Œè€Œæˆ‘ä»¬å®é™…æƒ³è¦çš„æ˜¯mysqlæœåŠ¡å™¨çš„ipåœ°å€ã€‚</p><p>ä»¥ä¸‹æ˜¯æˆ‘ä»¬å½“æ—¶çš„éªŒè¯é˜¶æ®µçš„prometheusæ¶æ„ï¼š</p><p><img src="/../../images/tech/frame/prome/my_prometheus_mysql_frame.png" alt="æ™®ç½—ç±³ä¿®æ–¯è¿œç¨‹é‡‡é›†mysqlæ¶æ„"></p><p>hostç­›é€‰çš„æ•ˆæœï¼š</p><p><img src="/../../images/tech/frame/prome/my_prometheus_mysql_host_real.png" alt="æ˜¾ç¤ºexporteræ‰€åœ¨çš„host"></p><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>ä¸­é—´çš„è¯•é”™è¿‡ç¨‹å°±ä¸è¯´äº†ï¼Œç›´æ¥è¿›å…¥ä¸»é¢˜ã€‚</p><p>æ ¸å¿ƒæ€è·¯ï¼š</p><ol><li>Prometheusæ”¯æŒè‡ªå®šä¹‰labelåŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é…ç½®mysqlé‡‡é›†å™¨çš„æ—¶å€™ï¼ŒæŠŠmysqlçš„å®é™…ipå½“åšä¸€ä¸ªlabelé…ç½®è¿›å»</li><li>grafanaåœ¨é…ç½®å˜é‡çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡æ­£åˆ™çš„æ–¹å¼ï¼Œå®ç°ä¸‹æ‹‰åˆ—è¡¨ä¸­<code>æ˜¾ç¤ºå€¼-å®é™…å€¼</code>è¿™ç§é”®å€¼å¯¹çš„åŠŸèƒ½</li></ol><h3 id="å¢åŠ mysql-server-ip-è‡ªå®šä¹‰label"><a href="#å¢åŠ mysql-server-ip-è‡ªå®šä¹‰label" class="headerlink" title="å¢åŠ mysql_server_ip è‡ªå®šä¹‰label"></a>å¢åŠ <code>mysql_server_ip</code> è‡ªå®šä¹‰label</h3><p>ä¿®æ”¹æ™®ç½—ç±³ä¿®æ–¯é…ç½®æ–‡ä»¶<code>prometheus.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">scrape_configs:</span> <br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">job_name:</span> <span class="hljs-string">&#x27;mysql&#x27;</span><br>    <span class="hljs-attr">scrape_interval:</span> <span class="hljs-string">10s</span><br>    <span class="hljs-attr">static_configs:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">targets:</span><br>         <span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;192.168.202.172:9104&#x27;</span><br>        <span class="hljs-attr">labels:</span><br>           <span class="hljs-attr">mysql_server_ip:</span> <span class="hljs-number">192.168</span><span class="hljs-number">.202</span><span class="hljs-number">.48</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">targets:</span><br>         <span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;192.168.202.172:9105&#x27;</span><br>        <span class="hljs-attr">labels:</span><br>           <span class="hljs-attr">mysql_server_ip:</span> <span class="hljs-number">192.168</span><span class="hljs-number">.202</span><span class="hljs-number">.248</span><br></code></pre></td></tr></table></figure><p>é‡å¯ç”Ÿæ•ˆã€‚</p><p>ç„¶åç™»å½•prometheusåç«¯: <a href="http://ip:9090/targets">http://ip:9090/targets</a>, æŸ¥çœ‹æˆ‘ä»¬æ–°å¢çš„<code>mysql_server_ip</code> labelæ˜¯å¦ç”Ÿæ•ˆï¼Œæ­¤æ—¶åœ¨æˆ‘ä»¬çš„mysqlä¸€æ ä¸­ï¼Œåº”è¯¥å·²ç»æœ‰äº†<code>mysql_server_ip</code>è¿™ä¸ªlabelï¼Œä¸”å€¼å°±æ˜¯å¯¹åº”mysqlçš„å®é™…ipã€‚</p><h3 id="é…ç½®grafanaå˜é‡"><a href="#é…ç½®grafanaå˜é‡" class="headerlink" title="é…ç½®grafanaå˜é‡"></a>é…ç½®grafanaå˜é‡</h3><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç™»å½•grafanaï¼Œè¿›å…¥å˜é‡é…ç½®é¡µé¢ï¼Œæ·»åŠ å˜é‡ï¼Œé€‰æ‹©<code>Query result</code> ç±»å‹ã€‚</p><p>åœ¨query ä¸€æ  è¾“å…¥ <code>mysql_up</code>, è¿™ä¼šæŸ¥å‡ºæ‰€æœ‰mysqlç”Ÿæ•ˆçš„ç»“æœé›†ã€‚ å¯ä»¥æ‰§è¡Œé¡µé¢å°¾éƒ¨çš„<code>run query</code>é¢„è§ˆç»“æœã€‚</p><p>ç„¶ååœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸€æ è¾“å…¥ <code>/mysql_server_ip=&quot;(?&lt;text&gt;[^&quot;]+)|instance=&quot;(?&lt;value&gt;[^&quot;]+)/g</code> å³å¯ã€‚</p><p>è¿™æ®µæ­£åˆ™çš„å«ä¹‰æ˜¯ï¼šä»queryçš„ç»“æœä¸­ï¼Œæå–å‡ºmysql_server_ipè¿™ä¸ªlabelçš„å€¼ï¼Œä½œä¸ºæ˜¾ç¤ºå€¼ï¼Œinstanceè¿™ä¸ªlabelçš„å€¼ä½œä¸ºå®é™…å€¼ã€‚</p><h3 id="ä¿å­˜ç”Ÿæ•ˆ"><a href="#ä¿å­˜ç”Ÿæ•ˆ" class="headerlink" title="ä¿å­˜ç”Ÿæ•ˆ"></a>ä¿å­˜ç”Ÿæ•ˆ</h3><p>è‡³æ­¤ï¼Œæˆ‘ä»¬çš„è‡ªå®šä¹‰ä¸‹æ‹‰é€‰æ‹©æ¡†å°±å®Œæˆäº†ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="/../../images/tech/frame/prome/my_prometheus_mysql_host_display_name.png" alt="æ˜¾ç¤ºå®é™…çš„mysqlåœ°å€"></p><p>å½“æˆ‘ä»¬é€‰æ‹©æ˜¾ç¤ºå€¼<code>192.168.202.48</code>æ—¶ï¼Œhostè·å¾—çš„æ˜¯å…¶å¯¹åº”çš„å®é™…å€¼<code>192.168.202.172:9104</code>ã€‚</p><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æ•´ä¸ªmysqlæ¨¡æ¿ä¸ç”¨å¤§æ”¹çš„æƒ…å†µä¸‹ï¼Œå®ç°äº†æ˜¾ç¤ºmysqlå®é™…ipåœ°å€çš„åŠŸèƒ½äº†ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å½“ç„¶ï¼Œåœ¨ä¸Šè¿°çš„å®è·µä¸­ï¼Œæˆ‘ä»¬çš„æ¶æ„æ˜¯æœ‰ç‚¹é—®é¢˜çš„ï¼Œ<code>mysqld-exporter</code>ä¸åº”è¯¥å’Œprometheuséƒ¨ç½²åœ¨ä¸€èµ·çš„ï¼Œè€Œæ˜¯åº”è¯¥éƒ¨ç½²åˆ°mysqlçš„æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·ï¼Œä¸Šé¢çš„é—®é¢˜ä¹Ÿå°±ä¸å­˜åœ¨äº†ã€‚</p><p>æˆ‘ä»¬åªæ˜¯åˆ©ç”¨è¿™ä¸ªå¥‘æœºï¼Œè°ƒç ”å­¦ä¹ äº†ä¸€ä¸‹prometheusçš„è‡ªå®šä¹‰labelåŠŸèƒ½ï¼Œä»¥åŠè‡ªå®šä¹‰é…ç½®grafanaçš„ä¸‹æ‹‰é€‰æ‹©æ¡†çš„é…ç½®æ–¹æ³•ã€‚</p><p>ä»¥ä¸‹æ˜¯Prometheusçš„æ¨èæ¶æ„ï¼š</p><p><img src="/../../images/tech/frame/prome/prometheus_recommand_frame.png" alt="prometheusæ¶æ„"></p><p><code>mysqld-exporter</code>çš„æ¨èä½¿ç”¨ï¼š</p><p><img src="/../../images/tech/frame/prome/prometheus_recommand_mysql_exporter.png" alt="mysqld-exporteræ¨èä½¿ç”¨"></p><h2 id="é«˜çº§ç©æ³•"><a href="#é«˜çº§ç©æ³•" class="headerlink" title="é«˜çº§ç©æ³•"></a>é«˜çº§ç©æ³•</h2><p>å…¶å®ï¼ŒPrometheusåœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œè¿˜æä¾›äº†ä¸€å¥—<code>å†é…ç½®label</code>çš„è¯­æ³•ï¼Œå¯ä»¥å®ç°å¯¹ä¸€äº›åŸç”Ÿlabelçš„äºŒæ¬¡ä¿®æ”¹ã€‚</p><p>å¤§è‡´é…ç½®å’Œæ•ˆæœå¦‚ä¸‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">scrape_configs:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">job_name:</span> <span class="hljs-string">&#x27;mysql_job&#x27;</span><br>    <span class="hljs-attr">static_configs:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">targets:</span> [<span class="hljs-string">&#x27;localhost:9090&#x27;</span>]<br><br>    <span class="hljs-attr">metric_relabel_configs:</span><br>      <span class="hljs-comment"># åˆ é™¤æ‰æ‰€æœ‰ä»¥&quot;temp_&quot;å¼€å¤´çš„æ ‡ç­¾</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">source_labels:</span> [<span class="hljs-string">__name__</span>]<br>        <span class="hljs-attr">action:</span> <span class="hljs-string">drop</span><br>        <span class="hljs-attr">regex:</span> <span class="hljs-string">&#x27;temp_.*&#x27;</span><br><br>      <span class="hljs-comment"># å°†`instance`æ ‡ç­¾å€¼æ”¹ä¸º`host`</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">source_labels:</span> [<span class="hljs-string">instance</span>]<br>        <span class="hljs-attr">target_label:</span> <span class="hljs-string">host</span><br>        <span class="hljs-attr">action:</span> <span class="hljs-string">replace</span><br>        <span class="hljs-attr">regex:</span> <span class="hljs-string">&#x27;(.*)&#x27;</span><br>        <span class="hljs-attr">replacement:</span> <span class="hljs-string">&#x27;$1&#x27;</span><br><br>      <span class="hljs-comment"># åˆ é™¤æ‰æ‰€æœ‰æ²¡æœ‰&quot;job&quot;æ ‡ç­¾çš„æ—¶é—´åºåˆ—</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">source_labels:</span> [<span class="hljs-string">job</span>]<br>        <span class="hljs-attr">action:</span> <span class="hljs-string">drop</span><br>        <span class="hljs-attr">regex:</span> <span class="hljs-string">&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>å®Œæ•´çš„relabel_configé…ç½®å¦‚ä¸‹æ‰€ç¤ºï¼š</p><table><thead><tr><th>å­—æ®µ</th><th>å«ä¹‰</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td><code>source_labels</code></td><td>ç”¨äºæ‹¼æ¥å¹¶åŒ¹é…çš„åŸå§‹æ ‡ç­¾åˆ—è¡¨ï¼Œå†…å®¹æŒ‰ <code>separator</code> è¿æ¥åä¸ <code>regex</code> å¯¹æ¯”</td><td><code>[]</code></td></tr><tr><td><code>separator</code></td><td>å¤šä¸ª <code>source_labels</code> æ‹¼æ¥æ—¶çš„åˆ†éš”ç¬¦</td><td><code>&quot;;&quot;</code></td></tr><tr><td><code>regex</code></td><td>ç”¨äºåŒ¹é…æ‹¼æ¥åå­—ç¬¦ä¸²çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œæ”¯æŒæ•è·ç»„ï¼Œå¸¸ç”¨æ¥æå–å­ä¸²</td><td><code>&quot;(.*)&quot;</code></td></tr><tr><td><code>target_label</code></td><td>åŒ¹é…æˆåŠŸåæ–°æ ‡ç­¾çš„åç§°ï¼›åœ¨æŸäº› <code>action</code> ä¸‹è¡¨ç¤ºç›®æ ‡æ ‡ç­¾</td><td>â€”</td></tr><tr><td><code>replacement</code></td><td>ç”¨äºæ›¿æ¢çš„æ–°å€¼ï¼Œæ”¯æŒ <code>$1</code>ã€<code>$2</code> ç­‰æ•è·ç»„å¼•ç”¨</td><td><code>&quot;$1&quot;</code></td></tr><tr><td><code>modulus</code></td><td>ä»…å¯¹ <code>hashmod</code> æœ‰æ•ˆï¼ŒæŒ‡å®šå“ˆå¸Œå–æ¨¡çš„é™¤æ•°</td><td><code>â€”</code></td></tr><tr><td><code>action</code></td><td>æ‰§è¡Œçš„æ“ä½œç±»å‹ï¼ŒåŒ…æ‹¬ <code>replace</code>ã€<code>keep</code>ã€<code>drop</code>ã€<code>hashmod</code>ã€<code>labelmap</code>ã€<code>labeldrop</code>ã€<code>labelkeep</code>ã€<code>keepequal</code>ã€<code>dropequal</code>ã€<code>lowercase</code>ã€<code>uppercase</code></td><td><code>&quot;replace&quot;</code></td></tr></tbody></table><hr><p>å…¶ä¸­actionçš„æšä¸¾ï¼š</p><ol><li><strong>replace</strong>ï¼šä½¿ç”¨ <code>regex</code> ä¸ <code>replacement</code> ä¿®æ”¹æˆ–æ–°å¢æ ‡ç­¾å€¼ï¼ˆé»˜è®¤ï¼‰ </li><li><strong>keep &#x2F; drop</strong>ï¼šæ ¹æ® <code>regex</code> ä¿ç•™æˆ–ä¸¢å¼ƒæ•´ä¸ªç›®æ ‡ï¼ˆå½“åŒ¹é…å¤±è´¥æ—¶ï¼Œä¼šè·³è¿‡è¯¥ç›®æ ‡ï¼‰ </li><li><strong>hashmod</strong>ï¼šå¯¹æ‹¼æ¥åå†…å®¹åšå“ˆå¸Œå¹¶å–æ¨¡ï¼Œé€šå¸¸ç”¨äºå‡åŒ€åˆ†æµæˆ–åˆ†åŒº </li><li><strong>labelmap</strong>ï¼šå¯¹æ ‡ç­¾åç§°åšæ­£åˆ™æ›¿æ¢ï¼Œä¾‹å¦‚å°†æ‰€æœ‰ <code>__meta_kubernetes_*</code> æ ‡ç­¾ç»Ÿä¸€å‰ç¼€</li><li><strong>labeldrop &#x2F; labelkeep</strong>ï¼šæ‰¹é‡åˆ é™¤æˆ–ä¿ç•™ä¸ <code>regex</code> åŒ¹é…çš„æ ‡ç­¾åç§° </li><li><strong>keepequal &#x2F; dropequal</strong>ï¼šä»…å½“æŸä¸¤ä¸ªæ ‡ç­¾å€¼ç›¸ç­‰æˆ–ä¸ç­‰æ—¶æ‰ä¿ç•™æˆ–ä¸¢å¼ƒç›®æ ‡</li><li><strong>lowercase &#x2F; uppercase</strong>ï¼šå°†æŒ‡å®šæ ‡ç­¾å€¼è½¬æ¢ä¸ºå°å†™æˆ–å¤§å†™</li></ol><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://grafana.com/docs/grafana/latest/dashboards/variables/add-template-variables/#filter-variables-with-regex">grafanaçš„æ­£åˆ™è¡¨è¾¾å¼åŠŸèƒ½</a></p><p><a href="https://grafana.com/blog/2022/03/21/how-relabeling-in-prometheus-works/?utm_source=chatgpt.com">relabel é…ç½®æ–‡æ¡£</a></p>]]></content>
    
    
    <categories>
      
      <category>æ¡†æ¶</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ™®ç½—ç±³ä¿®æ–¯</tag>
      
      <tag>prometheus</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JDK 21æ–°ç‰¹æ€§ç®€ä»‹</title>
    <link href="/2025/04/21/java-jdk-v21/"/>
    <url>/2025/04/21/java-jdk-v21/</url>
    
    <content type="html"><![CDATA[<p>æŒ‰ç…§JDKæ¯åŠå¹´å‘å¸ƒä¸€æ¬¡ç‰ˆæœ¬çš„èŠ‚å¥, JDK21åœ¨2023å¹´9æœˆ19æ—¥å‘å¸ƒï¼Œæ˜¯ä¸€ä¸ªé•¿æœŸæ”¯æŒç‰ˆæœ¬, æœ¬æ–‡å°±æ˜¯ç®€å•ä»‹ç»ä¸€ä¸‹è¿™æ¬¡æ›´æ–°çš„æ–°ç‰¹æ€§ä¸æ”¹åŠ¨.</p><p>ä¸€å¥è¯æ€»ç»“, è¿™ä»ç„¶æ˜¯jdkçš„ä¸€ä¸ªçŸ­æœŸæ”¯æŒç‰ˆæœ¬,æ­¤ç‰ˆæœ¬åŒ…æ‹¬7ä¸ª JEPï¼ˆjdkå¢å¼ºå»ºè®®ï¼‰ï¼Œä»¥åŠæ•°ç™¾ä¸ªè¾ƒå°çš„åŠŸèƒ½å¢å¼ºå’Œæ•°åƒä¸ªé”™è¯¯ä¿®å¤.</p><h2 id="æ–°ç‰¹æ€§æ±‡æ€»"><a href="#æ–°ç‰¹æ€§æ±‡æ€»" class="headerlink" title="æ–°ç‰¹æ€§æ±‡æ€»"></a>æ–°ç‰¹æ€§æ±‡æ€»</h2><h3 id="è¯­è¨€ç‰¹æ€§"><a href="#è¯­è¨€ç‰¹æ€§" class="headerlink" title="è¯­è¨€ç‰¹æ€§:"></a>è¯­è¨€ç‰¹æ€§:</h3><ul><li><strong><a href="https://openjdk.org/jeps/440">JEP 440</a> Record Patterns</strong>(è®°å½•æ¨¡å¼) : è®°å½•æ¨¡å¼æ˜¯ç»è¿‡äº†å‰ä¸¤ä¸ªç‰ˆæœ¬çš„å­µåŒ–ï¼Œè¿™ä¸ªç‰ˆæœ¬æ­£å¼å‘å¸ƒäº†ã€‚å…¶ç›®çš„æ˜¯å°†æˆ‘ä»¬ä»javaå¤æ‚çš„ç±»æ„é€ ä¸­è§£æ”¾å‡ºæ¥,æ›´å…³æ³¨äºæ•°æ®. ä¸€èˆ¬ç”¨äºä¸€ç»„æ•°æ®æ„æˆçš„ä¸€ä¸ªæ•´ä½“,æ¯”å¦‚åæ ‡point(x,y)ã€‚è®°å½•æ¨¡å¼å¯ä»¥åµŒå¥—ï¼Œswitchä¹Ÿæ”¯æŒè®°å½•æ¨¡å¼ã€‚</li><li><strong><a href="https://openjdk.org/jeps/441">JEP 4441</a> Pattern Matching for switch</strong>(switchè®°å½•æ¨¡å¼): switchå¢å¼ºï¼Œæ”¯æŒè®°å½•æ¨¡å¼ç­‰è§£æ.<ul><li>switch æ”¯æŒnullçš„åˆ¤æ–­ï¼Œä¸ç”¨åœ¨å¤–é¢åˆ¤æ–­ä¸€énulläº†ã€‚å½“ç„¶ä¸ºäº†å…¼å®¹æ€§ï¼Œå¦‚æœæ²¡æœ‰null case ,ä»ç„¶ä¼šæŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚</li><li>switch æ”¯æŒwhençš„è¯­æ³•æ”¯æŒï¼Œå¯ä»¥å¯¹caseçš„å­é›†è¿›è¡ŒäºŒæ¬¡åŒ¹é…ï¼Œè¿”å›å¸ƒå°”å€¼å³å¯</li><li>switch æ”¯æŒç±»å‹è‡ªåŠ¨æ¨æ–­ï¼ˆboolean ã€ long ã€ float å’Œ doubleç­‰åŸå§‹ç±»å‹ä¹‹å¤–çš„ç±»å‹ï¼‰</li><li>switch è®°å½•æ¨¡å¼æ³›å‹çš„è§£æ</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">I</span> &#123;&#125;<br><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testSwitch</span><span class="hljs-params">(Object o)</span> &#123;<br>    <span class="hljs-keyword">switch</span> (o) &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-literal">null</span> -&gt; &#123; &#125;<br>        <span class="hljs-keyword">case</span> Integer i -&gt; String.format(<span class="hljs-string">&quot;int %d&quot;</span>, i);<br>        <span class="hljs-keyword">case</span> Long l    -&gt; String.format(<span class="hljs-string">&quot;long %d&quot;</span>, l);<br>        <span class="hljs-keyword">case</span> Double d  -&gt; String.format(<span class="hljs-string">&quot;double %f&quot;</span>, d);<br>        <span class="hljs-keyword">case</span> String s<br>        <span class="hljs-keyword">when</span> s.equalsIgnoreCase(<span class="hljs-string">&quot;YES&quot;</span>) -&gt; &#123;<br>            System.out.println(<span class="hljs-string">&quot;You got it&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">case</span> String s<br>        <span class="hljs-keyword">when</span> s.equalsIgnoreCase(<span class="hljs-string">&quot;NO&quot;</span>) -&gt; &#123;<br>            System.out.println(<span class="hljs-string">&quot;Shame&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">case</span> String s -&gt; &#123;<br>            System.out.println(<span class="hljs-string">&quot;Sorry?&quot;</span>);<br>        &#125;<br>      <span class="hljs-keyword">case</span> Pair&lt;I&gt;(I fst, C snd) p -&gt; &#123;<br>        System.out.println(<span class="hljs-string">&quot;Sorry?&quot;</span>);<br>      &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="åº“å‡çº§"><a href="#åº“å‡çº§" class="headerlink" title="åº“å‡çº§"></a>åº“å‡çº§</h3><ul><li><strong><a href="https://openjdk.org/jeps/444">JEP 444</a> Virtual Threads</strong>(è™šçº¿ç¨‹) : å¯¹æ ‡goè¯­è¨€åç¨‹çš„è™šçº¿ç¨‹ç»ˆäºæŠ•å…¥äº†ä½¿ç”¨,ä¹Ÿå°±æ˜¯è¯´åœ¨ä¸€ä¸ªç³»ç»Ÿçº¿ç¨‹ä¸Šå¯ä»¥å†å¼€è¾Ÿå‡ºå¹³å°çº§çš„è™šçº¿ç¨‹æ¥å®ç°è½»é‡çº§å¹¶å‘<ul><li>æ ¹æ®å®˜æ–¹çš„å»ºè®®ï¼Œè™šçº¿ç¨‹å› ä¸ºæ›´è½»é‡ï¼Œæ‰€ä»¥ä¸ç”¨æä»€ä¹ˆè™šçº¿ç¨‹æ± ï¼Œéšç”¨éšå»ºå³å¯</li><li>è™šçº¿ç¨‹ä¸ç³»ç»Ÿçº¿ç¨‹çš„å…³ç³»æ˜¯M:N</li><li>G1 GC ä¸æ”¯æŒå·¨å¤§çš„æ ˆå—å¯¹è±¡ã€‚å¦‚æœä¸€ä¸ªè™šæ‹Ÿçº¿ç¨‹çš„æ ˆè¾¾åˆ°åŒºåŸŸå¤§å°çš„ä¸€åŠï¼Œå¯èƒ½å°è‡³ 512KBï¼Œé‚£ä¹ˆå¯èƒ½ä¼šæŠ›å‡º StackOverflowError</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è™šçº¿ç¨‹çš„è°ƒç”¨</span><br><span class="hljs-keyword">try</span> (<span class="hljs-type">var</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newVirtualThreadPerTaskExecutor()) &#123;<br>    IntStream.range(<span class="hljs-number">0</span>, <span class="hljs-number">10_000</span>).forEach(i -&gt; &#123;<br>        executor.submit(() -&gt; &#123;<br>            Thread.sleep(Duration.ofSeconds(<span class="hljs-number">1</span>));<br>            <span class="hljs-keyword">return</span> i;<br>        &#125;);<br>    &#125;);<br>&#125;  <span class="hljs-comment">// executor.close() is called implicitly, and waits</span><br></code></pre></td></tr></table></figure><ul><li><strong><a href="https://openjdk.org/jeps/431">JEP 431</a> Sequenced Collections</strong>(æœ‰åºé›†åˆ) : åŸå…ˆé›†åˆç±»æ¥å£æ˜¯æ²¡æœ‰åœ¨é¡ºåºæ–¹é¢çš„ç›¸å…³æ¥å£ï¼Œè¿™äº›éƒ½æ˜¯ä¾èµ–äºåº•å±‚å®ç°ç±»å®ç°çš„ï¼Œç°åœ¨è¿™äº›é¡¶å±‚æ¥å£è¡¥ä¸Šäº†è¿™ä¸€åŠŸèƒ½,ä¸»è¦å½±å“æ˜¯<code>collection</code>å’Œ<code>map</code>æ¥å£ã€‚<ul><li>æ–°å¢SequencedCollectionæ¥å£</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">SequencedMap</span>&lt;K,V&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Map</span>&lt;K,V&gt; &#123;<br>  <span class="hljs-keyword">interface</span> <span class="hljs-title class_">SequencedCollection</span>&lt;E&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Collection</span>&lt;E&gt; &#123;<br>    <span class="hljs-comment">// æ–°æ–¹æ³•</span><br>    SequencedCollection&lt;E&gt; <span class="hljs-title function_">reversed</span><span class="hljs-params">()</span>;<br>    <span class="hljs-comment">// ä» Deque æå–çš„æ–¹æ³•</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">addFirst</span><span class="hljs-params">(E)</span>;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">addLast</span><span class="hljs-params">(E)</span>;<br>    E <span class="hljs-title function_">getFirst</span><span class="hljs-params">()</span>;<br>    E <span class="hljs-title function_">getLast</span><span class="hljs-params">()</span>;<br>    E <span class="hljs-title function_">removeFirst</span><span class="hljs-params">()</span>;<br>    E <span class="hljs-title function_">removeLast</span><span class="hljs-params">()</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>æ–°å¢SequencedMap</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">SequencedMap</span>&lt;K,V&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Map</span>&lt;K,V&gt; &#123;<br>    <span class="hljs-comment">// æ–°æ–¹æ³•</span><br>    SequencedMap&lt;K,V&gt; <span class="hljs-title function_">reversed</span><span class="hljs-params">()</span>;<br>    SequencedSet&lt;K&gt; <span class="hljs-title function_">sequencedKeySet</span><span class="hljs-params">()</span>;<br>    SequencedCollection&lt;V&gt; <span class="hljs-title function_">sequencedValues</span><span class="hljs-params">()</span>;<br>    SequencedSet&lt;Entry&lt;K,V&gt;&gt; <span class="hljs-title function_">sequencedEntrySet</span><span class="hljs-params">()</span>;<br>    V <span class="hljs-title function_">putFirst</span><span class="hljs-params">(K, V)</span>;<br>    V <span class="hljs-title function_">putLast</span><span class="hljs-params">(K, V)</span>;<br>    <span class="hljs-comment">// ä» NavigableMap æå–çš„æ–¹æ³•</span><br>    Entry&lt;K, V&gt; <span class="hljs-title function_">firstEntry</span><span class="hljs-params">()</span>;<br>    Entry&lt;K, V&gt; <span class="hljs-title function_">lastEntry</span><span class="hljs-params">()</span>;<br>    Entry&lt;K, V&gt; <span class="hljs-title function_">pollFirstEntry</span><span class="hljs-params">()</span>;<br>    Entry&lt;K, V&gt; <span class="hljs-title function_">pollLastEntry</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>æœ€ç»ˆç±»å›¾ï¼š<br><img src="/../../images/tech/java/jdk21-seq-collection.png" alt="jdk21ä¸­æ–°å¢çš„æœ‰åºæ¥å£"></p><ul><li><strong><a href="https://openjdk.org/jeps/452">JEP 452</a> Key Encapsulation Mechanism API</strong>(å¯†é’¥å°è£…æœºåˆ¶) : ä¸€ç§ä½¿ç”¨å…¬é’¥å¯†ç å­¦æ¥ä¿æŠ¤å¯¹ç§°å¯†é’¥çš„åŠ å¯†æŠ€æœ¯,ç°åœ¨javaæŠŠè¿™å¥—æ ‡å‡†æ¥å£å®ç°ç±»ã€‚</li></ul><h3 id="æ€§èƒ½æå‡"><a href="#æ€§èƒ½æå‡" class="headerlink" title="æ€§èƒ½æå‡"></a>æ€§èƒ½æå‡</h3><ul><li><strong><a href="https://openjdk.org/jeps/439">JEP 439</a> Generational ZGC</strong>(ZGCåƒåœ¾å›æ”¶å™¨) : åƒåœ¾æ”¶é›†å™¨ï¼ˆZGCï¼‰æ‰©å±•åˆ°ç»´æŠ¤å¹´è½»å’Œæ—§å¯¹è±¡çš„å•ç‹¬ä»£ï¼Œæé«˜åº”ç”¨ç¨‹åºæ€§èƒ½</li></ul><h3 id="å…¶ä»–æ–°ç‰¹æ€§"><a href="#å…¶ä»–æ–°ç‰¹æ€§" class="headerlink" title="å…¶ä»–æ–°ç‰¹æ€§"></a>å…¶ä»–æ–°ç‰¹æ€§</h3><ul><li><strong><a href="https://openjdk.org/jeps/451">JEP 451</a> Prepare to Disallow the Dynamic Loading of Agents</strong>(å‡†å¤‡ç¦æ­¢åŠ¨æ€åŠ è½½Agents) : åŠ¨æ€åŠ è½½ï¼ˆAttach APIï¼‰å¯ä»¥åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œâ€œçƒ­åŠ è½½â€ä¸€äº›åŠŸèƒ½(æ¯”å¦‚ä¿®å¤bug)åˆ°è¿è¡Œçš„ç¨‹åºä¸­ï¼Œè¿™ä¸å®‰å…¨ï¼Œä¹Ÿä¸ç¬¦åˆä»£ç çš„å®Œæ•´æ€§ã€‚æ‰€ä»¥è¿™ä¸ªç‰ˆæœ¬ä¼šæç¤ºè­¦å‘Šï¼Œå¹¶åœ¨æœªæ¥å°†è¿™ä¸ªåŠŸèƒ½ç¦ç”¨ã€‚</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8301226">JDK-8301226</a> æ–°å¢Math.clamp() å’Œ StrictMath.clamp() æ–¹æ³•</strong> : è¿™ä¸¤ä¸ªæ–¹æ³•å¯ä»¥æ–¹ä¾¿åœ°å°†æ•°å€¼å€¼é™åˆ¶åœ¨æŒ‡å®šçš„æœ€å°å€¼å’Œæœ€å¤§å€¼ä¹‹é—´ã€‚</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8302590">JDK-8302590</a> æ–°å¢ String indexOf(int,int,int) å’Œ indexOf(String,int,int) æ–¹æ³•</strong> : æ·»åŠ äº†ä¸¤ä¸ªæ–°æ–¹æ³• indexOf(int ch, int beginIndex, int endIndex) å’Œ indexOf(String str, int beginIndex, int endIndex) åˆ° java.lang.String ä¸­ï¼Œä»¥æ”¯æŒå¯¹å­—ç¬¦ ch çš„å‰å‘æœç´¢ï¼Œä»¥åŠåˆ†åˆ«å¯¹ String str çš„æœç´¢ï¼Œå¹¶é™åˆ¶åœ¨æŒ‡å®šçš„ç´¢å¼•èŒƒå›´å†…ã€‚</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8305486">JDK-8305486</a> æ–°å¢ splitWithDelimiters æ–¹æ³•</strong> : ä¸è¿™äº› split() æ–¹æ³•ä¸åŒï¼Œåœ¨ <code>java.lang.String</code> å’Œ <code>java.util.regex.Pattern</code> ä¸­æ–°å¢çš„ <code>splitWithDelimiters()</code> æ–¹æ³•è¿”å›å­—ç¬¦ä¸²å’Œåˆ†éš”ç¬¦ï¼Œè€Œä¸ä»…ä»…æ˜¯å­—ç¬¦ä¸²ã€‚</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8302323">JDK-8302323</a> StringBuilderå’ŒStringBufferæ–°å¢ repeat æ–¹æ³•</strong> : sb.repeat(â€˜-â€˜, 80) å°†å°† 80 ä¸ªè¿å­—ç¬¦æ’å…¥åˆ° java.lang.StringBuilder sb å¯¹è±¡çš„å€¼ä¸­</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8305107">JDK-8305107</a> æ”¯æŒEmojiçš„æ­£åˆ™åŒ¹é…</strong> : å¯ä»¥ä½¿ç”¨æ–°çš„ \p{IsXXX} æ„é€ æ¥åŒ¹é…å…·æœ‰ Emoji ç›¸å…³å±æ€§çš„å­—ç¬¦, å¦‚ï¼š<code>Pattern.compile(&quot;\\p&#123;IsEmoji&#125;&quot;).matcher(&quot;ğŸ‰&quot;).matches()</code></li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8191565">JDK-8191565</a> Last Resort G1 Full GC Moves Humongous Objects</strong> : G1åƒåœ¾å›æ”¶æ—¶ä¼šç§»åŠ¨å·¨å‹å¯¹è±¡ï¼Œè¿™æ ·å¯ä»¥ä¿æŒå°½é‡å¤šçš„è¿ç»­ç©ºé—´ï¼Œæ–¹ä¾¿åç»­å·¨å‹å¯¹è±¡çš„åˆ†é…ã€‚</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8298127">JDK-8298127</a> æ–°å¢ HSS&#x2F;LMS ç­¾åéªŒè¯</strong> </li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8288050">JDK-8288050</a> PBES2 æ‘˜è¦ç®—æ³•æ–°å¢ SHA-512&#x2F;224 å’Œ SHA-512&#x2F;256 å®ç°</strong> </li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8301553">JDK-8301553</a> æ–°å¢åŸºäºå¯†ç çš„åŠ å¯†çš„ç®—æ³•SunPKCS11</strong> </li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8306560">JDK-8306560</a> JShell é‡Œå¯ä»¥è°ƒç”¨jdkå·¥å…·</strong> ï¼š æ¯”å¦‚åœ¨JShellé‡Œè°ƒç”¨<code>jmap</code>å·¥å…· </li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8208077">JDK-8208077</a> File::listRoots å°† Windows ä¸Šå¯ç”¨çš„é©±åŠ¨å™¨å…¨éƒ¨è¿”å›</strong> ï¼š åœ¨æœ¬æ¬¡ç‰ˆæœ¬ä¸­ï¼Œæ–¹æ³• java.io.File.listRoots() åœ¨ Microsoft Windows ä¸Šçš„è¡Œä¸ºå·²æ›´æ”¹ï¼Œè¿”å›çš„æ•°ç»„ç°åœ¨åŒ…æ‹¬æ‰€æœ‰å¯ç”¨ç£ç›˜é©±åŠ¨å™¨çš„ File å¯¹è±¡ã€‚è¿™ä¸ JDK 10 åˆ° JDK 20 ä¸­çš„è¡Œä¸ºä¸åŒï¼Œå½“æ—¶æ­¤æ–¹æ³•ä¼šè¿‡æ»¤æ‰ä¸å¯è®¿é—®æˆ–æ²¡æœ‰åª’ä½“çš„ç£ç›˜é©±åŠ¨å™¨ã€‚æ­¤æ›´æ”¹é¿å…äº†åœ¨å…ˆå‰ç‰ˆæœ¬ä¸­è§‚å¯Ÿåˆ°çš„æ€§èƒ½é—®é¢˜ï¼Œå¹¶ç¡®ä¿è¯¥æ–¹æ³•ä¸ FileSystem.getDefault().getRootDirectories() è¿”å›çš„æ ¹ç›®å½•è¿­ä»£ä¿æŒä¸€è‡´ã€‚</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8305092">JDK-8305092</a> Thread.sleep(millis, nanos) ç°åœ¨èƒ½å¤Ÿæ‰§è¡Œäºšæ¯«ç§’çº§ç¡çœ </strong> ï¼š Thread.sleep(millis, nanos) æ–¹æ³•èƒ½å¤Ÿåœ¨ POSIX å¹³å°ä¸Šæ‰§è¡Œäºšæ¯«ç§’çº§ç¡çœ ã€‚åœ¨æ­¤æ›´æ”¹ä¹‹å‰ï¼Œéé›¶ nanos å‚æ•°ä¼šå‘ä¸Šå–æ•´åˆ°å®Œæ•´çš„æ¯«ç§’ã€‚è™½ç„¶å¤§å¤šæ•° POSIX ç³»ç»Ÿä¸Šçš„ç²¾åº¦å¾—åˆ°äº†æé«˜ï¼Œä½†å®é™…çš„ç¡çœ æŒç»­æ—¶é—´ä»ç„¶å—ç³»ç»Ÿè®¾æ–½çš„ç²¾åº¦å’Œå‡†ç¡®æ€§çš„å½±å“ã€‚</li></ul><h2 id="é¢„è§ˆé˜¶æ®µç‰¹æ€§"><a href="#é¢„è§ˆé˜¶æ®µç‰¹æ€§" class="headerlink" title="é¢„è§ˆé˜¶æ®µç‰¹æ€§:"></a>é¢„è§ˆé˜¶æ®µç‰¹æ€§:</h2><h3 id="è¯­è¨€ç‰¹æ€§-1"><a href="#è¯­è¨€ç‰¹æ€§-1" class="headerlink" title="è¯­è¨€ç‰¹æ€§"></a>è¯­è¨€ç‰¹æ€§</h3><ul><li><strong><a href="https://openjdk.org/jeps/430">JEP 430</a> String Templates</strong>(å­—ç¬¦ä¸²æ¨¡æ¿) : å¯¹åŸæ¥çš„<code>str.format()</code>èƒ½åŠ›è¿›è¡Œäº†å¢å¼ºï¼Œä½¿å…¶å¯ä»¥æ›´æ˜“è¯»å’Œæ›´å®¹æ˜“ä½¿ç”¨ã€‚<ul><li>æ¯”å¦‚ï¼š<code>STR.&quot;\&#123;x&#125; + \&#123;y&#125; = \&#123;x + y&#125;&quot;;</code> ç»“æœä¸ºï¼š<code>&quot;10 + 20 = 30&quot;</code></li><li>æ”¯æŒæ•°ç»„ï¼š<code>STR.&quot;\&#123;array[0]&#125; + \&#123;array[1]&#125; = \&#123;array[0] + array[1]&#125;&quot;;</code> </li><li>æ”¯æŒæ¨¡æ¿çš„åµŒå¥—ä½¿ç”¨ï¼š<code>String tmp = STR.&quot;\&#123;x&#125;, \&#123;y&#125;&quot;;  String s = STR.&quot;\&#123;z&#125;, \&#123;tmp&#125;&quot;;</code></li><li>è·¨è¡Œä½¿ç”¨ï¼š</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">title</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;My Web Page&quot;</span>;<br><span class="hljs-type">String</span> <span class="hljs-variable">text</span>  <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Hello, world&quot;</span>;<br><span class="hljs-type">String</span> <span class="hljs-variable">html</span> <span class="hljs-operator">=</span> STR.<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">&lt;html&gt;</span><br><span class="hljs-string">&lt;head&gt;</span><br><span class="hljs-string">&lt;title&gt;\&#123;title&#125;&lt;/title&gt;</span><br><span class="hljs-string">&lt;/head&gt;</span><br><span class="hljs-string">&lt;body&gt;</span><br><span class="hljs-string">&lt;p&gt;\&#123;text&#125;&lt;/p&gt;</span><br><span class="hljs-string">&lt;/body&gt;</span><br><span class="hljs-string">&lt;/html&gt;</span><br><span class="hljs-string">&quot;&quot;&quot;</span>;<br></code></pre></td></tr></table></figure><ul><li>è‡ªå®šä¹‰å­—ç¬¦ä¸²æ¨¡æ¿å·¥å…·ï¼š<code>FMT</code>å’Œ<code>RAW </code>ï¼Œå…¶ä¸­<code>FMT</code>è´Ÿè´£å­—ç¬¦ä¸²æ¨¡æ¿çš„æ’å€¼æ“ä½œï¼Œ<code>RAW</code>è´Ÿè´£ç”Ÿæˆä¸€ä¸ªæœªç»è§£æçš„<code>StringTemplate</code>å¯¹è±¡ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Joan&quot;</span>;<br><span class="hljs-type">String</span> <span class="hljs-variable">info</span> <span class="hljs-operator">=</span> STR.<span class="hljs-string">&quot;My name is \&#123;name&#125;&quot;</span>;<br><br><span class="hljs-comment">// ç­‰ä»·äº</span><br><span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Joan&quot;</span>;<br><span class="hljs-type">StringTemplate</span> <span class="hljs-variable">st</span> <span class="hljs-operator">=</span> RAW.<span class="hljs-string">&quot;My name is \&#123;name&#125;&quot;</span>;<br><span class="hljs-type">String</span> <span class="hljs-variable">info</span> <span class="hljs-operator">=</span> STR.process(st);<br></code></pre></td></tr></table></figure><ul><li><strong><a href="https://openjdk.org/jeps/443">JEP 443</a> Unnamed Patterns and Variables</strong>(æœªå‘½åæ¨¡å¼) : é€šè¿‡æœªå‘½åæ¨¡å¼å¢å¼º Java è¯­è¨€ï¼Œè¿™äº›æ¨¡å¼åŒ¹é…è®°å½•ç»„ä»¶è€Œä¸å£°æ˜ç»„ä»¶çš„åç§°æˆ–ç±»å‹ï¼Œä»¥åŠæœªå‘½åå˜é‡ï¼Œè¿™äº›å˜é‡å¯ä»¥åˆå§‹åŒ–ä½†ä¸èƒ½ä½¿ç”¨ã€‚ä¸¤è€…å‡ä»¥ä¸‹åˆ’çº¿å­—ç¬¦è¡¨ç¤ºï¼Œå³ _ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span> <span class="hljs-variable">acc</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span> (Order order : orders) &#123;<br>        <span class="hljs-keyword">if</span> (acc &lt; LIMIT) &#123;<br>         acc++;<br>        &#125;<br>&#125;<br><span class="hljs-comment">// order å£°æ˜äº†ä½†æ˜¯æ²¡æœ‰ä½¿ç”¨ï¼Œå¯ä»¥ç®€åŒ–æˆä¸‹é¢å½¢å¼</span><br><span class="hljs-keyword">for</span> (Order _ : orders) &#123;<br>    <span class="hljs-keyword">if</span> (acc &lt; LIMIT) &#123; <br>        acc++;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><strong><a href="https://openjdk.org/jeps/445">JEP 445</a> Unnamed Classes and Instance Main Methods</strong>(æœªå‘½åä¸»æ–¹æ³•) : ç®€å•æ¥è¯´ï¼Œå°±æ˜¯ç®€åŒ–äº†mainå…¥å£æ–¹æ³•çš„å£°æ˜ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloWorld</span> &#123; <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123; <br>        System.out.println(<span class="hljs-string">&quot;Hello, World!&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">// å¯ä»¥å†™æˆå®ä¾‹ä¸»æ–¹æ³•ï¼Œè€Œä¸å†æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼š</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloWorld</span> &#123;<br>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    System.out.println(<span class="hljs-string">&quot;Hello, World!&quot;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// ç”šè‡³å¯ä»¥å†™æˆæœªå‘½åç±»çš„å½¢å¼ï¼š</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>  System.out.println(<span class="hljs-string">&quot;Hello, World!&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>é€šè¿‡è¿™ç§æ–¹å¼ç®€åŒ–javaä¸»æ–¹æ³•çš„å£°æ˜ï¼Œä½†è¿™ä¹Ÿå¸¦æ¥äº†ä¸€ä¸ªé—®é¢˜ï¼Œå½“ä¸€ä¸ªç±»é‡Œæœ‰å¤šä¸ªmainæ–¹æ³•çš„æ—¶å€™ï¼Œæ‰§è¡Œçš„æ˜¯å“ªä¸€ä¸ªå‘¢ï¼Ÿjvmä¼šé€‰æ‹©ä¸‹é¢çš„ç¬¬ä¸€ä¸ªæ¥è°ƒç”¨</p><ol><li>public static void main(String[] args)</li><li>public static void main()</li><li>void main(String[] args)</li><li>void main()</li></ol><h3 id="åº“å‡çº§-1"><a href="#åº“å‡çº§-1" class="headerlink" title="åº“å‡çº§"></a>åº“å‡çº§</h3><ul><li><strong><a href="https://openjdk.org/jeps/442">JEP 442</a> Foreign Function &amp; Memory API</strong>(å¤–éƒ¨å‡½æ•°å’Œå†…å­˜è®¿é—®) : ç¬¬ä¸‰æ¬¡é¢„è§ˆã€‚java ç¨‹åºå¯ä»¥é€šè¿‡å®ƒä¸ Java è¿è¡Œæ—¶ä¹‹å¤–ä»£ç å’Œæ•°æ®äº¤äº’ã€‚é€šè¿‡é«˜æ•ˆè°ƒç”¨å¤–éƒ¨å‡½æ•°ï¼ˆå³ JVM ä¹‹å¤–çš„ä»£ç ï¼‰ï¼Œä»¥åŠå®‰å…¨è®¿é—®å¤–éƒ¨å†…å­˜ï¼ˆå³ä¸ç”± JVM ç®¡ç†çš„å†…å­˜ï¼‰ï¼Œè¯¥ API ä½¿ Java ç¨‹åºèƒ½å¤Ÿåœ¨æ²¡æœ‰ JNI çš„è„†å¼±æ€§å’Œå±é™©çš„æƒ…å†µä¸‹è°ƒç”¨æœ¬åœ°åº“å’Œå¤„ç†æœ¬åœ°æ•°æ®.</li><li><strong><a href="https://openjdk.org/jeps/446">JEP 446</a> Scoped Values</strong>(ä½œç”¨åŸŸå€¼) : é€šè¿‡å¼•å…¥ä½œç”¨åŸŸå€¼ï¼Œä½¿å¾—ä¸€äº›ä¿¡æ¯å¯ä»¥åœ¨çº¿ç¨‹åŠå…¶å­çº¿ç¨‹é—´å…±äº«æ•°æ®,ç±»ä¼¼<code>ThreadLocal</code>è¿™æ ·ï¼Œè·³è¿‡ä¼ å‚æ¥è¿›è¡Œå€¼ä¼ é€’çš„æ–¹å¼ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ScopedValue&lt;String&gt; X = ScopedValue.newInstance();<br><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">foo</span><span class="hljs-params">()</span> &#123;<br>    ScopedValue.where(X, <span class="hljs-string">&quot;hello&quot;</span>).run(() -&gt; bar());<br>&#125;<br><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">bar</span><span class="hljs-params">()</span> &#123;<br>    System.out.println(X.get()); <span class="hljs-comment">// prints hello</span><br>    ScopedValue.where(X, <span class="hljs-string">&quot;goodbye&quot;</span>).run(() -&gt; baz());<br>    System.out.println(X.get()); <span class="hljs-comment">// prints hello</span><br>&#125;<br><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">baz</span><span class="hljs-params">()</span> &#123;<br>    System.out.println(X.get()); <span class="hljs-comment">// prints goodbye</span><br>&#125;<br></code></pre></td></tr></table></figure><ul><li><strong><a href="https://openjdk.org/jeps/448">JEP 448</a> Vector API</strong>(å‘é‡api) : ç¬¬å…­æ¬¡é¢„è§ˆã€‚ç°ä»£çš„CPUéƒ½æä¾›äº†å‘é‡æŒ‡ä»¤é›†ï¼Œè¯¥ API èƒ½å¤Ÿåœ¨æ”¯æŒçš„ CPU æ¶æ„ä¸Šå¯é åœ°ç¼–è¯‘ä¸ºæœ€ä¼˜å‘é‡æŒ‡ä»¤ï¼Œä»è€Œå®ç°æ¯”ç­‰æ•ˆæ ‡é‡è®¡ç®—æ›´ä¼˜è¶Šçš„æ€§èƒ½ã€‚</li></ul><h2 id="ç§»é™¤çš„åŠŸèƒ½"><a href="#ç§»é™¤çš„åŠŸèƒ½" class="headerlink" title="ç§»é™¤çš„åŠŸèƒ½"></a>ç§»é™¤çš„åŠŸèƒ½</h2><ul><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8300977">JDK-8300977</a> java.io.Fileâ€™s Canonical Path Cache Is Removed</strong> ï¼š <code>File::getCanonicalFile</code> å’Œ <code>File::getCanonicalPath</code>çš„è·¯å¾„ç¼“å­˜åŠŸèƒ½è¢«åºŸé™¤ï¼Œå¯¹ä½¿ç”¨æ²¡æœ‰å½±å“</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8297295">JDK-8297295</a> ThreadGroup.allowThreadSuspension Is Removed</strong> ï¼š æœ¬ç‰ˆæœ¬ä¸­å·²ç§»é™¤ java.lang.ThreadGroup.allowThreadSuspension(boolean) æ–¹æ³•ã€‚è¯¥æ–¹æ³•ç”¨äº JDK 1.1 ä¸­çš„ä½å†…å­˜å¤„ç†ï¼Œä½†ä»æœªå®Œå…¨æŒ‡å®šã€‚å®ƒåœ¨ JDK 1.2ï¼ˆ1998 å¹´ï¼‰ä¸­è¢«å¼ƒç”¨ï¼Œå¹¶æ”¹ä¸ºâ€œæ— æ“ä½œâ€ã€‚</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8205129">JDK-8205129</a> The java.lang.Compiler Class Has Been Removed</strong> ï¼šjava.lang.Compiler ç±»å·²è¢«ç§»é™¤ã€‚è¿™ä¸ªæœªæŒ‡å®šå……åˆ† API å§‹äº JDK 1.0ï¼Œæ—©æœŸ JDK ç‰ˆæœ¬ä¸­ä½¿ç”¨çš„â€œç»å…¸ VMâ€ã€‚åœ¨ HotSpot VM ä¸­çš„å®ç°åªæ˜¯æ‰“å°ä¸€æ¡è­¦å‘Šï¼ŒæŒ‡å‡ºå®ƒä¸å—æ”¯æŒã€‚è¯¥ç±»è‡ª Java SE 9 ä»¥æ¥å·²è¢«å¼ƒç”¨å¹¶æ ‡è®°ä¸ºåˆ é™¤ã€‚</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8302819">JDK-8302819</a> Remove the JAR Index Feature</strong> ï¼šâ€œJAR ç´¢å¼•â€åŠŸèƒ½å·²è¢«ä» JAR æ–‡ä»¶è§„èŒƒä¸­åˆ é™¤ã€‚JAR ç´¢å¼•æ˜¯æ—©æœŸ JDK ç‰ˆæœ¬ä¸­çš„é—ç•™ä¼˜åŒ–ï¼Œå…è®¸åœ¨é€šè¿‡ç½‘ç»œåŠ è½½å°ç¨‹åºæˆ–å…¶ä»–ç±»æ—¶æ¨è¿Ÿä¸‹è½½ JAR æ–‡ä»¶ã€‚è‡ª JDK 18 ä»¥æ¥ï¼Œè¯¥åŠŸèƒ½å·²è¢«ç¦ç”¨ï¼Œæ„å‘³ç€ JAR æ–‡ä»¶ä¸­çš„ META-INF&#x2F;INDEX.LIST æ¡ç›®åœ¨è¿è¡Œæ—¶å°†è¢«å¿½ç•¥ã€‚</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8307244">JDK-8307244</a> Remove the JAR Index Feature</strong> ï¼šè¯¥ç±» javax.management.remote.rmi.RMIIIOPServerImpl å·²è¢«ç§»é™¤ã€‚åœ¨ JDK 9 ä¸­ï¼ŒIIOP ä¼ è¾“å·²è¢«ä» JMX è¿œç¨‹ API ä¸­ç§»é™¤ã€‚è‡ª Java SE 9 ä»¥æ¥ï¼Œæ­¤ç±»å·²è¢«å¼ƒç”¨ï¼Œå…¶æ„é€ å‡½æ•°å·²æ›´æ”¹ä¸ºæŠ›å‡º UnsupportedOperationException ã€‚</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8225409">JDK-8225409</a> Removal of G1 Hot Card Cache</strong> ï¼šG1 çƒ­å¡ç¼“å­˜å·²è¢«ç§»é™¤ã€‚æ€§èƒ½æµ‹è¯•è¡¨æ˜ï¼Œåœ¨å¹¶å‘ç²¾ç‚¼æ§åˆ¶çš„æ”¹è¿›ä¹‹åï¼Œå®ƒå¯¹æ€§èƒ½æ²¡æœ‰è´¡çŒ®ã€‚è€Œç§»é™¤è¯¥åŠŸèƒ½åï¼Œå‡å°‘äº† G1 åƒåœ¾æ”¶é›†å™¨çš„å†…å­˜å ç”¨ï¼Œå¤§çº¦ä¸º Java å †å¤§å°çš„ 0.2%</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8302385">JDK-8302385</a> The MetaspaceReclaimPolicy Flag has Been Obsoleted</strong> ï¼šMetaspaceReclaimPolicy é€‰é¡¹æ›¾ç”¨äºåœ¨ç±»å¸è½½åå¾®è°ƒå…ƒç©ºé—´çš„å†…å­˜å›æ”¶è¡Œä¸ºã€‚å®é™…ä¸Šï¼Œè¿™æ•ˆæœæœ‰é™ï¼Œå¾ˆå°‘ä½¿ç”¨ã€‚</li></ul><h2 id="åºŸå¼ƒçš„åŠŸèƒ½ï¼ˆåæ¥ä¼šç§»é™¤ï¼‰"><a href="#åºŸå¼ƒçš„åŠŸèƒ½ï¼ˆåæ¥ä¼šç§»é™¤ï¼‰" class="headerlink" title="åºŸå¼ƒçš„åŠŸèƒ½ï¼ˆåæ¥ä¼šç§»é™¤ï¼‰"></a>åºŸå¼ƒçš„åŠŸèƒ½ï¼ˆåæ¥ä¼šç§»é™¤ï¼‰</h2><ul><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8280031">JDK-8280031</a> Deprecate GTK2 for Removal</strong> ï¼š GTK2 ç”¨äºlinuxä¸Šå¯¹ AWT&#x2F;Swing çš„å®ç°æ”¯æŒï¼Œéšç€ GTK4 åœ¨ 2020 å¹´ 12 æœˆçš„å‘å¸ƒï¼ŒGTK 2 å·¥å…·åŒ…å³å°†è¾¾åˆ°å…¶ç”Ÿå‘½å‘¨æœŸçš„ç»ˆç‚¹</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8303175">JDK-8303175</a> com.sun.nio.file.SensitivityWatchEventModifier Is Deprecated</strong> ï¼š è¯¥æšä¸¾ä¸­çš„å¸¸é‡ç”¨äºåœ¨ macOS ä¸ŠåŸºäºè½®è¯¢çš„ WatchService å®ç°ä¸­è®¾ç½®è½®è¯¢æ–‡ä»¶æ›´æ”¹çš„é—´éš”ã€‚åŸºäºè½®è¯¢çš„ WatchService å·²æ›´æ”¹ï¼Œåœ¨æ³¨å†Œè¦ç›‘è§†çš„æ–‡ä»¶æ—¶å¿½ç•¥è¿™äº›ä¿®é¥°ç¬¦ã€‚</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8304982">JDK-8304982</a> Emit Warning for Removal of COMPAT Provider</strong> ï¼š COMPAT åœ¨ JDK 9 æ—¶ä»£æä¾›ï¼Œç”¨äºè¿ç§»åˆ° CLDR åŒºåŸŸæ•°æ®ï¼Œå½“æ—¶å®ƒæˆä¸ºäº†é»˜è®¤çš„åŒºåŸŸæ•°æ®ï¼ˆJEP 252ï¼‰ã€‚JDK 21 ä¸ºäº†å…¼å®¹æ€§ä¿ç•™äº† JDK 8 çš„é—ç•™åŒºåŸŸæ•°æ®ï¼Œä½†ä¸€äº›æ–°åŠŸèƒ½å¹¶æœªåº”ç”¨ã€‚é—ç•™çš„åŒºåŸŸæ•°æ®å°†åœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­åˆ é™¤ã€‚é¼“åŠ±ç”¨æˆ·è¿ç§»åˆ° CLDR åŒºåŸŸæ•°æ®</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8298966">JDK-8298966</a> Deprecate JMX Subject Delegation and the JMXConnector.getMBeanServerConnection(Subject) Method for Removal</strong> ï¼š JMX Subject Delegation åŠŸèƒ½å·²è¢«åºŸå¼ƒï¼Œå¹¶è®¡åˆ’åœ¨æœªæ¥ç‰ˆæœ¬ä¸­åˆ é™¤ã€‚</li></ul><h2 id="é—®é¢˜ä¿®å¤"><a href="#é—®é¢˜ä¿®å¤" class="headerlink" title="é—®é¢˜ä¿®å¤"></a>é—®é¢˜ä¿®å¤</h2><ul><li><p><strong><a href="https://bugs.openjdk.org/browse/JDK-8307990">JDK-8307990</a> Fixed Indefinite jspawnhelper Hangs</strong> ï¼š ä¿®å¤äº†ä¸å®šæ—¶ jspawnhelper åœæ»é—®é¢˜</p><p>è‡ª JDK 13 ä»¥æ¥ï¼Œåœ¨ Linux ä¸Šæ‰§è¡Œå­è¿›ç¨‹çš„å‘½ä»¤é»˜è®¤ä½¿ç”¨æ‰€è°“çš„ POSIX_SPAWN å¯åŠ¨æœºåˆ¶ï¼ˆå³ -Djdk.lang.Process.launchMechanism&#x3D;POSIX_SPAWN ï¼‰ã€‚åœ¨çˆ¶ JVM è¿›ç¨‹åœ¨ JVM ä¸æ–°åˆ›å»ºçš„ jspawnhelper è¿›ç¨‹ä¹‹é—´çš„æ¡æ‰‹å®Œæˆä¹‹å‰å¼‚å¸¸ç»ˆæ­¢çš„æƒ…å†µä¸‹ï¼Œ jspawnhelper åœ¨ JDK 13 åˆ° JDK 20 ä¸­å¯èƒ½ä¼šæ— é™æœŸåœ°åœæ»ã€‚æ­¤é—®é¢˜å·²åœ¨ JDK 21 ä¸­ä¿®å¤ã€‚å¦‚æœçˆ¶è¿›ç¨‹æœ‰æ‰“å¼€çš„å¥—æ¥å­—ï¼Œåˆ™æ­¤é—®é¢˜å°¤å…¶æœ‰å®³ï¼Œå› ä¸ºåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ´¾ç”Ÿçš„ jspawnhelper è¿›ç¨‹å°†ç»§æ‰¿å®ƒä»¬å¹¶ä¿æŒæ‰€æœ‰ç›¸åº”çš„ç«¯å£æ‰“å¼€ï¼Œä»è€Œæœ‰æ•ˆåœ°é˜»æ­¢å…¶ä»–è¿›ç¨‹ç»‘å®šåˆ°å®ƒä»¬ã€‚ </p><p>è¿™ç§å¼‚å¸¸è¡Œä¸ºå·²åœ¨å†…å­˜çº¦æŸä¸¥æ ¼çš„ç¯å¢ƒä¸­é¢‘ç¹ fork å­è¿›ç¨‹çš„åº”ç”¨ç¨‹åºä¸­è§‚å¯Ÿåˆ°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ“ä½œç³»ç»Ÿå¯èƒ½ä¼šåœ¨ fork è¿‡ç¨‹ä¸­ç»ˆæ­¢ JVMï¼Œä»è€Œå¯¼è‡´æ‰€è¿°é—®é¢˜ã€‚å¦‚æœæ–°è¿›ç¨‹å°è¯•ç»‘å®šä¸åˆå§‹åº”ç”¨ç¨‹åºç›¸åŒçš„ç«¯å£ï¼Œåˆ™ç”±äºå®ƒä»¬å°†è¢«æŒ‚èµ·çš„ jspawnhelper å­è¿›ç¨‹é˜»å¡ï¼Œå› æ­¤æ— æ³•åœ¨å´©æºƒåé‡å¯ JVM è¿›ç¨‹ã€‚</p><p>æ­¤é—®é¢˜çš„æ ¹æœ¬åŸå› æ˜¯ jspawnhelper æœªå…³é—­ç”¨äºä¸çˆ¶ JVM æ¡æ‰‹çš„ç®¡é“çš„å†™å…¥ç«¯ï¼Œè¿™å·²åœ¨å°è¯•ä»çˆ¶è¿›ç¨‹è¯»å–æ•°æ®ä¹‹å‰å…³é—­äº†é€šä¿¡ç®¡é“çš„å†™å…¥ç«¯å¾—åˆ°ä¿®å¤ã€‚è¿™æ ·ï¼Œ jspawnhelper å°†å¯é åœ°ä»é€šä¿¡ç®¡é“è¯»å– EOF äº‹ä»¶ï¼Œå¹¶åœ¨çˆ¶è¿›ç¨‹æ„å¤–æ­»äº¡æ—¶ç»ˆæ­¢ã€‚</p><p>è¿™ç§é—®é¢˜çš„ç¬¬äºŒä¸ªå˜ä½“å¯èƒ½å‘ç”Ÿï¼Œå› ä¸º JDK ä¸­çš„æ¡æ‰‹ä»£ç æ²¡æœ‰æ­£ç¡®å¤„ç† write(2) çš„ä¸­æ–­ã€‚è¿™å¯èƒ½å¯¼è‡´å‘ jspawnhelper å­è¿›ç¨‹å‘é€ä¸å®Œæ•´çš„ä¿¡æ¯ã€‚ç»“æœæ˜¯çˆ¶çº¿ç¨‹å’Œå­è¿›ç¨‹ä¹‹é—´çš„æ­»é”ï¼Œè¿™è¡¨ç°ä¸ºåœ¨è¯»å–ç®¡é“æ—¶è¢«é˜»å¡çš„ jspawnhelper è¿›ç¨‹ï¼Œä»¥åŠç›¸åº”çš„çˆ¶ Java è¿›ç¨‹ä¸­çš„ä»¥ä¸‹å †æ ˆè·Ÿè¸ª</p></li><li><p><strong><a href="https://bugs.openjdk.org/browse/JDK-8307466">JDK-8307466</a> Error Computing the Amount of Milli- and Microseconds between java.time.Instants</strong> ï¼š ä½¿ç”¨ <code>ChronoUnit.MILLIS.between(t1, t2)</code> ã€ <code>ChronoUnit.MICROS.between(t1, t2)</code> ã€ <code>t1.until(t2, MILLIS)</code> æˆ– <code>t1.until(t2, MICROS)</code> è®¡ç®—ä¸¤ä¸ªæ—¶é—´ç‚¹ä¹‹é—´çš„æ—¶é—´å·®å·²è¢«çº æ­£ã€‚è‡ª JDK 18 ä»¥æ¥ï¼Œè®¡ç®—å®ä¾‹ä¹‹é—´å•ä½çš„å®ç°æ²¡æœ‰åœ¨è®¡ç®—æ¯«ç§’å’Œå¾®ç§’æ—¶åœ¨ç§’å’Œçº³ç§’æ—¶è¿›è¡Œè¿›ä½å’Œå€Ÿä½ã€‚</p></li><li><p><strong><a href="https://bugs.openjdk.org/browse/JDK-8303465">JDK-8303465</a> Enhance Contents (Trusted Certificate Entries) of macOS KeychainStore</strong> : macOS KeychainStore å®ç°ç°åœ¨åœ¨ç”¨æˆ·åŸŸã€ç®¡ç†å‘˜åŸŸæˆ–ä¸¤è€…ä¸­æ­£ç¡®ä¿¡ä»»è¯ä¹¦ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œåªæœ‰ç”¨æˆ·åŸŸè¢«è€ƒè™‘ã€‚æ­¤å¤–ï¼Œå¦‚æœè¯ä¹¦çš„ä¿¡ä»»è®¾ç½®ä¸­åœ¨ä»»ä¸€åŸŸå­˜åœ¨é’ˆå¯¹ç‰¹å®šç›®çš„çš„â€œæ‹’ç»â€æ¡ç›®ï¼Œåˆ™è¯¥è¯ä¹¦å°†ä¸ä¼šæˆä¸º macOS KeychainStore çš„ä¸€éƒ¨åˆ†.</p></li><li><p><strong><a href="https://bugs.openjdk.org/browse/JDK-8305091">JDK-8305091</a> Allow Key&#x2F;Nonce Reuse for DECRYPT_MODE ChaCha20 and ChaCha20-Poly1305 Cipher Objects</strong> : SunJCE å¯¹ Cipher å¯¹è±¡ä½¿ç”¨ ChaCha20 å’Œ ChaCha20-Poly1305 ç®—æ³•çš„å®ç°ç°åœ¨å°†åœ¨ DECRYPT_MODE æ—¶å…è®¸å¯†é’¥&#x2F;nonce é‡ç”¨ã€‚æ­¤æ›´æ”¹ä½¿è¿™äº›ç®—æ³•ä¸å½“å‰ SunJCE AES-GCM è§£å¯†æ¨¡å¼è¡Œä¸ºåœ¨å¯†é’¥&#x2F;nonce é‡ç”¨æ–¹é¢ä¿æŒä¸€è‡´ã€‚æ‰€æœ‰ ENCRYPT_MODE å¯†é’¥&#x2F;nonce é‡ç”¨ç¦ä»¤çš„è¡Œä¸ºä¿æŒä¸å˜ã€‚</p></li><li><p><strong><a href="https://bugs.openjdk.org/browse/JDK-8027682">JDK-8027682</a> Disallow Extra Semicolons Between â€œimportâ€ Statements</strong> : Java è¯­è¨€è§„èŒƒä¸å…è®¸åœ¨ import è¯­å¥ä¹‹é—´å‡ºç°å¤šä½™çš„åˆ†å·ï¼Œç„¶è€Œç¼–è¯‘å™¨ä¹‹å‰å…è®¸è¿™æ ·åšï¼›JDK21 ä¿®å¤äº†è¿™ä¸ªé—®é¢˜ã€‚</p></li></ul><h2 id="jdk21-æ”¯æŒçš„å·¥å…·"><a href="#jdk21-æ”¯æŒçš„å·¥å…·" class="headerlink" title="jdk21 æ”¯æŒçš„å·¥å…·"></a>jdk21 æ”¯æŒçš„å·¥å…·</h2><p>å…¨å¹³å°å¯ç”¨çš„jdk å·¥å…·<br><img src="/../../images/tech/java/jdk21-tool-all.png" alt="å…¨å¹³å°å¯ç”¨"></p><p>ä»…windowså¯ç”¨çš„jdkå·¥å…·<br><img src="/../../images/tech/java/jdk21-tool-windows.png" alt="windows only"></p><h2 id="åè¯è§£æ"><a href="#åè¯è§£æ" class="headerlink" title="åè¯è§£æ"></a>åè¯è§£æ</h2><ul><li><p>HarfBuzz: ä¸€ä¸ªå¼€æºçš„ç”¨äºæ–‡å­—å¡‘å½¢çš„è½¯ä»¶å¼€å‘åº“ï¼Œäº¦å³ç”¨äºè½¬æ¢Unicodeæ–‡æœ¬åˆ°å­—å½¢æŒ‡æ ‡åŠæ–¹ä½çš„è¿‡ç¨‹</p></li><li><p>FreeType:  åŒHarfBuzzä¸€æ ·, ä¹Ÿæ˜¯ä¸€ä¸ªå¼€æºå­—ä½“åº“. å®ƒæ˜¯ä¸€ä¸ªç”¨Cè¯­è¨€å®ç°çš„ä¸€ä¸ªå­—ä½“å…‰æ …åŒ–åº“ã€‚å®ƒå¯ä»¥ç”¨æ¥å°†å­—ç¬¦æ …æ ¼åŒ–å¹¶æ˜ å°„æˆä½å›¾ä»¥åŠæä¾›å…¶ä»–å­—ä½“ç›¸å…³ä¸šåŠ¡çš„æ”¯æŒ</p></li><li><p>Preview(é¢„è§ˆ): åŠŸèƒ½å·²ç»åŸºæœ¬å®Œæ•´, å¯ä»¥è¯•ç”¨äº†. å¯ä»¥ç®€å•ç†è§£ä¸ºbetaå…¬æµ‹ç‰ˆ. æ¥æºäº <a href="https://openjdk.org/jeps/12">JEP12</a></p><blockquote><p>åŠŸèƒ½ä»¥é¢„è§ˆç‰ˆçš„å½¢å¼å‘å¸ƒï¼Œä»¥æ”¶é›†æœ‰å…³å®ƒä»¬çš„åé¦ˆè€Œä¸æ‰¿è¯ºä¿æŒå…¶å‘åå…¼å®¹æ€§â€”â€”è¿™æ„å‘³ç€é¼“åŠ±æ¯ä¸ªäººå°è¯•å®ƒä»¬ï¼Œä½†åŒæ—¶ä¸é¼“åŠ±åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨å®ƒä»¬ã€‚</p><p>é¢„è§ˆåŠŸèƒ½ä¸æ˜¯å¼€ç®±å³ç”¨çš„ï¼Œä¸ºäº†è®¿é—®å®ƒä»¬ï¼Œéœ€è¦ä½¿ç”¨*â€“enable-preview*ç¼–è¯‘å™¨æ ‡å¿—ã€‚</p></blockquote></li><li><p>Incubator(å­µåŒ–) : å®éªŒæ€§ APIå·²ç»åˆ°äº†ä¸€å®šé˜¶æ®µ, å·²ç»è®¡åˆ’å¼€å‘å‡ºä¸€æ•´å¥—å®Œæ•´çš„åŠŸèƒ½.ä»¥ç‹¬ç«‹æ¨¡å—çš„å½¢å¼å‘å¸ƒ. æ¥æºäº <a href="https://openjdk.org/jeps/11">JEP11</a></p></li><li><p>Experimental(å®éªŒ) : vmçº§çš„æ—©æœŸåŠŸèƒ½, ä¸ç¨³å®š, åŠŸèƒ½ä¸å®Œæ•´. å®éªŒæ€§è´¨.</p><blockquote><p>å®éªŒæ€§åŠŸèƒ½ä»£è¡¨ï¼ˆä¸»è¦æ˜¯ï¼‰VM çº§åŠŸèƒ½çš„æ—©æœŸç‰ˆæœ¬ï¼Œè¿™äº›åŠŸèƒ½å¯èƒ½æ˜¯æœ‰é£é™©çš„ã€ä¸å®Œæ•´çš„ï¼Œç”šè‡³æ˜¯ä¸ç¨³å®šçš„ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œéœ€è¦ä½¿ç”¨ä¸“ç”¨æ ‡å¿—å¯ç”¨å®ƒä»¬</p><p>å‡ºäºæ¯”è¾ƒçš„ç›®çš„ï¼Œå¦‚æœä¸€ä¸ªå®éªŒåŠŸèƒ½è¢«è®¤ä¸ºæ˜¯ 25%â€œå®Œæˆâ€ï¼Œé‚£ä¹ˆä¸€ä¸ªé¢„è§ˆåŠŸèƒ½åº”è¯¥è‡³å°‘ 95%â€œå®Œæˆâ€ã€‚</p><p>é¢„è§ˆ,å­µåŒ–,å®éªŒä¸‰è€…çš„å…³ç³»å¤§è‡´: å®éªŒ &#x3D;&gt; å­µåŒ– &#x3D;&gt; é¢„è§ˆ &#x3D;&gt; åˆå¹¶jdkä¸»ä½“åŠŸèƒ½.</p></blockquote></li><li><p>JEP : JDK Enhancement Proposal , jdkå¢å¼ºå»ºè®®. ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„jdkæ–°ç‰¹æ€§çš„æ¥æº. <a href="https://openjdk.org/jeps/0">JEPå¤§å…¨</a></p></li></ul><h2 id="å¾€æœŸæ–‡ç« "><a href="#å¾€æœŸæ–‡ç« " class="headerlink" title="å¾€æœŸæ–‡ç« "></a>å¾€æœŸæ–‡ç« </h2><p><a href="/2022/10/20/java-jdk-v19/">jdk19æ–°ç‰¹æ€§</a></p><p><a href="/2023/04/04/java-jdk-v20/">jdk20æ–°ç‰¹æ€§</a></p><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><p><a href="https://docs.oracle.com/en/java/javase/21/">jdk21å®˜æ–¹æ–‡æ¡£</a><br><a href="https://www.oracle.com/java/technologies/javase/21-relnote-issues.html#NewFeature">jdk21çš„æ–°ç‰¹æ€§</a><br><a href="https://www.oracle.com/java/technologies/javase/21all-relnotes.html">jdk21åŠåç»­ä¿®å¤bugç‰ˆæœ¬æ–‡æ¡£</a><br><a href="https://docs.oracle.com/en/java/javase/21/gctuning/index.html">jdk21åƒåœ¾å›æ”¶å™¨å®˜ç½‘</a><br><a href="https://docs.oracle.com/en/java/javase/21/vm/preface.html">jdk21è™šæ‹Ÿæœºä»‹ç»</a>    </p><p><a href="https://openjdk.org/">openjdkå®˜ç½‘</a><br><a href="https://4comprehension.com/preview-experimental-and-incubating-features-in-java/">jdkä¸­é¢„è§ˆ,å®éªŒ,å­µåŒ–çš„å…³ç³»</a><br><a href="https://www.oracle.com/java/technologies/java-se-support-roadmap.html">jdkå„ç‰ˆæœ¬æ”¯æŒæ—¶é—´</a></p>]]></content>
    
    
    <categories>
      
      <category>java</category>
      
      <category>javaç‰ˆæœ¬ç‰¹æ€§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>javaç‰ˆæœ¬ç‰¹æ€§</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å…³äºå·¥ä½œä¸­è€ƒæ ¸ä»£ç é‡çš„ä¸€äº›æ€è€ƒ</title>
    <link href="/2025/04/16/life-code-line/"/>
    <url>/2025/04/16/life-code-line/</url>
    
    <content type="html"><![CDATA[<p>ä¸çŸ¥é“æ˜¯ä¸æ˜¯å› ä¸ºç°åœ¨å¤§ç¯å¢ƒä¸å¤ªå¥½çš„åŸå› ï¼Œç°åœ¨å…¬å¸å¼€å§‹è€ƒæ ¸ä»£ç é‡äº†ã€‚</p><p>è€ƒæ ¸æ–¹å¼ä¹ŸæŒºç®€å•ï¼Œæœ‰ä¸€ä¸ªå«<code>æ€ç é€¸</code>çš„å¹³å°ï¼ˆé“¾æ¥ä¸è´´äº†ï¼Œä¸æƒ³æ¨å¹¿è¿™ç§äº§å“ï¼‰ï¼Œå¯ä»¥ç»Ÿè®¡ä»£ç è¡Œæ•°ï¼Œä»£ç çš„å¤æ‚åº¦ç­‰æƒ…å†µï¼Œç„¶åæ ¹æ®ä¸€å®šçš„è§„åˆ™ï¼Œå¾—åˆ°ä¸€å®šçš„åˆ†æ•°ï¼Œæœ€åæ ¹æ®è¿™ä¸ªåˆ†æ•°æ’åï¼Œç„¶åå’Œç»©æ•ˆæŒ‚é’©ã€‚</p><p>ç†è®ºä¸Šï¼Œè¿™ä¸ªå¹³å°æƒ³å¯¹ä»£ç æƒ…å†µåšåˆ°ä¸€ä¸ªé‡åŒ–ï¼Œä½†çœŸçš„åšå¾—åˆ°å—ï¼Ÿ</p><p>å†™ä»£ç ç†è®ºä¸Šä½œä¸ºä¸€ä¸ªè„‘åŠ›åŠ³åŠ¨ï¼Œä»£ç å†™å‡ºæ¥ä¹Ÿæ˜¯ä¸å¯è§çš„ï¼Œé™¤éäººå·¥å¤æ£€ï¼Œä¸ç„¶å¾ˆéš¾è¯„ä¼°æŸä¸€æ®µä»£ç çš„ä»·å€¼é«˜ä½ã€‚</p><p>æ¯”å¦‚ï¼š</p><ul><li>å†™æ ¸å¿ƒé€»è¾‘å¼•æ“çš„éƒ¨åˆ†ï¼Œè‚¯å®šæ¯”å†™æ¥å£å±‚çš„ä»£ç é‡è¦å°‘ï¼Œä½†æ¥å£å±‚çš„ä»£ç å¯èƒ½ä¸€å¹´å°±åºŸæ‰äº†ï¼Œè€Œæ ¸å¿ƒé€»è¾‘å¼•æ“çš„ä»£ç å¯èƒ½è¦è¿è¡Œä¸ƒå…«å¹´ï¼Œè€Œä¸”æ ¸å¿ƒä»£ç ä»˜å‡ºçš„è„‘åŠ›æ€è€ƒæ›´æ˜¯è¦å¤šå¾—å¤šã€‚</li><li>ä¿®bugè¿™ç§äº‹è¯¥æ€ä¹ˆé‡åŒ–å‘¢ï¼ŸæŸ¥äº†åŠå¤©bugï¼Œç»“æœæ˜¯ä¸€ä¸ªé…ç½®å¯¼è‡´çš„é—®é¢˜ï¼Œä¸€è¡Œä»£ç é‡ä¹Ÿæ²¡æœ‰ã€‚</li><li>è€Œä¸”ä¸åŒåœ°æ–¹çš„bugï¼Œä¿®å¤éš¾åº¦ä¹Ÿä¸ä¸€æ ·ï¼Œæœ‰çš„æ—¶å€™ä¸€è¡Œä»£ç å°±æ˜¯æ¯”åˆ«äººå‡ åè¡Œä»£ç ç®¡ç”¨ã€‚</li><li>ç°åœ¨æœ‰å¾ˆå¤šæ¨¡æ¿å¼•æ“å¯ä»¥ç”Ÿæˆä»£ç ï¼Œè¿™é‡Œåˆæ˜¯æ€ä¹ˆè€ƒæ ¸å‘¢ï¼Ÿ</li><li>å‰ç«¯ã€åç«¯ã€è¿ç»´ä¸åŒå·¥ç§ï¼Œä¸åŒè¯­è¨€çš„çš„ä»£ç ï¼Œæ•ˆæœä¹Ÿæ˜¯å®Œå…¨ä¸ä¸€æ ·çš„ï¼Œæœ‰çš„äººå…¨æ ˆï¼Œä»–å½’åœ¨å“ªä¸€ç±»è€ƒæ ¸å‘¢ï¼Ÿ</li><li>ç­‰ç­‰</li></ul><p>æ—¢ç„¶ç°åœ¨æœºå™¨è€ƒæ ¸ä»£ç é‡ï¼Œ è¿˜è¦è¿™ä¹ˆå¤šçš„é—®é¢˜éš¾ä»¥è§£å†³ï¼Œä¸ºä»€ä¹ˆå…¬å¸è¿˜è¦æ¨è¡Œè¿™ä¸ªè€ƒæ ¸å‘¢ï¼Ÿ</p><p>æˆ‘è§‰å¾—æœ€å¤§çš„é—®é¢˜ï¼Œå°±æ˜¯å…¬å¸é¢†å¯¼å±‚å¯¹äºåº•å±‚çš„ä¸€ç§ä¸ä¿¡ä»»çš„å¿ƒç†åœ¨ä½œæ€ªã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œè€æ¿ä»¬èŠ±é’±é›‡å‘˜å·¥æ¥æ˜¯å¹²æ´»çš„ï¼Œä¸æ˜¯æ¥æ‘¸é±¼çš„ï¼Œå¯èƒ½è€æ¿ä»¬åœ¨ç½‘ä¸Šçœ‹åˆ°å‘˜å·¥æ‘¸é±¼çš„æ®µå­å¤šäº†ï¼Œå°±ä¸è‡ªç„¶çš„å¸¦å…¥åˆ°äº†è‡ªå·±èº«ä¸Šï¼Œè‡ªå·±çš„å‘˜å·¥åœ¨ä¸åœ¨æ‘¸é±¼å‘¢ï¼Ÿ</p><p>å¯æ˜¯é«˜ç®¡ä»¬åˆä¸èƒ½å¤©å¤©ç›¯ç€å‘˜å·¥å¹²æ´»ï¼Œè¿˜ä¸ç›¸ä¿¡è‡ªå·±çš„å‘˜å·¥åœ¨è®¤çœŸçš„å¹²æ´»ï¼Œå°±åªèƒ½æ‹¿å‡ºæ‰€è°“çš„â€œç®¡ç†å¤§æ³•â€æ¥â€œç§‘å­¦â€çš„ç®¡ç†å‘˜å·¥äº†ã€‚</p><p>è€Œç°ä»£çš„ç®¡ç†å·¥å…·ï¼Œè¯´åˆ°åº•å°±ä¸¤ä»¶äº‹ï¼šé‡åŒ–ï¼Œç»©æ•ˆã€‚</p><blockquote><p>ç»©æ•ˆï¼šå°±æ˜¯æŠŠæœ¬æ¥åº”è¯¥å‘ç»™å‘˜å·¥çš„é’±åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯å¿…å‘åº•è–ªï¼Œä¸€éƒ¨åˆ†æ˜¯æµ®åŠ¨ç»©æ•ˆï¼Œçœ‹ä½ çš„è¡¨ç°è€Œç»™é’±ã€‚<br>é‡åŒ–ï¼šè¾…åŠ©ç»©æ•ˆçš„è¯„ä¼°åŠæ³•ï¼Œç»™ä¸€ä¸ªå‘˜å·¥å‘å¤šå°‘ç»©æ•ˆï¼Œæ€»è¦æœ‰ä¸ªä¾æ®å§ï¼Œè¿™å°±è¦å¯¹å‘˜å·¥çš„å·¥ä½œè¿›è¡Œé‡åŒ–äº†ï¼Œä¹Ÿå°±æ˜¯å‘˜å·¥åšçš„å·¥ä½œéƒ½è¦èƒ½å¤Ÿç”¨æ•°å­—ä½“ç°å‡ºæ¥ã€‚</p></blockquote><p>ä½ çœ‹ï¼Œä»è®¾è®¡ä¸Šçœ‹ï¼Œéƒ½æ˜¯å¾ˆå¥½çš„å·¥å…·ï¼Œæ—¢èƒ½æ¿€å‘å‘˜å·¥çš„èƒ½åŠ¨æ€§ï¼Œåˆèƒ½ä¿è¯ç»©æ•ˆå‘æ”¾çš„å…¬å¹³æ€§ã€‚</p><p>ä½†æ— è®ºä»€ä¹ˆå·¥å…·éƒ½èƒ½è¢«ä¸­å›½çš„è€æ¿æŠŠç»ç»™å¿µæ­ªäº†ã€‚</p><p>è€æ¿ä¸æƒ³å¤šå‡ºé’±æç»§ç»­ï¼Œå°±æŠŠç»§ç»­å¼ºåˆ¶æ¯”ä¾‹åˆ†å¸ƒï¼Œæ¯”å¦‚2ï¼š7ï¼š1ï¼Œç›¸å½“äºæŠŠåº•å±‚1æˆçš„å‘˜å·¥çš„ç»©æ•ˆæ¥è¡¥è´´ç»™ä¸Šéƒ¨çš„2æˆçš„å‘˜å·¥ï¼Œè€Œå¯¹äºå…¬å¸ï¼Œæ²¡æœ‰å¤šèŠ±ä»»ä½•æˆæœ¬ã€‚è€Œä¸”è¿™ç§è¡Œä¸ºè¿˜æœ‰ä¸€ä¸ªå¾ˆå¥½å¬çš„åå­—ï¼šâ€œä¸æ–­å¥”è·‘â€ï¼Œâ€œé€‰æ‹©åˆé€‚çš„äººâ€ã€‚</p><p>åœ¨é‡åŒ–ä¸Šï¼Œå°±æ˜¯ä¸‡ç‰©çš†å¯é‡åŒ–ï¼Œä¸èƒ½é‡åŒ–çš„ä¸œè¥¿å°±æ˜¯ç®¡ç†ä¸ç§‘å­¦ã€åˆ›æ–°ä¸åˆ°ä½ã€‚é‡åŒ–æœ€ç»ˆæ¼”åŒ–æˆäº†å…¬å¸ç›‘è§†å‘˜å·¥çš„å·¥å…·ï¼Œè€Œå¤±å»äº†å…¶æœ¬æ¥å…¬å¹³è€ƒæ ¸çš„æœ¬é¢ç›®ã€‚</p><p>è€Œä¸”ï¼Œæœ€é‡è¦çš„ï¼Œé‡åŒ–å’Œç»©æ•ˆè¯„å®šéƒ½æ˜¯éå…¬å¼€çš„ï¼Œâ€œè–ªé…¬ä¿å¯†åˆ¶åº¦â€æœ€ç»ˆæˆäº†é«˜ç®¡ä»¬æš—ç®±æ“ä½œçš„ä¿æŠ¤è¡£ã€‚</p><p>æ‰€ä»¥ï¼Œå¯¹äºç¨‹åºå‘˜è¿™ä¸ªäº§å‡ºåªæœ‰ä»£ç çš„è„‘åŠ›åŠ³åŠ¨ç¾¤ä½“ï¼Œä»£ç é‡è€ƒæ ¸ï¼Œå°±æˆäº†è€æ¿ä»¬çš„â€œç§‘å­¦è€ƒæ ¸â€ä¸‹çš„ä¸€ä¸ªå¿…ç„¶é€‰æ‹©ã€‚</p><p>ç„¶åæˆ‘è¯´ä¸€ä¸‹ï¼Œä»£ç é‡åŒ–è€ƒæ ¸åçš„ç°çŠ¶ï¼š</p><ul><li>å¤§å®¶æ›´å€¾å‘äºå†™CURDè¿™ç§å®¹æ˜“äº§ç”Ÿä»£ç é‡çš„éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯æ ¸å¿ƒä¸šåŠ¡ï¼Œæœ‰é‚£ç§ä»£ç ç”Ÿæˆå·¥å…·çš„æ›´å¥½</li><li>ä»£ç è¶Šå¤æ‚è¶Šå¥½ï¼Œèƒ½10è¡Œè§£å†³çš„äº‹ï¼Œåšå†³ä¸ä¸€è¡Œæå®š</li><li>ä¸ºäº†å¢åŠ ä»£ç é‡ï¼Œå¯èƒ½ä¼šæœ‰ä¸€äº›æ ¹æœ¬ç”¨ä¸ä¸Šçš„ä»£ç è¢«æäº¤ä¸Šå»ï¼Œå¯¼è‡´åé¢é™¤äº†å½“äº‹äººï¼Œè°ä¹Ÿä¸æ•¢åˆ è¿™æ®µé€»è¾‘</li><li>åœ¨æ˜çŸ¥æœ‰bugçš„æƒ…å†µä¸‹ï¼Œä»ç„¶æäº¤ä»£ç ï¼Œä¸ºçš„å°±æ˜¯åé¢ä¿®æ”¹bugçš„ä»£ç é‡ï¼ˆä¸ç”¨æ‰¾bugï¼Œè€—æ—¶å¾ˆçŸ­ï¼‰ã€‚</li><li>å¤§é‡çš„ä»£ç å¤åˆ¶ç²˜è´´çš„ç°åœºå‡ºç°ï¼Œå®Œå…¨èƒŒç¦»äº†ä»£ç å¤ç”¨çš„åˆè¡·ã€‚ä½†ä¹Ÿæœ‰ä¸ªå¥½å¤„ï¼Œé™ä½äº†ä»£ç è€¦åˆåº¦ã€‚</li><li>é‡å¤é€ è½®å­ç°è±¡å‡ºç°ï¼Œå°½ç®¡æœ‰ä¸€äº›å¼€æºæˆç†Ÿæ–¹æ¡ˆã€‚</li><li>ç­‰ç­‰æˆ‘ä¸€äº›æ²¡å‘ç°çš„å‘ã€‚</li></ul><p>æœ¬æ¥å¤šä¸ªäººç»´æŠ¤ä¸€ä¸ªé¡¹ç›®ï¼Œå°±å®¹æ˜“å¯¼è‡´â€œä»£ç å±å±±â€çš„äº§ç”Ÿï¼Œå¦‚ä½•ç»´æŠ¤å°±æ˜¯ä¸šç•Œçš„ä¸€ä¸ªå¤§éš¾é¢˜ï¼Œç°åœ¨â€œå±å±±â€çš„äº§ç”Ÿé€Ÿåº¦æŒ‡æ•°å€çš„å¢é•¿ã€‚</p><p>åªèƒ½è¯´ï¼Œä¸Šæœ‰æ”¿ç­–ï¼Œä¸‹æœ‰å¯¹ç­–ã€‚åæ­£è¿‡å‡ å¹´å°±è¢«è£å‘˜äº†ï¼Œæ²¡å¿…è¦ä¸ºäº†ä»£ç çš„è´¨é‡è€Œè·Ÿå·¥èµ„è¿‡ä¸å»ã€‚</p><p>å›åˆ°é—®é¢˜ï¼Œä¸ºä»€ä¹ˆä¼šè¦æœ‰ä»£ç é‡è€ƒæ ¸å‘¢ï¼Ÿæ›´æ·±ä¸€å±‚ï¼Œä¸ºä»€ä¹ˆä¼šå­˜åœ¨æ‰€è°“çš„â€œç®¡ç†å¤§æ³•â€å‘¢ï¼Ÿ</p><p>æœ¬è´¨ä¸Šæ˜¯å…¬å¸è€æ¿å¯¹å‘˜å·¥å¤©ç„¶çš„ä¸ä¿¡ä»»æ„Ÿå¯¼è‡´çš„ï¼šæ—¢æƒ³é©¬å„¿è·‘ï¼Œåˆä¸ç›¸ä¿¡é©¬å„¿ä¼šçœŸçš„è·‘ï¼Œè¿˜ä¸èˆå¾—ç»™é©¬å„¿åƒè‰ã€‚</p><p>ä»Šå¹´ï¼Œæœ‰ä¸€ä¸ªé—®é¢˜åœ¨ç½‘ç»œä¸Šå¾ˆç«ï¼šä¸ºä»€ä¹ˆå¤§å…¬å¸æ²¡æœ‰æå‡ºdeepseekè¿™æ ·çš„äº§å“å‘¢ï¼Ÿ</p><p>æˆ‘è§‰å¾—çœ‹åˆ°ä»Šå¤©çš„æ–‡ç« ï¼Œå¯èƒ½ä¼šæœ‰ä¸€äº›æ€è€ƒå§ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æ€è€ƒ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åæ§½</tag>
      
      <tag>æ€è€ƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¦‚ä½•å®ç°ä¸€å¥—æ¨èç³»ç»Ÿï¼Ÿ</title>
    <link href="/2025/04/08/architecture-sys-recommendation/"/>
    <url>/2025/04/08/architecture-sys-recommendation/</url>
    
    <content type="html"><![CDATA[<p>æˆ‘ä»¬ç»å¸¸è¯´å¤§æ•°æ®æ¯”ä½ è¿˜æ‡‚ä½ ï¼Œæ— è®ºåœ¨åˆ·æŠ–éŸ³ï¼Œå¬éŸ³ä¹ï¼Œçœ‹å‰§è¿˜æ˜¯è´­ç‰©æ—¶ï¼Œéƒ½ä¼šçœ‹åˆ°ä¸€äº›æˆ‘ä»¬å¾ˆå–œæ¬¢çš„ä¸œè¥¿ï¼Œè®©æˆ‘ä»¬å¿ä¸ä½çš„å»çœ‹ä¸€çœ‹ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬å’Œâ€œå®ƒâ€æ˜¯å¦‚ä½•ç›¸é‡çš„å‘¢ï¼Ÿ è¿™èƒŒåçš„åŸå› æ˜¯ï¼Œå„ä¸ªç³»ç»Ÿçš„æ¨èå¼•æ“åœ¨ä¸æ–­çš„å­¦ä¹ ä½ çš„å–œå¥½ï¼Œç»™ä½ æ¨é€ä½ å–œæ¬¢çš„å†…å®¹ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬å°±èŠä¸€èŠï¼Œæ¨èå¼•æ“æ˜¯å¦‚ä½•ç»™æˆ‘ä»¬æ¨èå†…å®¹çš„ã€‚</p><h2 id="æ¨èçš„æ ¸å¿ƒæ€è·¯"><a href="#æ¨èçš„æ ¸å¿ƒæ€è·¯" class="headerlink" title="æ¨èçš„æ ¸å¿ƒæ€è·¯"></a>æ¨èçš„æ ¸å¿ƒæ€è·¯</h2><p>æ‰€è°“æ¨èï¼Œå°±æ˜¯æ ¹æ®ç”¨æˆ·çš„å–œå¥½ï¼Œæ¨èç»™ç”¨æˆ·ä¸€äº›ç”¨æˆ·ä¸çŸ¥é“çš„å†…å®¹ï¼ˆå•†å“ã€ä¹¦ç±ã€éŸ³ä¹ã€è§†é¢‘ç­‰ï¼‰ï¼Œå°†äººä¸å†…å®¹è”ç³»èµ·æ¥ã€‚</p><p>è¿™é‡Œæ¶‰åŠåˆ°ä¸¤ä¸ªæ¦‚å¿µï¼š</p><ul><li>ç”¨æˆ·å–œå¥½ï¼šä¸€èˆ¬ç”¨æˆ·æ˜¯ä¸ä¼šå°†è‡ªå·±çš„å–œæ¬¢ä»€ä¹ˆå‘Šè¯‰åˆ«äººçš„ï¼Œç”šè‡³ç”¨æˆ·å¯èƒ½è‡ªå·±éƒ½ä¸çŸ¥é“è‡ªå·±å–œæ¬¢ä»€ä¹ˆï¼Œè¿™é‡Œä¸»è¦æ˜¯é€šè¿‡ç”¨æˆ·åœ¨ç½‘ç«™é‡Œæ‰€æœ‰çš„è¡Œä¸ºè®°å½•æ¥è¿›è¡Œç»¼åˆåˆ†æï¼Œæ¯”å¦‚ä¸‹é¢çš„ç”¨æˆ·è¡Œä¸º<ul><li>è´­ä¹°è®°å½•ï¼šç”¨æˆ·ä¹°äº†ä»€ä¹ˆï¼Œå°±èƒ½åˆ†æå‡ºå¾ˆå¤šä¸œè¥¿ã€‚æ¯”å¦‚ç”¨æˆ·éœ€æ±‚ã€ä»·æ ¼ã€å“ç‰Œæ¥å—åº¦ç­‰ã€‚</li><li>ç‚¹èµã€åˆ†äº«ç­‰ä¸€åˆ‡æ­£å‘è¡Œä¸ºï¼šåˆ†æç”¨æˆ·çš„å–œå¥½</li><li>ç‚¹è¸©ã€ä¸¾æŠ¥ç­‰ä¸€åˆ‡è´Ÿå‘è¡Œä¸ºï¼šåˆ†äº«ç”¨æˆ·çš„ä¸å–œæ¬¢</li><li>è¯„è®ºã€æœç´¢è®°å½•ç­‰ä¸»åŠ¨è¡Œä¸ºï¼šç”¨æˆ·çš„ä¸»è§‚æ„æ„¿è¡¨è¾¾ï¼Œæ— è®ºæ˜¯æ–‡å­—ï¼Œè¿˜æ˜¯è¯­éŸ³ï¼Œéƒ½å¯ä»¥é€šè¿‡åˆ†è¯æŠ€æœ¯ã€è‡ªç„¶è¯­è¨€å¤„ç†æŠ€æœ¯ï¼Œå¾—åˆ°ä¸€äº›å…³é”®è¯ï¼Œè¿™äº›å…³é”®è¯å°±æ˜¯ç”¨æˆ·çš„å¥½æ¶ã€‚</li><li>ç‚¹å‡»ã€æµè§ˆæ—¶é•¿ï¼šæœ€ç›´è§‚çš„ï¼Œå–œæ¬¢ã€å¥½å¥‡æ‰ä¼šç‚¹å‡»ï¼›æ„Ÿå…´è¶£ï¼Œçœ‹çš„æ—¶é—´è¶Šé•¿ã€‚</li><li>æ”¶è—ï¼šå¼ºçƒˆå–œæ¬¢æ„å¿—çš„ä¸€ç§è¡¨ç°ã€‚</li><li>ç­‰ç­‰</li></ul></li><li>æ¨èå†…å®¹: æŠ–éŸ³çš„è§†é¢‘ï¼Œæ·˜å®çš„å•†å“ï¼Œå¹¿å‘Šï¼ŒQQçš„éŸ³ä¹,ä»¥åŠå¥½å‹ï¼Œç½‘ä¸Šå±•ç¤ºçš„ä¸€åˆ‡ï¼Œéƒ½å¯ä»¥ç®—æ˜¯å†…å®¹ï¼Œè€Œæ¯ä¸ªå†…å®¹ä¹Ÿå¯ä»¥æŒ–æ˜å‡ºä¸€äº›ç‰¹å¾ï¼Œæ¯”å¦‚ï¼š<ul><li>ä½œè€…ã€å•†å®¶ã€å“ç‰Œ</li><li>ä»·æ ¼</li><li>é£æ ¼ã€ä¸»é¢˜</li><li>å†…å®¹</li><li>è¯­è¨€</li><li>åœ°åŸŸ</li><li>ç­‰ç­‰</li></ul></li></ul><p>é€šè¿‡åˆ†æç”¨æˆ·è¡Œä¸ºï¼Œå°†å†…å®¹çš„ç†Ÿæ‚‰ä¸ç”¨æˆ·çš„å–œå¥½è”ç³»èµ·æ¥çš„è¿‡ç¨‹ï¼Œå°±å®ç°äº†å¹³å°å¯¹ç”¨æˆ·çš„å†…å®¹æ¨èäº†ï¼Œè¿™ä¹Ÿå°±æ˜¯æ‰€è°“â€œå¤§æ•°æ®æ¯”ä½ ç»™äº†è§£ä½ â€çš„åŸå› ã€‚</p><h2 id="æ¨èå¼•æ“çš„å®ç°"><a href="#æ¨èå¼•æ“çš„å®ç°" class="headerlink" title="æ¨èå¼•æ“çš„å®ç°"></a>æ¨èå¼•æ“çš„å®ç°</h2><p>æ¨èå¼•æ“çš„æŒ‡å¯¼æ€æƒ³æœ‰äº†ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥è¦åšçš„å°±æ˜¯åœ¨æŠ€æœ¯å±‚é¢å®ç°è¿™ä¸ªæ¨èå¼•æ“å¦‚ä½•å®ç°ï¼ŒæŒ‰ç…§ä¸åŒçš„å®ç°æ€è·¯ï¼Œå¤§è‡´å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p><h3 id="ååŒè¿‡æ»¤æ—¶ä»£"><a href="#ååŒè¿‡æ»¤æ—¶ä»£" class="headerlink" title="ååŒè¿‡æ»¤æ—¶ä»£"></a>ååŒè¿‡æ»¤æ—¶ä»£</h3><p>ååŒè¿‡æ»¤ç®—æ³•ï¼Œå¯ä»¥è¯´æ˜¯æœ€å¤è€çš„æ¨èç®—æ³•äº†ï¼Œè¿™ä¸ªç®—æ³•è¯ç”Ÿäº1992å¹´ï¼Œç”šè‡³å¯ä»¥è¯´ï¼Œè¿™ä¸ªç®—æ³•çš„è¯ç”Ÿï¼Œæ‰æœ‰äº†æ¨èç³»ç»Ÿçš„å‡ºç°ã€‚</p><p>è¿™ä¸ªç®—æ³•çš„æ ¸å¿ƒæ€æƒ³å¾ˆç®€å•ï¼š</p><ul><li>åŸºäºç”¨æˆ·çš„ååŒè¿‡æ»¤ç®—æ³•ï¼šä¸€ä¸ªç”¨æˆ·å¯¹ä¸€ä¸ªå†…å®¹å¾ˆå–œæ¬¢ï¼Œé‚£ä¹ˆç›¸ä¼¼çš„ç”¨æˆ·å¯èƒ½ä¹Ÿä¼šå–œæ¬¢è¿™ä¸ªå†…å®¹ã€‚</li><li>åŸºäºå†…å®¹çš„ååŒè¿‡æ»¤ç®—æ³•ï¼šä¸€ä¸ªå†…å®¹è¢«å¾ˆå¤šç”¨æˆ·å–œæ¬¢ï¼Œé‚£ä¹ˆç›¸ä¼¼çš„å†…å®¹å¯èƒ½ä¹Ÿä¼šè¢«è¿™äº›äººå–œæ¬¢ã€‚</li></ul><h4 id="åŸºäºç”¨æˆ·çš„ååŒè¿‡æ»¤ç®—æ³•"><a href="#åŸºäºç”¨æˆ·çš„ååŒè¿‡æ»¤ç®—æ³•" class="headerlink" title="åŸºäºç”¨æˆ·çš„ååŒè¿‡æ»¤ç®—æ³•"></a>åŸºäºç”¨æˆ·çš„ååŒè¿‡æ»¤ç®—æ³•</h4><p>æ— è®ºæ˜¯è§†é¢‘ç½‘ç«™ï¼Œè¿˜æ˜¯è´­ç‰©ç½‘ç«™ï¼Œæ­¤æ—¶å·²ç»æ”¶é›†åˆ°äº†ç›¸å½“å¤šç»´åº¦çš„ç”¨æˆ·è¡Œä¸ºæ•°æ®ï¼Œæ¯”å¦‚ è´­ä¹°è®°å½•ã€ç‚¹èµã€æ”¶è—ç­‰ã€‚</p><p>è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç®€å•çš„é›†åˆè¿‘ä¼¼åº¦ç®—æ³•ï¼Œæ¯”å¦‚<code>jaccard</code>ç®—æ³•ï¼ˆæ ¸å¿ƒé€»è¾‘ï¼šäº¤é›†&#x2F;å¹¶é›†ï¼‰æ¥å¯»æ‰¾ç›¸ä¼¼çš„ç”¨æˆ·ã€‚</p><p>æ¯”å¦‚ï¼Œé€šè¿‡å°†ç”¨æˆ·çš„è´­ä¹°è®°å½•ï¼Œæ”¶è—è®°å½•çš„å†…å®¹ç»„æˆä¸€ä¸ªé›†åˆï¼Œç„¶åé€šè¿‡<code>jaccard</code>ç®—æ³•ï¼Œä¸¤ä¸¤æ¯”è¾ƒï¼Œæ‰¾åˆ°ç›¸ä¼¼åº¦æ¯”è¾ƒé«˜çš„ç”¨æˆ·é›†åˆï¼Œç„¶åæŠŠå½¼æ­¤è´­ä¹°ã€æ”¶è—å†…å®¹æ¨èç»™å¯¹æ–¹ï¼Œä¸€ä¸ªæœ€ç®€å•çš„åŸºäºç”¨æˆ·çš„ååŒå†…å®¹æ¨èå°±å®Œæˆäº†ã€‚</p><h4 id="åŸºäºå†…å®¹çš„ååŒè¿‡æ»¤ç®—æ³•"><a href="#åŸºäºå†…å®¹çš„ååŒè¿‡æ»¤ç®—æ³•" class="headerlink" title="åŸºäºå†…å®¹çš„ååŒè¿‡æ»¤ç®—æ³•"></a>åŸºäºå†…å®¹çš„ååŒè¿‡æ»¤ç®—æ³•</h4><p>åŒ<code>åŸºäºç”¨æˆ·çš„ååŒè¿‡æ»¤ç®—æ³•</code>ä¸€æ ·ï¼Œ <code>åŸºäºå†…å®¹çš„ååŒè¿‡æ»¤ç®—æ³•</code>æ˜¯ä»¥å†…å®¹ä¸ºåˆ¤æ–­ä¾æ®ï¼Œæ¥å¯»æ‰¾ä¼šå–œæ¬¢è¿™ä¸ªå†…å®¹çš„äººã€‚</p><p>å¦‚æœè¯´<code>åŸºäºç”¨æˆ·çš„ååŒè¿‡æ»¤ç®—æ³•</code>è¿˜éœ€è¦è®°å½•ç”¨æˆ·è¡Œä¸ºçš„åŒ–ï¼Œé‚£ä¹ˆ<code>åŸºäºå†…å®¹çš„ååŒè¿‡æ»¤ç®—æ³•</code>åªéœ€è¦åˆ†æå†…å®¹ç›¸ä¼¼åº¦å°±å¯ä»¥äº†ï¼Œè€Œå†…å®¹çš„æ‰€æœ‰ä¿¡æ¯ï¼Œç½‘ç«™æ˜¯å…¨éƒ¨éƒ½æŒæ¡çš„ï¼Œæ¯”å¦‚é£æ ¼ã€ä»·æ ¼ã€å•†æˆ·ç­‰ï¼Œè€Œä¸”è¿˜èƒ½é€šè¿‡åŸºæœ¬å…ƒç´ ç»„åˆçš„æ–¹å¼ï¼Œæ•´åˆå‡ºæ›´å¤šçš„ä¿¡æ¯ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†æœ‰ç±»ä¼¼çš„é£æ ¼ã€ä»·æ ¼ç­‰ç»„æˆä¸€ä¸ªä¸ªé›†åˆï¼Œæœ€åæ ¹æ®ç”¨æˆ·çš„ç‚¹å‡»ã€æ”¶è—ç­‰ä¹ æƒ¯ï¼Œç›´æ¥æ¨èé›†åˆé‡Œçš„ç›¸å…³å†…å®¹å³å¯ã€‚</p><p>è¿™é‡Œå†…å®¹çš„æœ€ç»ˆé€‰æ‹©ï¼Œå¯ä»¥ç›´æ¥ä»ç›¸å…³é›†åˆé‡Œéšæœºé€‰æ‹©ï¼Œä¹Ÿå¯ä»¥è¿›ä¸€æ­¥ï¼Œé€šè¿‡ç±»ä¼¼<code>jaccard</code>ç®—æ³•ï¼Œå°†ç”¨æˆ·ç‚¹å‡»å†…å®¹çš„ç»„æˆçš„é›†åˆä¸ç›¸å…³å†…å®¹é›†åˆè¿›è¡Œç›¸ä¼¼åº¦æ¯”è¾ƒï¼Œå°†ç›¸ä¼¼åº¦æœ€é«˜çš„å†…å®¹æ¨èç»™ç”¨æˆ·ã€‚</p><h4 id="ç»¼åˆä½¿ç”¨"><a href="#ç»¼åˆä½¿ç”¨" class="headerlink" title="ç»¼åˆä½¿ç”¨"></a>ç»¼åˆä½¿ç”¨</h4><p>ä»»ä½•æ¨èç®—æ³•éƒ½ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œæ­£å¸¸æ¥è¯´ï¼Œå¯ä»¥å°†å„ç§ç®—æ³•ç»¼åˆæ¥ä½¿ç”¨ï¼Œæ¯”å¦‚é€šè¿‡<code>åŸºäºç”¨æˆ·çš„ååŒè¿‡æ»¤ç®—æ³•</code>æ‰¾åˆ°ç›¸ä¼¼ç”¨æˆ·ï¼Œç„¶åå†æ ¹æ®ç›¸ä¼¼ç”¨æˆ·çš„å†…å®¹ï¼Œé€šè¿‡<code>åŸºäºå†…å®¹çš„ååŒè¿‡æ»¤ç®—æ³•</code>è¿›ä¸€æ­¥ç­›é€‰å‡ºç›¸ä¼¼å†…å®¹ï¼Œæ¨èç»™è¿™äº›ç”¨æˆ·ã€‚</p><h3 id="æ ‡ç­¾æ—¶ä»£"><a href="#æ ‡ç­¾æ—¶ä»£" class="headerlink" title="æ ‡ç­¾æ—¶ä»£"></a>æ ‡ç­¾æ—¶ä»£</h3><p>åœ¨<code>ååŒè¿‡æ»¤ç®—æ³•</code>æ—¶ä»£ï¼Œä¸»è¦è¿˜æ˜¯é€šè¿‡ç”¨æˆ·çš„è¡Œä¸ºï¼Œå’Œå•†å“çš„åŸå§‹ä¿¡æ¯ï¼Œæ¥æ¨èå†…å®¹ã€‚</p><p>ä½†å¦‚ä½•æƒ³è¦æ›´ç²¾ç¡®çš„å»æŒ–æ˜ç”¨æˆ·çš„å–œæ¬¢ï¼Œå®ç°å†…å®¹å¾—æ›´ç²¾å‡†æ¨èï¼Œè¿™ä¸ªæ—¶å€™å°±å¼•å…¥äº†æ ‡ç­¾çš„æ¦‚å¿µã€‚</p><p>æ‰€è°“æ ‡ç­¾ï¼Œå°±æ˜¯åœ¨åŸå…ˆçš„ç”¨æˆ·å±æ€§ï¼Œå†…å®¹å±æ€§å¤–ï¼Œä»å¦ä¸€ä¸ªå‚ç›´ç»´åº¦ï¼Œæ¥å¯¹æ‰€æœ‰çš„ç”¨æˆ·ã€å†…å®¹æ‰“æ ‡ç­¾ï¼Œè¿™ä¸ªæ ‡ç­¾æ˜¯å¾ˆçµæ´»çš„ï¼Œå¦‚ç”¨æˆ·ã€å†…å®¹å®Œå…¨æ— å…³çš„ã€‚</p><p>ä¸¾ä¸ªæç«¯çš„ä¾‹å­ï¼šæˆ‘ä»¬å®Œå…¨å¯ä»¥ç»™ä¸€æœ¬ä¹¦ï¼Œæ‰“ä¸Šâ€œè‹¹æœâ€çš„æ ‡ç­¾ï¼Œè¿™ä¸ªè§„åˆ™ä¸Šæ˜¯å…è®¸çš„ã€‚</p><p>è€Œæ ‡ç­¾çš„æ¥æºï¼Œæ•´ä½“ä¸Šå¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼š</p><ul><li>ä¸»åŠ¨æ ‡ç­¾ï¼šç”¨æˆ·ä¸»åŠ¨ç»™å†…å®¹çš„æ ‡è®°è¡Œä¸º<ul><li>æ¯”å¦‚è±†ç“£ç”µå½±è¯„ä»·çš„æ—¶å€™ï¼Œä¼šè¦æ±‚æä¾›å°è±¡æ ‡ç­¾</li><li>æˆ‘ä»¬ç¬¬ä¸€æ¬¡ç™»å½•å¾®åšæ˜¯ï¼Œä¼šè®©æˆ‘ä»¬é€‰æ‹©å–œæ¬¢çš„é¢†åŸŸï¼Œè¿™å°±æ˜¯ç»™è‡ªå·±æ‰“æ ‡ç­¾ã€‚</li><li>ç­‰ç­‰</li></ul></li><li>è¢«åŠ¨æ ‡ç­¾<ul><li><code>åŸºäºå†…å®¹çš„ååŒè¿‡æ»¤ç®—æ³•</code>é‡Œç‰©å“çš„åŸå§‹å±æ€§éƒ½å¯ä»¥å½“åšæ ‡ç­¾æ¥ä½¿ç”¨ï¼Œæ¯”å¦‚ä½œè€…æ˜¯â€œé‡‘åº¸â€ï¼Œå†…å®¹æ˜¯â€œç¾å¥³è·³èˆâ€ç­‰</li><li>åŸºäºè‡ªç„¶è¯­è¨€æŠ€æœ¯çš„å‘å±•ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å¯¹å†…å®¹è¿›è¡Œåˆ†æï¼Œæå–å†…å®¹çš„å…³é”®è¯è¿›è¡Œæ‰“æ ‡</li><li>ç±»ä¼¼æœç´¢å¼•æ“è¿™æ ·çš„ï¼Œæˆ‘ä»¬çš„æœç´¢å…³é”®è¯ä¹Ÿæ˜¯å¤©ç„¶çš„æ ‡ç­¾ã€‚</li><li>ç­‰ç­‰</li></ul></li></ul><p><img src="/../../images/funny/movie_nezha.png" alt="å“ªå’ç”µå½±çš„æ ‡ç­¾"></p><p>é€šè¿‡ä¸Šé¢çš„ä¸»åŠ¨æ ‡ç­¾ã€è¢«åŠ¨æ ‡ç­¾ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†æˆ‘ä»¬éœ€è¦çš„æ ‡ç­¾ï¼Œè¿™äº›æ ‡ç­¾å¯èƒ½æ˜¯ä¸€ç»´çš„ï¼Œæ¯”å¦‚â€œä¹¦ç±â€ï¼›ä¹Ÿå¯ä»¥æ˜¯äºŒç»´çš„ï¼Œæ¯”å¦‚â€œä½œè€…ï¼šé‡‘åº¸â€ï¼›è¿˜å¯ä»¥æ˜¯å¤šç»´çš„ï¼Œå®Œå…¨çœ‹æˆ‘ä»¬çš„è®¾è®¡ã€‚</p><p>æœ‰äº†æ ‡ç­¾ï¼Œç‰¹åˆ«æ˜¯ä¸»åŠ¨æ ‡ç­¾çš„åŠ å…¥ï¼Œæˆ‘ä»¬çš„å†…å®¹åœ¨å„ä¸ªç»´åº¦ä¸Šçš„ç‰¹å¾ï¼ˆè¿™äº›ç‰¹å¾ä¹Ÿå¼€å¯äº†åé¢æœºå™¨å­¦ä¹ çš„åŸå§‹å…»æ–™ï¼‰ä¹Ÿå°±æ›´åŠ çš„ç²¾å‡†ã€‚</p><p>å†…å®¹ç²¾ç»†åŒ–äº†ï¼Œä¸Šé¢çš„<code>ååŒè¿‡æ»¤ç®—æ³•</code>è®¡ç®—å‡ºæ¥çš„ç»“æœä¹Ÿå°±æ›´åŠ çš„ç²¾å‡†äº†ã€‚</p><h3 id="å‘é‡æ¨è"><a href="#å‘é‡æ¨è" class="headerlink" title="å‘é‡æ¨è"></a>å‘é‡æ¨è</h3><p>ä¸ä»…ä»…å¦‚æ­¤ï¼Œæ ‡ç­¾çš„å‡ºç°ï¼Œè¿˜å…è®¸æˆ‘ä»¬åœ¨<code>ååŒè¿‡æ»¤ç®—æ³•</code>å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä¸€ç§æ›´é«˜æ•ˆçš„æ¨èç®—æ³•ï¼šåŸºäºå‘é‡çš„<code>ä½™å¼¦ç›¸ä¼¼åº¦ç®—æ³•</code>ï¼Œæ¥è¿›è¡Œå†…å®¹çš„æ•´åˆã€æ¨èã€‚</p><p>å‘é‡æ¨è å’Œä¹‹å‰çš„ <code>jaccard</code>ç­‰é›†åˆç®—æ³•ï¼Œåœ¨å®ç°ä¸Šæœ‰ç€æ ¹æœ¬çš„å·®å¼‚ã€‚ </p><p>ä¸€ä¸ªæ˜¯åŸºäºé›†åˆçš„ç®—æ³•ï¼ŒåŸºäºé›†åˆçš„ç®—æ³•ï¼Œæ— è®ºå¦‚ä½•ä¼˜åŒ–ï¼Œç²’åº¦éƒ½ä¸è¿‡ç²¾ç»†ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„æ¨èä¸å‡†ã€‚</p><p>å¦ä¸€ä¸ªæ˜¯åŸºäºå‘é‡çš„ç®—æ³•ï¼Œå‘é‡ç®—æ³•è„±ç¦»äº†é›†åˆå…ƒç´ åŒ¹é…çš„é™åˆ¶ï¼Œè€Œæ˜¯é€šè¿‡ä¸åŒçš„å…ƒç´ ç»„æˆçš„å‘é‡ï¼Œé€šè¿‡å‘é‡çš„æ–¹å‘æ¥åˆ¤æ–­å†…å®¹æ˜¯å¦ç›¸ä¼¼ã€‚<br>è€Œä¸”å‘é‡çš„ç‰¹æ€§æ˜¯æœ‰æ–¹å‘çš„ã€‚ <code>[a,b]</code>å’Œ <code>[b,a]</code>æ˜¯å®Œå…¨ä¸åŒçš„å‘é‡ã€‚ è¿™æ ·ï¼Œæˆ‘ä»¬ä¸ä»…å¯ä»¥æ›´åŠ ç»†ç²’åº¦çš„é‡åŒ–å„ç§ å†…å®¹ç‰¹å¾ï¼Œè¿˜å¯ä»¥é€šè¿‡ä¸€äº›è¡Œä¸ºå‘ç”Ÿçš„å…ˆåçš„é¡ºåºæ¥åˆ¤æ–­å†…å®¹æ˜¯å¦ç›¸ä¼¼ã€‚</p><p>æ¯”å¦‚ç”¨æˆ·a,ç»™ç”µå½±b,æ‰“äº†cçš„æ ‡ç­¾ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªä¸‰ç»´æ ‡ç­¾<code>[a,b,c]</code>ï¼Œè¿™ç§å¸¦æœ‰å¾ˆæ˜ç¡®æ–¹å‘æ€§è¡Œä¸ºçš„æ•°æ®ï¼Œç”¨é›†åˆæ˜¯å¾ˆéš¾å¤„ç†çš„ï¼Œä½†æ˜¯å¦‚æœå½“åšå‘é‡ï¼Œå°±å¾ˆå¥½å¤„ç†äº†ã€‚</p><p>æ‰€ä»¥ï¼Œå‘é‡æ¨èç®—æ³•çš„å‡ºç°ï¼Œä¸ä»…å¯èƒ½è®©æˆ‘ä»¬å¯¹å†…å®¹å®ç°æ›´ç»†ç²’åº¦çš„åˆ’åˆ†å’Œæ¨èï¼Œè¿˜èƒ½æ›´åŠ ç²¾å‡†çš„è¯†åˆ«ç”¨æˆ·çš„æ„å›¾ï¼ŒæŒ–æ˜å†…å®¹çš„<code>éšå¼è¯­ä¹‰ç›¸ä¼¼æ€§</code>ï¼Œä¸ºä»¥åçš„AIæ—¶ä»£çš„åƒäººåƒé¢æ‰“ä¸‹äº†åŸºç¡€ã€‚</p><p>è€Œä¸”ï¼Œæ›´è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å¯¹ä¸åŒçš„æ ‡ç­¾æ·»åŠ ä¸åŒçš„æƒé‡ï¼Œç”¨æ¥æ ‡è¯†æ ‡ç­¾çš„è´¨é‡ã€‚æ¯”å¦‚ç”¨æˆ·è¯„ä»·é‡Œï¼Œå–œæ¬¢&#x3D;100åˆ†ï¼Œä¸€èˆ¬&#x3D;50åˆ†ï¼Œä¸å–œæ¬¢&#x3D;-100åˆ†ã€‚</p><p>è¿™æ ·ï¼Œæœ‰äº†æƒé‡çš„åŠ æŒï¼Œå°±æ›´å¯ä»¥ä»æµ©å¦‚çƒŸæµ·çš„å†…å®¹ä¸­ï¼ŒåŒ¹é…åˆ°ç”¨æˆ·æœ€å–œæ¬¢çš„å†…å®¹äº†ï¼Œè¿˜å¯ä»¥åŒæ—¶æŠŠç”¨æˆ·çš„é›·åŒºè§„é¿æ‰ã€‚</p><h3 id="å›¾"><a href="#å›¾" class="headerlink" title="å›¾"></a>å›¾</h3><p>æœ‰äº†å‘é‡ï¼Œæœ‰äº†æƒé‡ï¼Œåœ¨åŠ ä¸Šå†…å®¹å½“ä½œç‚¹ï¼Œæœ‰æ²¡æœ‰æƒ³åˆ°äº›ä»€ä¹ˆï¼Ÿ</p><p>é€šè¿‡è¿™äº›è¦ç´ ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»„æˆä¸€ä¸ª<code>å›¾</code>ã€‚</p><p>æˆ‘ä»¬å®Œå…¨å¯ä»¥æŠŠæ‰€æœ‰çš„å†…å®¹å‘é‡ï¼Œå¯¼å…¥å›¾æ•°æ®åº“ä¸­ï¼Œå½¢æˆä¸€ä¸ªåºå¤§çš„å…³ç³»å›¾ï¼Œåªè¦åœ¨ä¸€å®šè·ç¦»å†…ï¼Œèƒ½å¤Ÿå½¼æ­¤åˆ°è¾¾çš„èŠ‚ç‚¹ï¼Œéƒ½æ˜¯å…·æœ‰ç›¸ä¼¼æ€§çš„ã€‚</p><p>è¿™æ ·ï¼Œæˆ‘ä»¬è¦å¯»æ‰¾çš„æ¨èçš„å†…å®¹ï¼Œå°±å¯ä»¥è½¬æ¢æˆåœ¨å›¾ä¸­ï¼Œç‚¹å’Œç‚¹ä¹‹é—´è·ç¦»çš„ç›¸ä¼¼åº¦ é—®é¢˜äº†ã€‚</p><p><img src="/../../images/tech/architecture/sys/map_demo.png" alt="å›¾"></p><p>å¦‚å›¾ä¸­ï¼Œæˆ‘ä»¬ç ”ç©¶å·¦å³ä¸¤ä¾§èŠ‚ç‚¹çš„ç‚¹è·ç¦»</p><ul><li>u1-&gt;A : [u1,ç”²ï¼Œå¤©ï¼ŒA] , [u1,ä¹™ï¼Œå¤©ï¼ŒA] , [u1,ä¹™ï¼Œåœ°ï¼ŒA] </li><li>u1-&gt;B : [u1,ç”²ï¼Œå¤©ï¼ŒB] , [u1,ä¹™ï¼Œå¤©ï¼ŒB]</li><li>u1-&gt;C : [u1,ä¹™ï¼Œå¤©ï¼ŒC]</li><li>u2-&gt;A : [u2,ä¹™ï¼Œå¤©ï¼ŒA] , [u2,ä¹™ï¼Œåœ°ï¼ŒA]</li><li>u2-&gt;B : [u2,ä¹™ï¼Œå¤©ï¼ŒB] </li><li>u2-&gt;C : [u2,ä¹™ï¼Œåœ°ï¼ŒC] , [u2,ä¸™ï¼Œç„ï¼ŒC]</li><li>u3-&gt;A : []</li><li>u3-&gt;B : []</li><li>u3-&gt;C : [u3,ä¸™ï¼Œç„ï¼ŒC]</li></ul><p>é€šè¿‡è·¯å¾„ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸<code>u1-&gt;A</code>ç›¸ä¼¼åº¦æœ€é«˜çš„æ˜¯<code>u2-&gt;A</code>ï¼ˆ<code>ä¹™-&gt;åœ°-&gt;A</code>ï¼‰, ç„¶åå¯ä»¥é€šè¿‡u2çš„è¿™æ¡è·¯å¾„ï¼ŒæŠŠCæ¨èç»™Aã€‚</p><p>å½“ç„¶è¿™æ˜¯æœ€ç®€å•çš„ä¾‹å­ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰è®¨è®ºæƒé‡çš„å½±å“ï¼Œå›¾è®ºä¸­ï¼Œä¸å¾ˆå¤šæ‰¾æœ€ä¼˜è·¯å¾„çš„ç®—æ³•ï¼Œå’ŒåŸºäºè·ç¦»çš„ç›¸ä¼¼åº¦ç®—æ³•ã€‚</p><p>ä½†å¦‚æœä»…ä»…æ˜¯ç”¨æ¥åšç³»ç»Ÿæ¨èçš„è¯ï¼Œç°åœ¨æ›´å¤šæ˜¯ä½¿ç”¨å‘é‡æ•°æ®åº“æ¥å­˜å‚¨å‘é‡ï¼Œå¯ä»¥æ›´æ–¹ä¾¿çš„è¿›è¡Œç›¸ä¼¼åº¦æŸ¥è¯¢å’Œæœç´¢ã€‚</p><h3 id="AI-åƒäººåƒé¢æ—¶ä»£"><a href="#AI-åƒäººåƒé¢æ—¶ä»£" class="headerlink" title="AI åƒäººåƒé¢æ—¶ä»£"></a>AI åƒäººåƒé¢æ—¶ä»£</h3><p>éšç€å¤§æ¨¡å‹çš„å¼€æºä¸æ™®åŠï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥æŠŠä¸Šé¢æ”¶é›†åˆ°çš„æ‰€æœ‰çš„ç”¨æˆ·ç‰¹å¾ï¼Œå†…å®¹ç‰¹å¾å…¨æœå¯¼å…¥åˆ°å¤§æ¨¡å‹é‡Œï¼Œé€šè¿‡å¤§æ¨¡å‹çš„è®­ç»ƒï¼Œæ¥æ„å»ºæ¯ä¸ªäººçš„ç”¨æˆ·ç”»åƒï¼Œä»¥åŠå†…å®¹å€¾å‘ã€‚</p><p>å› ä¸ºå¤§æ¨¡å‹çš„è®­ç»ƒï¼Œæ˜¯é€šè¿‡è®­ç»ƒæ•°æ®ï¼Œæ¥æ„å»ºå‡ºæ¨¡å‹çš„å‚æ•°ï¼Œè¿™å°±è„±ç¦»äº†æŸä¸ªç®—æ³•çš„å±€é™æ€§ï¼Œé€šè¿‡äº‹å®åæ¨å…³ç³»ï¼Œå†é€šè¿‡ä¸æ–­çš„å¥–åŠ±æ•°æ®å’Œæƒ©ç½šæ•°æ®ï¼Œè¿›è¡Œæ­£è´Ÿåé¦ˆï¼Œæœ€ç»ˆæ„å»ºå‡ºæ¥çš„æ¨¡å‹ä¼šæ›´â€œæ‡‚ä½ â€ã€‚</p><h2 id="è¿­ä»£è¿›åŒ–"><a href="#è¿­ä»£è¿›åŒ–" class="headerlink" title="è¿­ä»£è¿›åŒ–"></a>è¿­ä»£è¿›åŒ–</h2><p>æ˜¯çš„ï¼Œä»»ä½•ä¸€å¥—æ¨èå¼•æ“éƒ½ä¸æ˜¯ä¸‡èƒ½çš„ï¼ŒåŒ…æ‹¬å¤§æ¨¡å‹ã€‚</p><p>å› ä¸ºäººæ˜¯éšæ—¶éƒ½åœ¨å˜çš„ï¼Œç¤¾ä¼šä¹Ÿåœ¨ä¸æ–­çš„å˜åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä¸æ–­çš„å»è¿­ä»£ï¼Œä¸æ–­çš„å»è§‚å¯Ÿç”¨æˆ·å¯¹äºæˆ‘ä»¬æ¨èå†…å®¹çš„å–œæ¬¢ç¨‹åº¦ï¼Œä»¥æ­¤æ¥æ›´æ–°æˆ‘ä»¬çš„æ¨èå¼•æ“ï¼Œæ¥æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ã€‚</p><p>ç®€å•æ¥è¯´ï¼Œè¦åšåˆ°ä»¥ä¸‹ä¸¤ç‚¹ï¼š</p><ul><li>æ¿€åŠ±æœºåˆ¶ï¼šæ€»ç»“æ¨èç»™ç”¨æˆ·çš„å†…å®¹ä¸­ï¼Œç”¨æˆ·å–œæ¬¢çš„éƒ¨åˆ†çš„ç‰¹å¾ï¼Œä½œä¸ºæ”¹è¿›æ–¹å‘æ·»åŠ åˆ°æ¨èå¼•æ“ä¸­ã€‚</li><li>æƒ©ç½šæœºåˆ¶ï¼šæ€»ç»“æ¨èç»™ç”¨æˆ·çš„å†…å®¹ä¸­ï¼Œç”¨æˆ·ä¸å–œæ¬¢çš„éƒ¨åˆ†çš„ç‰¹å¾ï¼Œä½œä¸ºè¿‡æ»¤æ–¹å‘æ·»åŠ åˆ°æ¨èå¼•æ“ä¸­ã€‚</li></ul><p>è¿™ä¸¤ä¸ªæ¦‚å¿µåœ¨å¤§æ¨¡å‹è®­ç»ƒé‡Œå¸¸è§åˆ°ï¼Œä½†å…¶å®æ˜¯åœ¨å„ç§æ¨èç®—æ³•é‡Œéƒ½é€‚ç”¨ï¼Œå°±æ˜¯è®©æ­£ç¡®çš„å†…å®¹å‡ºç°çš„æ¦‚ç‡æ›´é«˜ï¼Œæ— æ•ˆçš„å†…å®¹å‡ºç°çš„æ¦‚ç‡æ›´ä½ï¼Œä¸æ–­çš„å¢å¼ºæ¨èå†…å®¹çš„å‡†ç¡®ç‡çš„ä¸€ä¸ªæ ¹æœ¬æ€è·¯ã€‚</p><p>è¦åšåˆ°ä¸æ–­çš„å»è¿­ä»£æˆ‘ä»¬çš„æ¨èå¼•æ“ï¼Œå°±éœ€è¦æœ‰ä¸€äº›æŒ‡æ ‡æ¥è¡¡é‡æ¨èå¼•æ“çš„æ¨èæ•ˆæœã€‚</p><p>æˆ‘ä»¬è¯¥å¦‚ä½•è¡¡é‡æ¨èçš„æ•ˆæœå‘¢ï¼Ÿå¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ä¸ªæŒ‡æ ‡æ¥åº¦é‡ï¼š</p><ul><li><p>å‡†ç¡®ç‡ï¼ˆPrecisionï¼‰ï¼šæ¨èåˆ—è¡¨ä¸­ç”¨æˆ·çœŸæ­£æ„Ÿå…´è¶£çš„å†…å®¹å æ¯”ï¼Œè¡¡é‡æ¨èç»“æœçš„ç²¾å‡†æ€§ï¼Œé¿å…â€œæ»¥æ¨èâ€ã€‚ä¾‹å¦‚ï¼Œæ¨è10ä¸ªå•†å“ä¸­æœ‰6ä¸ªè¢«ç”¨æˆ·ç‚¹å‡»ï¼Œåˆ™å‡†ç¡®ç‡ä¸º60%ã€‚</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Precision</mtext><mo>=</mo><mfrac><mtext>æ¨èçš„æ­£ç¡®å†…å®¹æ•°</mtext><mtext>æ¨èçš„æ€»å†…å®¹æ•°</mtext></mfrac></mrow><annotation encoding="application/x-tex">\text{Precision} = \frac{æ¨èçš„æ­£ç¡®å†…å®¹æ•°}{æ¨èçš„æ€»å†…å®¹æ•°}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">Precision</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0463em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">æ¨èçš„æ€»å†…å®¹æ•°</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">æ¨èçš„æ­£ç¡®å†…å®¹æ•°</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></li><li><p>å¬å›ç‡ï¼ˆRecallï¼‰ï¼šç³»ç»Ÿæ¨èçš„ç‰©å“å ç”¨æˆ·æ‰€æœ‰å¯èƒ½æ„Ÿå…´è¶£ç‰©å“çš„æ¯”ä¾‹ï¼Œè¡¡é‡æ˜¯å¦èƒ½å¤ŸæŠŠæ‰€æœ‰çš„ç”¨æˆ·å–œæ¬¢çš„å†…å®¹æ¨èç»™ç”¨æˆ·ã€‚ä¾‹å¦‚ï¼Œç”¨æˆ·å–œæ¬¢10ä¸ªå•†å“ï¼Œç³»ç»Ÿæ¨èäº†å…¶ä¸­6ä¸ªï¼Œåˆ™å¬å›ç‡ä¸º60%ã€‚</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Recall</mtext><mo>=</mo><mfrac><mtext>æ¨èçš„æ­£ç¡®å†…å®¹æ•°</mtext><mtext>ç”¨æˆ·å®é™…å–œæ¬¢çš„å†…å®¹æ•°</mtext></mfrac></mrow><annotation encoding="application/x-tex">\text{Recall} = \frac{æ¨èçš„æ­£ç¡®å†…å®¹æ•°}{ç”¨æˆ·å®é™…å–œæ¬¢çš„å†…å®¹æ•°}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">Recall</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0463em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">ç”¨æˆ·å®é™…å–œæ¬¢çš„å†…å®¹æ•°</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">æ¨èçš„æ­£ç¡®å†…å®¹æ•°</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></li><li><p>è¦†ç›–ç‡ï¼ˆCoverageï¼‰ï¼šæ¨èç³»ç»Ÿèƒ½å¤Ÿè¦†ç›–çš„ç‰©å“å å…¨éƒ¨ç‰©å“çš„æ¯”ä¾‹ï¼Œè¡¡é‡ç³»ç»Ÿå¯¹é•¿å°¾ç‰©å“ï¼ˆå†·é—¨å•†å“ï¼‰çš„æŒ–æ˜èƒ½åŠ›ã€‚</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Coverage</mtext><mo>=</mo><mfrac><mtext>æ¨èçš„å†…å®¹æ•°</mtext><mtext>ç³»ç»Ÿæ‹¥æœ‰çš„å†…å®¹æ€»æ•°</mtext></mfrac></mrow><annotation encoding="application/x-tex">\text{Coverage} = \frac{æ¨èçš„å†…å®¹æ•°}{ç³»ç»Ÿæ‹¥æœ‰çš„å†…å®¹æ€»æ•°}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">Coverage</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0463em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">ç³»ç»Ÿæ‹¥æœ‰çš„å†…å®¹æ€»æ•°</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">æ¨èçš„å†…å®¹æ•°</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></li><li><p>å…´è¶£åº¦ï¼ˆInterestï¼‰ï¼šç”¨æˆ·å¯¹æ¨èå†…å®¹çš„åå¥½ç¨‹åº¦ï¼Œé€šå¸¸é€šè¿‡éšå¼åé¦ˆï¼ˆå¦‚ç‚¹å‡»ç‡ã€åœç•™æ—¶é—´ï¼‰æˆ–æ˜¾å¼è¯„åˆ†ï¼ˆå¦‚5æ˜Ÿè¯„ä»·ï¼‰é‡åŒ–ã€‚</p></li></ul><h2 id="å†·å¯åŠ¨"><a href="#å†·å¯åŠ¨" class="headerlink" title="å†·å¯åŠ¨"></a>å†·å¯åŠ¨</h2><p>æ‰€è°“å†·å¯åŠ¨ï¼Œå°±æ˜¯åœ¨æ²¡æœ‰ä»»ä½•ç”¨æˆ·æ•°æ®å’Œå†…å®¹æ•°æ®çš„å…³ç³»æ—¶ï¼Œå¦‚ä½•å¿«é€Ÿæ„å»ºæ¨èå¼•æ“ï¼Œè®©ç³»ç»Ÿæ­£å‘çš„è·‘èµ·æ¥ã€‚</p><p>æŒ‰ç…§ä¸åŒçš„ç»´åº¦ï¼Œåˆå¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç§ï¼šç”¨æˆ·å†·å¯åŠ¨ï¼Œå†…å®¹å†·å¯åŠ¨ å’Œ ç³»ç»Ÿå†·å¯åŠ¨ã€‚</p><h3 id="ç”¨æˆ·å†·å¯åŠ¨"><a href="#ç”¨æˆ·å†·å¯åŠ¨" class="headerlink" title="ç”¨æˆ·å†·å¯åŠ¨"></a>ç”¨æˆ·å†·å¯åŠ¨</h3><p>ä¸€ä¸ªæ–°æ³¨å†Œçš„ç”¨æˆ·ï¼Œç³»ç»Ÿæ²¡æœ‰ä»–çš„ä»»ä½•è¡Œä¸ºæ•°æ®ï¼Œä¹Ÿæ²¡æœ‰å†å²äº¤äº’æ•°æ®ï¼Œè¯¥å¦‚ä½•ç»™ä»–æ¨èå†…å®¹ã€‚</p><p>æ—¢ç„¶æˆ‘ä»¬æ²¡æœ‰æ–°ç”¨æˆ·çš„è¡Œä¸ºæ•°æ®ï¼Œé‚£å°±å°½é‡çš„å»è·å–ç”¨æˆ·çš„ä¸€äº›é™æ€æ ‡ç­¾æ•°æ®ï¼Œæ¯”å¦‚ç”¨æˆ·æ³¨å†Œæ—¶ï¼Œè®©ç”¨æˆ·å¡«å†™æ€§åˆ«ã€å¹´é¾„ã€èŒä¸šã€å…´è¶£æ–¹å‘ç­‰åŸºæœ¬ä¿¡æ¯ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ ¹æ®ç”¨æˆ·ç™»å½•ipè·å–å…¶å¤§æ¦‚åœ°åŸŸä¿¡æ¯ï¼Œç™»å½•æ—¶é—´è·å–ä½œæ¯è§„å¾‹ç­‰ã€‚</p><p>ç”šè‡³å¯ä»¥é€šè¿‡ç”¨æˆ·ç™»å½•é‚®ç®±çš„æœåŠ¡å•†ï¼Œæ¥è·å–ç”¨æˆ·çš„ä¸€äº›é™æ€æ ‡ç­¾æ•°æ®ã€‚</p><p>è¿™äº›é™æ€æ ‡ç­¾å°±æ˜¯ç”¨æˆ·çš„åŸå§‹æ•°æ®ï¼Œå°†è¿™äº›ä¿¡æ¯æŠ•æ”¾åˆ°æ¨èå¼•æ“é‡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠå…¶ä»–ç±»ä¼¼ç”¨æˆ·çš„å–œå¥½å†…å®¹ï¼Œæ¨èç»™æ–°ç”¨æˆ·ï¼Œå®ç°æ–°ç”¨æˆ·çš„å†·å¯åŠ¨ã€‚</p><h3 id="å†…å®¹å†·å¯åŠ¨"><a href="#å†…å®¹å†·å¯åŠ¨" class="headerlink" title="å†…å®¹å†·å¯åŠ¨"></a>å†…å®¹å†·å¯åŠ¨</h3><p>ä¸€ä¸ªæ–°åŠ å…¥ç³»ç»Ÿçš„å†…å®¹ï¼Œæ²¡æœ‰è¢«ä»»ä½•äººå…³æ³¨è¿‡ï¼Œæ•°æ®å±‚é¢å‡ºäºé•¿å°¾éƒ¨ï¼Œè¯¥å¦‚ä½•æŠŠå®ƒæ¨èç»™åˆé€‚çš„ç”¨æˆ·ã€‚</p><p>è¿™é‡Œä¸»è¦è¦è§£å†³ä¸¤éƒ¨åˆ†å†…å®¹ï¼š</p><ul><li>æ–°å†…å®¹ï¼Œå¦‚ä½•å¿«é€Ÿæ‹†è§£å…¶å†…å®¹ã€ç‰¹å¾ç­‰æ ‡ç­¾ä¿¡æ¯ã€‚</li><li>é•¿å°¾å†…å®¹ï¼Œæ–°å†…å®¹çš„æ•°æ®ä¸€èˆ¬å¾ˆå·®ï¼Œæ— æ³•å’Œçƒ­ç‚¹å†…å®¹ç«äº‰ï¼Œè¯¥å¦‚ä½•å¿«é€Ÿæ›å…‰çš„é—®é¢˜ã€‚</li></ul><p>é’ˆå¯¹è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦åˆ†åˆ«æ¥è§£å†³ï¼š</p><ul><li>æ–°å†…å®¹çš„æ‰“æ ‡ï¼š<ul><li>è®©å†…å®¹æä¾›å•†å°½å¯èƒ½å…¨çš„å»å¡«å†™è¿™ä¸ªå†…å®¹çš„ç‰¹å¾ä¿¡æ¯</li><li>é€šè¿‡å†…å®¹æä¾›å•†æœ¬èº«çš„ä¿¡æ¯ï¼Œå¯¹å†…å®¹è¿›è¡Œæ‰“æ ‡ã€‚</li><li>é€šè¿‡ä¸€äº›å†…å®¹åˆ†æç³»ç»Ÿï¼Œè·å–å†…å®¹æœ¬èº«çš„ç‰¹æ€§ä¿¡æ¯ã€‚</li><li>äººå·¥åˆ†ç±»æ¨è</li></ul></li><li>å¯¹é•¿å°¾ç‰¹å¾<ul><li>å¯ä»¥è€ƒè™‘å°†æ–°å†…å®¹å¢åŠ æƒé‡åŸºæœ¬ï¼Œæˆ–è€…ç»™æ–°å†…å®¹å•ç‹¬çš„æµé‡æ± å­ï¼Œæ¯”å¦‚éŸ³ä¹è½¯ä»¶é‡Œçš„æ–°æ­Œæ¨èç­‰ã€‚</li><li>æ‰“ç ´æ¨èæ¨¡å‹ï¼Œå¢åŠ çº¯ç²¹æŒ‰æ—¶é—´æ›´æ–°çš„å†…å®¹æ¨¡å—</li><li>ä½¿ç”¨ä¸€äº›åé•¿å°¾çš„æ¨èç®—æ³•</li></ul></li></ul><h3 id="ç³»ç»Ÿå†·å¯åŠ¨"><a href="#ç³»ç»Ÿå†·å¯åŠ¨" class="headerlink" title="ç³»ç»Ÿå†·å¯åŠ¨"></a>ç³»ç»Ÿå†·å¯åŠ¨</h3><p>ä¸€ä¸ªæ–°ç½‘ç«™ï¼Œæ²¡æœ‰ç”¨æˆ·æˆ–ç”¨æˆ·å¾ˆå°‘ï¼Œè¯¥å¦‚ä½•å¿«é€Ÿçš„æ”¶é›†ç”¨æˆ·è¡Œä¸ºæ•°æ®ï¼Œæ„å»ºæ¨èå¼•æ“ã€‚</p><p>è¿™é‡Œå†…å®¹çš„æ–¹é¢å¯ä»¥å‚è€ƒå†…å®¹å†·å¯åŠ¨éƒ¨åˆ†ï¼Œä¹Ÿæš‚ä¸è€ƒè™‘ç”¨æˆ·çš„æ‹“æ–°é—®é¢˜ï¼Œä»…è€ƒè™‘åœ¨è‡ªç„¶å¢é•¿çš„ç”¨æˆ·ä½“ç³»å†…ï¼Œå°½å¿«çš„æ”¶é›†ç”¨æˆ·çš„è¡Œä¸ºæ•°æ®ã€‚</p><ul><li>æ’è¡Œæ¦œï¼Œçƒ­é—¨æ¦œç­‰æ¦œå•ï¼Œå¸å¼•ç”¨æˆ·çš„ç‚¹å‡»ï¼Œæ„å»ºç”¨æˆ·å’Œå…´è¶£å…³ç³»ã€‚</li><li>æœç´¢ï¼Œè®©ç”¨æˆ·åœ¨æœç´¢æ¡†ä¸­è¾“å…¥å†…å®¹ï¼Œæ„å»ºç”¨æˆ·å’Œå…³é”®è¯çš„å…³ç³»ã€‚</li><li>ç¤¾äº¤ç½‘ç»œï¼Œå¦‚æœç”¨æˆ·æ˜¯ç¤¾äº¤è´¦å·ç™»å½•çš„ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—ç”¨æˆ·çš„ç¤¾äº¤å…³ç³»ï¼ˆéœ€æˆæƒï¼‰ã€‚</li><li>éšæœºï¼Œå¢åŠ éšæœºå†…å®¹æ¨èï¼Œå¿«é€Ÿæ”¶é›†ç”¨æˆ·å’Œå†…å®¹çš„å…³ç³»ã€‚</li></ul><p>å½“ç„¶è¿˜æœ‰ä¸€äº›æ²¡æœ‰æåˆ°çš„å…¶ä»–æ–¹æ³•ï¼Œæœ¬èº«ä¸Šéƒ½æ˜¯å°½å¯èƒ½çš„å°†å…¨é‡çš„å†…å®¹å°½é‡å…¨é¢çš„å‘ˆç°åœ¨ç”¨æˆ·é¢å‰ï¼Œå°½å¯èƒ½å…¨é¢çš„æ„å»ºå…¨é‡çš„ç”¨æˆ·å’Œå†…å®¹çš„å…³ç³»ï¼Œè·å–æ¨èå¼•æ“çš„è®­ç»ƒæ•°æ®ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ¨èç³»ç»Ÿæ˜¯ä¸€ä¸ªåºå¤§ä¸”å¤æ‚çš„ç³»ç»Ÿï¼Œå…¶ä¸­æ¶‰åŠåˆ°æ¨èç®—æ³•ã€äº§å“è®¾è®¡ã€ç³»ç»Ÿè®¾è®¡ã€æ•°æ®åˆ†æã€ç³»ç»Ÿè°ƒä¼˜ç”šè‡³å¤§æ¨¡å‹ç­‰å„ä¸ªæ–¹é¢ã€‚</p><p>çŸ¥æ˜“è¡Œéš¾ï¼Œæœ¬æ–‡åªæ˜¯å°†è‡ªå·±äº†è§£åˆ°çš„æ¨èç³»ç»Ÿçš„ä¸€äº›åŸºæœ¬æ¦‚å¿µå’Œè®¾è®¡æ€è·¯è¿›è¡Œäº†ä¸€äº›æ•´ç†ï¼Œå¦‚æœè¦æ·±å…¥çš„äº†è§£ï¼Œè¿˜éœ€è¦æŒ‰å›¾ç´¢éª¥ï¼Œå»å„ä¸ªæ–¹å‘æ·±åŒ–å­¦ä¹ ã€‚</p><p>å¸Œæœ›å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©ã€‚</p><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><p><a href="https://www.hancher.top/2025/04/03/base-algorithm-similarity/">ç›¸ä¼¼åº¦ç®—æ³•åœ¨åœ°å€åŒ¹é…ä¸­çš„åº”ç”¨</a> </p><p><a href="https://url41.ctfile.com/f/62647441-1494884764-d5fd95?p=45fsk">Recommender_systems_handbook</a></p><p><a href="https://url41.ctfile.com/f/62647441-1494884743-3552c9?p=45fsk">æ¨èç³»ç»Ÿå®è·µ</a></p>]]></content>
    
    
    <categories>
      
      <category>ç³»ç»Ÿè®¾è®¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¶æ„</tag>
      
      <tag>æ¨èç³»ç»Ÿ</tag>
      
      <tag>æ¨èç®—æ³•</tag>
      
      <tag>æ–¹æ³•è®º</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç›¸ä¼¼åº¦ç®—æ³•åœ¨åœ°å€åŒ¹é…ä¸­çš„åº”ç”¨</title>
    <link href="/2025/04/03/base-algorithm-similarity/"/>
    <url>/2025/04/03/base-algorithm-similarity/</url>
    
    <content type="html"><![CDATA[<p>åœ¨åšåœ°å€åŒ¹é…çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼š</p><p>addr1 &#x3D; æ²³åŒ—çœçŸ³å®¶åº„å¸‚è£•ååŒºä¸‡è¾¾å¹¿åœº<br>addr2 &#x3D; æ²³åŒ—çŸ³å®¶åº„å¸‚è£•åä¸‡è¾¾å¹¿åœº    </p><p>æ˜¯åŒä¸€ä¸ªåœ°å€å—ï¼Ÿ</p><p>addr1 &#x3D; æ²³åŒ—çŸ³å®¶åº„å¸‚è£•åä¸‡è¾¾å¹¿åœº<br>addr3 &#x3D; æ²³åŒ—çŸ³å®¶åº„å¸‚è£•åä¸‡è¾¾å…¬é¦†    </p><p>æ˜¯åŒä¸€ä¸ªåœ°å€å—ï¼Ÿ</p><p>åœ¨äººçš„çœ¼é‡Œï¼Œè¿™å¯èƒ½ä¸æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Œå¯æ˜¯åœ¨è®¡ç®—æœºçœ¼é‡Œï¼Œè¿™å°±ä¸å¥½è¯´äº†ã€‚</p><p>è®¡ç®—æœºèƒ½å¤Ÿå¾ˆå¿«çš„åŒ¹é…ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦å®Œå…¨ä¸€æ ·ï¼Œä½†æ˜¯å¯¹äºå·®é‚£ä¹ˆå‡ ä¸ªå­—ç¬¦çš„ï¼Œè®¡ç®—æœºæ˜¯æ— æ³•è¯†åˆ«å…¶å·®åˆ«æœ‰å¤šå¤§çš„ï¼Œè€Œä¸”è®¡ç®—æœºä¹Ÿæ— æ³•è¯†åˆ«å‡ºæ¥å·®çš„é‚£å‡ ä¸ªå­—æ˜¯å…³é”®è¯è¿˜æ˜¯æ™®é€šçš„è¾…åŠ©è¯ã€‚</p><p>æ‰€ä»¥ç›¸ä¼¼åº¦ç®—æ³•ä¹Ÿå°±æ´¾ä¸Šç”¨åœºäº†ã€‚</p><p>æ‰€è°“ç›¸ä¼¼åº¦ç®—æ³•ï¼Œå°±æ˜¯é€šè¿‡ä¸€å®šçš„è®¡ç®—é€»è¾‘ï¼Œè€åˆ¤æ–­ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼ˆä¸ä»…ä»…æ˜¯å­—ç¬¦ä¸²ï¼‰ä¹‹é—´å·®è·æœ‰å¤šå¤§ï¼Œç„¶åç»™å‡ºä¸€ä¸ªè¯„åˆ†ï¼Œè¯„åˆ†è¶Šé«˜ï¼Œåˆ™ä¸¤ä¸ªå­—ç¬¦ä¸²è¶Šç›¸ä¼¼ï¼Œå¦‚æœä¸¤ä¸ªå­—ç¬¦ä¸²å®Œå…¨ä¸€æ ·ï¼Œåˆ™è¯„åˆ†ä¸º1ã€‚</p><p>æ ¹æ®å®ç°åŸç†çš„ä¸åŒï¼Œç›¸ä¼¼åº¦ç®—æ³•åˆå¯ä»¥åˆ†ä¸ºï¼š</p><ul><li>åŸºäºå‘é‡çš„è¿‘ä¼¼åŒ¹é…<ul><li>cosineä½™å¼¦ç›¸ä¼¼åº¦åŒ¹é…</li></ul></li><li>åŸºäºç¼–è¾‘è·ç¦»çš„è¿‘ä¼¼åŒ¹é…<ul><li>Levenshteinç®—æ³•</li></ul></li><li>åŸºäºå­—ç¬¦ä¸²å±€éƒ¨åŒ¹é…çš„è¿‘ä¼¼åŒ¹é…<ul><li>jaroWinkler</li><li>needlemanWunch</li><li>smithWaterman</li></ul></li><li>åŸºäºé›†åˆçš„è¿‘ä¼¼åŒ¹é…<ul><li>jaccard</li><li>dice</li><li>overlap Coefficient</li></ul></li></ul><h2 id="1-åŸºäºå‘é‡çš„ä½™å¼¦è¿‘ä¼¼åº¦åŒ¹é…"><a href="#1-åŸºäºå‘é‡çš„ä½™å¼¦è¿‘ä¼¼åº¦åŒ¹é…" class="headerlink" title="1. åŸºäºå‘é‡çš„ä½™å¼¦è¿‘ä¼¼åº¦åŒ¹é…"></a>1. åŸºäºå‘é‡çš„ä½™å¼¦è¿‘ä¼¼åº¦åŒ¹é…</h2><p>æ‰€è°“å‘é‡ï¼Œå°±æ˜¯æˆ‘ä»¬æ•°å­¦ä¸Šå­¦ä¹ è¿‡çš„é‚£ä¸ªå‘é‡ï¼ˆæ•°å­¦ç…§è¿›ç°å®ï¼‰ï¼Œæ˜¯ä¸€ä¸ªæœ‰æ–¹å‘çš„å­—æ®µã€‚<br>åœ¨å‘é‡è¿‘ä¼¼åŒ¹é…çš„é€»è¾‘é‡Œï¼Œå¦‚æœä¸¤ä¸ªå‘é‡é—´çš„å¤¹è§’è¶Šå°ï¼Œåˆ™ä¸¤ä¸ªå‘é‡è¶Šç›¸ä¼¼ï¼Œè¿™é‡Œç”¨åˆ°çš„ç®—æ³•å°±æ˜¯ä½™å¼¦ç›¸ä¼¼åº¦ç®—æ³•ã€‚</p><p><img src="/../../../images/tech/algorithm/cosine.png" alt="ä½™å¼¦å¤¹è§’ä¸å‘é‡"></p><p>ä½™å¼¦ç›¸ä¼¼åº¦å…¬å¼ï¼š</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>cosine</mtext><mo stretchy="false">(</mo><mover accent="true"><mi>a</mi><mo>âƒ—</mo></mover><mo separator="true">,</mo><mover accent="true"><mi>b</mi><mo>âƒ—</mo></mover><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mover accent="true"><mi>a</mi><mo>âƒ—</mo></mover><mo separator="true">â‹…</mo><mover accent="true"><mi>b</mi><mo>âƒ—</mo></mover></mrow><mrow><mi mathvariant="normal">âˆ¥</mi><mover accent="true"><mi>a</mi><mo>âƒ—</mo></mover><mi mathvariant="normal">âˆ¥</mi><mi mathvariant="normal">âˆ¥</mi><mover accent="true"><mi>b</mi><mo>âƒ—</mo></mover><mi mathvariant="normal">âˆ¥</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{cosine}(\vec{a}, \vec{b}) = \frac{\vec{a}Â·\vec{b}}{\|\vec{a}\|\|\vec{b}\|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2274em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">cosine</span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">a</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9774em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.7719em;vertical-align:-1.1174em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6544em;"><span style="top:-2.1326em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ¥</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">a</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mord">âˆ¥âˆ¥</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9774em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mord">âˆ¥</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">a</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9774em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.1174em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><p>å¯¹åº”åˆ°å­—ç¬¦ä¸²åŒ¹é…ä¸Šï¼Œç»“åˆTF-IDFç®—æ³•, ç»Ÿè®¡æ¯ä¸ªåœ°å€é‡Œåˆ†è¯å‡ºç°çš„é¢‘ç‡ï¼Œè¿™äº›é¢‘ç‡å°±ç»„æˆäº†è¿™ä¸ªè¿™ä¸ªåœ°å€çš„å‘é‡å€¼,ç„¶åå¥—ç”¨ä¸Šé¢çš„å…¬å¼ï¼Œå°±å¯ä»¥è®¡ç®—å‡ºä¸Šé¢çš„ä½™å¼¦ç›¸ä¼¼åº¦äº†ã€‚</p><p>ç„¶åï¼Œé—®é¢˜çš„å…³é”®å°±æ¥åˆ°äº†å¦‚ä½•æœ‰æ•ˆçš„å¯¹æ¯ä¸ªåœ°å€å­—ç¬¦ä¸²è¿›è¡Œåˆ†è¯æ‹†åˆ†äº†ï¼Œè¿™é‡Œæ¨èä¸€ä¸ªjavaé‡Œå¥½ç”¨çš„å·¥å…·<a href="https://github.com/hankcs/HanLP">HanLP</a>ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸“é—¨é¢å‘æ±‰è¯­åˆ†è¯çš„å·¥å…·åŒ…ï¼Œ1.0ç‰ˆæœ¬æä¾›äº†ä¸€å¥—javaçš„åˆ†è¯å™¨ï¼Œæ¯”è¾ƒå¥½ç”¨ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.hankcs<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hanlp<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>portable-1.8.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ç„¶åé€šè¿‡HanLPå¯¹å­—ç¬¦ä¸²è¿›è¡Œåˆ†è¯ï¼Œåˆ†è¯ç»“æœï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">addr1</span> = [æ²³åŒ—çœ, çŸ³å®¶åº„å¸‚, è£•ååŒº, ä¸‡è¾¾, å¹¿åœº]<br><span class="hljs-attr">addr2</span> = [æ²³åŒ—, çŸ³å®¶åº„å¸‚, è£•å, ä¸‡è¾¾, å¹¿åœº]<br><span class="hljs-attr">addr3</span> = [æ²³åŒ—, çŸ³å®¶åº„å¸‚, è£•å, ä¸‡è¾¾, å…¬é¦†]<br></code></pre></td></tr></table></figure><p>ç„¶åå°†æ¯”è¾ƒçš„ä¸¤ä¸ªçŸ­è¯­å–å¹¶é›†ï¼Œç»Ÿè®¡æ¯ä¸ªè¯å‡ºç°çš„é¢‘ç‡ï¼Œå°±å¯ä»¥å¾—åˆ°è¿™ä¸ªåœ°å€çš„å‘é‡å€¼äº†.</p><ul><li>addr1 vs addr2</li></ul><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">addr1 vs addr2 å¹¶é›† = <span class="hljs-selector-attr">[æ²³åŒ—çœ, çŸ³å®¶åº„å¸‚, è£•ååŒº, ä¸‡è¾¾, å¹¿åœº, æ²³åŒ—ï¼Œè£•å]</span><br><span class="hljs-comment">// å¹¶é›†ä¸­æ¯ä¸ªè¯å‡ºç°çš„é¢‘ç‡å°±æ˜¯å…¶åæ ‡ç‚¹ä½</span><br>addr1 = <span class="hljs-selector-attr">[1, 1, 1, 1, 1, 0, 0]</span><br>addr2 = <span class="hljs-selector-attr">[0, 1, 0, 1, 1, 1, 1]</span><br></code></pre></td></tr></table></figure><p>ä½™å¼¦å‘é‡è®¡ç®—ç»“æœï¼š</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mn>1</mn><mo separator="true">â‹…</mo><mn>0</mn><mo>+</mo><mn>1</mn><mo separator="true">â‹…</mo><mn>1</mn><mo>+</mo><mn>1</mn><mo separator="true">â‹…</mo><mn>0</mn><mo>+</mo><mn>1</mn><mo separator="true">â‹…</mo><mn>1</mn><mo>+</mo><mn>1</mn><mo separator="true">â‹…</mo><mn>1</mn><mo>+</mo><mn>0</mn><mo separator="true">â‹…</mo><mn>1</mn><mo>+</mo><mn>0</mn><mo separator="true">â‹…</mo><mn>1</mn></mrow><mrow><msqrt><mrow><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><msup><mn>0</mn><mn>2</mn></msup><mo>+</mo><msup><mn>0</mn><mn>2</mn></msup></mrow></msqrt><mo separator="true">â‹…</mo><msqrt><mrow><msup><mn>0</mn><mn>2</mn></msup><mo>+</mo><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><msup><mn>0</mn><mn>2</mn></msup><mo>+</mo><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><msup><mn>1</mn><mn>2</mn></msup></mrow></msqrt></mrow></mfrac><mo>=</mo><mn>0.6</mn></mrow><annotation encoding="application/x-tex">\frac{1Â·0+1Â·1+1Â·0+1Â·1+1Â·1+0Â·1+0Â·1}{\sqrt{1^2+1^2+1^2+1^2+1^2+0^2+0^2}Â·\sqrt{0^2+1^2+0^2+1^2+1^2+1^2+1^2}} = 0.6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.2514em;vertical-align:-0.93em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.1966em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9134em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-2.8734em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1266em;"><span></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9134em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-2.8734em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1266em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">0</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">0</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.6</span></span></span></span></span><ul><li>addr1 vs  addr3</li></ul><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">addr1 vs addr3 å¹¶é›† = <span class="hljs-selector-attr">[æ²³åŒ—çœ, çŸ³å®¶åº„å¸‚, è£•ååŒº, ä¸‡è¾¾, å¹¿åœº, æ²³åŒ—ï¼Œè£•å,å…¬é¦†]</span><br><span class="hljs-comment">// å¹¶é›†ä¸­æ¯ä¸ªè¯å‡ºç°çš„é¢‘ç‡å°±æ˜¯å…¶åæ ‡ç‚¹ä½</span><br>addr1 = <span class="hljs-selector-attr">[1, 1, 1, 1, 1, 0, 0, 0]</span><br>addr3 = <span class="hljs-selector-attr">[0, 1, 0, 1, 0, 1, 1, 1]</span><br></code></pre></td></tr></table></figure><p>ä½™å¼¦å‘é‡è®¡ç®—ç»“æœï¼š</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mn>1</mn><mo separator="true">â‹…</mo><mn>0</mn><mo>+</mo><mn>1</mn><mo separator="true">â‹…</mo><mn>1</mn><mo>+</mo><mn>1</mn><mo separator="true">â‹…</mo><mn>0</mn><mo>+</mo><mn>1</mn><mo separator="true">â‹…</mo><mn>1</mn><mo>+</mo><mn>1</mn><mo separator="true">â‹…</mo><mn>1</mn><mo>+</mo><mn>0</mn><mo separator="true">â‹…</mo><mn>1</mn><mo>+</mo><mn>0</mn><mo separator="true">â‹…</mo><mn>1</mn><mo>+</mo><mn>0</mn><mo separator="true">â‹…</mo><mn>1</mn></mrow><mrow><msqrt><mrow><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><msup><mn>0</mn><mn>2</mn></msup><mo>+</mo><msup><mn>0</mn><mn>2</mn></msup><mo>+</mo><msup><mn>0</mn><mn>2</mn></msup></mrow></msqrt><mo separator="true">â‹…</mo><msqrt><mrow><msup><mn>0</mn><mn>2</mn></msup><mo>+</mo><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><msup><mn>0</mn><mn>2</mn></msup><mo>+</mo><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><msup><mn>0</mn><mn>2</mn></msup><mo>+</mo><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><msup><mn>1</mn><mn>2</mn></msup><mo>+</mo><msup><mn>1</mn><mn>2</mn></msup></mrow></msqrt></mrow></mfrac><mo>=</mo><mn>0.4</mn></mrow><annotation encoding="application/x-tex">\frac{1Â·0+1Â·1+1Â·0+1Â·1+1Â·1+0Â·1+0Â·1+0Â·1}{\sqrt{1^2+1^2+1^2+1^2+1^2+0^2+0^2+0^2}Â·\sqrt{0^2+1^2+0^2+1^2+0^2+1^2+1^2+1^2}} = 0.4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.2514em;vertical-align:-0.93em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.1966em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9134em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-2.8734em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1266em;"><span></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9134em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-2.8734em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,-221l0 -0c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47zM834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1266em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">0</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">0</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">0</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.4</span></span></span></span></span><p>æ‰€ä»¥ï¼Œaddr1 å’Œ addr2 æ›´ç›¸ä¼¼ã€‚</p><h2 id="2-åŸºäºå­—ç¬¦ä¸²ç¼–è¾‘è·ç¦»çš„è¿‘ä¼¼åº¦åŒ¹é…"><a href="#2-åŸºäºå­—ç¬¦ä¸²ç¼–è¾‘è·ç¦»çš„è¿‘ä¼¼åº¦åŒ¹é…" class="headerlink" title="2. åŸºäºå­—ç¬¦ä¸²ç¼–è¾‘è·ç¦»çš„è¿‘ä¼¼åº¦åŒ¹é…"></a>2. åŸºäºå­—ç¬¦ä¸²ç¼–è¾‘è·ç¦»çš„è¿‘ä¼¼åº¦åŒ¹é…</h2><p>æ‰€è°“ç¼–è¾‘è·ç¦»ï¼Œå°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ é™¤ä¸€ä¸ªå­—ç¬¦ï¼Œæˆ–è€…å¢åŠ ä¸€ä¸ªå­—ç¬¦ï¼Œæˆ–è€…æ›¿æ¢ä¸€ä¸ªå­—ç¬¦ï¼Œå¯ä»¥å¾—åˆ°å¦å¤–ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆï¼Œå˜åŠ¨å‡ æ¬¡å°±æ˜¯è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²çš„ç¼–è¾‘è·ç¦»ã€‚</p><p>è¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œæˆ‘ä»¬å¯ä»¥æ‹¿ä¸Šé¢çš„ä¸‰ä¸ªåœ°å€ä¸¾ä¾‹ã€‚</p><p>addr2 å¯ä»¥é€šè¿‡å¢åŠ â€œçœâ€ï¼Œâ€œåŒºâ€ä¸¤ä¸ªå­—å¾—åˆ° addr1, æ‰€ä»¥addr1 å’Œ addr2 çš„ç¼–è¾‘è·ç¦»ä¸º2 ã€‚ </p><p>addr3 å¯ä»¥é€šè¿‡æ›¿æ¢â€œå…¬é¦†â€ä¸ºâ€œå¹¿åœºâ€ä¸¤ä¸ªå­—å¾—åˆ° addr2, è€Œaddr2 å’Œaddr1 çš„ç¼–è¾‘è·ç¦»ä¸º2ï¼Œ æ‰€ä»¥addr1 å’Œ addr3 çš„ç¼–è¾‘è·ç¦»ä¸º4 ã€‚</p><p>è¿™ä¸ªç®—æ³•ï¼Œä»…å…³æ³¨ä¸¤ä¸ªå­—ç¬¦çš„å˜åŒ–å·®å¼‚ï¼Œå—åˆ°ä¸€äº›è¾…åŠ©æ€§è¯æ±‡çš„å¹²æ‰°æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥ï¼Œè¿™ä¸ªç®—æ³•å¹¶ä¸é€‚åˆäºæ¯”è¾ƒä¸¤ä¸ªåœ°å€æ˜¯å¦ä¸€æ ·çš„é€»è¾‘ã€‚</p><h2 id="3-åŸºäºå­—ç¬¦ä¸²å±€éƒ¨åŒ¹é…çš„è¿‘ä¼¼åº¦åŒ¹é…"><a href="#3-åŸºäºå­—ç¬¦ä¸²å±€éƒ¨åŒ¹é…çš„è¿‘ä¼¼åº¦åŒ¹é…" class="headerlink" title="3. åŸºäºå­—ç¬¦ä¸²å±€éƒ¨åŒ¹é…çš„è¿‘ä¼¼åº¦åŒ¹é…"></a>3. åŸºäºå­—ç¬¦ä¸²å±€éƒ¨åŒ¹é…çš„è¿‘ä¼¼åº¦åŒ¹é…</h2><p>å…³äºå­—ç¬¦ä¸²çš„å±€éƒ¨åŒ¹é…çš„ç®—æ³•å°±å¾ˆå¤šäº†ï¼Œæˆ‘ä»¬å°±ä»¥ä¸Šé¢è¯´çš„é‚£å‡ ä¸ªç®—æ³•ä¸¾ä¾‹ï¼š</p><ul><li>smithWaterman ï¼šå±€éƒ¨åºåˆ—æ¯”å¯¹ï¼šå¯¹æ¯”ä¸¤ä¸ªå­—ç¬¦ä¸²ä¸­çš„å­åºåˆ—éƒ¨åˆ†ï¼Œé€šè¿‡ä¸€å¥—æ‰“åˆ†ç³»ç»Ÿï¼Œæ¥å¯»æ‰¾ä¸¤ä¸ªå­—ç¬¦ä¸­æ¯ä¸€ä¸ªç›¸ä¼¼ç‰‡æ®µï¼Œæœ€åè¿”å›æœ€å¤§çš„åŒ¹é…å¾—åˆ†ã€‚</li><li>needlemanWunchï¼šå…¨å±€åºåˆ—æ¯”å¯¹ï¼šé€šè¿‡å¡«å……æ›¿æ¢ç­‰æ–¹å¼ï¼Œå¯¹ä¸¤ä¸ªå­—ç¬¦ä¸²è¿›è¡Œæ”¹é€ ï¼Œé…åˆä¸€å¥—æ‰“åˆ†ç³»ç»Ÿï¼Œå¯¹æ¯ä¸€ç§å…¨å­—ç¬¦ä¸²æ”¹é€ æˆåŠŸåçš„æ–¹æ¡ˆè¿›è¡Œæ‰“åˆ†ï¼Œæœ€åè¿”å›æœ€å¤§çš„åŒ¹é…å¾—åˆ†ã€‚</li><li>jaroWinklerï¼šjaroç®—æ³•æ”¹è¿›ç‰ˆï¼Œå¼•å…¥äº†å‰ç¼€å› å­ï¼Œç›¸åŒå‰ç¼€çš„æ•°æ®ï¼ŒåŒ¹é…å¾—åˆ†ä¼šæ›´é«˜</li></ul><p>å› ä¸ºåœ°å€çš„ç‰¹æ®Šæ€§ï¼ŒjaroWinklerç®—æ³•ä¼šæ›´é€‚ç”¨ä¸€äº›ã€‚</p><h2 id="4-åŸºäºé›†åˆçš„è¿‘ä¼¼åº¦åŒ¹é…"><a href="#4-åŸºäºé›†åˆçš„è¿‘ä¼¼åº¦åŒ¹é…" class="headerlink" title="4. åŸºäºé›†åˆçš„è¿‘ä¼¼åº¦åŒ¹é…"></a>4. åŸºäºé›†åˆçš„è¿‘ä¼¼åº¦åŒ¹é…</h2><p>å°†å­—ç¬¦ä¸²æ‹†è§£æˆåˆ†è¯ï¼Œç„¶åå°†æ¯ä¸€ç»„åˆ†è¯çœ‹å‡ºä¸€ä¸ªé›†åˆï¼Œé€šè¿‡é›†åˆé—´çš„äº¤é›†ã€å¹¶é›†ç­‰æ–¹å¼ï¼Œæ˜¯å®ç°å­—ç¬¦ä¸²ç›¸ä¼¼åº¦åŒ¹é…çš„å¦ä¸€ç§å®ç°é€»è¾‘ã€‚</p><h3 id="4-1-jaccard"><a href="#4-1-jaccard" class="headerlink" title="4.1 jaccard"></a>4.1 jaccard</h3><p>jaccardç®—æ³•ï¼Œä¹Ÿå«æ°å¡å¾·ç®—æ³•ï¼Œ æ˜¯ä¸€ç§æ¯”è¾ƒæœ‰é™æ ·æœ¬é›†çš„ç›¸ä¼¼æ€§ä¸å·®å¼‚æ€§çš„ç®—æ³•ï¼Œå€¼è¶Šå¤§ï¼Œç›¸ä¼¼åº¦è¶Šé«˜ã€‚</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>jaccard</mtext><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>a</mi><mo>âˆ©</mo><mi>b</mi></mrow><mrow><mi>a</mi><mo>âˆª</mo><mi>b</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{jaccard}(a, b) = \frac{a \cap b}{a \cup b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">jaccard</span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0574em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆª</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">b</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ©</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">b</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><p>åŒæ ·ä»¥ä¸Šé¢çš„åœ°å€ä¸¾ä¾‹ï¼š<br>addr1 å’Œ addr2 äº¤é›† &#x3D; [çŸ³å®¶åº„å¸‚, ä¸‡è¾¾, å¹¿åœº]<br>addr1 å’Œ addr2 å¹¶é›† &#x3D; [æ²³åŒ—çœ, çŸ³å®¶åº„å¸‚, è£•ååŒº, ä¸‡è¾¾, å¹¿åœº, æ²³åŒ—ï¼Œè£•å]</p><p>æ‰€ä»¥ï¼š</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>jaccard</mtext><mo stretchy="false">(</mo><mi>a</mi><mi>d</mi><mi>d</mi><mi>r</mi><mn>1</mn><mo separator="true">,</mo><mi>a</mi><mi>d</mi><mi>d</mi><mi>r</mi><mn>2</mn><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>3</mn><mn>7</mn></mfrac><mo>=</mo><mn>0.42857</mn></mrow><annotation encoding="application/x-tex">\text{jaccard}(addr1, addr2) = \frac{3}{7} = 0.42857</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">jaccard</span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">7</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.42857</span></span></span></span></span><p>addr1 å’Œ addr3 äº¤é›† &#x3D; [çŸ³å®¶åº„å¸‚, ä¸‡è¾¾]<br>addr1 å’Œ addr3 å¹¶é›† &#x3D; [æ²³åŒ—çœ, çŸ³å®¶åº„å¸‚, è£•ååŒº, ä¸‡è¾¾, å¹¿åœº, æ²³åŒ—ï¼Œè£•å,å…¬é¦†]</p><p>æ‰€ä»¥ï¼š</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>jaccard</mtext><mo stretchy="false">(</mo><mi>a</mi><mi>d</mi><mi>d</mi><mi>r</mi><mn>1</mn><mo separator="true">,</mo><mi>a</mi><mi>d</mi><mi>d</mi><mi>r</mi><mn>3</mn><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>2</mn><mn>8</mn></mfrac><mo>=</mo><mn>0.25</mn></mrow><annotation encoding="application/x-tex">\text{jaccard}(addr1, addr3) = \frac{2}{8} = 0.25</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">jaccard</span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.25</span></span></span></span></span><h3 id="4-2-dice"><a href="#4-2-dice" class="headerlink" title="4.2 dice"></a>4.2 dice</h3><p>diceç®—æ³•ï¼Œjaccardç®—æ³•çš„ä¸€ä¸ªæ”¹è¿›ç‰ˆæœ¬ï¼Œå¢åŠ äº†ç›¸ä¼¼é›†åˆçš„æƒé‡ã€‚</p><p>dice çš„ç®—æ³•å…¬å¼ï¼š</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>dice</mtext><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mn>2</mn><mi mathvariant="normal">âˆ£</mi><mi>a</mi><mo>âˆ©</mo><mi>b</mi><mi mathvariant="normal">âˆ£</mi></mrow><mrow><mi mathvariant="normal">âˆ£</mi><mi>a</mi><mi mathvariant="normal">âˆ£</mi><mo>+</mo><mi mathvariant="normal">âˆ£</mi><mi>b</mi><mi mathvariant="normal">âˆ£</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{dice}(a, b) = \frac{2|a \cap b |}{|a| + |b|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">dice</span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ£</span><span class="mord mathnormal">a</span><span class="mord">âˆ£</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">âˆ£</span><span class="mord mathnormal">b</span><span class="mord">âˆ£</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2âˆ£</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ©</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">b</span><span class="mord">âˆ£</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">âˆ£</mi><mi>a</mi><mi mathvariant="normal">âˆ£</mi></mrow><annotation encoding="application/x-tex">|a|  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">âˆ£</span><span class="mord mathnormal">a</span><span class="mord">âˆ£</span></span></span></span> è¡¨ç¤ºé›†åˆaçš„å…ƒç´ ä¸ªæ•°ã€‚</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">âˆ£</mi><mi>b</mi><mi mathvariant="normal">âˆ£</mi></mrow><annotation encoding="application/x-tex">|b|  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">âˆ£</span><span class="mord mathnormal">b</span><span class="mord">âˆ£</span></span></span></span> è¡¨ç¤ºé›†åˆbçš„å…ƒç´ ä¸ªæ•°ã€‚</li></ul><p>åŒæ ·ä»¥ä¸Šé¢çš„åœ°å€ä¸¾ä¾‹ï¼š</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>dice</mtext><mo stretchy="false">(</mo><mi>a</mi><mi>d</mi><mi>d</mi><mi>r</mi><mn>1</mn><mo separator="true">,</mo><mi>a</mi><mi>d</mi><mi>d</mi><mi>r</mi><mn>2</mn><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mn>2</mn><mo separator="true">â‹…</mo><mn>3</mn></mrow><mrow><mn>5</mn><mo>+</mo><mn>5</mn></mrow></mfrac><mo>=</mo><mn>0.6</mn></mrow><annotation encoding="application/x-tex">\text{dice}(addr1, addr2) = \frac{2Â·3}{5 + 5} = 0.6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">dice</span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">5</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">5</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.6</span></span></span></span></span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>dice</mtext><mo stretchy="false">(</mo><mi>a</mi><mi>d</mi><mi>d</mi><mi>r</mi><mn>1</mn><mo separator="true">,</mo><mi>a</mi><mi>d</mi><mi>d</mi><mi>r</mi><mn>3</mn><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mn>2</mn><mo separator="true">â‹…</mo><mn>2</mn></mrow><mrow><mn>5</mn><mo>+</mo><mn>5</mn></mrow></mfrac><mo>=</mo><mn>0.4</mn></mrow><annotation encoding="application/x-tex">\text{dice}(addr1, addr3) = \frac{2Â·2}{5+5} = 0.4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">dice</span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">5</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">5</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.4</span></span></span></span></span><h3 id="4-3-Overlap-Coefficient"><a href="#4-3-Overlap-Coefficient" class="headerlink" title="4.3 Overlap Coefficient"></a>4.3 Overlap Coefficient</h3><p>Overlap Coefficientï¼ˆé‡å ç³»æ•°ï¼‰æ˜¯ä¸€ç§ç”¨äºè¡¡é‡ä¸¤ä¸ªé›†åˆç›¸ä¼¼åº¦çš„ç®—æ³•ï¼Œå…¶æ ¸å¿ƒåŸç†æ˜¯è®¡ç®—ä¸¤ä¸ªé›†åˆçš„äº¤é›†å¤§å°ä¸è¾ƒå°é›†åˆå¤§å°çš„æ¯”å€¼ã€‚</p><p>Overlap Coefficientçš„è®¡ç®—å…¬å¼ï¼š</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Overlap</mtext><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>a</mi><mo>âˆ©</mo><mi>b</mi></mrow><mrow><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi mathvariant="normal">âˆ£</mi><mi>a</mi><mi mathvariant="normal">âˆ£</mi><mo separator="true">,</mo><mi mathvariant="normal">âˆ£</mi><mi>b</mi><mi mathvariant="normal">âˆ£</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{Overlap}(a, b) = \frac{a \cap b}{min(|a|, |b|)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Overlap</span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3074em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">min</span><span class="mopen">(</span><span class="mord">âˆ£</span><span class="mord mathnormal">a</span><span class="mord">âˆ£</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">âˆ£</span><span class="mord mathnormal">b</span><span class="mord">âˆ£</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ©</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">b</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><p>ä¾æ®è¿™ä¸ªå…¬å¼ï¼Œä¸Šé¢åœ°å€çš„è®¡ç®—ç»“æœä¸ºï¼š</p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Overlap</mtext><mo stretchy="false">(</mo><mi>a</mi><mi>d</mi><mi>d</mi><mi>r</mi><mn>1</mn><mo separator="true">,</mo><mi>a</mi><mi>d</mi><mi>d</mi><mi>r</mi><mn>2</mn><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>3</mn><mn>5</mn></mfrac><mo>=</mo><mn>0.6</mn></mrow><annotation encoding="application/x-tex">\text{Overlap}(addr1, addr2) = \frac{3}{5} = 0.6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Overlap</span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">5</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.6</span></span></span></span></span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Overlap</mtext><mo stretchy="false">(</mo><mi>a</mi><mi>d</mi><mi>d</mi><mi>r</mi><mn>1</mn><mo separator="true">,</mo><mi>a</mi><mi>d</mi><mi>d</mi><mi>r</mi><mn>3</mn><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>2</mn><mn>5</mn></mfrac><mo>=</mo><mn>0.4</mn></mrow><annotation encoding="application/x-tex">\text{Overlap}(addr1, addr3) = \frac{2}{5} = 0.4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Overlap</span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">5</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.4</span></span></span></span></span><h2 id="5-åº”ç”¨å®è·µ"><a href="#5-åº”ç”¨å®è·µ" class="headerlink" title="5. åº”ç”¨å®è·µ"></a>5. åº”ç”¨å®è·µ</h2><p>ä»¥ä¸Šï¼Œè¿™äº›å­—ç¬¦ä¸²çš„ç›¸ä¼¼åº¦ç®—æ³•çš„åŸç†æˆ‘ä»¬éƒ½äº†è§£äº†ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥æ ¹æ®ä¸šåŠ¡åœºæ™¯å’Œç®—æ³•ç‰¹ç‚¹ï¼Œé€‰æ‹©åˆé€‚çš„ç®—æ³•åº”ç”¨ï¼Œç”šè‡³å¯ä»¥ç»„åˆçš„ä½¿ç”¨ã€‚</p><p>æˆ‘è¿™è¾¹æ˜¯è¦åšäº†ä¸€ä¸ªåœ°å€æ¯”è¾ƒçš„é¡¹ç›®ï¼Œå› ä¸ºåœ°å€çš„ç‰¹ç‚¹ï¼Œæˆ‘é€‰æ‹©äº†å‰ç¼€åŒ¹é…çš„jaroWinklerç®—æ³•ï¼Œç»„åˆcosineä½™å¼¦ç®—æ³•æ¥å®ç°ï¼Œåªæœ‰ä¸¤ä¸ªç®—æ³•éƒ½æˆåŠŸçš„æ—¶å€™ï¼Œæ‰è®¤ä¸ºä¸¤ä¸ªåœ°å€æ˜¯ç›¸ä¼¼çš„ã€‚</p><p>å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>é¢„å¤„ç†ï¼šå°†ä¸¤ä¸ªåœ°å€å¯¹é½ï¼Œç»Ÿä¸€æŒ‰ç…§çœå¸‚å¿é•‡çš„æ ¼å¼è¡¥å…¨åœ°å€ï¼Œä¸ç„¶å•ç»™ä¸€ä¸ªä¸‡è¾¾å¹¿åœºï¼Œæ ¹æœ¬æ— æ³•åŒ¹é…å‡†ç¡®åœ°å€ã€‚</li><li>åœ°å€è§„èŒƒåŒ–è¡¥å…¨åï¼Œä½¿ç”¨hanLPåˆ†è¯ï¼Œå¯¹åœ°å€è¿›è¡Œåˆ†è¯ï¼Œå¾—åˆ°ä¸€ä¸ªè¯è¡¨ã€‚</li><li>ä½¿ç”¨jaroWinklerç›¸ä¼¼åº¦ç®—æ³•åŒ¹é…åœ°å€</li><li>ä½¿ç”¨cosineç®—æ³•åŒ¹é…åœ°å€</li><li>ä¸¤ä¸ªç®—æ³•çš„æˆåŠŸç‡éƒ½è¾¾åˆ°é˜ˆå€¼ï¼Œæ‰è®¤ä¸ºä¸¤ä¸ªåœ°å€æ˜¯ç›¸ä¼¼çš„ã€‚</li><li>æœ€åå†æ ¹æ®åœ°å€çš„ç‰¹ç‚¹ï¼Œå‰é¢çš„è¯éƒ½æ˜¯è¾…åŠ©æ€§å®šè¯­ï¼Œåªæœ‰æœ€åçš„è¯æ‰æ˜¯å…³é”®è¯ï¼Œæ‰€ä»¥æˆ‘æœ€ååˆå¢åŠ äº†ä¸€æ¬¡ä¼˜åŒ–ï¼šå¯¹æ¯”ä¸¤ä¸ªåœ°å€çš„å°¾ä¸²ï¼Œå¦‚æœå®Œå…¨ç›¸åŒçš„éƒ¨åˆ†å¤§äºæŸä¸ªé˜ˆå€¼ï¼Œåˆ™è®¤ä¸ºä¸¤ä¸ªåœ°å€æ˜¯ç›¸ä¼¼çš„ã€‚</li></ol><h2 id="6-è¿™äº›ç®—æ³•çš„ä»£ç demo"><a href="#6-è¿™äº›ç®—æ³•çš„ä»£ç demo" class="headerlink" title="6. è¿™äº›ç®—æ³•çš„ä»£ç demo"></a>6. è¿™äº›ç®—æ³•çš„ä»£ç demo</h2><p>ä»¥ä¸‹æ˜¯è¿™äº›ç®—æ³•çš„ä»£ç demoï¼Œå¤§å®¶å¯ä»¥å‚è€ƒä¸€ä¸‹ï¼š</p><ul><li>pom.xml</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.github.mpkorstanje<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>simmetrics-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.1.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.hankcs<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hanlp<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>portable-1.8.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>hanLP: å‰é¢å·²ç»ä»‹ç»è¿‡äº†ï¼Œæ˜¯ä¸€ä¸ªå¾ˆå¥½ç”¨çš„ä¸­æ–‡åˆ†è¯å·¥å…·ç±»ã€‚</p><p>simmetricsï¼š ä¸€ä¸ªå¼€æºçš„å­—ç¬¦ä¸²ç›¸ä¼¼åº¦ç®—æ³•åº“ï¼Œé›†æˆäº†å¾ˆå¤šå¸¸ç”¨çš„ç®—æ³•ï¼Œå¯ä»¥æ‹¿æ¥ç›´æ¥ä½¿ç”¨ã€‚</p><ul><li>code</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">addr1</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;æ²³åŒ—çœçŸ³å®¶åº„å¸‚è£•ååŒºä¸‡è¾¾å¹¿åœº&quot;</span>;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">addr2</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;æ²³åŒ—çŸ³å®¶åº„å¸‚è£•åä¸‡è¾¾å¹¿åœº&quot;</span>;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">addr3</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;æ²³åŒ—çŸ³å®¶åº„å¸‚è£•åä¸‡è¾¾å…¬é¦†&quot;</span>;<br><br><br>        List&lt;String&gt; addr1List = hanlpSeg(addr1);<br>        List&lt;String&gt; addr2List = hanlpSeg(addr2);<br>        List&lt;String&gt; addr3List = hanlpSeg(addr3);<br><br>        <span class="hljs-comment">//</span><br>        System.out.println(<span class="hljs-string">&quot;---cosineï¼š  aÂ·b / (||a|| * ||b||)---&quot;</span>);<br>        CosineSimilarity&lt;String&gt; cosineClient = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CosineSimilarity</span>&lt;String&gt;();<br>        <span class="hljs-type">float</span> <span class="hljs-variable">score</span> <span class="hljs-operator">=</span> cosineClient.compare(HashMultiset.create(addr1List),<br>                HashMultiset.create(addr2List));<br>        System.out.println(score);<br>        score = cosineClient.compare(HashMultiset.create(addr1List),<br>                HashMultiset.create(addr3List));<br>        System.out.println(score);<br><br><br>        System.out.println(<span class="hljs-string">&quot;---jaccardï¼šâˆ£a âˆ© bâˆ£ / âˆ£a âˆª bâˆ£--- &quot;</span>);<br>        <span class="hljs-type">Jaccard</span> <span class="hljs-variable">jaccard</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jaccard</span>&lt;String&gt;();<br>        System.out.println(jaccard.compare(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;(addr1List),<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;(addr2List)));<br>        System.out.println(jaccard.compare(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;(addr1List),<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;(addr3List)));<br><br>        System.out.println(<span class="hljs-string">&quot;---diceï¼š2å€äº¤é›†å¤§å°é™¤ä»¥ä¸¤é›†åˆå¤§å°ä¹‹å’Œ ç±»ä¼¼Jaccardä½†å¯¹å…±æœ‰è¯æ›´æ•æ„Ÿ --- &quot;</span>);<br>        Dice&lt;String&gt; dice = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dice</span>&lt;String&gt;();<br>        System.out.println(dice.compare(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;(addr1List),<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;(addr2List)));<br>        System.out.println(dice.compare(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;(addr1List),<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;(addr3List)));<br><br>        System.out.println(<span class="hljs-string">&quot;---overlapCoefficientï¼šäº¤é›†å¤§å°é™¤ä»¥è¾ƒçŸ­é›†åˆçš„å¤§å°--- &quot;</span>);<br>        OverlapCoefficient&lt;String&gt; overlapCoefficient = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OverlapCoefficient</span>&lt;String&gt;();<br>        System.out.println(overlapCoefficient.compare(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;(addr1List),<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;(addr2List)));<br>        System.out.println(overlapCoefficient.compare(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;(addr1List),<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;(addr3List)));<br>        <br><br>        System.out.println(<span class="hljs-string">&quot;---smithWatermanï¼šå±€éƒ¨åºåˆ—å¯¹é½ åŠ¨æ€è§„åˆ’+å¾—åˆ†çŸ©é˜µ--- &quot;</span>);<br>        <span class="hljs-type">StringMetric</span> <span class="hljs-variable">smithWaterman</span> <span class="hljs-operator">=</span> StringMetrics.smithWaterman();<br>        System.out.println(smithWaterman.compare(addr1,addr2));<br>        System.out.println(smithWaterman.compare(addr1,addr3));<br><br>        System.out.println(<span class="hljs-string">&quot;---needlemanWunchï¼šå…¨å±€åºåˆ—å¯¹é½ï¼ŒåŠ¨æ€è§„åˆ’+å›ºå®šç©ºä½ç½šåˆ†--- &quot;</span>);<br>        <span class="hljs-type">StringMetric</span> <span class="hljs-variable">needlemanWunch</span> <span class="hljs-operator">=</span> StringMetrics.needlemanWunch();<br>        System.out.println(needlemanWunch.compare(addr1,addr2));<br>        System.out.println(needlemanWunch.compare(addr1,addr3));<br><br>        System.out.println(<span class="hljs-string">&quot;---jaroWinklerï¼šå…³æ³¨å‰ç¼€åŒ¹é…--- &quot;</span>);<br>        <span class="hljs-type">StringMetric</span> <span class="hljs-variable">jaroWinkler</span> <span class="hljs-operator">=</span> StringMetrics.jaroWinkler();<br>        System.out.println(jaroWinkler.compare(addr1,addr2));<br>        System.out.println(jaroWinkler.compare(addr1,addr3));<br><br>        System.out.println(<span class="hljs-string">&quot;---levenshteinï¼šç¼–è¾‘è·ç¦»--- &quot;</span>);<br>        <span class="hljs-type">Levenshtein</span> <span class="hljs-variable">levenshtein</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Levenshtein</span>();<br>        System.out.println(levenshtein.compare(addr1,addr2)+<span class="hljs-string">&quot;:è·ç¦»=&quot;</span>+levenshtein.distance(addr1,addr2));<br>        System.out.println(levenshtein.compare(addr1,addr3)+<span class="hljs-string">&quot;:è·ç¦»=&quot;</span>+levenshtein.distance(addr1,addr3));<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> List&lt;String&gt; <span class="hljs-title function_">hanlpSeg</span><span class="hljs-params">(String str)</span> &#123;<br>        <span class="hljs-type">Segment</span> <span class="hljs-variable">segment</span> <span class="hljs-operator">=</span> HanLP.newSegment().enablePlaceRecognize(<span class="hljs-literal">true</span>);<br>        <span class="hljs-comment">// å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼ï¼Œè‡ªå·±æŒ‡å®šåˆ†è¯</span><br><span class="hljs-comment">//      CustomDictionary.add(&quot;ä¸‡è¾¾å¹¿åœº&quot;,&quot;ns 1000&quot;);</span><br>      <br>      List&lt;String&gt; list = segment.seg(str).stream().map(term -&gt; term.word).toList();<br>        System.out.println(list);<br>        <span class="hljs-keyword">return</span> list;<br><br>    &#125;<br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://hanlp.hankcs.com/install.html#_1-x%E7%89%88">hanLp 1.xæ–‡æ¡£</a></p><p><a href="https://github.com/Simmetrics/simmetrics">simmetrics github</a></p>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç®—æ³•</tag>
      
      <tag>ç›¸ä¼¼åº¦ç®—æ³•</tag>
      
      <tag>ä½™å¼¦ç›¸ä¼¼åº¦</tag>
      
      <tag>å‘é‡</tag>
      
      <tag>jaroWinkler</tag>
      
      <tag>blockDistance</tag>
      
      <tag>jaccard</tag>
      
      <tag>simmetrics</tag>
      
      <tag>hanlp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>spring AI åŠŸèƒ½åˆä½“éªŒ</title>
    <link href="/2025/03/24/spring-springboot-ai-demo/"/>
    <url>/2025/03/24/spring-springboot-ai-demo/</url>
    
    <content type="html"><![CDATA[<p>ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•åœ¨æœ¬åœ°éƒ¨ç½²deepseek,è¿™ä¸€ç¯‡æˆ‘ä»¬ç»§ç»­å­¦ä»¥è‡´ç”¨ï¼Œæ¢ç´¢ä¸€ä¸‹å¦‚ä½•é€šè¿‡springAI æ¡†æ¶å¿«é€Ÿç»§æ‰¿æˆ‘ä»¬çš„deepseekæœåŠ¡ï¼Œå®ç°å¯¹å¤–æœåŠ¡çš„åŠŸèƒ½ã€‚</p><h2 id="1-åˆ›å»ºä¸€ä¸ªspringboot-aié¡¹ç›®"><a href="#1-åˆ›å»ºä¸€ä¸ªspringboot-aié¡¹ç›®" class="headerlink" title="1. åˆ›å»ºä¸€ä¸ªspringboot aié¡¹ç›®"></a>1. åˆ›å»ºä¸€ä¸ªspringboot aié¡¹ç›®</h2><p>springbootæä¾›äº†ä¸€ä¸ªaiæ¡†æ¶ï¼Œå¯ä»¥å¿«é€Ÿåˆ›å»ºä¸€ä¸ªaié¡¹ç›®ï¼Œå¹¶å¯ä»¥é€šè¿‡é…ç½®çš„æ–¹å¼ï¼Œå¿«é€Ÿé›†æˆï¼š</p><ul><li><code>openai</code></li><li><code>æ™ºè°±ai</code></li><li><code>åƒå¸†ai</code></li><li><code>google vertexAI</code></li><li><code>Azure openAI</code></li><li><code>deepseek</code></li><li>æœˆä¹‹æš—é¢<code>kimi</code></li><li><code>è‹±ä¼Ÿè¾¾chat</code></li><li>IBMçš„<code>watsonX ai</code></li><li><code>ollma</code>å¤§æ¨¡å‹</li><li>å„ç§å¸¸è§çš„å‘é‡æ•°æ®åº“</li></ul><p>å¯ä»¥çœ‹åˆ°ï¼Œdeepseekå¾ˆå¿«å°±é›†æˆè¿›å»äº†ï¼Œæ­£å¥½æ»¡è¶³æˆ‘ä»¬çš„è¯‰æ±‚ã€‚</p><h3 id="æ„å»ºé¡¹ç›®"><a href="#æ„å»ºé¡¹ç›®" class="headerlink" title="æ„å»ºé¡¹ç›®"></a>æ„å»ºé¡¹ç›®</h3><p>æ‰“å¼€springbootçš„<a href="https://start.spring.io/">å¿«é€Ÿæ„å»ºé¡µé¢</a>,æ·»åŠ <code>Open AI</code> å’Œ <code>Spring Reactive Web</code>ä¸¤ä¸ªä¾èµ–ï¼Œç„¶åå¼€å§‹ã€‚<br><img src="/../../images/tech/spring/spring-ai-project.png" alt="spring AIé¡¹ç›®"></p><ul><li><code>Open AI</code> æ˜¯ä¸€ä¸ªchatæ¡†æ¶ï¼Œé™¤äº†æ¥å…¥openaiå¤–ï¼Œè¿˜å¯ä»¥æ¥å…¥æˆ‘ä»¬çš„deepseek r1æ¨¡å‹ã€‚</li><li><code>Spring Reactive Web</code> æ˜¯äº¤äº’å¼webæ¡†æ¶ï¼Œdeepseekçš„æµå¼äº¤äº’éœ€è¦ç”¨çš„æ­¤æ¡†æ¶ï¼Œè€Œæˆ‘ä»¬éƒ¨ç½²çš„<code>deepseek r1 1.5b</code>æ¨¡å‹ä¼¼ä¹åªæ”¯æŒæµå¼äº¤äº’ï¼Œæ‰€ä»¥éœ€è¦ç”¨åˆ°æ­¤æ¡†æ¶ã€‚<ul><li>ç¥å¥‡çš„æ—¶ï¼Œå¦‚æœæˆ‘è¿deepseekå®˜æ–¹çš„æ»¡è¡€r1æ¨¡å‹ï¼ŒåŠæ—¶ä¸æ˜¯æµå¼äº¤äº’ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œè¿™é‡Œå°šæœªæ‰¾åˆ°åŸå› ï¼Œæœ‰çŸ¥é“çš„æœ‹å‹å¯ä»¥è§£ç­”ä¸€ä¸‹ã€‚</li></ul></li></ul><p>è¿™å°±æ˜¯æˆ‘ä»¬åˆ›å»ºå¥½çš„springboot AIé¡¹ç›®çš„pomé…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-openai-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-comment">&lt;!--&lt;dependency&gt;--&gt;</span><br><span class="hljs-comment">&lt;!--&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;--&gt;</span><br><span class="hljs-comment">&lt;!--&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;--&gt;</span><br><span class="hljs-comment">&lt;!--&lt;/dependency&gt;--&gt;</span><br><br><span class="hljs-comment">&lt;!--r1 å¿…é¡»æ˜¯æµæ¨¡å¼--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-webflux<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-devtools<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>runtime<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">optional</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">optional</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">optional</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">optional</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="apiæ¥å£"><a href="#apiæ¥å£" class="headerlink" title="apiæ¥å£"></a>apiæ¥å£</h3><p>chat controller æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@RequestMapping(&quot;/ai/chat&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatController</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> OpenAiChatModel chatModel;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ChatController</span><span class="hljs-params">(OpenAiChatModel chatModel)</span> &#123;<br>        <span class="hljs-built_in">this</span>.chatModel = chatModel;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é˜»å¡å¼æ¥å£ï¼Œå¯ä»¥ä½¿ç”¨æ™®é€šçš„webæ¡†æ¶ï¼Œä¼šç­‰deepseekå›ç­”å®Œæˆåä¸€æ¬¡æ€§è¿”å›</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> message é—®é¢˜</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@GetMapping(&quot;/generate&quot;)</span><br>    <span class="hljs-keyword">public</span> Map <span class="hljs-title function_">generate</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = &quot;message&quot;, defaultValue = &quot;Tell me a joke&quot;)</span> String message)</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">uuid</span> <span class="hljs-operator">=</span> UUID.randomUUID().toString();<br>        System.out.printf(<span class="hljs-string">&quot;uid=%s, message: %s%n&quot;</span>, uuid, message);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.chatModel.call(message);<br>        System.out.printf(<span class="hljs-string">&quot;uid=%s, message: %s%n&quot;</span>, uuid, res);<br>        <span class="hljs-keyword">return</span> Map.of(<span class="hljs-string">&quot;generation&quot;</span>, res);<br>    &#125;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æµå¼äº¤äº’æ¥å£ï¼Œä¼šä¸€ä¸ªå­—ä¸€ä¸ªå­—çš„è¿”å›æ•°æ®ï¼Œéœ€è¦ä½¿ç”¨å“åº”å¼webæ¡†æ¶</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> message é—®é¢˜</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@GetMapping(&quot;/generateStream&quot;)</span><br>    <span class="hljs-keyword">public</span> Flux&lt;ChatResponse&gt; <span class="hljs-title function_">generateStream</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = &quot;message&quot;, defaultValue = &quot;Tell me a joke&quot;)</span> String message)</span> &#123;<br>        <span class="hljs-type">Prompt</span> <span class="hljs-variable">prompt</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Prompt</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">UserMessage</span>(message));<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.chatModel.stream(prompt);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><ul><li>generateï¼š é˜»å¡å¼æ¥å£ï¼Œå¦‚æœæˆ‘ä»¬ä»‹å…¥çš„deepseekV3æ¨¡å‹ï¼ŒR1æ»¡è¡€æ¨¡å‹ï¼Œå¯ä»¥ç”¨è¿™ä¸ªæ¥å£è¯·æ±‚ï¼Œä¼šä¸€æ¬¡æ€§æŠŠå›ç­”å…¨éƒ¨è¿”å›ã€‚éœ€è¦æ·»åŠ ä¾èµ–<code>spring-boot-starter-web</code></li><li>generateStreamï¼šæµå¼æ¥å£ï¼Œå¦‚æœdeepseekV3æ¨¡å‹ï¼ŒR1æ¨¡å‹ï¼Œå¯ä»¥ç”¨è¿™ä¸ªæ¥å£è¯·æ±‚ï¼Œä¼šä¸€ä¸ªå­—ä¸€ä¸ªå­—è¿”å›æ•°æ®ã€‚ ç»éªŒè¯ï¼ŒR1çš„1.5Bæ¨¡å‹ä»…æ”¯æŒæµå¼äº¤äº’ã€‚</li></ul><h3 id="é…ç½®deepseek"><a href="#é…ç½®deepseek" class="headerlink" title="é…ç½®deepseek"></a>é…ç½®deepseek</h3><p>æœ€åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä»‹å…¥è‡ªå·±æ­å»ºçš„deepseekäº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs application.properties"># r1 æ¨¡å‹éœ€è¦ä½¿ç”¨æµæ¨¡å¼<br>spring.ai.openai.base-url=http://192.168.2.68:8000<br>spring.ai.openai.api-key=test-key # è‡ªå·±æ­å»ºçš„æ¨¡å‹ä¸ç”¨key<br>spring.ai.openai.chat.options.model=model/DeepSeek-R1-Distill-Qwen-1.5B<br>spring.ai.openai.embedding.enabled=false<br><br></code></pre></td></tr></table></figure><h3 id="å¯åŠ¨é¡¹ç›®"><a href="#å¯åŠ¨é¡¹ç›®" class="headerlink" title="å¯åŠ¨é¡¹ç›®"></a>å¯åŠ¨é¡¹ç›®</h3><p>ç„¶ååœ¨æµè§ˆå™¨é‡Œè®¿é—®<code>http://localhost:8080/ai/chat/generateStream?message=ä½ æ˜¯è°</code> ï¼Œå°±å¯ä»¥çœ‹åˆ°deepseekçš„å›ç­”äº†ï¼Œä¼šçœ‹åˆ°ä¸€é•¿ä¸²çš„æµå¼æ•°æ®ï¼Œç±»ä¼¼ä¸‹é¢ï¼š<br><img src="/../../images/tech/spring/spring-ai-deepseek-r1-res.png" alt="deepseek r1æµå¼è¿”å›demo"></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://docs.spring.io/spring-ai/reference/concepts.html">spring AI å®˜æ–¹æ–‡æ¡£</a></p><p><a href="https://github.com/Hanchers/springboot3-demo/tree/main/hello-ai">github demoä»£ç </a></p>]]></content>
    
    
    <categories>
      
      <category>spring</category>
      
      <category>springboot</category>
      
    </categories>
    
    
    <tags>
      
      <tag>spring</tag>
      
      <tag>springAI</tag>
      
      <tag>deepseek</tag>
      
      <tag>AI</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>çº¯cpuç‰ˆlinuxæœ¬åœ°å®‰è£…DeepSeek-R1-Distill-Qwen-1.5B</title>
    <link href="/2025/03/13/ai-deepseek-install-ds-r1-1-5b/"/>
    <url>/2025/03/13/ai-deepseek-install-ds-r1-1-5b/</url>
    
    <content type="html"><![CDATA[<p>æƒ³è¦å­¦ä¹ ä¸€ä¸‹deepseekçš„è¿è¡ŒåŸç†ä¸æ¨¡å‹è°ƒä¼˜ï¼Œæ‰€ä»¥å°±æœ‰äº†åœ¨æœ¬åœ°å®‰è£…ä¸€å¥—deepseekçš„æƒ³æ³•ã€‚</p><p>å› ä¸ºæ˜¯å­¦ä¹ ä¸ºä¸»ï¼Œå°±é€‰æ‹©äº†DeepSeek-R1-Distill-Qwen-1.5Bç‰ˆæœ¬ä¸ºæˆ‘ä»¬çš„å­¦ä¹ ç‰ˆæœ¬ã€‚</p><p>ä½†æˆ‘åªæœ‰ä¸€å°centos7çš„çº¯cpuæœåŠ¡å™¨ï¼Œç”¨æ¥å­¦ä¹ ä¹Ÿå¤Ÿç”¨äº†ã€‚ä»¥ä¸‹è®°å½•deepseekåœ¨çº¯cpuç‰ˆæœ¬çš„linuxä¸Šéƒ¨ç½²çš„è¿‡ç¨‹ã€‚</p><h2 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h2><ul><li>cpu: Intel Xeon Processor (Skylake, IBRS)</li><li>osï¼š centos7</li><li>å†…å­˜ï¼š16g</li><li>gpu: æ— </li></ul><h2 id="å®‰è£…è¿‡ç¨‹"><a href="#å®‰è£…è¿‡ç¨‹" class="headerlink" title="å®‰è£…è¿‡ç¨‹"></a>å®‰è£…è¿‡ç¨‹</h2><h3 id="å®‰è£…python3"><a href="#å®‰è£…python3" class="headerlink" title="å®‰è£…python3"></a>å®‰è£…python3</h3><p>vllm å®˜æ–¹éœ€è¦python: 3.9 - 3.12</p><blockquote><p>Python: 3.9 â€“ 3.12</p></blockquote><h4 id="å®‰è£…pyenv"><a href="#å®‰è£…pyenv" class="headerlink" title="å®‰è£…pyenv"></a>å®‰è£…pyenv</h4><p>å› ä¸ºlinuxé‡Œå·²ç»æœ‰äº†ä¸€å¥—2.7çš„Pythonäº†ï¼Œæ‰€ä»¥è¦æŒ‰ç…§Python3çš„è¯ï¼Œåªèƒ½é‡æ–°å®‰è£…ä¸€å¥—äº†ã€‚ç»¼åˆè€ƒè™‘ï¼Œé€‰æ‹©ä½¿ç”¨<code>pyenv</code>å·¥å…·æ¥å®‰è£…ï¼Œæ¯”è¾ƒç®€å•</p><p>å®‰è£…pyenv:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -fsSL https://pyenv.run | bash<br></code></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥æ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -s -S -L https://raw.githubusercontent.com/pyenv/pyenv-installer/master/bin/pyenv-installer | bash<br></code></pre></td></tr></table></figure><h4 id="å®‰è£…python"><a href="#å®‰è£…python" class="headerlink" title="å®‰è£…python"></a>å®‰è£…python</h4><p>pyenvå®‰è£…å®Œæˆåï¼Œä½¿ç”¨pyenvå®‰è£… Python3.10.16ï¼ˆ3.xç‰ˆæœ¬éƒ½å¯ä»¥,å°½é‡ç”¨æœ€æ–°çš„ï¼‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">pyenv install -v 3.10.16<br></code></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œå¤§æ¦‚ç‡ä¼šæç¤º<code>Missing the OpenSSL lib</code>è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥å‚è€ƒ<a href="https://www.hancher.top/2025/03/11/linux-centos7-install-py3-10-no-ssl-err/">centos7å®‰è£…Python3.10ï¼Œæç¤ºno ssl é—®é¢˜è§£å†³</a>è§£å†³</p><p>è¿™é‡Œæœ‰ä¸¤ä¸ªé€‰æ‹©ï¼š</p><p>å¦‚æœå¸Œæœ›å°†Python3.10 è®¾ç½®ä¸ºå…¨å±€çš„Pythonç¯å¢ƒé…ç½®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">pyenv global 3.10.16<br></code></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ä»»æ„ä½ç½®ä½¿ç”¨python3äº†ï¼Œè€Œä¸”Pythonå‘½ä»¤ä¹ŸæŒ‡å‘äº†Python3.</p><p>å¦‚æœå¸Œæœ›ä»…åœ¨æŸä¸ªç›®å½•ä¸‹ä½¿ç”¨Python3.10ï¼Œå¯ä»¥é…ç½®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">pyenv <span class="hljs-built_in">local</span> 3.10.16<br></code></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œæˆ‘ä»¬åªæœ‰åœ¨è¿™ä¸ªç›®å½•ä¸‹ï¼Œæ‰ä¼šä½¿ç”¨åˆ°Python3.10. å…¶ä»–é…ç½®ä¸‹ï¼Œè¿˜æ˜¯ä½¿ç”¨ç³»ç»Ÿé…ç½®ã€‚</p><p><strong>æ³¨æ„ï¼Œä»¥ä¸Šé…ç½®éœ€è¦é‡å¯ç»ˆç«¯ç”Ÿæ•ˆ</strong></p><h3 id="å®‰è£…vllm"><a href="#å®‰è£…vllm" class="headerlink" title="å®‰è£…vllm"></a>å®‰è£…vllm</h3><p>å®‰è£…å¥½python3.10åï¼Œå¼€å§‹å®‰è£…vllm.</p><p>å› ä¸ºvllmå®˜æ–¹æ²¡æœ‰æä¾›cpuç‰ˆæœ¬çš„è½®å­ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä»æºç æ‰‹åŠ¨ç¼–è¯‘vllmã€‚</p><h4 id="å¼€å¯è™šæ‹Ÿç¯å¢ƒ"><a href="#å¼€å¯è™šæ‹Ÿç¯å¢ƒ" class="headerlink" title="å¼€å¯è™šæ‹Ÿç¯å¢ƒ"></a>å¼€å¯è™šæ‹Ÿç¯å¢ƒ</h4><p>å¼€å¯è™šæ‹Ÿç¯å¢ƒï¼Œä½¿vllmçš„å®‰è£…ä¸å…¶ä»–pythonç¯å¢ƒéš”ç¦»ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">python -m venv vllm_env<br><span class="hljs-built_in">source</span> vllm_env/bin/activate<br><br></code></pre></td></tr></table></figure><h3 id="å‡çº§gcc"><a href="#å‡çº§gcc" class="headerlink" title="å‡çº§gcc"></a>å‡çº§gcc</h3><p>æŸ¥çœ‹ä¸€ä¸‹å½“å‰ç³»ç»Ÿçš„gccç‰ˆæœ¬, centos7 å¤§æ¦‚ç‡æ˜¯<code>4.8.5</code>. å¦‚æœè¦å®‰è£…vllmï¼Œéœ€è¦å°†gccå‡çº§åˆ°<code>11.x</code>ã€‚</p><p>å¦‚æœå½“å‰ç³»ç»Ÿgccå·²ç»æ˜¯<code>11.x</code>, å¯ä»¥è·³è¿‡æ­¤æ­¥ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ gcc --version<br><br>gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-44)<br>Copyright (C) 2015 Free Software Foundation, Inc.<br>This is free software; see the <span class="hljs-built_in">source</span> <span class="hljs-keyword">for</span> copying conditions.  There is NO<br>warranty; not even <span class="hljs-keyword">for</span> MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.<br></code></pre></td></tr></table></figure><p>å‡çº§gccï¼Œè¯·å‚è€ƒ<a href="https://www.hancher.top/2025/03/12/linux-centos7-gcc-upgrade/">centos7å‡çº§gccåˆ°ç‰ˆæœ¬8</a></p><h3 id="å®‰è£…vllm-1"><a href="#å®‰è£…vllm-1" class="headerlink" title="å®‰è£…vllm"></a>å®‰è£…vllm</h3><p>vllm éœ€è¦ä¾èµ– PyTorch æ¥è¿›è¡Œåº•å±‚è®¡ç®—ã€‚å› ä¸ºæˆ‘è¿™æ˜¯çº¯cpuçš„å­¦ä¹ ç‰ˆï¼Œæ‰€ä»¥åªæœ‰å®‰è£…cpuç‰ˆå³å¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">pip install torch torchvision torchaudio numactl-devel python3-devel openssl-devel xz-devel libffi-devel<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹cpuæ˜¯å¦æ”¯æŒ<code>avx512_bf16</code>å‘é‡æŒ‡ä»¤é›†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">grep avx512_bf16 /proc/cpuinfo<br></code></pre></td></tr></table></figure><p>å¦‚æœæ²¡æœ‰è¾“å‡ºï¼Œåˆ™è¯´æ˜ä¸æ”¯æŒï¼Œéœ€è¦åœ¨æ‰“åŒ…vllmçš„æ—¶å€™ç¦ç”¨<code>VLLM_CPU_AVX512BF16=1</code></p><p>å…‹éš†æºç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/vllm-project/vllm.git vllm_source<br><span class="hljs-built_in">cd</span> vllm_source<br></code></pre></td></tr></table></figure><p>åœ¨vllmæºç ç›®å½•ä¸‹ï¼Œæ‰“åŒ…cpuç‰ˆvllm</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># å®‰è£…cmakeæ‰“åŒ…å·¥å…·</span><br>pip install <span class="hljs-string">&quot;cmake&gt;=3.26&quot;</span> wheel packaging ninja <span class="hljs-string">&quot;setuptools-scm&gt;=8&quot;</span> numpy<br><br><span class="hljs-comment"># æ ¹æ®å®˜æ–¹æ¨èçš„cpué…ç½®ï¼Œä¸‹è½½cpuç‰ˆçš„ä¾èµ–</span><br>pip install -v -r requirements/cpu.txt --extra-index-url https://download.pytorch.org/whl/cpu<br><br><span class="hljs-comment"># æŒ‡å®šcpuæ¨¡å¼ï¼Œæ‰“åŒ…</span><br>FORCE_CUDA=0 VLLM_TARGET_DEVICE=cpu VLLM_CPU_AVX512BF16=1 python setup.py install<br></code></pre></td></tr></table></figure><p>æœ‰çš„centos7ç‰ˆæœ¬æ¯”è¾ƒè€ï¼ˆæ¯”å¦‚æˆ‘ï¼‰ï¼Œä¼šæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs log">vllm_source/csrc/cpu/utils.cpp:84:38: error: â€˜gettidâ€™ was not declared in this scope; did you mean â€˜getuidâ€™?<br>   84 |     thread_core_mapping.emplace_back(gettid(), omp_cpu_ids[i]);<br></code></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´<code>gettid</code>è¿™ä¸ªæ–¹æ³•æ‰¾ä¸åˆ°ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯ç”¨äºè·å–çº¿ç¨‹IDçš„ï¼Œæˆ‘çš„ç³»ç»Ÿä¸æ”¯æŒè¿™ä¸ªåŠŸèƒ½ï¼Œéœ€è¦è‡ªå·±å»å®šä¹‰ç›¸å…³é€»è¾‘ï¼š</p><p>åœ¨<code>vllm_source/csrc/cpu/utils.cpp</code>æ–‡ä»¶å¤´éƒ¨æ·»åŠ å¦‚ä¸‹ä»£ç </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/syscall.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> gettid() syscall(SYS_gettid)</span><br></code></pre></td></tr></table></figure><p>æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> VLLM_NUMA_DISABLED</span><br>  <span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;numa.h&gt;</span></span><br>  <span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br>  <span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span><br>  <span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sched.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;cpu_types.hpp&quot;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/syscall.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> gettid() syscall(SYS_gettid)</span><br></code></pre></td></tr></table></figure><p>ä¿®æ”¹å®Œæˆåï¼Œæ¸…ç†æ‰cmake ç¼“å­˜ï¼Œé‡æ–°æ‰“åŒ…ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># åœ¨vllm_sourceç›®å½•ä¸‹</span><br><span class="hljs-built_in">rm</span> -rf build<br><br><span class="hljs-comment"># æŒ‡å®šcpuæ¨¡å¼ï¼Œæ‰“åŒ…</span><br>FORCE_CUDA=0 VLLM_TARGET_DEVICE=cpu VLLM_CPU_AVX512BF16=1 python setup.py install<br></code></pre></td></tr></table></figure><p>æœ€ç»ˆï¼Œvllmç»ˆäºå®‰è£…æˆåŠŸäº†,éªŒè¯ä¸€ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ python -c <span class="hljs-string">&quot;import vllm; print(vllm.__version__)&quot;</span><br><br>INFO 03-14 08:37:09 [__init__.py:256] Automatically detected platform cpu.<br>0.7.4.dev410+ga73122d.d20250314<br></code></pre></td></tr></table></figure><p>vllmå®‰è£…æˆåŠŸã€‚</p><h3 id="å¯åŠ¨deepseek"><a href="#å¯åŠ¨deepseek" class="headerlink" title="å¯åŠ¨deepseek"></a>å¯åŠ¨deepseek</h3><p>deepseekæ¨¡å‹ä¸€èˆ¬éƒ½æ¯”è¾ƒå¤§ï¼Œæœ€åæå‰ä¸‹è½½ä¸‹æ¥ã€‚</p><p>æ¨èä½¿ç”¨<code>modelscope</code>æ¥ç®¡ç†ã€‚<code>modelscope</code>æ˜¯ä¸€ä¸ªç”¨æ¥ç®¡ç†å¤§æ¨¡å‹çš„å¹³å°ï¼Œå¯ä»¥ç”¨æ¥ä¸‹è½½å„å¤§å¹³å°çš„å¼€æºæ¨¡å‹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># å®‰è£…</span><br>pip install modelscope<br><br><span class="hljs-comment"># ä¸‹è½½deepseek æ¨¡å‹</span><br><span class="hljs-built_in">mkdir</span> -p model/DeepSeek-R1-Distill-Qwen-1.5B<br>modelscope download --model deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B --local_dir model/DeepSeek-R1-Distill-Qwen-1.5B<br></code></pre></td></tr></table></figure><p><img src="/../../../images/tech/ai/model/modelscope_models.png" alt="modelscopeæ”¯æŒçš„æ¨¡å‹"></p><p>å¯åŠ¨DeepSeek-R1-Distill-Qwen-1.5Bæ¨¡å‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vllm serve model/DeepSeek-R1-Distill-Qwen-1.5B --tensor-parallel-size 2 --max-model-len 32768 --enforce-eager<br></code></pre></td></tr></table></figure><p>æç¤ºå¦‚ä¸‹ï¼Œé¡¹ç›®å¯åŠ¨æˆåŠŸï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs log">INFO:     Started server process [28967]<br>INFO:     Waiting for application startup.<br>INFO:     Application startup complete.<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬åœ¨æ—¥å¿—é‡Œä¼šå‘ç°ï¼Œæ¨¡å‹æä¾›äº†å¾ˆå¤šæ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä¸€ä¸‹ï¼š</p><ul><li>æŸ¥çœ‹æ¨¡å‹ä¿¡æ¯</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl http://localhost:8000/v1/models<br></code></pre></td></tr></table></figure><p>è¿”å›ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;object&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;list&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>    <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;/root/bai/deepseek/model/DeepSeek-R1-Distill-Qwen-1.5B&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;object&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;model&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;created&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1741916807</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;owned_by&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;vllm&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;root&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;/root/bai/deepseek/model/DeepSeek-R1-Distill-Qwen-1.5B&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;parent&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;max_model_len&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">32768</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;permission&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span><br>          <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;modelperm-74deb10e678f409698477a7818e7d57c&quot;</span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;object&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;model_permission&quot;</span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;created&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1741916807</span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;allow_create_engine&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;allow_sampling&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;allow_logprobs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;allow_search_indices&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;allow_view&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;allow_fine_tuning&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;organization&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;*&quot;</span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;group&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;is_blocking&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><br>        <span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">]</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><ul><li>å¯¹è¯</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -X POST http://localhost:8000/v1/chat/completions \<br>  -H <span class="hljs-string">&quot;Content-Type: application/json&quot;</span> \<br>  -d <span class="hljs-string">&#x27;&#123;</span><br><span class="hljs-string">        &quot;model&quot;: &quot;model/DeepSeek-R1-Distill-Qwen-1.5B&quot;,</span><br><span class="hljs-string">        &quot;messages&quot;: [</span><br><span class="hljs-string">          &#123;&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;ä½ æ˜¯è°&quot;&#125;</span><br><span class="hljs-string">        ],</span><br><span class="hljs-string">        &quot;stream&quot;: false</span><br><span class="hljs-string">      &#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>è¿”å›ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;chatcmpl-5620282684554598b0448f1f7f4b6bda&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;object&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;chat.completion&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;created&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1742174087</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;model&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;model/DeepSeek-R1-Distill-Qwen-1.5B&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;choices&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;index&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;role&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;assistant&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;reasoning_content&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;content&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ‚¨å¥½ï¼æˆ‘æ˜¯ç”±ä¸­å›½çš„æ·±åº¦æ±‚ç´¢ï¼ˆDeepSeekï¼‰å…¬å¸å¼€å‘çš„æ™ºèƒ½åŠ©æ‰‹DeepSeek-R1ã€‚å¦‚æ‚¨æœ‰ä»»ä½•ä»»ä½•é—®é¢˜ï¼Œæˆ‘ä¼šå°½æˆ‘æ‰€èƒ½ä¸ºæ‚¨æä¾›å¸®åŠ©ã€‚\n&lt;/think&gt;\n\næ‚¨å¥½ï¼æˆ‘æ˜¯ç”±ä¸­å›½çš„æ·±åº¦æ±‚ç´¢ï¼ˆDeepSeekï¼‰å…¬å¸å¼€å‘çš„æ™ºèƒ½åŠ©æ‰‹DeepSeek-R1ã€‚å¦‚æ‚¨æœ‰ä»»ä½•ä»»ä½•é—®é¢˜ï¼Œæˆ‘ä¼šå°½æˆ‘æ‰€èƒ½ä¸ºæ‚¨æä¾›å¸®åŠ©ã€‚&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;tool_calls&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;logprobs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;finish_reason&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;stop&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;stop_reason&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><br><span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;usage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;prompt_tokens&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">7</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;total_tokens&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">80</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;completion_tokens&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">73</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;prompt_tokens_details&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><br><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;prompt_logprobs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><ul><li><p>é¡¹ç›®swaggeræ–‡æ¡£</p><p>æµè§ˆå™¨æ‰“å¼€ï¼š<a href="http://localhost:8000/docs">http://localhost:8000/docs</a></p></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://docs.vllm.ai/en/latest/getting_started/installation/cpu.html">vllm å®˜æ–¹å®‰è£…cpuç‰ˆæœ¬è¯´æ˜</a></p><p><a href="https://www.modelscope.cn/docs/intro/quickstart">å®‰è£…modelscope</a></p><p><a href="https://huggingface.co/deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B">huggingfaceï¼šDeepSeek-R1-Distill-Qwen-1.5Bæ¨¡å‹</a></p>]]></content>
    
    
    <categories>
      
      <category>AI</category>
      
    </categories>
    
    
    <tags>
      
      <tag>deepseek</tag>
      
      <tag>AI</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>centos7ç³»ç»Ÿå‡çº§gccåˆ°gcc8åŠä»¥ä¸Šç‰ˆæœ¬</title>
    <link href="/2025/03/12/linux-centos7-gcc-upgrade/"/>
    <url>/2025/03/12/linux-centos7-gcc-upgrade/</url>
    
    <content type="html"><![CDATA[<p>å› ä¸ºcentosåœæ­¢ç»´æŠ¤äº†ï¼Œå¯¼è‡´<code>mirror.centos.org</code>è¿™ä¸ªåŸŸåä¹Ÿå¤±æ•ˆäº†ï¼Œè¿™å°±è®©æˆ‘ä»¬åœ¨ä½¿ç”¨<code>yum</code>å‘½ä»¤å‡çº§ä¸€äº›ç»„ä»¶çš„æ—¶å€™ï¼Œå‘ç”Ÿä¸€äº›åŸŸåé—®é¢˜ã€‚</p><p>æ¯”å¦‚ï¼Œæˆ‘è¿™æ¬¡è¦æŠŠgcc 4.xç‰ˆæœ¬ å‡çº§åˆ° gcc 8.xç‰ˆæœ¬ï¼Œ ä½¿ç”¨<code>yum</code>å®‰è£…å°±é‡åˆ°åŸŸåå¤±æ•ˆäº†é—®é¢˜ï¼Œè¿™é‡Œè®°å½•äº†è§£å†³åŠæ³•ã€‚</p><h2 id="é—®é¢˜è§£å†³"><a href="#é—®é¢˜è§£å†³" class="headerlink" title="é—®é¢˜è§£å†³"></a>é—®é¢˜è§£å†³</h2><h3 id="è·Ÿæ¢é˜¿é‡Œäº‘é•œåƒåŸŸå"><a href="#è·Ÿæ¢é˜¿é‡Œäº‘é•œåƒåŸŸå" class="headerlink" title="è·Ÿæ¢é˜¿é‡Œäº‘é•œåƒåŸŸå"></a>è·Ÿæ¢é˜¿é‡Œäº‘é•œåƒåŸŸå</h3><p>è¿›å…¥<code>/etc/yum.repos.d/</code>ç›®å½•, å°†<code>CentOS-SCLo-scl.repo</code>å’Œ<code>CentOS-SCLo-scl-rh.repo</code>ä¸¤ä¸ªæ–‡ä»¶å¤‡ä»½ï¼Œ</p><p>ç„¶åä¿®æ”¹é‡Œé¢çš„<code>baseurl</code> æˆ–è€… <code>mirrorlist</code>, ç”¨<code>mirrors.aliyun.com</code>æ›¿æ¢åŸå…ˆçš„å·²ç»è¿‡æœŸçš„åŸŸåã€‚</p><p><code>CentOS-SCLo-scl.repo</code>æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[centos-sclo-sclo]</span><br><span class="hljs-attr">name</span>=CentOS-<span class="hljs-number">7</span> - SCLo sclo<br><span class="hljs-attr">baseurl</span>=https://mirrors.aliyun.com/centos/<span class="hljs-number">7</span>/sclo/x<span class="hljs-number">86_64</span>/sclo/<br><span class="hljs-comment">#baseurl=https://vault.centos.org/centos/7/sclo/$basearch/sclo/</span><br><span class="hljs-attr">gpgcheck</span>=<span class="hljs-number">1</span><br><span class="hljs-attr">enabled</span>=<span class="hljs-number">1</span><br><span class="hljs-attr">gpgkey</span>=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-SIG-SCLo<br></code></pre></td></tr></table></figure><p><code>CentOS-SCLo-scl-rh.repo</code>æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[centos-sclo-rh]</span><br><span class="hljs-attr">name</span>=CentOS-<span class="hljs-number">7</span> - SCLo rh<br><span class="hljs-attr">baseurl</span>=https://mirrors.aliyun.com/centos/<span class="hljs-number">7</span>/sclo/x<span class="hljs-number">86_64</span>/rh/<br><span class="hljs-attr">gpgcheck</span>=<span class="hljs-number">1</span><br><span class="hljs-attr">enabled</span>=<span class="hljs-number">1</span><br><span class="hljs-attr">gpgkey</span>=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-SIG-SCLo<br></code></pre></td></tr></table></figure><p>ç„¶åæ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æ¸…ç†yumç¼“å­˜</span><br>yum clean all<br><span class="hljs-comment"># é‡æ–°æ„å»ºç¼“å­˜</span><br>yum makecache<br></code></pre></td></tr></table></figure><h3 id="é‡æ–°å®‰è£…devtoolset-8"><a href="#é‡æ–°å®‰è£…devtoolset-8" class="headerlink" title="é‡æ–°å®‰è£…devtoolset-8"></a>é‡æ–°å®‰è£…devtoolset-8</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">yum install -y centos-release-scl<br>yum install -y devtoolset-8-gcc*<br></code></pre></td></tr></table></figure><h3 id="éªŒè¯å®‰è£…æˆåŠŸ"><a href="#éªŒè¯å®‰è£…æˆåŠŸ" class="headerlink" title="éªŒè¯å®‰è£…æˆåŠŸ"></a>éªŒè¯å®‰è£…æˆåŠŸ</h3><p>æ¿€æ´»devtoolset-8ç¯å¢ƒï¼ˆä¸´æ—¶ç”Ÿæ•ˆï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">scl <span class="hljs-built_in">enable</span> devtoolset-8 bash<br>gcc --version  <span class="hljs-comment"># åº”æ˜¾ç¤ºgcc 8.x.x</span><br></code></pre></td></tr></table></figure><h3 id="æ¿€æ´»gcc8"><a href="#æ¿€æ´»gcc8" class="headerlink" title="æ¿€æ´»gcc8"></a>æ¿€æ´»gcc8</h3><p>è¿›å…¥ç»ˆç«¯çš„é…ç½®æ–‡ä»¶ï¼š<code>~/.bashrc</code>æˆ–<code>/etc/profile</code>, æ·»åŠ å¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">source</span> /opt/rh/devtoolset-8/enable<br></code></pre></td></tr></table></figure><p>ç„¶å <code>source</code>å¯¹åº”çš„æ–‡ä»¶ï¼Œæˆ–è€…é‡å¯ç»ˆç«¯ï¼Œå‘½ä»¤ç”Ÿæ•ˆã€‚</p><p>æˆ‘å› ä¸ºè¦å®‰è£…vllmç¯å¢ƒï¼Œéœ€è¦C++ 17çš„ç‰ˆæœ¬ï¼Œæ‰€ä»¥éœ€è¦gcc11çš„ç¯å¢ƒï¼ŒæŒ‰ç…§ä¸Šè¿°æ­¥éª¤å‡çº§çš„gcc11ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># $ yum install -y devtoolset-11-gcc*</span><br>$ gcc --version<br><br>gcc (GCC) 11.2.1 20220127 (Red Hat 11.2.1-9)<br>Copyright (C) 2021 Free Software Foundation, Inc.<br>This is free software; see the <span class="hljs-built_in">source</span> <span class="hljs-keyword">for</span> copying conditions.  There is NO<br>warranty; not even <span class="hljs-keyword">for</span> MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹äººç”Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>é—®é¢˜è§£å†³</tag>
      
      <tag>centos</tag>
      
      <tag>gcc</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>centos7å®‰è£…Python3.10æç¤ºno sslé”™è¯¯è§£å†³</title>
    <link href="/2025/03/11/linux-centos7-install-py3-10-no-ssl-err/"/>
    <url>/2025/03/11/linux-centos7-install-py3-10-no-ssl-err/</url>
    
    <content type="html"><![CDATA[<p>åœ¨centos7ç³»ç»Ÿé»˜è®¤å®‰è£…çš„Pythonæ˜¯2.7ï¼Œ ç°åœ¨è¦å‡çº§åˆ°3.10.xã€‚</p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>æœ¬ç€æ–¹ä¾¿ç‰ˆæœ¬ç®¡ç†çš„åŸå› ï¼Œä½¿ç”¨<a href="https://github.com/pyenv/pyenv">pyenv</a>çš„æ–¹å¼æ¥å®‰è£…python3.10.16ç‰ˆæœ¬ã€‚</p><p>ç„¶åé‡åˆ°äº†æ‰€æœ‰ç¨‹åºå‘˜å®‰è£…Python3.10å¿…ç„¶ä¼šé‡åˆ°çš„å™©æ¢¦ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs log">Traceback (most recent call last):<br>  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;<br>  File &quot;/root/.pyenv/versions/3.10.16/lib/python3.10/ssl.py&quot;, line 99, in &lt;module&gt;<br>    import _ssl             # if we can&#x27;t import it, let the error propagate<br>ModuleNotFoundError: No module named &#x27;_ssl&#x27;<br>ERROR: The Python ssl extension was not compiled. Missing the OpenSSL lib?<br><br>Please consult to the Wiki page to fix the problem.<br>https://github.com/pyenv/pyenv/wiki/Common-build-problems<br><br><br>BUILD FAILED (CentOS Linux 7 using python-build 20180424)<br></code></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ²¡æœ‰æ‰¾åˆ°ç³»ç»Ÿçš„sslé…ç½®ï¼Ÿ</p><p>å¯æ˜¯æˆ‘çš„ç³»ç»Ÿä¸Šå®‰è£…äº†opensslå‘€ï¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ openssl version<br><br>OpenSSL 3.0.0 7 sep 2021 (Library: OpenSSL 3.0.0 7 sep 2021)<br></code></pre></td></tr></table></figure><p>ç»è¿‡æœç´¢ï¼Œç¡®è®¤Python3.10çš„å®‰è£…ä¾èµ–openssl 1.11ç‰ˆæœ¬ï¼Œæˆ‘çš„ç‰ˆæœ¬å¤ªé«˜äº†ã€‚</p><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è§£å†³ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># å®‰è£…openssl 1.11</span><br>yum install -y openssl-devel openssl11-devel openssl11-lib xz-devel<br><span class="hljs-comment"># å®‰è£…Python</span><br>CPPFLAGS=<span class="hljs-string">&quot;-I/usr/include/openssl11&quot;</span> LDFLAGS=<span class="hljs-string">&quot;-L/usr/lib64/openssl11 -lssl -lcrypto &quot;</span> pyenv install -v 3.10.16<br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h2><p><a href="https://github.com/pyenv/pyenv/wiki/Common-build-problems#error-the-python-ssl-extension-was-not-compiled-missing-the-openssl-lib">pyenv å®˜æ–¹å¸¸è§é—®é¢˜è§£å†³å‚è€ƒ</a></p>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹äººç”Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>é—®é¢˜è§£å†³</tag>
      
      <tag>centos</tag>
      
      <tag>python</tag>
      
      <tag>pyenv</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>springbootå¯ä»¥æŠŠé¡¹ç›®æ‰“åŒ…æˆappäº†ï¼Œdockeræ‰“åŒ…ç‰ˆ</title>
    <link href="/2025/03/08/spring-spring-native-image-docker/"/>
    <url>/2025/03/08/spring-spring-native-image-docker/</url>
    
    <content type="html"><![CDATA[<p>ä¸Šä¸€ç¯‡æ–‡ç« ä»‹ç»äº†å¦‚æœé€šè¿‡graalVM æ‰“åŒ…javaæœ¬åœ°åº”ç”¨ï¼Œè¿™é‡Œæˆ‘ä»¬ç»§ç»­ä»‹ç»å¦‚ä½•é€šè¿‡dockeræ‰“åŒ…javaçš„åŸç”Ÿé•œåƒã€‚</p><p>åœ¨æ“ä½œä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ€è€ƒä¸€ä¸‹é—®é¢˜ï¼šä¸ºä»€ä¹ˆè¦æ‰“åŒ…æˆdockerå®¹å™¨å‘¢ï¼Ÿ</p><p>å°±æ˜¯ä¸ºäº†äº‘åŸç”Ÿï¼</p><p>æˆ–è€…è¯´ï¼Œjavaçš„æœ¬åœ°appæ‰“åŒ…åŠŸèƒ½çš„æ”¯æŒï¼Œä¸€å¤§åŸå› å°±æ˜¯ä¸ºäº†é€‚åº”äº‘åŸç”Ÿæ—¶ä»£ï¼Œæ‰€ä»¥æ”¯æŒå®¹å™¨ä¹Ÿæ˜¯å¿…ç„¶çš„é€‰æ‹©äº†ã€‚</p><p><img src="/../../images/tech/spring/spring_native_app_docker.png" alt="javaåŸç”Ÿapp dockeråŒ–åéƒ¨ç½²æ¶æ„å›¾"></p><p>ä¸‹é¢å¼€å§‹å±•ç°ä»£ç å®ç°ã€‚</p><h2 id="ä»£ç å’Œä¾èµ–"><a href="#ä»£ç å’Œä¾èµ–" class="headerlink" title="ä»£ç å’Œä¾èµ–"></a>ä»£ç å’Œä¾èµ–</h2><p>ä»£ç éƒ¨åˆ†å’Œæœ¬åœ°ç¯å¢ƒé…ç½®æ–¹é¢ï¼Œå’Œä¸Šç¯‡æ–‡ç«  <a href="https://www.hancher.top/2025/03/04/spring-spring-native-image-graalvm/">springbootå¯ä»¥æŠŠé¡¹ç›®æ‰“åŒ…æˆappäº†ï¼ŒGraalæ‰“åŒ…ç‰ˆ</a> é‡Œçš„<code>graalvm-native-app</code>é¡¹ç›®å®Œå…¨ä¸€è‡´ï¼Œå°±ä¸å¤šè¯´äº†ã€‚</p><p>æ¥ä¸‹æ¥æ˜¯æ‰“åŒ…éƒ¨åˆ†çš„å·®å¼‚ã€‚</p><p>è¦å°†é¡¹ç›®æ‰“åŒ…æˆdockerçš„åŸç”Ÿåº”ç”¨é•œåƒï¼Œéœ€è¦å…ˆåœ¨æ“ä½œç³»ç»Ÿä¸Šå®‰è£…dockerç¯å¢ƒã€‚</p><ul><li>linux: å‚è€ƒ<a href="https://docs.docker.com/engine/install/">å®˜æ–¹æ–‡æ¡£</a>é€‰æ‹©è‡ªå·±çš„å‘è¡Œç‰ˆå®‰è£…</li><li>mac&#x2F;windows: ä¸ªäººå¼€å‘è¿™å¯ä»¥å®‰è£…docker desktopåº”ç”¨ï¼Œä¸€é”®å®‰è£…ï¼Œå¾ˆç®€å•ã€‚</li></ul><p>docker å®‰è£…å¥½ å’Œ nikåŒ…ï¼ˆè§ä¸Šæ–‡ï¼‰å®‰è£…å®Œæˆåï¼Œæˆ‘ä»¬çš„ç¯å¢ƒå°±å‡†å¤‡å¥½äº†ã€‚</p><h3 id="æ‰“åŒ…"><a href="#æ‰“åŒ…" class="headerlink" title="æ‰“åŒ…"></a>æ‰“åŒ…</h3><p>è¦æƒ³æ‰“åŒ…æˆdocker åŸç”Ÿappé•œåƒï¼Œéœ€è¦ä¾èµ–ä¸€ä¸ª<code>paketobuildpacks/builder-jammy-java-tiny</code>é•œåƒã€‚</p><p>é¡¹ç›®æ‰“åŒ…è¿‡ç¨‹ä¸­ä¹Ÿä¼šè‡ªåŠ¨ä¸‹è½½ï¼Œä½†æ˜¯æå‰å‡†å¤‡å¥½ä¼šæå‡æ‰“åŒ…æ•ˆç‡ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker pull paketobuildpacks/builder-jammy-java-tiny:latest<br></code></pre></td></tr></table></figure><p>é•œåƒpullæˆåŠŸåï¼Œå°±å¯ä»¥æ‰§è¡Œæ‰“åŒ…å‘½ä»¤äº†ï¼Œç†è®ºä¸Šï¼Œä¸ç”¨ä»»ä½•æ“ä½œï¼Œä¸€æ¡å‘½ä»¤å³å¯å°†springbooté¡¹ç›®æ‰“åŒ…æˆdockeré•œåƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mvn -Pnative spring-boot:build-image<br></code></pre></td></tr></table></figure><p>æ­¤å‘½ä»¤å’Œä¸‹é¢çš„é…ç½®æ•ˆæœä¸€æ ·ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">executions</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">execution</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">goals</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">goal</span>&gt;</span>build-image<span class="hljs-tag">&lt;/<span class="hljs-name">goal</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">goals</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">execution</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">executions</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br></code></pre></td></tr></table></figure><p>éƒ½æ˜¯è§¦å‘springbootæ„å»ºæ’ä»¶é‡Œçš„æ„å»ºdockeré•œåƒé€»è¾‘ã€‚</p><p>ä¸‹é¢æ˜¯éƒ¨åˆ†æ„å»ºè¿‡ç¨‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br></pre></td><td class="code"><pre><code class="hljs log">[INFO] --- spring-boot-maven-plugin:3.4.3:build-image (default-cli) @ graalvm-native-app ---<br>[INFO] Building image &#x27;docker.io/library/graalvm-native-app:0.0.1-SNAPSHOT&#x27;<br>[INFO] <br>[INFO]  &gt; Pulling builder image &#x27;docker.io/paketobuildpacks/builder-jammy-java-tiny:latest&#x27; 100%<br>[INFO]  &gt; Pulled builder image &#x27;paketobuildpacks/builder-jammy-java-tiny@sha256:c5c53c656d9151071482c79f2460aee477e25d05d83b5286549074707d1f76f1&#x27;<br>[INFO]  &gt; Pulling run image &#x27;docker.io/paketobuildpacks/run-jammy-tiny:latest&#x27; for platform &#x27;linux/arm64&#x27; 12%<br>[INFO]  &gt; Pulling run image &#x27;docker.io/paketobuildpacks/run-jammy-tiny:latest&#x27; for platform &#x27;linux/arm64&#x27; 32%<br>[INFO]  &gt; Pulling run image &#x27;docker.io/paketobuildpacks/run-jammy-tiny:latest&#x27; for platform &#x27;linux/arm64&#x27; 100%<br>[INFO]  &gt; Pulled run image &#x27;paketobuildpacks/run-jammy-tiny@sha256:0c5ac79d549c4b077a7d857631f817f8b573f5da2c109a51f320ee584d44d3f2&#x27;<br>[INFO]  &gt; Executing lifecycle version v0.20.6<br>[INFO]  &gt; Using build cache volume &#x27;pack-cache-064fa27f6606.build&#x27;<br>[INFO] <br>[INFO]  &gt; Running creator<br>[INFO]     [creator]     ===&gt; ANALYZING<br>[INFO]     [creator]     Image with name &quot;docker.io/library/graalvm-native-app:0.0.1-SNAPSHOT&quot; not found<br>[INFO]     [creator]     ===&gt; DETECTING<br>[INFO]     [creator]     target distro name/version labels not found, reading /etc/os-release file<br>[INFO]     [creator]     6 of 15 buildpacks participating<br>[INFO]     [creator]     paketo-buildpacks/ca-certificates   3.9.1<br>[INFO]     [creator]     paketo-buildpacks/bellsoft-liberica 11.0.5<br>[INFO]     [creator]     paketo-buildpacks/syft              2.8.0<br>[INFO]     [creator]     paketo-buildpacks/executable-jar    6.12.1<br>[INFO]     [creator]     paketo-buildpacks/spring-boot       5.32.1<br>[INFO]     [creator]     paketo-buildpacks/native-image      5.15.1<br>[INFO]     [creator]     ===&gt; RESTORING<br>[INFO]     [creator]     ===&gt; BUILDING<br>[INFO]     [creator]     target distro name/version labels not found, reading /etc/os-release file<br>[INFO]     [creator]     <br>[INFO]     [creator]     Paketo Buildpack for CA Certificates 3.9.1<br>[INFO]     [creator]       https://github.com/paketo-buildpacks/ca-certificates<br>[INFO]     [creator]       Build Configuration:<br>[INFO]     [creator]         $BP_EMBED_CERTS                    false  Embed certificates into the image<br>[INFO]     [creator]         $BP_ENABLE_RUNTIME_CERT_BINDING    true   Deprecated: Enable/disable certificate helper layer to add certs at runtime<br>[INFO]     [creator]         $BP_RUNTIME_CERT_BINDING_DISABLED  false  Disable certificate helper layer to add certs at runtime<br>[INFO]     [creator]       Launch Helper: Contributing to layer<br>[INFO]     [creator]         Creating /layers/paketo-buildpacks_ca-certificates/helper/exec.d/ca-certificates-helper<br>[INFO]     [creator]     <br>[INFO]     [creator]     Paketo Buildpack for BellSoft Liberica 11.0.5<br>[INFO]     [creator]       https://github.com/paketo-buildpacks/bellsoft-liberica<br>[INFO]     [creator]       Build Configuration:<br>[INFO]     [creator]         $BP_JVM_JLINK_ARGS           --no-man-pages --no-header-files --strip-debug --compress=1  configure custom link arguments (--output must be omitted)<br>[INFO]     [creator]         $BP_JVM_JLINK_ENABLED        false                                                        enables running jlink tool to generate custom JRE<br>[INFO]     [creator]         $BP_JVM_TYPE                 JRE                                                          the JVM type - JDK or JRE<br>[INFO]     [creator]         $BP_JVM_VERSION              21                                                           the Java version<br>[INFO]     [creator]       Launch Configuration:<br>[INFO]     [creator]         $BPL_DEBUG_ENABLED           false                                                        enables Java remote debugging support<br>[INFO]     [creator]         $BPL_DEBUG_PORT              8000                                                         configure the remote debugging port<br>[INFO]     [creator]         $BPL_DEBUG_SUSPEND           false                                                        configure whether to suspend execution until a debugger has attached<br>[INFO]     [creator]         $BPL_HEAP_DUMP_PATH                                                                       write heap dumps on error to this path<br>[INFO]     [creator]         $BPL_JAVA_NMT_ENABLED        true                                                         enables Java Native Memory Tracking (NMT)<br>[INFO]     [creator]         $BPL_JAVA_NMT_LEVEL          summary                                                      configure level of NMT, summary or detail<br>[INFO]     [creator]         $BPL_JFR_ARGS                                                                             configure custom Java Flight Recording (JFR) arguments<br>[INFO]     [creator]         $BPL_JFR_ENABLED             false                                                        enables Java Flight Recording (JFR)<br>[INFO]     [creator]         $BPL_JMX_ENABLED             false                                                        enables Java Management Extensions (JMX)<br>[INFO]     [creator]         $BPL_JMX_PORT                5000                                                         configure the JMX port<br>[INFO]     [creator]         $BPL_JVM_HEAD_ROOM           0                                                            the headroom in memory calculation<br>[INFO]     [creator]         $BPL_JVM_LOADED_CLASS_COUNT  35% of classes                                               the number of loaded classes in memory calculation<br>[INFO]     [creator]         $BPL_JVM_THREAD_COUNT        250                                                          the number of threads in memory calculation<br>[INFO]     [creator]         $JAVA_TOOL_OPTIONS                                                                        the JVM launch flags<br>[INFO]     [creator]         Using Java version 17 extracted from MANIFEST.MF<br>[INFO]     [creator]       BellSoft Liberica NIK 17.0.14: Contributing to layer<br>[INFO]     [creator]         Downloading from https://github.com/bell-sw/LibericaNIK/releases/download/23.0.7+1-17.0.14+10/bellsoft-liberica-vm-core-openjdk17.0.14+10-23.0.7+1-linux-aarch64.tar.gz<br>[INFO]     [creator]         Verifying checksum<br>[INFO]     [creator]         Expanding to /layers/paketo-buildpacks_bellsoft-liberica/native-image-svm<br>[INFO]     [creator]         Adding 146 container CA certificates to JVM truststore<br>[INFO]     [creator]         Writing env.build/JAVA_HOME.override<br>[INFO]     [creator]         Writing env.build/JDK_HOME.override<br>[INFO]     [creator]     <br>[INFO]     [creator]     Paketo Buildpack for Syft 2.8.0<br>[INFO]     [creator]       https://github.com/paketo-buildpacks/syft<br>[INFO]     [creator]         Downloading from https://github.com/anchore/syft/releases/download/v1.20.0/syft_1.20.0_linux_arm64.tar.gz<br>[INFO]     [creator]         Verifying checksum<br>[INFO]     [creator]         Writing env.build/SYFT_CHECK_FOR_APP_UPDATE.default<br>[INFO]     [creator]     <br>[INFO]     [creator]     Paketo Buildpack for Executable JAR 6.12.1<br>[INFO]     [creator]       https://github.com/paketo-buildpacks/executable-jar<br>[INFO]     [creator]       Class Path: Contributing to layer<br>[INFO]     [creator]         Writing env/CLASSPATH.delim<br>[INFO]     [creator]         Writing env/CLASSPATH.prepend<br>[INFO]     [creator]       Process types:<br>[INFO]     [creator]         executable-jar: java org.springframework.boot.loader.launch.JarLauncher (direct)<br>[INFO]     [creator]         task:           java org.springframework.boot.loader.launch.JarLauncher (direct)<br>[INFO]     [creator]         web:            java org.springframework.boot.loader.launch.JarLauncher (direct)<br>[INFO]     [creator]     <br>[INFO]     [creator]     Paketo Buildpack for Spring Boot 5.32.1<br>[INFO]     [creator]       https://github.com/paketo-buildpacks/spring-boot<br>[INFO]     [creator]       Build Configuration:<br>[INFO]     [creator]         $BPL_JVM_CDS_ENABLED                 false  whether to enable CDS optimizations at runtime<br>[INFO]     [creator]         $BPL_SPRING_AOT_ENABLED              false  whether to enable Spring AOT at runtime<br>[INFO]     [creator]         $BP_JVM_CDS_ENABLED                  false  whether to enable CDS &amp; perform JVM training run<br>[INFO]     [creator]         $BP_SPRING_AOT_ENABLED               false  whether to enable Spring AOT<br>[INFO]     [creator]         $BP_SPRING_CLOUD_BINDINGS_DISABLED   false  whether to contribute Spring Boot cloud bindings support<br>[INFO]     [creator]         $BP_SPRING_CLOUD_BINDINGS_VERSION    1      default version of Spring Cloud Bindings library to contribute<br>[INFO]     [creator]       Launch Configuration:<br>[INFO]     [creator]         $BPL_SPRING_CLOUD_BINDINGS_DISABLED  false  whether to auto-configure Spring Boot environment properties from bindings<br>[INFO]     [creator]         $BPL_SPRING_CLOUD_BINDINGS_ENABLED   true   Deprecated - whether to auto-configure Spring Boot environment properties from bindings<br>[INFO]     [creator]       Class Path: Contributing to layer<br>[INFO]     [creator]         Writing env.build/CLASSPATH.append<br>[INFO]     [creator]         Writing env.build/CLASSPATH.delim<br>[INFO]     [creator]       Image labels:<br>[INFO]     [creator]         org.opencontainers.image.title<br>[INFO]     [creator]         org.opencontainers.image.version<br>[INFO]     [creator]         org.springframework.boot.version<br>[INFO]     [creator]     <br>[INFO]     [creator]     Paketo Buildpack for Native Image 5.15.1<br>[INFO]     [creator]       https://github.com/paketo-buildpacks/native-image<br>[INFO]     [creator]       Build Configuration:<br>[INFO]     [creator]         $BP_BINARY_COMPRESSION_METHOD          Compression mechanism used to reduce binary size. Options: `none` (default), `upx` or `gzexe`<br>[INFO]     [creator]         $BP_NATIVE_IMAGE                       enable native image build<br>[INFO]     [creator]         $BP_NATIVE_IMAGE_BUILD_ARGUMENTS       arguments to pass to the native-image command<br>[INFO]     [creator]         $BP_NATIVE_IMAGE_BUILD_ARGUMENTS_FILE  a file with arguments to pass to the native-image command<br>[INFO]     [creator]         $BP_NATIVE_IMAGE_BUILT_ARTIFACT        the built application artifact explicitly, required if building from a JAR<br>[INFO]     [creator]       Native Image: Contributing to layer<br>[INFO]     [creator]         Executing native-image --no-fallback -H:+StaticExecutableWithDynamicLibC -H:Name=/layers/paketo-buildpacks_native-image/native-image/com.hancher.springboot3.graalvmnativeapp.GraalvmNativeAppApplication -cp /workspace:/workspace/BOOT-INF/classes:/workspace/BOOT-INF/lib/spring-boot-3.4.3.jar:/workspace/BOOT-INF/lib/spring-boot-autoconfigure-3.4.3.jar:/workspace/BOOT-INF/lib/logback-classic-1.5.16.jar:/workspace/BOOT-INF/lib/logback-core-1.5.16.jar:/workspace/BOOT-INF/lib/log4j-to-slf4j-2.24.3.jar:/workspace/BOOT-INF/lib/log4j-api-2.24.3.jar:/workspace/BOOT-INF/lib/jul-to-slf4j-2.0.16.jar:/workspace/BOOT-INF/lib/jakarta.annotation-api-2.1.1.jar:/workspace/BOOT-INF/lib/snakeyaml-2.3.jar:/workspace/BOOT-INF/lib/jackson-databind-2.18.2.jar:/workspace/BOOT-INF/lib/jackson-annotations-2.18.2.jar:/workspace/BOOT-INF/lib/jackson-core-2.18.2.jar:/workspace/BOOT-INF/lib/jackson-datatype-jdk8-2.18.2.jar:/workspace/BOOT-INF/lib/jackson-datatype-jsr310-2.18.2.jar:/workspace/BOOT-INF/lib/jackson-module-parameter-names-2.18.2.jar:/workspace/BOOT-INF/lib/tomcat-embed-core-10.1.36.jar:/workspace/BOOT-INF/lib/tomcat-embed-el-10.1.36.jar:/workspace/BOOT-INF/lib/tomcat-embed-websocket-10.1.36.jar:/workspace/BOOT-INF/lib/spring-web-6.2.3.jar:/workspace/BOOT-INF/lib/spring-beans-6.2.3.jar:/workspace/BOOT-INF/lib/micrometer-observation-1.14.4.jar:/workspace/BOOT-INF/lib/micrometer-commons-1.14.4.jar:/workspace/BOOT-INF/lib/spring-webmvc-6.2.3.jar:/workspace/BOOT-INF/lib/spring-aop-6.2.3.jar:/workspace/BOOT-INF/lib/spring-context-6.2.3.jar:/workspace/BOOT-INF/lib/spring-expression-6.2.3.jar:/workspace/BOOT-INF/lib/slf4j-api-2.0.16.jar:/workspace/BOOT-INF/lib/spring-core-6.2.3.jar:/workspace/BOOT-INF/lib/spring-jcl-6.2.3.jar:/workspace/BOOT-INF/lib/spring-boot-jarmode-tools-3.4.3.jar com.hancher.springboot3.graalvmnativeapp.GraalvmNativeAppApplication<br>[INFO]     [creator]     ================================================================================<br>[INFO]     [creator]     GraalVM Native Image: Generating &#x27;com.hancher.springboot3.graalvmnativeapp.GraalvmNativeAppApplication&#x27; (static executable)...<br>[INFO]     [creator]     ================================================================================<br>[INFO]     [creator]     For detailed information and explanations on the build output, visit:<br>[INFO]     [creator]     https://github.com/oracle/graal/blob/master/docs/reference-manual/native-image/BuildOutput.md<br>[INFO]     [creator]     --------------------------------------------------------------------------------<br>[INFO]     [creator]     Warning: Method ch.qos.logback.core.FileAppender.valueOf(String) not found.<br>[INFO]     [creator]     Warning: Method ch.qos.logback.core.Layout.valueOf(String) not found.<br>[INFO]     [creator]     Warning: Method ch.qos.logback.core.rolling.RollingPolicy.valueOf(String) not found.<br>[INFO]     [creator]     Warning: Method ch.qos.logback.core.rolling.TriggeringPolicy.valueOf(String) not found.<br>[INFO]     [creator]     Warning: Method ch.qos.logback.core.spi.ContextAware.valueOf(String) not found.<br>[INFO]     [creator]     Warning: Could not resolve class jakarta.inject.Inject for reflection configuration. Reason: java.lang.ClassNotFoundException: jakarta.inject.Inject.<br>[INFO]     [creator]     Warning: Could not resolve class jakarta.inject.Provider for reflection configuration. Reason: java.lang.ClassNotFoundException: jakarta.inject.Provider.<br>[INFO]     [creator]     Warning: Could not resolve class jakarta.inject.Qualifier for reflection configuration. Reason: java.lang.ClassNotFoundException: jakarta.inject.Qualifier.<br>[INFO]     [creator]     Warning: Could not resolve class javax.inject.Inject for reflection configuration. Reason: java.lang.ClassNotFoundException: javax.inject.Inject.<br>[INFO]     [creator]     Warning: Could not resolve class javax.inject.Qualifier for reflection configuration. Reason: java.lang.ClassNotFoundException: javax.inject.Qualifier.<br>[INFO]     [creator]     Warning: Could not resolve class javax.money.MonetaryAmount for reflection configuration. Reason: java.lang.ClassNotFoundException: javax.money.MonetaryAmount.<br>[INFO]     [creator]     Warning: Could not resolve class kotlin.Metadata for reflection configuration. Reason: java.lang.ClassNotFoundException: kotlin.Metadata.<br>[INFO]     [creator]     Warning: Could not resolve class kotlin.reflect.full.KClasses for reflection configuration. Reason: java.lang.ClassNotFoundException: kotlin.reflect.full.KClasses.<br>[INFO]     [creator]     Warning: Could not resolve class org.eclipse.core.runtime.FileLocator for reflection configuration. Reason: java.lang.ClassNotFoundException: org.eclipse.core.runtime.FileLocator.<br>[INFO]     [creator]     Warning: Could not resolve class org.reactivestreams.Publisher for reflection configuration. Reason: java.lang.ClassNotFoundException: org.reactivestreams.Publisher.<br>[INFO]     [creator]     [1/8] Initializing...                                            (5.0s @ 0.12GB)<br>[INFO]     [creator]      Java version: 17.0.14+10-LTS, vendor version: Liberica-NIK-23.0.7-1<br>[INFO]     [creator]      Graal compiler: optimization level: 2, target machine: armv8-a<br>[INFO]     [creator]      C compiler: gcc (linux, aarch64, 11.4.0)<br>[INFO]     [creator]      Garbage collector: Serial GC (max heap size: 80% of RAM)<br>[INFO]     [creator]      1 user-specific feature(s)<br>[INFO]     [creator]      - org.springframework.aot.nativex.feature.PreComputeFieldFeature<br>[INFO]     [creator]     SLF4J(W): No SLF4J providers were found.<br>[INFO]     [creator]     SLF4J(W): Defaulting to no-operation (NOP) logger implementation<br>[INFO]     [creator]     SLF4J(W): See https://www.slf4j.org/codes.html#noProviders for further details.<br>[INFO]     [creator]     [2/8] Performing analysis...  [*******]                         (69.2s @ 1.53GB)<br>[INFO]     [creator]       16,540 (90.76%) of 18,224 types reachable<br>[INFO]     [creator]       27,186 (67.63%) of 40,196 fields reachable<br>[INFO]     [creator]       79,799 (63.18%) of 126,298 methods reachable<br>[INFO]     [creator]        5,144 types,   355 fields, and 5,950 methods registered for reflection<br>[INFO]     [creator]           64 types,    72 fields, and    55 methods registered for JNI access<br>[INFO]     [creator]            4 native libraries: dl, pthread, rt, z<br>[INFO]     [creator]     [3/8] Building universe...                                       (6.4s @ 1.98GB)<br>[INFO]     [creator]     [4/8] Parsing methods...      [***]                              (7.4s @ 1.32GB)<br>[INFO]     [creator]     [5/8] Inlining methods...     [***]                              (2.6s @ 1.02GB)<br>[INFO]     [creator]     [6/8] Compiling methods...    [*******]                         (50.6s @ 1.30GB)<br>[INFO]     [creator]     [7/8] Layouting methods...    [***]                              (5.8s @ 1.92GB)<br>[INFO]     [creator]     [8/8] Creating image...       [***]                              (6.5s @ 2.08GB)<br>[INFO]     [creator]       36.96MB (49.04%) for code area:    51,972 compilation units<br>[INFO]     [creator]       35.49MB (47.09%) for image heap:  387,870 objects and 253 resources<br>[INFO]     [creator]        2.92MB ( 3.88%) for other data<br>[INFO]     [creator]       75.38MB in total<br>[INFO]     [creator]     --------------------------------------------------------------------------------<br>[INFO]     [creator]     Top 10 origins of code area:            Top 10 object types in image heap:<br>[INFO]     [creator]       12.67MB java.base                        8.53MB byte[] for code metadata<br>[INFO]     [creator]        4.24MB tomcat-embed-core-10.1.36.jar    3.95MB java.lang.Class<br>[INFO]     [creator]        3.38MB java.xml                         3.68MB java.lang.String<br>[INFO]     [creator]        2.00MB jackson-databind-2.18.2.jar      3.30MB byte[] for java.lang.String<br>[INFO]     [creator]        1.58MB spring-core-6.2.3.jar            3.23MB byte[] for general heap data<br>[INFO]     [creator]        1.55MB spring-boot-3.4.3.jar            2.11MB byte[] for embedded resources<br>[INFO]     [creator]        1.33MB svm.jar (Native Image)           1.39MB c.o.s.c.h.DynamicHubCompanion<br>[INFO]     [creator]      983.63kB spring-web-6.2.3.jar             1.01MB byte[] for reflection metadata<br>[INFO]     [creator]      910.71kB spring-beans-6.2.3.jar         740.64kB java.lang.String[]<br>[INFO]     [creator]      876.46kB spring-webmvc-6.2.3.jar        597.34kB c.o.s.c.h.DynamicHu~onMetadata<br>[INFO]     [creator]        7.22MB for 69 more packages             6.20MB for 3523 more object types<br>[INFO]     [creator]     --------------------------------------------------------------------------------<br>[INFO]     [creator]     Recommendations:<br>[INFO]     [creator]      HEAP: Set max heap for improved and more predictable memory usage.<br>[INFO]     [creator]      CPU:  Enable more CPU features with &#x27;-march=native&#x27; for improved performance.<br>[INFO]     [creator]     --------------------------------------------------------------------------------<br>[INFO]     [creator]        27.4s (17.7% of total time) in 132 GCs | Peak RSS: 3.50GB | CPU load: 2.69<br>[INFO]     [creator]     --------------------------------------------------------------------------------<br>[INFO]     [creator]     Produced artifacts:<br>[INFO]     [creator]      /layers/paketo-buildpacks_native-image/native-image/com.hancher.springboot3.graalvmnativeapp.GraalvmNativeAppApplication (executable)<br>[INFO]     [creator]     ================================================================================<br>[INFO]     [creator]     Finished generating &#x27;com.hancher.springboot3.graalvmnativeapp.GraalvmNativeAppApplication&#x27; in 2m 34s.<br>[INFO]     [creator]       Removing bytecode<br>[INFO]     [creator]       Process types:<br>[INFO]     [creator]         native-image: ./com.hancher.springboot3.graalvmnativeapp.GraalvmNativeAppApplication (direct)<br>[INFO]     [creator]         task:         ./com.hancher.springboot3.graalvmnativeapp.GraalvmNativeAppApplication (direct)<br>[INFO]     [creator]         web:          ./com.hancher.springboot3.graalvmnativeapp.GraalvmNativeAppApplication (direct)<br>[INFO]     [creator]     ===&gt; EXPORTING<br>[INFO]     [creator]     Adding layer &#x27;paketo-buildpacks/ca-certificates:helper&#x27;<br>[INFO]     [creator]     Adding layer &#x27;paketo-buildpacks/executable-jar:classpath&#x27;<br>[INFO]     [creator]     Adding layer &#x27;buildpacksio/lifecycle:launch.sbom&#x27;<br>[INFO]     [creator]     Added 1/1 app layer(s)<br>[INFO]     [creator]     Adding layer &#x27;buildpacksio/lifecycle:launcher&#x27;<br>[INFO]     [creator]     Adding layer &#x27;buildpacksio/lifecycle:config&#x27;<br>[INFO]     [creator]     Adding layer &#x27;buildpacksio/lifecycle:process-types&#x27;<br>[INFO]     [creator]     Adding label &#x27;io.buildpacks.lifecycle.metadata&#x27;<br>[INFO]     [creator]     Adding label &#x27;io.buildpacks.build.metadata&#x27;<br>[INFO]     [creator]     Adding label &#x27;io.buildpacks.project.metadata&#x27;<br>[INFO]     [creator]     Adding label &#x27;org.opencontainers.image.title&#x27;<br>[INFO]     [creator]     Adding label &#x27;org.opencontainers.image.version&#x27;<br>[INFO]     [creator]     Adding label &#x27;org.springframework.boot.version&#x27;<br>[INFO]     [creator]     Setting default process type &#x27;web&#x27;<br>[INFO]     [creator]     Saving docker.io/library/graalvm-native-app:0.0.1-SNAPSHOT...<br>[INFO]     [creator]     *** Images (ede8e2b9d153):<br>[INFO]     [creator]           docker.io/library/graalvm-native-app:0.0.1-SNAPSHOT<br>[INFO]     [creator]     Adding cache layer &#x27;paketo-buildpacks/bellsoft-liberica:native-image-svm&#x27;<br>[INFO]     [creator]     Adding cache layer &#x27;paketo-buildpacks/syft:syft&#x27;<br>[INFO]     [creator]     Adding cache layer &#x27;paketo-buildpacks/native-image:native-image&#x27;<br>[INFO]     [creator]     Adding cache layer &#x27;buildpacksio/lifecycle:cache.sbom&#x27;<br>[INFO] <br>[INFO] Successfully built image &#x27;docker.io/library/graalvm-native-app:0.0.1-SNAPSHOT&#x27;<br>[INFO] <br>[INFO] ------------------------------------------------------------------------<br>[INFO] BUILD SUCCESS<br>[INFO] ------------------------------------------------------------------------<br>[INFO] Total time:  06:41 min<br>[INFO] Finished at: 2025-03-08T00:22:42+08:00<br>[INFO] ------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure><p>åŒæ‰“åŒ…javaæœ¬åœ°åº”ç”¨ä¸€æ ·ï¼Œæ‰“åŒ…docker é•œåƒä¹Ÿä¼šæ¯”è¾ƒæ…¢ï¼Œæ…¢æ…¢ç­‰å¾…ã€‚</p><p>è¿™é‡Œçš„æ‰“åŒ…æ…¢ï¼Œä¹Ÿæ˜¯ä¸ºäº†ä»¥åçš„appåœ¨å¯åŠ¨å’Œè¿è¡Œæ—¶é€Ÿåº¦å¿«ã€‚</p><p>æ‰“åŒ…æˆåŠŸåï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨dockeré•œåƒé‡Œçœ‹åˆ°æˆ‘ä»¬è‡ªå·±çš„åº”ç”¨é•œåƒäº†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker images<br></code></pre></td></tr></table></figure><p>è¿è¡Œdocker </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker run --<span class="hljs-built_in">rm</span> -p 8080:8080 docker.io/library/graalvm-native-app:0.0.1-SNAPSHOT<br></code></pre></td></tr></table></figure><ul><li>â€“rm å®¹å™¨ç»“æŸåä¼šè‡ªåŠ¨åˆ é™¤</li></ul><p>å®¹å™¨åœ¨0.08ç§’å°±å¯åŠ¨èµ·æ¥äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆå¿«ã€‚</p><p>éªŒè¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ curl localhost:8080/hancher<br><br>Hello hancher<br></code></pre></td></tr></table></figure><h2 id="build-image-VS-build-image-no-fork"><a href="#build-image-VS-build-image-no-fork" class="headerlink" title="build-image VS build-image-no-fork"></a>build-image VS build-image-no-fork</h2><p>springboot åœ¨æ‰“åŒ…dockeré•œåƒçš„æ—¶å€™ï¼Œæœ‰<code>build-image</code> å’Œ <code>build-image-no-fork</code>ä¸¤ç§æ¨¡å¼ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</p><h3 id="build-image"><a href="#build-image" class="headerlink" title="build-image"></a>build-image</h3><p>è¿™æ˜¯ Spring Boot Maven æ’ä»¶çš„é»˜è®¤ç›®æ ‡ï¼Œç”¨äºæ„å»ºåŸºäº Cloud Native Buildpacks çš„ Docker é•œåƒ</p><p>å…ˆè°ƒç”¨ Paketo Buildpacksï¼ˆé»˜è®¤æ„å»ºå·¥å…·ï¼‰æ¥åˆ†æé¡¹ç›®ã€ç¼–è¯‘ä»£ç å¹¶ç”Ÿæˆé•œåƒã€‚<br>ç„¶å æ‰“åŒ… JAR æ–‡ä»¶ï¼Œå†åŸºäº JAR ç”Ÿæˆé•œåƒã€‚</p><ul><li><p>æ‰§è¡Œè¿‡ç¨‹ï¼š</p><ul><li>åœ¨ç‹¬ç«‹çš„ Maven è¿›ç¨‹ï¼ˆforked processï¼‰ä¸­è¿è¡Œã€‚</li><li>ä¼šå¯åŠ¨ä¸€ä¸ªæ–°çš„ JVM å®ä¾‹æ¥æ‰§è¡Œæ„å»ºä»»åŠ¡ï¼Œä¸å½“å‰çš„ Maven æ„å»ºè¿›ç¨‹åˆ†ç¦»ã€‚</li></ul></li><li><p>ä¼˜ç‚¹</p><ul><li>éš”ç¦»æ€§å¥½ï¼Œæ„å»ºé•œåƒçš„è¿‡ç¨‹ä¸ä¼šå¹²æ‰°ä¸» Maven è¿›ç¨‹ã€‚</li><li>é€‚åˆæ ‡å‡†æ„å»ºæµç¨‹ï¼Œå°¤å…¶æ˜¯ CI&#x2F;CD ç¯å¢ƒã€‚</li></ul></li><li><p>ç¼ºç‚¹</p><ul><li>å¯åŠ¨æ–°è¿›ç¨‹ä¼šå¢åŠ å°‘é‡å¼€é”€</li></ul></li></ul><h3 id="build-image-no-fork"><a href="#build-image-no-fork" class="headerlink" title="build-image-no-fork"></a>build-image-no-fork</h3><p>åœ¨å½“å‰ Maven è¿›ç¨‹ä¸­æ„å»º Docker é•œåƒï¼Œè€Œä¸å¯åŠ¨æ–°çš„å­è¿›ç¨‹ï¼Œè¿™æ ·è™½ç„¶ä¼šä¸å…¶ä»–æ“ä½œå†²çªï¼Œä½†ä¼šæ›´å¿«ï¼Œé€‚åˆæœ¬åœ°å¼€å‘æ—¶ä½¿ç”¨ï¼ˆæ²¡æœ‰å¹¶å‘ï¼‰ã€‚</p><ul><li><p>æ‰§è¡Œè¿‡ç¨‹ï¼š</p><ul><li>åœ¨å½“å‰ JVM å®ä¾‹å†…ç›´æ¥æ‰§è¡Œé•œåƒæ„å»ºä»»åŠ¡ï¼Œä¸è¿›è¡Œ fork</li></ul></li><li><p>ä¼˜ç‚¹</p><ul><li>å‡å°‘è¿›ç¨‹åˆ›å»ºçš„å¼€é”€ï¼Œæ„å»ºé€Ÿåº¦å¯èƒ½ç•¥å¿«ï¼ˆå°¤å…¶åœ¨å°å‹é¡¹ç›®ä¸­ï¼‰</li><li>æ›´é€‚åˆè°ƒè¯•æˆ–æœ¬åœ°å¼€å‘ï¼Œå› ä¸ºå®ƒä¸å½“å‰ Maven ä¸Šä¸‹æ–‡ç´§å¯†è€¦åˆã€‚</li></ul></li><li><p>ç¼ºç‚¹</p><ul><li>å¦‚æœæ„å»ºè¿‡ç¨‹ä¸­å‡ºç°é—®é¢˜ï¼ˆä¾‹å¦‚å†…å­˜ä¸è¶³ã€å¼‚å¸¸ï¼‰ï¼Œå¯èƒ½ä¼šå½±å“æ•´ä¸ª Maven æ„å»ºæµç¨‹</li><li>å› ä¸ºæ²¡æœ‰è¿›ç¨‹éš”ç¦»çš„åŸå› ï¼Œå¯èƒ½å¯¼è‡´èµ„æºç«äº‰æˆ–é…ç½®å†²çª</li></ul></li></ul><p>ä¸»è¦åŒºåˆ«</p><table><thead><tr><th>ç‰¹æ€§</th><th><code>build-image</code></th><th><code>build-image-no-fork</code></th></tr></thead><tbody><tr><td><strong>æ‰§è¡Œè¿›ç¨‹</strong></td><td>æ–°å»ºç‹¬ç«‹è¿›ç¨‹ï¼ˆforkedï¼‰</td><td>å½“å‰è¿›ç¨‹ï¼ˆno forkï¼‰</td></tr><tr><td><strong>éš”ç¦»æ€§</strong></td><td>é«˜ï¼Œç‹¬ç«‹äºä¸» Maven è¿›ç¨‹</td><td>ä½ï¼Œä¸ä¸» Maven è¿›ç¨‹å…±äº«ç¯å¢ƒ</td></tr><tr><td><strong>æ€§èƒ½å¼€é”€</strong></td><td>ç•¥é«˜ï¼ˆå¯åŠ¨æ–° JVMï¼‰</td><td>ç•¥ä½ï¼ˆæ— éœ€æ–°è¿›ç¨‹ï¼‰</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>CI&#x2F;CDã€æ ‡å‡†æ„å»º</td><td>æœ¬åœ°è°ƒè¯•ã€å°å‹é¡¹ç›®</td></tr><tr><td><strong>ç¨³å®šæ€§</strong></td><td>æ›´ç¨³å®šï¼ˆéš”ç¦»é—®é¢˜ï¼‰</td><td>å¯èƒ½å—ä¸»è¿›ç¨‹å½±å“</td></tr></tbody></table><p>ä½ å­¦åºŸäº†å—ï¼Ÿ</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://docs.spring.io/spring-boot/how-to/native-image/developing-your-first-application.html#howto.native-image.developing-your-first-application.native-build-tools">ä½¿ç”¨GraalVMæ‰“åŒ…ç³»ç»Ÿå¯æ‰§è¡Œç¨‹åº</a></p><p><a href="https://github.com/Hanchers/springboot3-demo/tree/main/graalvm-native-app">github demo</a></p><p><a href="https://docs.spring.io/spring-boot/maven-plugin/build-image.html">springbootæ‰“åŒ…dockeré•œåƒé…ç½®</a></p>]]></content>
    
    
    <categories>
      
      <category>spring</category>
      
      <category>springboot</category>
      
    </categories>
    
    
    <tags>
      
      <tag>docker</tag>
      
      <tag>spring</tag>
      
      <tag>springboot3.x</tag>
      
      <tag>native-image</tag>
      
      <tag>GraalVM</tag>
      
      <tag>native-application</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>springbootå¯ä»¥æŠŠé¡¹ç›®æ‰“åŒ…æˆappäº†ï¼ŒGraalæ‰“åŒ…ç‰ˆ</title>
    <link href="/2025/03/04/spring-spring-native-image-graalvm/"/>
    <url>/2025/03/04/spring-spring-native-image-graalvm/</url>
    
    <content type="html"><![CDATA[<p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œåœ¨javaçš„ä¸–ç•Œï¼Œæœ‰ä¸€ä¸ªç¥å¥‡çš„å­˜åœ¨ï¼Œé‚£å°±æ˜¯è™šæ‹Ÿæœºï¼ˆjvmï¼‰ã€‚</p><p>å› ä¸ºè™šæ‹Ÿæœºçš„å­˜åœ¨ï¼Œjavaå®ç°äº†æœ€æ—©çš„â€œä¸€å¤„ç¼–è¯‘ï¼Œå¤„å¤„æ‰§è¡Œâ€çš„è®¾è®¡æ€æƒ³ï¼ŒæˆåŠŸåœ¨æ—©æœŸçš„å„å¤§è¯­è¨€çš„ç«äº‰ä¸­è„±é¢–è€Œå‡ºï¼Œå¹¶åœ¨å„ç§åèµ·ä¹‹ç§€çš„å†²å‡»ä¸‹ï¼Œé•¿æœŸä¿æŒæœ€å—æ¬¢è¿çš„ç¼–ç¨‹è¯­è¨€çš„å¤´éƒ¨åŒºåŸŸã€‚</p><p>å®åœ¨æ˜¯å¤ªæ–¹ä¾¿äº†ï¼Œåªè¦æœ‰è™šæ‹Ÿæœºçš„å­˜åœ¨ï¼Œæˆ‘ä»¬åœ¨ç¼–ç¨‹çš„æ—¶å€™å°±ä¸ç”¨è€ƒè™‘å„ç§è¿è¡Œç³»ç»Ÿçš„å¤æ‚æ€§ä¸å·®å¼‚ï¼Œè¿™äº›ç”±å„ç§ç³»ç»Ÿçš„è™šæ‹Ÿæœºå¼€å‘ä¸“å®¶ä»¬æ›¿æˆ‘ä»¬è§£å†³äº†ï¼Œè€Œæˆ‘ä»¬ä»…éœ€è¦å…³æ³¨ç¼–ç å°±è¡Œäº†ã€‚</p><p>ä½†è¿›å…¥äº†21æ—¶é—´ï¼Œäº‘åŸç”Ÿçš„å…´èµ·ï¼Œjavaçš„æœ€å¤§çš„ä¼˜åŠ¿è™šæ‹Ÿæœºï¼Œä¹Ÿæ¸æ¸é˜»ç¢äº†å…¶åœ¨äº‘ä¸Šå¼€ç–†æ‰©åœŸçš„é˜»åŠ›ã€‚</p><p>â€œå†…å­˜å ç”¨é«˜â€ã€â€œSTWâ€ ã€ â€œå¯åŠ¨é€Ÿåº¦æ…¢â€ç­‰ä¸€äº›è™šæ‹Ÿæœºçš„å›ºæœ‰ç‰¹æ€§ï¼Œå¯¼è‡´javaåœ¨goç­‰è¿™äº›ä¸ºäº‘è€Œè®¾è®¡çš„è¯­è¨€é¢å‰å°½æ˜¾é¢“åŠ¿ã€‚</p><p>æ‰€ä»¥ï¼Œjavaèƒ½ä¸èƒ½è·³è¿‡è™šæ‹Ÿæœºï¼Œç›´æ¥æŠŠç¨‹åºç¼–è¯‘æ‰“åŒ…æˆå¯ä»¥ç›´æ¥åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œçš„å‘¢ï¼Ÿ</p><p>è¯´å®è¯ï¼Œåˆšå¼€å§‹å­¦ä¹ javaçš„æ—¶å€™ï¼Œæˆ‘å°±æœ‰è¿™ä¸ªç–‘é—®ï¼Œä¸ºäº†æŠŠjavaçš„å¯æ‰§è¡Œç¨‹åºï¼ˆjarï¼‰æ‰“åŒ…æˆå¯ä»¥åœ¨windowsä¸Šè¿è¡Œçš„exeç¨‹åºï¼Œå½“æ—¶è¿˜æè¿‡å¾ˆå¤šåé—¨çš„çš„åŠæ³•ã€‚</p><p>ç°åœ¨ï¼Œéšç€GraalVMçš„æˆç†Ÿï¼Œspringbootçš„ä¹Ÿæå‡ºäº†ç›´æ¥å°†javaç¨‹åºç›´æ¥æ‰“åŒ…æˆç³»ç»Ÿå¯æ‰§è¡Œç¨‹åºï¼ˆæœ¬åœ°åº”ç”¨ï¼‰çš„æŠ€æœ¯æ–¹æ¡ˆã€‚</p><p><img src="/../../images/tech/spring/spring_native_app_graalvm.png" alt="javaæœ¬åœ°appéƒ¨ç½²æ¶æ„"></p><p>ä»Šå¤©æˆ‘ä»¬å°±æ¥éªŒè¯ä¸€ä¸‹ï¼</p><h2 id="å®ç°è¿‡ç¨‹"><a href="#å®ç°è¿‡ç¨‹" class="headerlink" title="å®ç°è¿‡ç¨‹"></a>å®ç°è¿‡ç¨‹</h2><h3 id="hello-world"><a href="#hello-world" class="headerlink" title="hello world"></a>hello world</h3><p>å…ˆå†™ä¸€å¥—<code>hello world</code>çš„springbootç¨‹åºï¼Œä½¿ç”¨mavenæˆ–gradleæ‰“åŒ…ã€‚</p><p>è¿™é‡Œå’Œæˆ‘ä»¬æ­£å¸¸çš„é¡¹ç›®å¼€å‘æµç¨‹å®Œæˆä¸€è‡´ï¼Œæ²¡æœ‰ä»»ä½•ä¸åŒã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GraalvmNativeAppApplication</span> &#123;<br><br><span class="hljs-meta">@RequestMapping(&quot;/&#123;name&#125;&quot;)</span><br>String <span class="hljs-title function_">home</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> String name)</span> &#123;<br><span class="hljs-type">String</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Hello &quot;</span> + name;<br>System.out.println(x);<br><span class="hljs-keyword">return</span> x;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>SpringApplication.run(GraalvmNativeAppApplication.class, args);<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ˜¯è¿™ä¸ªé¡¹ç›®çš„ä¸šåŠ¡ä»£ç ï¼Œæ²¡æœ‰å…¶ä»–çš„äº†ã€‚</p><h3 id="é…ç½®GraalVM"><a href="#é…ç½®GraalVM" class="headerlink" title="é…ç½®GraalVM"></a>é…ç½®GraalVM</h3><p>åœ¨<code>pom.xml</code>é‡Œé…ç½®GraalVM æœ¬åœ°åº”ç”¨æ‰“åŒ…æ’ä»¶,è¿™æ˜¯æˆ‘ä»¬çš„springbootç¨‹åºèƒ½å¤Ÿæ‰“åŒ…æˆæœ¬åœ°åº”ç”¨çš„æ ¸å¿ƒå…¥å£ï¼Œä¸€å®šè¦æœ‰ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.graalvm.buildtools<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>native-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å…¶ä»–çš„ï¼Œé¡¹ç›®é‡Œå°±ä¸éœ€è¦äº†ã€‚</p><p>ä¹Ÿå¯ä»¥é€šè¿‡<a href="https://start.spring.io/">start.spring.io</a>æ¥æ„å»ºé¡¹ç›®ï¼Œspringä¼šæŠŠä¸€åˆ‡é…ç½®å¥½,è®°å¾—çœ‹æ„æ¶å¥½åçš„<code>HELP.MD</code>æ–‡ä»¶å‘¦ã€‚<br><img src="/../../images/tech/spring/start-springboot-graalvm.png" alt="springbootåˆå§‹åŒ–æ—¶é…ç½®graalvm"></p><h3 id="ç¯å¢ƒä¾èµ–"><a href="#ç¯å¢ƒä¾èµ–" class="headerlink" title="ç¯å¢ƒä¾èµ–"></a>ç¯å¢ƒä¾èµ–</h3><p>æ¥ä¸‹æ¥å°±æ˜¯è¦é…ç½®ä¸€ä¸‹ç³»ç»Ÿç¯å¢ƒäº†ã€‚</p><p>è¦å°†é¡¹ç›®æ‰“åŒ…æˆç³»ç»ŸåŸç”Ÿè¿è¡Œåº”ç”¨ï¼Œéœ€è¦åœ¨æˆ‘ä»¬çš„ç³»ç»Ÿé‡Œå®‰è£…ä¸€å¥—æœ¬åœ°é•œåƒæ”¯æŒåº“(<a href="https://bell-sw.com/pages/downloads/native-image-kit/#nik-23-(jdk-17)">Liberica Native Image Kit page</a>),è¿™ä¸ªnikåº“å®ç°äº†å°†javaå­—èŠ‚ç ç¼–è¯‘æˆæ“ä½œç³»ç»ŸäºŒè¿›åˆ¶æ‰§è¡Œç è¿™ä¸€è¿‡ç¨‹ã€‚</p><p>å®‰è£…nikåŒ…å¯ä»¥æ‰‹åŠ¨å®‰è£…ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<a href="https://sdkman.io/install">sdk</a>ç‰ˆæœ¬æ§åˆ¶å·¥å…·æ¥å®‰è£…, è¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯è¿™ç§æ–¹å¼ï¼ˆæˆ‘ä½¿ç”¨çš„æ˜¯macç”µè„‘ï¼‰ã€‚</p><p>ä½¿ç”¨sdkå®‰è£…java nik çš„å‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sdk install 23.0.7.r17-nik<br></code></pre></td></tr></table></figure><p>å®‰è£…å®Œæˆåï¼Œç³»ç»Ÿå°±è‡ªåŠ¨å°†å½“å‰çš„jdkåˆ‡æ¢æˆåˆšä¸‹è½½çš„è¿™ä¸ªjdkäº†ã€‚</p><p>å¯ä»¥åœ¨<a href="https://sdkman.io/jdks/nik">å®˜æ–¹é…ç½®</a>è¿™é‡ŒæŸ¥çœ‹å®‰è£…å¯¹åº”jdkçš„å‘½ä»¤ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">% java --version<br><br>openjdk 17.0.14 2025-01-21 LTS<br>OpenJDK Runtime Environment Liberica-NIK-23.0.7-1 (build 17.0.14+10-LTS)<br>OpenJDK 64-Bit Server VM Liberica-NIK-23.0.7-1 (build 17.0.14+10-LTS, mixed mode, sharing)<br></code></pre></td></tr></table></figure><p>å‡ºç°è¿™ä¸ªä¿¡æ¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰“åŒ…äº†ã€‚</p><h3 id="æ‰“åŒ…"><a href="#æ‰“åŒ…" class="headerlink" title="æ‰“åŒ…"></a>æ‰“åŒ…</h3><p>å‘½ä»¤è¡Œè¾“å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mvn -Pnative native:compile<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå‘½ä»¤ä¼šè§¦å‘<code>native-maven-plugin</code>mavenæ’ä»¶ï¼Œæ‰§è¡Œæœ¬åœ°æ‰“åŒ…appã€‚</p><p>è¿™ä¸ªè¿‡ç¨‹ä¼šå¾ˆæ…¢ï¼Œè€Œä¸”ä¼šå¾ˆè€—cpuï¼Œæˆ‘çš„ç”µè„‘cpuåŸºæœ¬éƒ½è·‘æ»¡äº†ï¼Œç°åœ¨ç»ˆäºç†è§£ï¼Œé‚£äº›cç¨‹åºå‘˜ä»¬åœ¨ç¼–è¯‘é¡¹ç›®æ—¶ä¼šå»æŠ½çƒŸäº†ï¼Œç¡®å®è¿™æ®µæ—¶é—´å•¥ä¹Ÿå¹²ä¸äº†ã€‚</p><p>æ‰§è¡Œè¿‡ç¨‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs log">...<br>[1/8] Initializing...                                                                                    (3.9s @ 0.14GB)<br> Java version: 17.0.14+10-LTS, vendor version: Liberica-NIK-23.0.7-1<br> Graal compiler: optimization level: 2, target machine: armv8-a<br> C compiler: cc (apple, arm64, 15.0.0)<br> Garbage collector: Serial GC (max heap size: 80% of RAM)<br> 1 user-specific feature(s)<br> - org.springframework.aot.nativex.feature.PreComputeFieldFeature<br>SLF4J(W): No SLF4J providers were found.<br>SLF4J(W): Defaulting to no-operation (NOP) logger implementation<br>SLF4J(W): See https://www.slf4j.org/codes.html#noProviders for further details.<br>[2/8] Performing analysis...  [******]                                                                  (35.5s @ 1.50GB)<br>  16,529 (90.73%) of 18,218 types reachable<br>  27,176 (67.68%) of 40,151 fields reachable<br>  79,715 (63.21%) of 126,116 methods reachable<br>   5,144 types,   357 fields, and 5,957 methods registered for reflection<br>      64 types,    72 fields, and    55 methods registered for JNI access<br>       5 native libraries: -framework CoreServices, -framework Foundation, dl, pthread, z<br>[3/8] Building universe...                                                                               (3.9s @ 1.59GB)<br>[4/8] Parsing methods...      [**]                                                                       (2.7s @ 1.79GB)<br>[5/8] Inlining methods...     [****]                                                                     (1.6s @ 1.95GB)<br>[6/8] Compiling methods...    [*****]                                                                   (23.4s @ 1.61GB)<br>[7/8] Layouting methods...    [**]                                                                       (4.5s @ 1.70GB)<br>[8/8] Creating image...       [***]                                                                      (7.9s @ 1.29GB)<br>  36.95MB (50.32%) for code area:    51,915 compilation units<br>  35.50MB (48.34%) for image heap:  386,138 objects and 253 resources<br>1006.98kB ( 1.34%) for other data<br>  73.44MB in total<br>------------------------------------------------------------------------------------------------------------------------<br>Top 10 origins of code area:                                Top 10 object types in image heap:<br>  12.68MB java.base                                            8.53MB byte[] for code metadata<br>   4.24MB tomcat-embed-core-10.1.36.jar                        3.95MB java.lang.Class<br>   3.38MB java.xml                                             3.68MB java.lang.String<br>   2.00MB jackson-databind-2.18.2.jar                          3.30MB byte[] for java.lang.String<br>   1.58MB spring-core-6.2.3.jar                                3.23MB byte[] for general heap data<br>   1.54MB spring-boot-3.4.3.jar                                2.11MB byte[] for embedded resources<br>   1.29MB svm.jar (Native Image)                               1.39MB com.oracle.svm.core.hub.DynamicHubCompanion<br> 983.58kB spring-web-6.2.3.jar                                 1.01MB byte[] for reflection metadata<br> 910.85kB spring-beans-6.2.3.jar                             741.69kB java.lang.String[]<br> 876.34kB spring-webmvc-6.2.3.jar                            597.07kB c.o.svm.core.hub.DynamicHub$ReflectionMetadata<br>   7.23MB for 69 more packages                                 6.15MB for 3522 more object types<br>------------------------------------------------------------------------------------------------------------------------<br>Recommendations:<br> HEAP: Set max heap for improved and more predictable memory usage.<br> CPU:  Enable more CPU features with &#x27;-march=native&#x27; for improved performance.<br>------------------------------------------------------------------------------------------------------------------------<br>                       10.3s (12.1% of total time) in 171 GCs | Peak RSS: 2.64GB | CPU load: 5.10<br>------------------------------------------------------------------------------------------------------------------------<br>Produced artifacts:<br> ../springboot3-demo/graalvm-native-app/target/graalvm-native-app (executable)<br>========================================================================================================================<br>Finished generating &#x27;graalvm-native-app&#x27; in 1m 24s.<br>[INFO] ------------------------------------------------------------------------<br>[INFO] BUILD SUCCESS<br>[INFO] ------------------------------------------------------------------------<br>[INFO] Total time:  01:38 min<br>[INFO] Finished at: 2025-03-03T16:41:31+08:00<br>[INFO] ------------------------------------------------------------------------<br><br></code></pre></td></tr></table></figure><p>è¿è¡Œapp</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./graalvm-native-app<br></code></pre></td></tr></table></figure><p>éªŒè¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ curl localhost:8080/hancher<br><br>Hello hancher<br></code></pre></td></tr></table></figure><h2 id="ä¼˜ç¼ºç‚¹"><a href="#ä¼˜ç¼ºç‚¹" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h2><p>å…ˆè¯´ä¼˜ç‚¹</p><ul><li>å»æ‰äº†jvmè¿™ä¸€å±‚ï¼Œéƒ¨ç½²æ›´åŠ ç®€å•æ–¹ä¾¿äº†</li><li>é€šè¿‡appè¿™ç§å½¢å¼ï¼ŒåŸç”Ÿçº§åˆ«æ”¯æŒäº†windowsã€macã€linuxç­‰ä¸»æµæ“ä½œç³»ç»Ÿ</li><li>å¯åŠ¨æ›´å¿«ï¼Œå› ä¸ºä»£ç éƒ½ç¼–è¯‘æˆç³»ç»Ÿç›´æ¥è¿è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸éœ€è¦jvmçš„è§£æ<ul><li>ä¸Šé¢çš„helloWorldï¼Œä½¿ç”¨jarå¯åŠ¨ï¼Œè€—æ—¶0.9sï¼Œä½¿ç”¨appå¯åŠ¨ï¼Œè€—æ—¶0.18ç§’ï¼Œå°†è¿‘5å€çš„å·®è·ã€‚</li></ul></li><li>è¿è¡Œæ—¶å ç”¨å†…å­˜æ›´ä½ï¼Œæ®ç»Ÿè®¡ï¼Œèƒ½å‡å°‘50%å·¦å³</li></ul><p>å†è¯´ç¼ºç‚¹</p><ul><li>æ‰“åŒ…å¾ˆæ…¢,ä¼šå ç”¨å¾ˆé«˜çš„å†…å­˜å’Œcpu</li><li>å¯¹äºåå°„ç­‰åŠ¨æ€ç‰¹æ€§æ”¯æŒçš„ä¸å¥½ï¼Œæ¯”å¦‚<code>Class.forName()</code>, æ‰€ä»¥ä»…é€‚ç”¨äºä¸€äº›ç®€æ˜“é¡¹ç›®ï¼Œé‡é‡çº§é¡¹ç›®ç°é˜¶æ®µè¿˜ä¸å¤ªæ”¯æŒ</li><li>ä¸€ä¸ªç³»ç»Ÿä»…èƒ½æ‰“åŒ…æœ¬ç³»ç»Ÿçš„appï¼Œä¸åƒgoé‚£æ ·ï¼Œä¸€ä¸ªç³»ç»Ÿèƒ½æ‰“åŒ…æ‰€æœ‰å¹³å°çš„appã€‚</li><li>åŒ…ä½“ç§¯æ¯”åŸç”Ÿçš„jarå¤§äº†ä¸å°‘<ul><li>ä¸Šé¢çš„helloWorldï¼Œjarå¤§å°ç©ºé—´20Mï¼Œappå¤§å°73Mï¼Œ å¤§äº†3å€</li><li>ä½†å¦‚æœç®—ä¸Šjdkï¼Œ æˆ‘ç»Ÿè®¡äº†æˆ‘å®‰è£…åçš„jdk17å¤§å°300Mï¼Œå†åŠ ä¸Šjarï¼Œ ä½¿ç”¨jarçš„æ€»ä½“ç©ºé—´æ¯”appå¤§äº†è¿‘5å€</li></ul></li></ul><p>æ€»å¾—æ¥è¯´ï¼Œjavaåœ¨ç¼–è¯‘æˆæœ¬åœ°appè¿™ä¸€å—ï¼Œè¿˜æœ‰å¾ˆå¤§çš„ç©ºé—´ï¼Œä½†å·²ç»å®Œæˆäº†ä»0åˆ°1çš„è¿›æ­¥ï¼Œæ›´é€‚åˆäº‘åŸç”Ÿäº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯ä¸æ–­çš„ä¼˜åŒ–äº†ã€‚</p><p>é€‚ç”¨çš„åœºæ™¯ï¼š</p><ul><li>æ–°é¡¹ç›®ï¼Œè½»é‡çº§é¡¹ç›®ã€‚è€é¡¹ç›®ä¸å¤ªå»ºè®®ä½¿ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œå› ä¸ºåŠ¨æ€ç‰¹æ€§çš„é™åˆ¶ï¼Œå¯èƒ½ä¼šæœ‰ä¸€äº›åŠŸèƒ½éªŒè¯ä¸åˆ°</li><li>ç±»ä¼¼äº‘åŸç”Ÿçš„Serverlessæ¶æ„ï¼Œé€»è¾‘ç®€å•ï¼Œæ›´å¼ºè°ƒå¯åŠ¨é€Ÿåº¦ä¸å†…å­˜å æ¯”çš„æœåŠ¡</li><li>å®¹å™¨åŒ–éƒ¨ç½²çš„å¾®æœåŠ¡ç­‰ï¼ˆnative app æœ‰å®¹å™¨ç‰ˆï¼Œä¸‹ç¯‡æ–‡ç« ä»‹ç»ï¼‰</li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://docs.spring.io/spring-boot/how-to/native-image/developing-your-first-application.html#howto.native-image.developing-your-first-application.native-build-tools">ä½¿ç”¨GraalVMæ‰“åŒ…ç³»ç»Ÿå¯æ‰§è¡Œç¨‹åº</a></p><p><a href="https://github.com/Hanchers/springboot3-demo/tree/main/graalvm-native-app">github demo</a></p>]]></content>
    
    
    <categories>
      
      <category>spring</category>
      
      <category>springboot</category>
      
    </categories>
    
    
    <tags>
      
      <tag>springboot3.x</tag>
      
      <tag>native-image</tag>
      
      <tag>GraalVM</tag>
      
      <tag>native-application</tag>
      
      <tag>spring6</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é€šè¿‡ä¼˜åŒ–robotçš„æ–¹å¼ï¼ŒåŠ é€Ÿè°·æ­Œæ”¶å½•æˆ‘ä»¬çš„ç½‘ç«™</title>
    <link href="/2025/02/25/site-google-optimize-robot/"/>
    <url>/2025/02/25/site-google-optimize-robot/</url>
    
    <content type="html"><![CDATA[<p>å‰æ®µæ—¶é—´ä¸æ˜¯è®²è¿™ä¸ªåšå®¢ç½‘ç«™å½•å…¥åˆ°googleçš„google search console ç«™ç‚¹äº†å—ï¼Œ ç°åœ¨é€šè¿‡<code>site:www.hancher.top</code>ç¡®å®èƒ½çœ‹åˆ°æˆ‘çš„ç½‘ç«™äº†ã€‚</p><p>ä½†æ˜¯ï¼Œæˆ‘å‘ç°ï¼Œæˆ‘çš„æ–°å†…å®¹ï¼Œgoogleæ”¶å½•çš„å¾ˆæ…¢ï¼Œå³ä½¿å¢åŠ äº†ä¸»åŠ¨æäº¤urlçš„åŠŸèƒ½ï¼Œä¹Ÿè¿˜æ˜¯å¾ˆæ…¢ã€‚</p><h2 id="é—®é¢˜ä¸è§£å†³"><a href="#é—®é¢˜ä¸è§£å†³" class="headerlink" title="é—®é¢˜ä¸è§£å†³"></a>é—®é¢˜ä¸è§£å†³</h2><p>ç„¶åæˆ‘åœ¨æŸ¥çœ‹googleç«™ç‚¹åå°çš„æ—¶å€™ï¼Œå‘ç°æˆ‘ä»¬æ˜¯èƒ½çœ‹åˆ°googleçš„çˆ¬è™«çˆ¬å–æˆ‘ä»¬ç½‘ç«™çš„è®°å½•çš„ã€‚</p><p>ä½ç½®ï¼šè®¾ç½® -&gt; æŠ“å–ç»Ÿè®¡ä¿¡æ¯(æ‰“å¼€æŠ¥å‘Š) -&gt; æŒ‰å“åº”ç»Ÿè®¡ -&gt; æˆåŠŸ(200) ï¼Œ ç„¶åå°±èƒ½çœ‹åˆ°çˆ¬è™«çˆ¬å–æˆ‘ä»¬ç½‘ç«™çš„è®°å½•äº†ã€‚</p><p>ç»“æœæˆ‘å‘ç°ï¼Œè°·æ­Œçˆ¬å–æˆ‘ä»¬ç½‘ç«™ï¼Œæ¯å¤©åªæœ‰ä¸€å®šçš„æ¬¡æ•°ï¼ˆ3-20æ¬¡å·¦å³ï¼‰ï¼Œè€Œå…¶ä¸­å¤§éƒ¨åˆ†æ¬¡æ•°éƒ½è¢«js,css,å›¾ç‰‡ç­‰å†…å®¹å ç”¨äº†ï¼Œå¯¼è‡´æˆ‘ä»¬æ–°å†…å®¹ï¼Œgoogleçˆ¬å–ä¸åˆ°ã€‚</p><p><img src="/../../images/site/seo/google_url_crawl.png" alt="è°·æ­Œæ¯å¤©çš„çˆ¬å–é“¾æ¥æƒ…å†µ"></p><p>ä»”ç»†åˆ†æå°±èƒ½å‘ç°ï¼Œé™¤äº†2æœˆ21æ—¥çš„é‚£ä¸€å¤©çˆ¬åˆ°äº†æˆ‘çš„æ–‡ç« å¤–ï¼Œå…¶ä»–çš„çˆ¬å–çš„éƒ½æ˜¯js,css,å›¾ç‰‡ç­‰æ— æ•ˆå†…å®¹ï¼Œä¸¥é‡å¹²æ‰°äº†è°·æ­Œå¯¹æˆ‘ä»¬æ–‡ç« çš„æ”¶å½•ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦é€šè¿‡<code>robots.txt</code>çš„æ–¹å¼ï¼Œå‘Šè¯‰googleï¼Œå“ªäº›å†…å®¹èƒ½çˆ¬ï¼Œå“ªäº›å†…å®¹ä¸çˆ¬ï¼Œæ¥æå‡googleå¯¹æˆ‘ä»¬æ–‡ç« çš„æ”¶å½•æ•ˆç‡ã€‚</p><blockquote><p>robots.txt æ–‡ä»¶è§„å®šäº†æœç´¢å¼•æ“æŠ“å–å·¥å…·å¯ä»¥è®¿é—®æ‚¨ç½‘ç«™ä¸Šçš„å“ªäº›ç½‘å€ã€‚ æ­¤æ–‡ä»¶ä¸»è¦ç”¨äºé¿å…æ‚¨çš„ç½‘ç«™æ”¶åˆ°è¿‡å¤šè¯·æ±‚</p></blockquote><p>ä¸‹é¢æ˜¯æˆ‘çš„ä¼˜åŒ–åçš„robots.txté…ç½®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs robots.txt">User-agent: *<br>Disallow: /*.js$<br>Disallow: /*.css$<br><br>Sitemap: https://www.hancher.top/sitemap.xml<br></code></pre></td></tr></table></figure><p>æ³¨æ„ï¼ŒæŒ‰ç…§è°·æ­Œå®˜æ–¹çš„è¯´æ³•ï¼Œjsç­‰ä¹Ÿæ˜¯ä¸€ä¸ªç½‘é¡µçš„é‡è¦ç»„æˆéƒ¨åˆ†, å¦‚éå¿…è¦ï¼Œå»ºè®®ä¸è¦ç¦æ­¢jsçš„çˆ¬å–ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œçš„é…ç½®æ˜¯ä¸€ä¸ªä¸´æ—¶ä¸¾æªï¼Œç­‰googleå°†æˆ‘ä»¬çš„ç½‘ç«™å†…å®¹å…¨éƒ¨æ”¶å½•åï¼Œå¯ä»¥å†æŠŠjsç­‰å†…å®¹æ”¾å¼€ã€‚</p><p><img src="/../../images/site/seo/google_crawl_js.png" alt="JavaScript SEO åŸºç¡€çŸ¥è¯†"></p><p>å¯¹äº†ï¼Œrobots.txtæ–‡ä»¶æ›´æ–°åï¼Œè¦è®°å¾—åˆ°è°·æ­Œå®˜ç½‘æäº¤ä¸€ä¸‹ï¼Œå¦åˆ™googleä¸ä¼šåŠæ—¶æ›´æ–°ã€‚<br><img src="/../../images/site/seo/google-sitemap-add.png" alt="é‡æ–°æ·»åŠ ç½‘ç«™åœ°å›¾"></p><p>æ›´æ–°robotsçš„çˆ¬è™«æ•ˆæœï¼š<br><img src="/../../images/site/seo/google-crawl-no-js.png" alt="åªçˆ¬æ–‡ç« "></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://developers.google.com/search/docs/crawling-indexing/robots/create-robots-txt?hl=zh-cn">å¦‚ä½•ç¼–å†™å’Œæäº¤ robots.txt æ–‡ä»¶</a></p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç«™</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å»ºç«™</tag>
      
      <tag>seo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>spring6 restClientå¦‚ä½•æ‰“å°è¯·æ±‚å’Œå“åº”æ—¥å¿—</title>
    <link href="/2025/02/25/spring-spring6-http-interface-log/"/>
    <url>/2025/02/25/spring-spring6-http-interface-log/</url>
    
    <content type="html"><![CDATA[<p>åœ¨é¡¹ç›®å‡çº§åˆ°springboot3.xåï¼Œå®˜æ–¹æä¾›çš„RestClientå®¢æˆ·ç«¯æ˜¯å¿…é¡»ä½“éªŒçš„ã€‚</p><p>é‚£ä¹ˆï¼Œåœ¨å®é™…ç”Ÿäº§ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ä¸€ç§æƒ…å†µï¼Œå°±è¡Œå¸Œæœ›åœ¨æ—¥å¿—é‡Œæ‰“å°æˆ‘ä»¬å¯¹ç¬¬ä¸‰æ–¹æ¥å£çš„è¯·æ±‚å‚æ•°å’Œè¿”å›å€¼ï¼Œä»¥ä¾¿æˆ‘ä»¬æ›´å¥½çš„è°ƒå‚å’Œå®šä½é—®é¢˜ï¼Œé‚£ä¹ˆï¼Œæœ¬æ–‡å°±è®©æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹ï¼Œå¦‚ä½•ä½¿ç”¨æœ€æ–°çš„spring6 restClientæ‰“å°è¯·æ±‚å’Œå“åº”æ—¥å¿—ã€‚</p><p>å…¶å®ï¼Œå’Œspringboot2.xæ—¶ä»£ï¼Œå®ç°æ–¹æ¡ˆä¸€æ ·ï¼Œè¿˜æ˜¯é€šè¿‡springçš„<code>ClientHttpRequestInterceptor</code>æ‰©å±•ç‚¹æ¥å®ç°ã€‚</p><p><code>ClientHttpRequestInterceptor</code>æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œå¾ˆç®€å•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">ClientHttpResponse <span class="hljs-title function_">intercept</span><span class="hljs-params">(HttpRequest request, <span class="hljs-type">byte</span>[] body, ClientHttpRequestExecution execution)</span> <span class="hljs-keyword">throws</span> IOException;<br></code></pre></td></tr></table></figure><p>å…¶å¯ä»¥æ‹¦æˆªRestClientå¯¹å¤–è¯·æ±‚çš„requestè¯·æ±‚ä½“ï¼Œbodyå‚æ•°ï¼Œä»¥åŠå‘ç”Ÿçš„å¼‚å¸¸ï¼ŒåŒæ—¶è¿˜èƒ½æ‹¦æˆªè¿”å›çš„Responseç»“æœã€‚</p><p>æ‰€ä»¥ï¼Œå®ç°äº†è¿™ä¸ªæ¥å£ï¼Œæˆ‘ä»¬å°±å¯ä»¥åŒæ—¶è·å¾—è¯·æ±‚å®é™…å‘ç”Ÿæ—¶çš„å‚æ•°æƒ…å†µå’Œç»“æœå€¼äº†ï¼Œæ‰“å°æ—¥å¿—çš„åŠŸèƒ½ä¹Ÿå°±æœ‰äº†ã€‚</p><p>show code:</p><p>æ‰“å°æ—¥å¿—çš„å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LoggingRequestInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ClientHttpRequestInterceptor</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(LoggingRequestInterceptor.class);<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> ClientHttpResponse <span class="hljs-title function_">intercept</span><span class="hljs-params">(HttpRequest request, <span class="hljs-type">byte</span>[] body, ClientHttpRequestExecution execution)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-comment">// æ‰“å°è¯·æ±‚ä¿¡æ¯</span><br>        logRequest(request, body);<br>        <span class="hljs-comment">// æ‰§è¡Œè¯·æ±‚</span><br>        <span class="hljs-type">ClientHttpResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RepeatReadClientHttpRequestWrapper</span>(execution.execute(request, body));<br>        <span class="hljs-comment">// æ‰“å°å“åº”ä¿¡æ¯</span><br>        logResponse(response);<br>        <span class="hljs-keyword">return</span> response;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">logRequest</span><span class="hljs-params">(HttpRequest request, <span class="hljs-type">byte</span>[] body)</span> &#123;<br>        logger.debug(<span class="hljs-string">&quot;Request URI: &#123;&#125; &#123;&#125;&quot;</span>,request.getMethod(), request.getURI());<br>        logger.debug(<span class="hljs-string">&quot;Request Headers: &#123;&#125;&quot;</span>, request.getHeaders());<br>        <span class="hljs-keyword">if</span> (body.length &gt; <span class="hljs-number">0</span>) &#123;<br>            logger.debug(<span class="hljs-string">&quot;Request Body: &#123;&#125;&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(body, StandardCharsets.UTF_8));<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">logResponse</span><span class="hljs-params">(ClientHttpResponse response)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        logger.debug(<span class="hljs-string">&quot;Response  Code: &#123;&#125; , Headers: &#123;&#125;&quot;</span>, response.getStatusCode(),response.getHeaders());<br><br>        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">responseBody</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br>        <span class="hljs-keyword">try</span> (<span class="hljs-type">BufferedReader</span> <span class="hljs-variable">reader</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedReader</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InputStreamReader</span>(response.getBody(), StandardCharsets.UTF_8))) &#123;<br>            String line;<br>            <span class="hljs-keyword">while</span> ((line = reader.readLine()) != <span class="hljs-literal">null</span>) &#123;<br>                responseBody.append(line);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (responseBody.length() &gt; <span class="hljs-number">0</span>) &#123;<br>            logger.debug(<span class="hljs-string">&quot;Response Body: &#123;&#125;&quot;</span>, responseBody.toString());<br>        &#125;<br>    &#125;<br><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è¿”å›çš„å“åº”æµåªèƒ½è¯»å–ä¸€æ¬¡ï¼Œæ‰€ä»¥éœ€è¦é‡æ–°å°è£…ä¸€ä¸ªç±»ï¼Œå®ç°ClientHttpResponseæ¥å£ï¼Œé‡å†™getBodyæ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªInputStreamï¼Œ</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RepeatReadClientHttpRequestWrapper</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ClientHttpResponse</span> &#123;<br>        <span class="hljs-keyword">private</span> ClientHttpResponse response;<br>        <span class="hljs-keyword">private</span> <span class="hljs-type">byte</span>[] bodyData = <span class="hljs-literal">null</span>;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">RepeatReadClientHttpRequestWrapper</span><span class="hljs-params">(ClientHttpResponse response)</span> &#123;<br>            <span class="hljs-built_in">this</span>.response = response;<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> HttpStatusCode <span class="hljs-title function_">getStatusCode</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>            <span class="hljs-keyword">return</span> response.getStatusCode();<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getStatusText</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>            <span class="hljs-keyword">return</span> response.getStatusText();<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> &#123;<br>            response.close();<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> InputStream <span class="hljs-title function_">getBody</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>            <span class="hljs-keyword">if</span> (Objects.isNull(bodyData)) &#123;<br>                bodyData = response.getBody().readAllBytes();<br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayInputStream</span>(bodyData);<br>        &#125;<br><br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> HttpHeaders <span class="hljs-title function_">getHeaders</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">return</span> response.getHeaders();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ—¥å¿—æ‰“å°ç±»å®ç°åï¼Œè¿˜éœ€è¦æ³¨å…¥åˆ°RestClientå®¢æˆ·ç«¯ä¸­æ‰èƒ½å®ç°ï¼Œå¾ˆç®€å•ï¼š</p><p>è¿˜è®°å¾—<a href="/2025/02/20/spring-spring6-http-interface/#3-2-%E6%B3%A8%E5%86%8C%E4%BB%A3%E7%90%86%E7%B1%BB">å‰æ–‡</a>çš„RestClientçš„æ„å»ºbeané…ç½®ç±»å—ï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">RestClient</span> <span class="hljs-variable">restClient</span> <span class="hljs-operator">=</span> RestClient.builder()<br>        .baseUrl(<span class="hljs-string">&quot;http://localhost:8080/&quot;</span>)<br>        .requestInterceptor(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LoggingRequestInterceptor</span>())  <span class="hljs-comment">//æ³¨å…¥æ—¥å¿—æ‰“å°ç±»</span><br>        .build();<br><br></code></pre></td></tr></table></figure><p>ç»“æŸï¼Œä¸‹ç­!</p><h2 id="ç›¸å…³é˜…è¯»"><a href="#ç›¸å…³é˜…è¯»" class="headerlink" title="ç›¸å…³é˜…è¯»"></a>ç›¸å…³é˜…è¯»</h2><p><a href="/2025/02/20/spring-spring6-http-interface/">spring6.xä½¿ç”¨@HttpExchangeæ³¨è§£è°ƒç”¨ç¬¬ä¸‰æ–¹æ¥å£</a></p>]]></content>
    
    
    <categories>
      
      <category>spring</category>
      
      <category>springboot</category>
      
    </categories>
    
    
    <tags>
      
      <tag>spring</tag>
      
      <tag>springboot3.x</tag>
      
      <tag>http interface</tag>
      
      <tag>HttpExchange</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç»™åšå®¢æ·»åŠ è‡ªå®šä¹‰çš„å›¾æ ‡</title>
    <link href="/2025/02/23/site-self-icon/"/>
    <url>/2025/02/23/site-self-icon/</url>
    
    <content type="html"><![CDATA[<p>åœ¨ç”¨æƒ¯äº†fluidå®˜æ–¹ä»‹ç»çš„iconå›¾ç‰‡åï¼Œæƒ³è¦æ·»åŠ ä¸€äº›è‡ªå·±çš„iconï¼Œæ”¹å¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿ</p><p>æ¯”å¦‚ï¼Œæˆ‘çš„é¡µé¢éœ€è¦ä¸€ä¸ªå…¬ä¼—å·icon <i class = 'iconfont icon-gongzhonghao'></i>ï¼Œå®˜æ–¹æä¾›çš„iconå›¾æ ‡é‡Œå°±æ²¡æœ‰ï¼Œå°±åªèƒ½è‡ªå·±æƒ³åŠæ³•å¯»æ‰¾æ·»åŠ äº†ã€‚</p><p>æ‰€å¹¸ï¼Œå®˜æ–¹è¿˜æä¾›äº†ä¸€ä¸ª<a href="https://hexo.fluid-dev.com/docs/icon/">æ‰©å±•ç‚¹</a>, æœ¬æ–‡å°±è¯¦ç»†ä»‹ç»å¦‚ä½•åˆ©ç”¨é˜¿é‡Œå·´å·´çš„iconfontæ¥æ·»åŠ è‡ªå®šä¹‰çš„å›¾æ ‡çš„æ“ä½œæµç¨‹ã€‚</p><h2 id="æ³¨å†Œé˜¿é‡Œiconfont"><a href="#æ³¨å†Œé˜¿é‡Œiconfont" class="headerlink" title="æ³¨å†Œé˜¿é‡Œiconfont"></a>æ³¨å†Œé˜¿é‡Œiconfont</h2><p>ç‚¹å‡»<a href="https://www.iconfont.cn/">iconfont</a> æ³¨å†Œè´¦å·ã€‚</p><p>ç„¶åå°±å¯ä»¥åœ¨è¿™ä¸ªç½‘ç«™é‡Œå¯»æ‰¾è‡ªå·±å–œæ¬¢çš„å›¾æ ‡äº†ï¼Œ2000wä¸ªå›¾æ ‡ï¼Œæ€»æœ‰ä¸€æ¬¾ä½ å–œæ¬¢çš„ï¼Œå¦‚æœä¸å–œæ¬¢ï¼Œè¿˜å¯ä»¥è‡ªå·±åˆ¶ä½œï¼Œä¸Šä¼ è‡ªå·±çš„iconã€‚<br><img src="/../../images/site/icon/iconfont_total.png" alt="iconfontå›¾æ ‡æ€»é‡"></p><p>å°†é€‰æ‹©å¥½çš„iconï¼ŒåŠ å…¥åˆ°è‡ªå·±çš„iconfonté¡¹ç›®é‡Œï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨äº†ã€‚</p><h2 id="ç½‘ç«™å¼•å…¥icon"><a href="#ç½‘ç«™å¼•å…¥icon" class="headerlink" title="ç½‘ç«™å¼•å…¥icon"></a>ç½‘ç«™å¼•å…¥icon</h2><p>æƒ³è¦è®©è‡ªå·±çš„ç½‘ç«™é‡Œä½¿ç”¨æˆ‘ä»¬åœ¨iconfonté‡Œé€‰æ‹©çš„iconï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ol><li>ç›´æ¥å°†å¯¹åº”çš„iconä¸‹è½½ä¸‹æ¥ï¼Œç„¶åè‡ªå®šä¹‰cssè„šæœ¬</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.icon</span> &#123;<br>    <span class="hljs-comment">/* è®¾ç½®èƒŒæ™¯å›¾çš„è·¯å¾„ï¼Œå¯æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹ */</span><br>    <span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">&#x27;path/to/your/icon.png&#x27;</span>); <br>    <span class="hljs-comment">/* èƒŒæ™¯å›¾ä¸é‡å¤ */</span><br>    <span class="hljs-attribute">background-repeat</span>: no-repeat; <br>    <span class="hljs-comment">/* èƒŒæ™¯å›¾è¦†ç›–å…ƒç´  */</span><br>    <span class="hljs-attribute">background-size</span>: cover; <br>    <span class="hljs-comment">/* å…ƒç´ çš„å®½åº¦ */</span><br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">30px</span>; <br>    <span class="hljs-comment">/* å…ƒç´ çš„é«˜åº¦ */</span><br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">30px</span>; <br>    <span class="hljs-comment">/* å¯æ ¹æ®éœ€è¦æ·»åŠ å…¶ä»–æ ·å¼ */</span><br>    <span class="hljs-attribute">display</span>: inline-block; <br>&#125;<br></code></pre></td></tr></table></figure><p>æ¥ç€åœ¨<code>_config.yml</code>é…ç½®æ–‡ä»¶é‡Œå¼•å…¥è‡ªå®šä¹‰çš„css</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">custom_css:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">/css/custom.css</span> <span class="hljs-comment"># è‡ªå®šä¹‰cssè·¯å¾„, å¯å¤šä¸ª</span><br></code></pre></td></tr></table></figure><p>ç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ç½‘ç«™çš„ä»»æ„åœ°æ–¹ï¼ˆåŒ…æ‹¬æ–‡ç« ï¼‰é‡Œä½¿ç”¨è‡ªå®šä¹‰çš„iconäº†ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span> = <span class="hljs-string">&#x27;iconfont icon-word&#x27;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br></code></pre></td></tr></table></figure><ol start="2"><li>ä½¿ç”¨iconfontå®˜æ–¹çš„csså¼•å…¥æ–¹å¼</li></ol><p>ä½¿ç”¨è‡ªå®šä¹‰cssçš„æ–¹å¼ï¼Œçµæ´»åº¦å¾ˆé«˜ï¼Œä½†æ¯”è¾ƒç¹çã€‚ </p><p>å…¶å®iconfontå®˜æ–¹å·²ç»æä¾›äº†åœ¨çº¿çš„cssæ–¹å¼ï¼Œä¾›æˆ‘ä»¬åœ¨çº¿å¼•å…¥ä½¿ç”¨ã€‚</p><p>è¿›å…¥æˆ‘çš„é¡¹ç›®ï¼Œç‚¹å‡»<code>æŸ¥çœ‹åœ¨çº¿é“¾æ¥</code>ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬é¡¹ç›®ä¸‹æ”¶è—çš„å›¾æ ‡çš„ä¼šå…¨éƒ¨æ‰“åŒ…è¿›ä¸€ä¸ªåœ¨çº¿cssé“¾æ¥é‡Œï¼Œè¿™æ˜¯ä¸€ä¸ªç»å¯¹è·¯å¾„ï¼Œå‰é¢åŠ ä¸Š<code>http</code>æˆ–<code>https</code>å°±èƒ½åœ¨çº¿è®¿é—®äº†ã€‚ </p><p><img src="/../../images/site/icon/iconfont_css_url.png" alt="iconfont cssè·¯å¾„"></p><p>æ¥ç€ï¼Œå°†è¿™ä¸ªcssé“¾æ¥å¤åˆ¶ï¼Œåœ¨è‡ªå·±çš„é¡¹ç›®ä¸‹<code>source/css</code>ç›®å½•ï¼Œæ–°å»ºä¸€ä¸ª<code>custom.css</code>æ–‡ä»¶(éšæ„å‘½å)ï¼Œå­˜å‚¨è¿™ä¸ªè·¯å¾„ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-keyword">@import</span> url(<span class="hljs-string">&#x27;//at.alicdn.com/t/c/xxx.css&#x27;</span>);<br><br></code></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ç‚¹å‡»è¿™ä¸ªè·¯å¾„ï¼ŒæŸ¥çœ‹é‡Œé¢çš„å†…å®¹ï¼Œç„¶åå°†å†…å®¹å¤åˆ¶åˆ°è¿™ä¸ªcssæ–‡ä»¶ä¸­ï¼Œè¿™æ ·è¿˜å¯ä»¥å¯¹æ ·å¼è¿›è¡Œä¿®æ”¹ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-keyword">@font-face</span> &#123;<br>  <span class="hljs-attribute">font-family</span>: <span class="hljs-string">&quot;iconfont&quot;</span>; <span class="hljs-comment">/* Project id 4835676 */</span><br>  <span class="hljs-attribute">src</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">&#x27;//at.alicdn.com/t/c/xxx.woff2?t=1740236137377&#x27;</span>) <span class="hljs-built_in">format</span>(<span class="hljs-string">&#x27;woff2&#x27;</span>),<br>       <span class="hljs-built_in">url</span>(<span class="hljs-string">&#x27;//at.alicdn.com/t/c/xxx.woff?t=1740236137377&#x27;</span>) <span class="hljs-built_in">format</span>(<span class="hljs-string">&#x27;woff&#x27;</span>),<br>       <span class="hljs-built_in">url</span>(<span class="hljs-string">&#x27;//at.alicdn.com/t/c/xxx.ttf?t=1740236137377&#x27;</span>) <span class="hljs-built_in">format</span>(<span class="hljs-string">&#x27;truetype&#x27;</span>);<br>&#125;<br><br><span class="hljs-selector-class">.iconfont</span> &#123;<br>  <span class="hljs-attribute">font-family</span>: <span class="hljs-string">&quot;iconfont&quot;</span> <span class="hljs-meta">!important</span>;<br>  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">16px</span>;<br>  <span class="hljs-attribute">font-style</span>: normal;<br>  -webkit-<span class="hljs-attribute">font-smoothing</span>: antialiased;<br>  -moz-osx-<span class="hljs-attribute">font-smoothing</span>: grayscale;<br>&#125;<br><br><span class="hljs-selector-class">.icon-gongzhonghao</span><span class="hljs-selector-pseudo">:before</span> &#123;<br>  <span class="hljs-attribute">content</span>: <span class="hljs-string">&quot;\eb79&quot;</span>;<br>&#125;<br><br><span class="hljs-selector-class">.icon-word</span><span class="hljs-selector-pseudo">:before</span> &#123;<br>  <span class="hljs-attribute">content</span>: <span class="hljs-string">&quot;\e7d4&quot;</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>æ¥ç€ï¼Œå°±å’Œè‡ªå®šä¹‰cssä¸€æ ·ï¼Œåœ¨<code>_config.yml</code>é…ç½®æ–‡ä»¶é‡Œå¼•å…¥è‡ªå®šä¹‰çš„css</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">custom_css:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">/css/custom.css</span> <span class="hljs-comment"># è‡ªå®šä¹‰cssè·¯å¾„, å¯å¤šä¸ª</span><br></code></pre></td></tr></table></figure><p>æœ€åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ç½‘ç«™çš„ä»»æ„åœ°æ–¹ï¼ˆåŒ…æ‹¬æ–‡ç« ï¼‰é‡Œä½¿ç”¨è‡ªå®šä¹‰çš„iconäº†ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span> = <span class="hljs-string">&#x27;iconfont icon-gongzhonghao&#x27;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæ–¹å¼æ›´ç®€å•ï¼Œæ¨èä½¿ç”¨è¿™ç§æ–¹å¼ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç«™</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å»ºç«™</tag>
      
      <tag>iconfont</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>windowsç³»ç»Ÿjavaå¯åŠ¨æ—¶å¦‚ä½•æŒ‡å®šjdkï¼Ÿ</title>
    <link href="/2025/02/22/java-java-with-specify-jdk/"/>
    <url>/2025/02/22/java-java-with-specify-jdk/</url>
    
    <content type="html"><![CDATA[<p>åœ¨æ—¥å¸¸çš„å¼€å‘ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬åœ¨æˆ‘ä»¬çš„æœºå™¨ä¸Šå®‰è£…ä¸€ä¸ªjdkï¼Œç„¶åå†é€šè¿‡é…ç½®ç¯å¢ƒå˜é‡çš„æ–¹å¼ï¼Œå®ç°javaå‘½ä»¤çš„ä½¿ç”¨ã€‚</p><p>ä½†æ˜¯ï¼Œåœ¨æ—¥å¸¸é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ä¸€ç§æƒ…å†µï¼Œé‚£å°±æ˜¯æœåŠ¡å™¨ä¸Šå·²ç»å®‰è£…äº†ä¸€ä¸ªjdkäº†ï¼Œä½†æ˜¯ä¸ç¬¦åˆæˆ‘ä»¬çš„ç‰ˆæœ¬ï¼Œæ¯”å¦‚windowsæœåŠ¡å™¨ä¸Šï¼Œå®‰è£…äº†ä¸€ä¸ªjdk8ï¼Œè€Œä¸”è¿˜é…ç½®å¥½äº†ç¯å¢ƒå˜é‡ã€‚<br>è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ˜¯ä¸èƒ½ä¿®æ”¹å…³äºè¿™ä¸ªjdk8çš„é…ç½®çš„ï¼Œå°¤å…¶æ˜¯ç¯å¢ƒå˜é‡ï¼Œä¸‡ä¸€å¼•èµ·å…¶ä»–çš„ç¨‹åºä¸èƒ½è¿è¡Œï¼Œå°±æ˜¯æˆ‘ä»¬çš„é”…äº†ï¼Œè€Œæˆ‘ä»¬éœ€è¦çš„jdkç‰ˆæœ¬æ˜¯17ã€‚</p><p>è¿™ç§æƒ…å†µè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>æ‰€ä»¥ï¼Œæœ€ç†æƒ³çš„æƒ…å†µå°±æ˜¯ï¼Œæˆ‘ä»¬è‡ªå·±å®‰è£…ä¸€ä¸ªjdk17ï¼Œç„¶ååœ¨ç¨‹åºè¿è¡Œçš„æ—¶å€™æŒ‡å®šè¿è¡Œçš„jdkå°±æ˜¯æˆ‘ä»¬å®‰è£…çš„jdk17ï¼Œè¿™æ ·å°±å¯ä»¥å®Œç¾é¿å…è¿™ä¸ªé—®é¢˜äº†ã€‚</p><p>ä»¥ä¸‹å°±æ˜¯åœ¨linux å’Œ windows ç³»ç»Ÿä¸‹ï¼ŒæŒ‡å®šjdkç‰ˆæœ¬è¿è¡Œjavaç¨‹åºçš„å‘½ä»¤ã€‚</p><h2 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h2><p>å‡è®¾jdkçš„ç›®å½•æ˜¯å’Œä½ çš„jarç¨‹åºåœ¨ä¸€ä¸ªç›®å½•ä¸‹ï¼Œç„¶ååœ¨è¿™ä¸ªç›®å½•ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">jdk-17.0.12/bin/java  -jar your_app.jar<br><span class="hljs-comment"># æˆ–ç»å¯¹è·¯å¾„</span><br>/home/jdk-17.0.12/bin/java  -jar your_app.jar<br></code></pre></td></tr></table></figure><p>è¿›é˜¶ï¼š<br>æˆ‘ä»¬å¯ä»¥æŠŠä¸Šé¢çš„å¯åŠ¨å‘½ä»¤ï¼Œå†™åˆ°ä¸€ä¸ªbashæ–‡ä»¶é‡Œï¼Œæ¯”å¦‚å«<code>start.sh</code>, ç„¶ååœ¨å¯åŠ¨ç¨‹åºçš„æ—¶å€™ï¼Œç›´æ¥æ‰§è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash start.sh<br></code></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±ä¸ç”¨è®°å¿†ç¹ççš„å¯åŠ¨å‘½ä»¤äº†ï¼Œå°¤å…¶æ˜¯å¯åŠ¨å‘½ä»¤é‡Œè¿˜æœ‰å¾ˆå¤šå‚æ•°çš„æƒ…å†µä¸‹ã€‚</p><h2 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h2><p>å‡è®¾jdkçš„ç›®å½•æ˜¯å’Œä½ çš„jarç¨‹åºåœ¨ä¸€ä¸ªç›®å½•ä¸‹ï¼Œç„¶ååœ¨è¿™ä¸ªç›®å½•ï¼Œæ‰“å¼€CMDå‘½ä»¤ç»ˆç«¯ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cmd">&quot;.\jdk-<span class="hljs-number">17</span>.<span class="hljs-number">0</span>.<span class="hljs-number">12</span>\bin\java.exe&quot; -jar your_app.jar<br># æˆ–<br>&quot;jdk-<span class="hljs-number">17</span>.<span class="hljs-number">0</span>.<span class="hljs-number">12</span>\bin\java.exe&quot; -jar your_app.jar<br># æˆ–<br>&quot;jdk-<span class="hljs-number">17</span>.<span class="hljs-number">0</span>.<span class="hljs-number">12</span>/bin/java.exe&quot; -jar your_app.jar<br># æˆ–ç»å¯¹è·¯å¾„<br>&quot;C:\Program Files\Java\jdk-<span class="hljs-number">17</span>.<span class="hljs-number">0</span>.<span class="hljs-number">12</span>\bin\java.exe&quot; -jar your_app.jar<br></code></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œè¡¨ç¤ºjdkç›®å½•çš„è·¯å¾„ï¼Œä¸€å®šè¦åŠ å¼•å·ï¼Œæ‰èƒ½è¢«CMDç¨‹åºè¯†åˆ«æˆä¸€ä¸ªæ•´ä½“ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p><p>å½“ç„¶ï¼Œwin10ä»¥åï¼Œwindowsä¸Šæœ‰äº†ä¸€ä¸ªæ–°çš„å‘½ä»¤ç»ˆç«¯ï¼Œå«powershellï¼Œè¿™ä¸ªå‘½ä»¤ç»ˆç«¯ï¼Œåœ¨ä½¿ç”¨ä¹ æƒ¯ä¸Šæ›´è´´è¿‘linuxï¼Œæ‰€ä»¥ï¼Œä¹Ÿå¯ä»¥å»æ‰å¤šä½™çš„å¼•å·ï¼š</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">.\jdk<span class="hljs-literal">-17</span>.<span class="hljs-number">0.12</span>\bin\java.exe <span class="hljs-literal">-jar</span> your_app.jar<br></code></pre></td></tr></table></figure><p>è¿›é˜¶ï¼š<br>åœ¨windowsä¸‹ï¼Œæˆ‘ä»¬åŒæ ·ä¹Ÿå¯ä»¥æŠŠä¸Šé¢çš„windowså‘½ä»¤å†™å…¥ä¸€ä¸ªbatæ–‡ä»¶ï¼Œæ¯”å¦‚å«<code>start.bat</code>ã€‚<br>ç„¶ååœ¨å¯åŠ¨ç¨‹åºçš„æ—¶å€™ï¼Œç›´æ¥åŒå‡»è¿™ä¸ªè„šæœ¬ï¼Œç¨‹åºå°±å¯ä»¥è‡ªåŠ¨æ‰§è¡Œäº†ï¼Œæ›´ç®€å•ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å…¶å®æœ‰äº›å¹´å¤´ç¼–ç¨‹ç»éªŒçš„æœ‹å‹éƒ½æ˜ç™½ï¼Œæ‰€è°“çš„ç¯å¢ƒå˜é‡ï¼Œå°±æ˜¯æŠŠæˆ‘ä»¬å¸¸ç”¨çš„ä¸€äº›ç¨‹åºçš„ç›®å½•ï¼Œå­˜å‚¨åˆ°ç³»ç»Ÿçš„é…ç½®é‡Œã€‚<br>è¿™æ ·ï¼Œå½“æˆ‘ä»¬åœ¨å‘½ä»¤è¡Œé‡Œç›´æ¥è¾“å…¥ä¸€ä¸ªå‘½ä»¤æ—¶ï¼Œæ¯”å¦‚<code>java</code>ï¼Œç³»ç»Ÿä¼šå»æˆ‘ä»¬é…ç½®çš„è·¯å¾„é‡Œæ‰¾è¿™ä¸ªå‘½ä»¤ï¼Œç„¶ååœ¨é…ç½®ç¯å¢ƒå˜é‡çš„jdk8ç›®å½•é‡Œï¼Œæ‰¾åˆ°javaå‘½ä»¤ï¼Œç„¶åæ‰§è¡Œè¿™ä¸ªå‘½ä»¤ã€‚</p><p>æœ¬è´¨ä¸Šè¿˜æ˜¯è°ƒç”¨å¯¹åº”ç›®å½•ä¸‹çš„javaå‘½ä»¤ã€‚ </p><p>æ‰€ä»¥ï¼Œå¯ä»¥ç†è§£ä¸ºï¼Œè¿™å°±æ˜¯ä¸€ä¸ªè¯­æ³•ç³–ã€‚</p><p>åŒæ ·çš„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦æŒ‡å®šjavaç¨‹åºçš„è¿è¡Œjdkæˆ–jreï¼Œåªè¦é€šè¿‡è¿™ä¸ªç›®å½•ä¸‹çš„javaå¯æ‰§è¡Œç¨‹åºè¿è¡Œè¿™ä¸ªç¨‹åºå°±å¯ä»¥äº†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>java</tag>
      
      <tag>jdk</tag>
      
      <tag>windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>spring6.xä½¿ç”¨@HttpExchangeæ³¨è§£è°ƒç”¨ç¬¬ä¸‰æ–¹æ¥å£</title>
    <link href="/2025/02/20/spring-spring6-http-interface/"/>
    <url>/2025/02/20/spring-spring6-http-interface/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘æœ‰ä¸€ä¸ªæ–°é¡¹ç›®ï¼Œå› ä¸ºæ²¡æœ‰å†å²è´Ÿæ‹…ï¼Œæ•´å“ˆä¸Šæ‰‹äº†æœ€æ–°çš„springboot3.xä½“ç³»ï¼Œæ‰€ä»¥å°±é¡ºå¸¦ä¹Ÿå‡çº§äº†spring6.xã€‚</p><p>åœ¨ä½¿ç”¨spring6.xæ—¶ï¼Œå‘ç°springå®˜æ–¹æä¾›äº†ä¸€å¥—HTTP Interfaceçš„åŠŸèƒ½ æŒºå¥½ç”¨ï¼Œç±»ä¼¼@FeignClientçš„é‚£æ ·ï¼Œä¹Ÿå¯ä»¥é€šè¿‡@HttpExchangeæ³¨è§£æ¥è°ƒç”¨ç¬¬ä¸‰æ–¹æ¥å£ï¼Œä»æ­¤å¯ä»¥æ‘†è„±RestTemplateè‡ƒè‚¿çš„è°ƒç”¨ï¼Œå®ç°è½»é‡çº§çš„ç¬¬ä¸‰æ–¹æ¥å£æœåŠ¡äº†ã€‚</p><p>æ‰€ä»¥ç‰¹æ­¤è®°å½•ï¼Œä¸å¤§å®¶åˆ†äº«ä¸€ä¸‹ã€‚</p><h2 id="1-ç‰ˆæœ¬"><a href="#1-ç‰ˆæœ¬" class="headerlink" title="1. ç‰ˆæœ¬"></a>1. ç‰ˆæœ¬</h2><ul><li>springboot3.3.5</li><li>spring-framework 6.1.14</li><li>jdk 17 (spring6.x æœ€ä½jdkç‰ˆæœ¬)</li></ul><h2 id="2-åŸç†"><a href="#2-åŸç†" class="headerlink" title="2. åŸç†"></a>2. åŸç†</h2><p>å…¶å®ï¼Œä»æ¶æ„ä¸Šæ¥è¯´ï¼Œspringæ¡†æ¶å¹¶æ²¡æœ‰å¯¹å¤–æ¥å£è°ƒç”¨çš„åº•å±‚åšå¤ªå¤šçš„æ”¹å˜ï¼Œ<code>HTTP Interface</code> æ˜¯åœ¨åŸå…ˆçš„<code>RestTemplate</code>è¿™ç±»httpå®¢æˆ·ç«¯çš„ä¸Šé¢ï¼Œåˆæäº†ä¸€ä¸ªæ¥å£ä»£ç†å±‚,<br>ä»£ç†å±‚ä¸Šé¢æ˜¯æˆ‘ä»¬<code>HTTP Interface</code>çš„æ¥å£å®šä¹‰éƒ¨åˆ†ï¼Œç„¶åé€šè¿‡ä»£ç†å±‚çš„ä»£ç†ï¼Œå°†http è¯·æ±‚åŠŸèƒ½è½¬å‘åˆ°åº•å±‚çš„httpå®¢æˆ·ç«¯å®ç°ã€‚è€Œè¿™åº•å±‚çš„httpå®¢æˆ·ç«¯å®ç°ï¼Œå°±æ˜¯æˆ‘ä»¬ä¹‹å‰ä½¿ç”¨è¿‡çš„<code>RestTemplate</code>ï¼Œä»¥åŠspring6.x æ–°æä¾›çš„<code>RestClient</code>ã€‚<br><img src="/../../images/tech/spring/spring6-http-interface.png" alt="http-interfaceè®¾è®¡åŸç†"></p><p>é€šè¿‡ä¸Šé¢çš„æ¶æ„å›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œ<code>HTTP Interface</code>å¹¶ä¸æ˜¯å“åº”å¼webï¼ˆwebFluxï¼‰ç‹¬æœ‰çš„ï¼Œè€Œæ˜¯å¯ä»¥é€šè¿‡è‡ªç”±çš„ç»„åˆåº•å±‚çš„httpå®¢æˆ·ç«¯å®ç°, æ¥æ”¯æŒä¸åŒçš„åœºæ™¯ï¼Œä¹Ÿå°±æ˜¯è¯´<code>servlet</code>é˜»å¡å¼webä¹Ÿæ”¯æŒã€‚</p><p>å†æ¬¡å°è¯äº†æŠ€æœ¯åœˆçš„é‚£å¥è€è¯ï¼š</p><blockquote><p>æ²¡æœ‰é—®é¢˜ä¸æ˜¯é€šè¿‡åŠ ä¸€å±‚ä¸èƒ½è§£å†³ï¼Œå¦‚æœä¸è¡Œï¼Œé‚£å°±å†åŠ ä¸€å±‚</p></blockquote><h3 id="2-1-RestClient"><a href="#2-1-RestClient" class="headerlink" title="2.1 RestClient"></a>2.1 RestClient</h3><p>å¤šè¯´ä¸€å¥<code>RestClient</code>ï¼Œå¤§å®¶å¯èƒ½å¯¹<code>RestTemplate</code>å’Œ<code>WebClient</code>å¾ˆç†Ÿæ‚‰äº†ï¼Œä¸€ä¸ªæ•°é˜»å¡å¼webè¯·æ±‚å¸¸é’æ ‘ï¼Œä¸€ä¸ªæ˜¯å“åº”å¼webè¯·æ±‚å®¢æˆ·ç«¯ã€‚<br>ä½†æ˜¯<code>RestTemplate</code> ç›¸å¯¹äº <code>WebClient</code> æ¥è¯´å¤ªéš¾ç”¨äº†ï¼Œè¯­æ³•ç¹çï¼Œè§£æä¸å˜ã€‚ æ‰€ä»¥spring6.1ç‰ˆæœ¬ å¼•å…¥äº†<code>RestClient</code>è¿™ä¸€å®ç°ã€‚</p><p>å®‰è£…å®˜æ–¹çš„è§£é‡Šï¼š</p><blockquote><p>The RestClient offers a more modern API for synchronous HTTP access. RestTemplate uses the same HTTP library abstraction as RestClient.<br>ç¿»è¯‘ï¼šRestTemplateå’ŒRestClientä½¿ç”¨ç›¸åŒçš„HTTPåº“ï¼Œ ä½†æ˜¯RestClientæä¾›äº†ä¸€ç§ç°ä»£çš„HTTPè®¿é—®APIï¼Œæ–¹ä¾¿å¤§å®¶ä½¿ç”¨ã€‚</p></blockquote><p>RestClientçš„ä½¿ç”¨demoï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br><span class="hljs-type">Pet</span> <span class="hljs-variable">pet</span> <span class="hljs-operator">=</span> restClient.get()<br>  .uri(<span class="hljs-string">&quot;https://petclinic.example.com/pets/&#123;id&#125;&quot;</span>, id)<br>  .accept(APPLICATION_JSON)<br>  .retrieve()<br>  .body(Pet.class);<br></code></pre></td></tr></table></figure><p>æ˜¯ä¸æ˜¯å¾ˆç®€æ´ï¼Œç°ä»£çš„å¾ˆå¤šhttpå®¢æˆ·ç«¯éƒ½æ˜¯è¿™ç§æµå¼è°ƒç”¨è¯­æ³•ç³–ï¼Œæ¯”å¦‚<code>okhttp</code>ã€javaåŸç”Ÿçš„<code>HTTPClient</code>ç­‰</p><h3 id="2-2-HttpExchange"><a href="#2-2-HttpExchange" class="headerlink" title="2.2 HttpExchange"></a>2.2 HttpExchange</h3><p><code>HTTP Interface</code>çš„æ ¸å¿ƒæ³¨è§£ï¼Œå¯ä»¥æ”¾åˆ°ä¸€ä¸ªjavaæ¥å£ç±»ä¸Šï¼Œä¹Ÿå¯ä»¥æ”¾åˆ°ä¸€ä¸ªæ¥å£æ–¹æ³•ä¸Šã€‚é€šfeignä¸€æ ·ï¼Œå¯ä»¥åŒæ­¥ä½¿ç”¨spring-webä½“ç³»ä¸‹çš„ç›¸å…³çš„æ³¨è§£ï¼Œæ¯”å¦‚<code>@PathVariable</code>ã€<code>@RequestParam</code>ç­‰ï¼Œ<br>è¿™äº›å¯ä»¥åœ¨controlleré‡Œèƒ½å¤Ÿæ­£å¸¸ä½¿ç”¨çš„æ³¨è§£ï¼Œéƒ½å¯ä»¥æ— ç¼çš„åœ¨<code>@HttpExchange</code>æ³¨è§£æ ‡è®°çš„æ¥å£æˆ–æ–¹æ³•ä¸Šä½¿ç”¨ã€‚</p><p>åœ¨æ–¹æ³•ä¸Šä½¿ç”¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">RepositoryService</span> &#123;<br><br><span class="hljs-meta">@GetExchange(&quot;/repos/&#123;owner&#125;/&#123;repo&#125;&quot;)</span><br>Repository <span class="hljs-title function_">getRepository</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> String owner, <span class="hljs-meta">@PathVariable</span> String repo)</span>;<br><br><span class="hljs-comment">// more HTTP exchange methods...</span><br><br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ç±»ä¸Šä½¿ç”¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@HttpExchange(url = &quot;/repos/&#123;owner&#125;/&#123;repo&#125;&quot;, accept = &quot;application/vnd.github.v3+json&quot;)</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">RepositoryService</span> &#123;<br><br><span class="hljs-meta">@GetExchange</span><br>Repository <span class="hljs-title function_">getRepository</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> String owner, <span class="hljs-meta">@PathVariable</span> String repo)</span>;<br><br><span class="hljs-meta">@PatchExchange(contentType = MediaType.APPLICATION_FORM_URLENCODED_VALUE)</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">updateRepository</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> String owner, <span class="hljs-meta">@PathVariable</span> String repo,</span><br><span class="hljs-params"><span class="hljs-meta">@RequestParam</span> String name, <span class="hljs-meta">@RequestParam</span> String description, <span class="hljs-meta">@RequestParam</span> String homepage)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>çœ‹åˆ°è¿™é‡Œï¼Œå¤§å®¶ä¼šæœ‰ä¸€ä¸ªç–‘é—®ï¼Œ ç¬¬ä¸‰æ–¹è°ƒç ”çš„åŸŸååœ°å€åœ¨å“ªé‡Œé…ç½®å‘¢ï¼Ÿ</p><p>åœ¨feigné‡Œï¼Œæˆ‘ä»¬åœ¨<code>@FeignClient</code>æ³¨è§£é‡Œï¼Œå¯ä»¥é€šè¿‡<code>url</code>å±æ€§æ¥æŒ‡å®šåŸŸååœ°å€ï¼Œä½†æ˜¯<code>HTTP Interface</code>ä¸è¡Œï¼Œéœ€è¦åœ¨æ¥å£å¯¹åº”çš„ä»£ç†beané‡Œé…ç½®å¯¹åº”çš„åŸŸååœ°å€ï¼Œè¿™é‡Œä¸å¦‚feignå¥½ç”¨ã€‚</p><p>æˆ‘ä»¬ä¸Šé¢é…ç½®çš„æ¥å£<code>RepositoryService</code>å¿…é¡»æ‰‹åŠ¨æ³¨å†Œåˆ°<code>HttpServiceProxyFactory</code>é‡Œæ‰ç”Ÿæ•ˆï¼Œä¸ç„¶æ— æ³•ä½¿ç”¨ã€‚</p><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±æŒ‡å®šåº•å±‚å®é™…çš„httpå®¢æˆ·ç«¯ã€‚</p><ul><li>RestClient</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><br><span class="hljs-keyword">public</span> RepositoryService <span class="hljs-title function_">repositoryService</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">RestClient</span> <span class="hljs-variable">restClient</span> <span class="hljs-operator">=</span> RestClient.builder().baseUrl(<span class="hljs-string">&quot;https://api.github.com/&quot;</span>).build();<br>    <span class="hljs-type">RestClientAdapter</span> <span class="hljs-variable">adapter</span> <span class="hljs-operator">=</span> RestClientAdapter.create(restClient);<br>    <span class="hljs-type">HttpServiceProxyFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> HttpServiceProxyFactory.builderFor(adapter).build();<br><br>    <span class="hljs-type">RepositoryService</span> <span class="hljs-variable">service</span> <span class="hljs-operator">=</span> factory.createClient(RepositoryService.class);<br>&#125;<br><br></code></pre></td></tr></table></figure><ul><li>WebClient</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><br><span class="hljs-keyword">public</span> RepositoryService <span class="hljs-title function_">repositoryService</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">WebClient</span> <span class="hljs-variable">webClient</span> <span class="hljs-operator">=</span> WebClient.builder().baseUrl(<span class="hljs-string">&quot;https://api.github.com/&quot;</span>).build();<br>    <span class="hljs-type">WebClientAdapter</span> <span class="hljs-variable">adapter</span> <span class="hljs-operator">=</span> WebClientAdapter.create(webClient);<br>    <span class="hljs-type">HttpServiceProxyFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> HttpServiceProxyFactory.builderFor(adapter).build();<br><br>    <span class="hljs-type">RepositoryService</span> <span class="hljs-variable">service</span> <span class="hljs-operator">=</span> factory.createClient(RepositoryService.class);<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>RestTemplate</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> RepositoryService <span class="hljs-title function_">repositoryService</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">RestTemplate</span> <span class="hljs-variable">restTemplate</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RestTemplate</span>();<br>    restTemplate.setUriTemplateHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DefaultUriBuilderFactory</span>(<span class="hljs-string">&quot;https://api.github.com/&quot;</span>));<br>    <span class="hljs-type">RestTemplateAdapter</span> <span class="hljs-variable">adapter</span> <span class="hljs-operator">=</span> RestTemplateAdapter.create(restTemplate);<br>    <span class="hljs-type">HttpServiceProxyFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> HttpServiceProxyFactory.builderFor(adapter).build();<br><br>    <span class="hljs-type">RepositoryService</span> <span class="hljs-variable">service</span> <span class="hljs-operator">=</span> factory.createClient(RepositoryService.class);<br>&#125;<br><br></code></pre></td></tr></table></figure><p>ç„¶åï¼Œæˆ‘ä»¬çš„æ¥å£<code>RepositoryService</code>å°±æ³¨å†Œæˆspringå®¹å™¨é‡Œçš„ä¸€ä¸ªbeanï¼Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹æ³¨å…¥äº†ã€‚</p><h3 id="2-3-HttpExchangeçš„å˜ç§"><a href="#2-3-HttpExchangeçš„å˜ç§" class="headerlink" title="2.3 HttpExchangeçš„å˜ç§"></a>2.3 HttpExchangeçš„å˜ç§</h3><p>springå®˜æ–¹å¯¹<code>@HttpExchange</code>æ³¨è§£ï¼Œæä¾›äº†ä¸€äº›æ‰©å±•ï¼Œæ–¹ä¾¿ä½¿ç”¨ï¼š</p><ul><li>GetExchange</li><li>PostExchange</li><li>PutExchange</li><li>PatchExchange</li><li>DeleteExchange</li></ul><h2 id="3-ä¸Šä»£ç "><a href="#3-ä¸Šä»£ç " class="headerlink" title="3. ä¸Šä»£ç "></a>3. ä¸Šä»£ç </h2><p>å¥½äº†ï¼Œæˆ‘ä»¬æ¥å†™ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œçœ‹çœ‹<code>HTTP Interface</code>çš„ä½¿ç”¨ã€‚</p><h3 id="3-1-ä¸šåŠ¡æ¥å£"><a href="#3-1-ä¸šåŠ¡æ¥å£" class="headerlink" title="3.1 ä¸šåŠ¡æ¥å£"></a>3.1 ä¸šåŠ¡æ¥å£</h3><p>è¿™æ˜¯æˆ‘ä»¬é¡¹ç›®é‡Œçš„ä¸šåŠ¡æ¥å£ï¼Œå®šä¹‰äº†<code>HTTP Interface</code>çš„æ¥å£å®šä¹‰ï¼Œé€šè¿‡<code>@GetExchange</code>æ³¨è§£æ¥å®šä¹‰æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">TestApi</span> &#123;<br><br>    <span class="hljs-meta">@GetExchange(value = &quot;/queryTest&quot;,accept = &quot;application/json&quot;)</span><br>    TestRes <span class="hljs-title function_">test</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = &quot;pageNum&quot;,defaultValue = &quot;1&quot;)</span> <span class="hljs-type">int</span> pageNum,</span><br><span class="hljs-params">                     <span class="hljs-meta">@RequestParam(value = &quot;pageSize&quot;,defaultValue = &quot;10&quot;)</span> <span class="hljs-type">int</span> pageSize,</span><br><span class="hljs-params">                     <span class="hljs-meta">@RequestParam(value = &quot;jobName&quot;,required = false)</span> String jobName</span><br><span class="hljs-params">                     </span><br><span class="hljs-params">    )</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿”å›ç»“æœä¼šè‡ªåŠ¨å°è£…åˆ°<code>TestRes</code>å¯¹è±¡ä¸­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span>  <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestBaseRes</span> &#123;<br>    <span class="hljs-keyword">private</span> String msg;<br>    <span class="hljs-keyword">private</span> Integer code;<br>    <span class="hljs-keyword">private</span> Boolean success;<br><br>&#125;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestRes</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">TestBaseRes</span> &#123;<br><br>    <span class="hljs-keyword">private</span> TestData data;<br><br><br>    <span class="hljs-meta">@Data</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestData</span> &#123;<br>        <span class="hljs-keyword">private</span> Integer total;<br>        <span class="hljs-keyword">private</span> JSONArray rows;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3-2-æ³¨å†Œä»£ç†ç±»"><a href="#3-2-æ³¨å†Œä»£ç†ç±»" class="headerlink" title="3.2 æ³¨å†Œä»£ç†ç±»"></a>3.2 æ³¨å†Œä»£ç†ç±»</h3><p>å°†TestApié…ç½®åˆ°ä»£ç†ç±»ä¸­ï¼Œå¹¶æŒ‡å®šè¯·æ±‚åŸŸåï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestConfig</span> &#123;<br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> TestApi <span class="hljs-title function_">testApi</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">RestClient</span> <span class="hljs-variable">restClient</span> <span class="hljs-operator">=</span> RestClient.builder().baseUrl(<span class="hljs-string">&quot;http://localhost:8080/&quot;</span>).build();<br>        <span class="hljs-type">RestClientAdapter</span> <span class="hljs-variable">adapter</span> <span class="hljs-operator">=</span> RestClientAdapter.create(restClient);<br>        <span class="hljs-type">HttpServiceProxyFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> HttpServiceProxyFactory.builderFor(adapter).build();<br><br>        <span class="hljs-keyword">return</span> factory.createClient(TestApi.class);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3-3-ä½¿ç”¨æ¥å£"><a href="#3-3-ä½¿ç”¨æ¥å£" class="headerlink" title="3.3 ä½¿ç”¨æ¥å£"></a>3.3 ä½¿ç”¨æ¥å£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Autowired</span><br>TestApi testApi;<br></code></pre></td></tr></table></figure><p>å®Œæ•´ä»£ç å¯ä»¥æŸ¥çœ‹æˆ‘çš„github: <a href="https://gist.github.com/Hanchers/c0e64954ceefb7e9635a171da6d97e86">spring6.x http interface demo</a></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://docs.spring.io/spring-framework/reference/integration/rest-clients.html#rest-http-interface">spring6 å®˜æ–¹ä½¿ç”¨http interfaceæ¡ˆä¾‹</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>spring</category>
      
      <category>springboot</category>
      
    </categories>
    
    
    <tags>
      
      <tag>spring</tag>
      
      <tag>springboot3.x</tag>
      
      <tag>http interface</tag>
      
      <tag>HttpExchange</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸»åŠ¨æ¨é€æˆ‘ä»¬çš„åšå®¢åˆ°æœç´¢å¼•æ“</title>
    <link href="/2025/02/18/site-hexo-site-url-auto-submit/"/>
    <url>/2025/02/18/site-hexo-site-url-auto-submit/</url>
    
    <content type="html"><![CDATA[<p>å„å¤§æœç´¢å¼•æ“éƒ½æä¾›äº†è®©ç”¨æˆ·ä¸»åŠ¨æ¨é€urlåœ°å€åˆ°æœç´¢å¼•æ“çš„åŠŸèƒ½ï¼Œä½†æ˜¯è¿™ä¸ªåŠŸèƒ½éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å»æ”¶é›†æˆ‘ä»¬çš„urlï¼Œç„¶åå†é€šè¿‡ç¼–ç¨‹çš„æ–¹å¼å»å®ç°æ¨é€åŠŸèƒ½ï¼Œæ¯”è¾ƒéº»çƒ¦ã€‚</p><p>å› ä¸ºä½¿ç”¨çš„æ˜¯hexoæ¶æ„ï¼Œå…¶æœ‰ä¸€äº›æ’ä»¶å·²ç»å®ç°äº†ç±»ä¼¼çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬é€‰æ‹©äº†å…¶ä¸­çš„<code>hexo-submit-urls-to-search-engine</code>æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚</p><p>åŸå› æœ‰äºŒï¼š</p><ol><li>è¿™ä¸ªæ’ä»¶è¿˜åœ¨æ›´æ–°ï¼Œè¯´æ˜è¿˜åœ¨ç»´æŠ¤</li><li>æ”¯æŒç›®å‰ä¸»æµçš„ç™¾åº¦ã€è°·æ­Œã€å¿…åº”æœç´¢å¼•æ“ï¼Œä¸”ä¸€é”®æ¨é€ã€‚</li></ol><p>ä¸‹é¢è®©æˆ‘ä»¬å¼€å§‹å§ï¼</p><h1 id="å‰æœŸå‡†å¤‡"><a href="#å‰æœŸå‡†å¤‡" class="headerlink" title="å‰æœŸå‡†å¤‡"></a>å‰æœŸå‡†å¤‡</h1><p>è¦å°†æˆ‘ä»¬çš„åšå®¢çš„urlæ¨é€çš„æœç´¢å¼•æ“ï¼Œæˆ‘ä»¬å°±å…ˆéœ€è¦åœ¨æœç´¢å¼•æ“é‚£é‡Œæ³¨å†Œè´¦å·ï¼Œç„¶åè·å–å¯¹åº”çš„å¯†é’¥æ‰è¡Œã€‚</p><h2 id="ç™¾åº¦ï¼ˆbaiduï¼‰"><a href="#ç™¾åº¦ï¼ˆbaiduï¼‰" class="headerlink" title="ç™¾åº¦ï¼ˆbaiduï¼‰"></a>ç™¾åº¦ï¼ˆbaiduï¼‰</h2><p>è¿›å…¥<a href="https://ziyuan.baidu.com/site/index#/">ç™¾åº¦èµ„æº</a>ç«™ç‚¹ç®¡ç†é¡µé¢ï¼Œæ·»åŠ ç½‘ç«™ã€‚<br><img src="/../../images/site/seo/baidu-ziyuan-add.png" alt="æ·»åŠ è‡ªå·±çš„ç½‘ç«™"><br>åœ°å€å†™è‡ªå·±çš„ç½‘ç«™åœ°å€å³å¯ã€‚</p><p>ä¸‰æ­¥é…ç½®å¥½åï¼Œç‚¹å‡»æäº¤ï¼Œæˆ‘ä»¬çš„ç«™ç‚¹å°±å·²ç»æ³¨å†Œåˆ°ç™¾åº¦äº†ã€‚ ç†è®ºä¸Šè¿™ä¸ªæ—¶å€™ï¼Œç™¾åº¦çš„çˆ¬è™«å°±ä¼šä¸»åŠ¨çš„çˆ¬å–æˆ‘ä»¬çš„ç½‘ç«™äº†ã€‚</p><p>ä½†æ˜¯å‘¢ï¼Ÿå› ä¸ºæˆ‘çš„åšå®¢æ˜¯æ‰˜ç®¡åœ¨githubä¸Šçš„ï¼Œå› ä¸ºä¼—æ‰€å‘¨çŸ¥çš„åŸå› ï¼Œç™¾åº¦æ˜¯çˆ¬ä¸äº†githubä¸Šçš„ç½‘ç«™çš„ã€‚æ‰€ä»¥ï¼Œå¯¹äºç™¾åº¦çš„æœç´¢å¼•æ“ï¼Œæˆ‘ä»¬ç°åœ¨åªèƒ½é€šè¿‡ä¸»åŠ¨æ¨é€çš„æ–¹å¼ï¼Œå°†æˆ‘ä»¬çš„æ–°æ–‡ç« æ¨é€ç»™ç™¾åº¦ ã€‚</p><p>åœ¨<code>èµ„æºæäº¤</code>-&gt;<code>apiæäº¤</code>ç›®å½•ä¸‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‹¿åˆ°æˆ‘ä»¬è¦æ¨é€çš„æ¥å£åœ°å€å’Œæ¨é€å¯†é’¥ï¼ˆtokenï¼‰äº†ï¼Œè¿™ä¸ªtokenè¦è®°ä½ï¼Œåé¢æ’ä»¶ä¸­ä¼šç”¨åˆ°ã€‚<br><img src="/../../images/site/seo/baidu-ziyuan-api-token.png" alt="ç™¾åº¦apiæäº¤token"></p><p>ç™¾åº¦çš„é…ç½®å°±è¿™äº›ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•ã€‚</p><h2 id="å¿…åº”ï¼ˆbingï¼‰"><a href="#å¿…åº”ï¼ˆbingï¼‰" class="headerlink" title="å¿…åº”ï¼ˆbingï¼‰"></a>å¿…åº”ï¼ˆbingï¼‰</h2><p>è¿›å…¥bingçš„ç«™ç‚¹ç®¡ç†å·¥å…·<a href="https://www.bing.com/webmasters">webmasters</a>ï¼Œ å¦‚æœæ²¡æ³¨å†Œè¿‡ï¼Œ<br>å¯ä»¥å‚è€ƒæˆ‘çš„æ–‡ç« <a href="https://www.hancher.top/2025/01/22/site-bing-site-seo/">å°†æˆ‘ä»¬çš„åšå®¢å½•å…¥bingæœç´¢å¼•æ“</a>å®ç°å‡†å¤‡å·¥ä½œã€‚</p><p>bingç«™ç‚¹æ³¨å†Œå¥½åï¼Œæ‰“å¼€å³ä¸Šè§’çš„é…ç½®æŒ‰é’®,å³å¯çœ‹åˆ°<code>apiè®¿é—®</code>å‡­è¯ç®¡ç†å…¥å£ï¼š<br><img src="/../../images/site/seo/bing-api-token-entry.png" alt="apiè®¿é—®å‡­è¯ç®¡ç†å…¥å£">  </p><p>ç„¶åï¼Œåœ¨<code>APIå¯†é’¥</code>è¿™é‡Œç”Ÿæˆå¯†é’¥ï¼Œè®°ä½è¿™ä¸ªå¯†é’¥ï¼Œåé¢æ’ä»¶ä¸­ä¼šç”¨åˆ°ã€‚<br><img src="/../../images/site/seo/bing-api-token-gen.png" alt="ç”Ÿæˆå¯†é’¥"></p><h2 id="è°·æ­Œï¼ˆgoogleï¼‰"><a href="#è°·æ­Œï¼ˆgoogleï¼‰" class="headerlink" title="è°·æ­Œï¼ˆgoogleï¼‰"></a>è°·æ­Œï¼ˆgoogleï¼‰</h2><p>è°·æ­Œçš„é…ç½®å°±æ¯”è¾ƒéº»çƒ¦äº†ã€‚</p><p>é¦–å…ˆï¼ŒåŒç™¾åº¦ä¸€æ ·ï¼Œæˆ‘ä»¬è¦åœ¨<a href="https://search.google.com/search-console/about">google-search-console</a>é‡Œæ³¨å†Œæˆ‘ä»¬çš„ç½‘ç«™ã€‚<br><img src="/../../images/site/seo/google-search-console-add.png" alt="æ·»åŠ åŸŸåç«™ç‚¹"></p><p>ç„¶åï¼Œåœ¨ç«™ç‚¹æ·»åŠ æˆåŠŸåï¼Œæ‰“å¼€<a href="https://developers.google.cn/search/apis/indexing-api/v3/prereqs?hl=zh-cn">è°·æ­ŒIndex apiæ–‡æ¡£</a>æŒ‰ç…§è¦æ±‚ï¼Œé…ç½®ä¸€äº›å†…å®¹ã€‚<br><img src="/../../images/site/seo/google-index-api-add.png" alt="é…ç½®IndexApiä»…éœ€3æ­¥"></p><h3 id="åˆ›å»ºé¡¹ç›®"><a href="#åˆ›å»ºé¡¹ç›®" class="headerlink" title="åˆ›å»ºé¡¹ç›®"></a>åˆ›å»ºé¡¹ç›®</h3><p>åœ¨è®¾ç½®å·¥å…·é‡Œå…ˆåˆ›å»ºé¡¹ç›®ã€‚åˆ›å»ºé¡¹ç›®å³å¯ï¼Œå¯ç”¨apiï¼Œåé¢è¯´çš„å‡­è¯ä»€ä¹ˆçš„ä¸ç”¨ç®¡ã€‚<br><img src="/../../images/site/seo/google-index-api-open.png" alt="å¯ç”¨api"></p><p>å½“ç„¶ï¼Œé”™è¿‡äº†ä¹Ÿä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥åœ¨<a href="https://console.cloud.google.com/welcome">è°·æ­Œäº‘æ§åˆ¶å°</a>é¦–é¡µè¿›è¡Œè¡¥æ•‘ã€‚<br><img src="/../../images/site/seo/google-cloud-console-welcome.png" alt="è°·æ­Œäº‘é¦–é¡µçš„apiå…¥å£"><br>è¿›å…¥åï¼Œå¼€å¯<code>web search index api</code>å³å¯ã€‚</p><h3 id="åˆ›å»ºæœåŠ¡è´¦å·"><a href="#åˆ›å»ºæœåŠ¡è´¦å·" class="headerlink" title="åˆ›å»ºæœåŠ¡è´¦å·"></a>åˆ›å»ºæœåŠ¡è´¦å·</h3><p>åˆ›å»ºæœåŠ¡è´¦å·ï¼Œåªéœ€è¦å¡«å†™ç¬¬ä¸€æ­¥å³å¯ï¼Œåé¢çš„å¯é€‰æ­¥éª¤éƒ½å¯ä»¥è·³è¿‡ã€‚<br><img src="/../../images/site/seo/google-index-api-service-account-add.png" alt="åˆ›å»ºæœåŠ¡è´¦å·"><br>åˆ›å»ºå¥½æœåŠ¡è´¦å·åï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªé‚®ç®±åœ°å€ï¼Œç±»ä¼¼<code>xxxx@xxxx.iam.gserviceaccount.com</code>ï¼Œè¿™ä¸ªé‚®ç®±è¦è®°ä½ï¼Œåé¢ä¼šç”¨åˆ°ã€‚</p><p>ç„¶åï¼Œåœ¨æœåŠ¡è´¦å·é¡µé¢å»åˆ›å»ºå¯†é’¥ï¼Œé€‰æ‹©<code>JSON</code>æ ¼å¼ï¼Œä¸‹è½½åˆ°è‡ªå·±çš„ç”µè„‘ä¸Šï¼Œåé¢ä¼šç”¨åˆ°ã€‚<br><img src="/../../images/site/seo/google-index-api-service-account-step.png" alt="æœåŠ¡è´¦å·åˆ›å»ºæ­¥éª¤"></p><h3 id="å…³è”ç½‘ç«™"><a href="#å…³è”ç½‘ç«™" class="headerlink" title="å…³è”ç½‘ç«™"></a>å…³è”ç½‘ç«™</h3><p>åœ¨<a href="https://search.google.com/search-console/about">google-search-console</a>é‡Œï¼ˆæ­¤æ—¶åº”è¯¥å·²ç»æ³¨å†Œå¥½ï¼‰ã€‚</p><p>ç‚¹å‡»å·¦è¾¹æ çš„è®¾ç½®ï¼Œè¿›å…¥<code>ç”¨æˆ·å’Œæƒé™</code>é…ç½®éƒ¨åˆ†ï¼š<br><img src="/../../images/site/seo/google-search-console-config-user.png" alt="é…ç½®ç”¨æˆ·"><br>ç‚¹å‡»æ·»åŠ ç”¨æˆ·ï¼Œå°†æˆ‘ä»¬åœ¨æœåŠ¡è´¦å·é‚£é‡Œè·å¾—çš„é‚®ç®±åœ°å€å¡«å…¥ï¼Œé€‰æ‹©<code>æ‹¥æœ‰è€…</code>å³å¯ã€‚<br><img src="/../../images/site/seo/google-search-console-config-user-add.png" alt="æ·»åŠ ç”¨æˆ·"></p><p><strong>æ³¨æ„ï¼Œä¸€å®šè¦é€‰æ‹©æ‹¥æœ‰è€…</strong></p><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬åœ¨è°·æ­Œçš„é…ç½®ä¹Ÿå®Œæˆäº†ã€‚</p><h1 id="å®‰è£…æ’ä»¶"><a href="#å®‰è£…æ’ä»¶" class="headerlink" title="å®‰è£…æ’ä»¶"></a>å®‰è£…æ’ä»¶</h1><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>æ‰“å¼€é¡¹ç›®ï¼Œåœ¨æ§åˆ¶å°æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install --save hexo-submit-urls-to-search-engine<br></code></pre></td></tr></table></figure><p>åœ¨<code>_config.yml</code>ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># ä¸»åŠ¨æäº¤æ–‡ç« åˆ°æœç´¢å¼•æ“</span><br><span class="hljs-attr">hexo_submit_urls_to_search_engine:</span><br>  <span class="hljs-attr">submit_condition:</span> <span class="hljs-string">count</span> <span class="hljs-comment">#é“¾æ¥è¢«æäº¤çš„æ¡ä»¶ï¼Œå¯é€‰å€¼ï¼šcount | period ç°ä»…æ”¯æŒcount</span><br>  <span class="hljs-attr">count:</span> <span class="hljs-number">10</span> <span class="hljs-comment"># æäº¤æœ€æ–°çš„2ä¸ªé“¾æ¥</span><br>  <span class="hljs-attr">period:</span> <span class="hljs-number">900</span> <span class="hljs-comment"># æäº¤ä¿®æ”¹æ—¶é—´åœ¨ 900 ç§’å†…çš„é“¾æ¥</span><br>  <span class="hljs-attr">google:</span> <span class="hljs-number">1</span> <span class="hljs-comment"># æ˜¯å¦å‘Googleæäº¤ï¼Œå¯é€‰å€¼ï¼š1 | 0ï¼ˆ0ï¼šå¦ï¼›1ï¼šæ˜¯ï¼‰</span><br>  <span class="hljs-attr">bing:</span> <span class="hljs-number">1</span> <span class="hljs-comment"># æ˜¯å¦å‘bingæäº¤ï¼Œå¯é€‰å€¼ï¼š1 | 0ï¼ˆ0ï¼šå¦ï¼›1ï¼šæ˜¯ï¼‰</span><br>  <span class="hljs-attr">baidu:</span> <span class="hljs-number">1</span> <span class="hljs-comment"># æ˜¯å¦å‘baiduæäº¤ï¼Œå¯é€‰å€¼ï¼š1 | 0ï¼ˆ0ï¼šå¦ï¼›1ï¼šæ˜¯ï¼‰</span><br>  <span class="hljs-attr">txt_path:</span> <span class="hljs-string">submit_urls.txt</span><br>  <span class="hljs-attr">baidu_host:</span> <span class="hljs-string">https://www.hancher.top</span><br>  <span class="hljs-attr">baidu_token:</span> <span class="hljs-comment"># å‰é¢å¾—åˆ°çš„ç™¾åº¦apiçš„å¯†é’¥</span><br>  <span class="hljs-attr">bing_host:</span> <span class="hljs-string">https://www.hancher.top</span><br>  <span class="hljs-attr">bing_enable_indexnow:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># æ˜¯å¦ç”¨ indexNow æäº¤é“¾æ¥ç»™å¿…åº”: true (Yes) | false (No). åªæœ‰ 2.1.1 åŠä¹‹åçš„ç‰ˆæœ¬æ‰å¯ä»¥å¼€å¯è¿™ä¸ªåŠŸèƒ½ã€‚</span><br>  <span class="hljs-attr">bing_token:</span> <span class="hljs-comment"># å‰é¢å¾—åˆ°çš„å¿…åº”apiçš„å¯†é’¥</span><br>  <span class="hljs-attr">google_host:</span> <span class="hljs-string">https://www.hancher.top</span><br>  <span class="hljs-attr">google_key_file:</span> <span class="hljs-string">xxx.json</span> <span class="hljs-comment">#å­˜æ”¾google keyçš„jsonæ–‡ä»¶ï¼Œæ”¾äºç½‘ç«™æ ¹ç›®å½•ï¼ˆä¸hexo _config.ymlæ–‡ä»¶ä½ç½®ç›¸åŒï¼‰ï¼Œè¯·ä¸è¦æŠŠjsonæ–‡ä»¶å†…å®¹ç›´æ¥å‘å¸ƒåœ¨å…¬ä¼—ä»“åº“é‡Œ!</span><br>  <span class="hljs-attr">google_proxy:</span> <span class="hljs-number">0</span>  <span class="hljs-comment"># åœ¨github ä¸Šï¼Œä¸ç”¨ä»£ç†ã€‚</span><br>  <span class="hljs-attr">replace:</span> <span class="hljs-number">0</span><br><span class="hljs-attr">deploy:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">cjh_google_url_submitter</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">cjh_bing_url_submitter</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">cjh_baidu_url_submitter</span><br></code></pre></td></tr></table></figure><p>æŠŠgoogleä¸‹è½½çš„jsonæ–‡ä»¶æ”¾åœ¨ç½‘ç«™æ ¹ç›®å½•ï¼Œé€š_config.ymlå¹³çº§ã€‚</p><h2 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h2><p>é…ç½®æ’ä»¶å®Œæˆåï¼Œåœ¨æ§åˆ¶å°æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">hexo clean &amp; hexo generate<br><span class="hljs-comment"># æˆ–è€…</span><br>npm run clean &amp; npm run build<br></code></pre></td></tr></table></figure><p>å¦‚æœåœ¨ç”Ÿæˆçš„ç½‘ç«™é‡Œï¼Œæœ‰<code>submit_urls.txt</code>æ–‡ä»¶ï¼Œåˆ™è¯´æ˜é…ç½®æˆåŠŸã€‚</p><h2 id="github-actioné…ç½®"><a href="#github-actioné…ç½®" class="headerlink" title="github actioné…ç½®"></a>github actioné…ç½®</h2><p>åœ¨ä»£ç çš„<code>.github/workflows/hexo.yml</code>é‡Œå¢åŠ å¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">jobs:</span><br>  <span class="hljs-attr">build:</span><br>    <span class="hljs-attr">steps:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">æ„å»ºåšå®¢å†…å®¹</span><br>        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">clean</span> <span class="hljs-string">&amp;&amp;</span> <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">build</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">æäº¤urlåˆ°æœç´¢å¼•æ“</span><br>        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">deploy</span><br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬æäº¤ä»£ç çš„æ—¶å€™å°±ä¼šå‘ç°å·®è·å¯ä»¥æ­£å¸¸è¿è¡Œäº†ã€‚<br><img src="/../../images/site/seo/hexo_auto_submit_url.png" alt="æ’ä»¶è¿è¡Œæ•ˆæœ"><br>ä¸‰å¤§å¼•æ“æäº¤çš„è¿”å›å€¼ï¼š   </p><ul><li>ç™¾åº¦ï¼š</li></ul><p>è¶…è¿‡æ¯æ—¥é™é¢ï¼ˆ10æ¡ï¼‰</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Baidu</span> response:  &#123;<span class="hljs-string">&quot;error&quot;</span>:<span class="hljs-number">400</span>,<span class="hljs-string">&quot;message&quot;</span>:<span class="hljs-string">&quot;over quota&quot;</span>&#125;<br></code></pre></td></tr></table></figure><p>ç°åœ¨ç™¾åº¦çš„æ¯æ—¥é™é¢å°±å‰©10æ¡äº†ï¼Œè¯·èŠ‚çº¦ä½¿ç”¨ã€‚</p><p>æˆåŠŸï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Baidu</span> response:  &#123;<span class="hljs-string">&quot;remain&quot;</span>:<span class="hljs-number">0</span>,<span class="hljs-string">&quot;success&quot;</span>:<span class="hljs-number">10</span>&#125;<br></code></pre></td></tr></table></figure><ul><li>å¿…åº”ï¼š</li></ul><p>è¶…è¿‡æ¯æ—¥é™é¢ï¼ˆ10æ¡ï¼‰</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs nix">Bing <span class="hljs-params">response:</span>  &#123;<br>  <span class="hljs-params">ErrorCode:</span> <span class="hljs-number">2</span>,<br>  <span class="hljs-params">Message:</span> &#x27;ERROR<span class="hljs-operator">!</span><span class="hljs-operator">!</span><span class="hljs-operator">!</span> You have exceeded your daily url submission <span class="hljs-params">quota :</span> <span class="hljs-number">10</span>&#x27;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯†é’¥æ²¡æœ‰é…ç½®å¯¹ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">Bing response:  &#123; ErrorCode: 3, Message: &#x27;ERROR!!! InvalidApiKey&#x27; &#125;<br></code></pre></td></tr></table></figure><p>æˆåŠŸï¼š</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nix">Bing <span class="hljs-params">response:</span>  &#123; <span class="hljs-params">d:</span> <span class="hljs-literal">null</span> &#125;<br></code></pre></td></tr></table></figure><ul><li>è°·æ­Œï¼š<br>ç½‘ç«™å…³è”è´¦å·ä¸æ˜¯æ‹¥æœ‰è€…æƒé™</li></ul><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs markdown">Google response:  &#123;<br>  error: &#123;<br><span class="hljs-code">    code: 403,</span><br><span class="hljs-code">    message: &#x27;Permission denied. Failed to verify the URL ownership.&#x27;,</span><br><span class="hljs-code">    status: &#x27;PERMISSION_DENIED&#x27;</span><br><span class="hljs-code">  &#125;</span><br><span class="hljs-code">&#125;</span><br></code></pre></td></tr></table></figure><p>index api æ²¡æœ‰å¼€å¯ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs markdown">Google response:  &#123;<br>  error: &#123;<br><span class="hljs-code">    code: 403,</span><br><span class="hljs-code">    message: &#x27;Web Search Indexing API has not been used in project xxx before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/indexing.googleapis.com/overview?project=xxxx then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.&#x27;,</span><br><span class="hljs-code">    status: &#x27;PERMISSION_DENIED&#x27;,</span><br><span class="hljs-code">    details: [ [Object], [Object], [Object] ]</span><br><span class="hljs-code">  &#125;</span><br><span class="hljs-code">&#125;</span><br></code></pre></td></tr></table></figure><p>ç‚¹å‡»è¿”å›çš„é“¾æ¥ï¼Œå»å¼€å¯apiæƒé™å³å¯ã€‚</p><p>æˆåŠŸï¼š  </p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs markdown">Google response:  &#123;<br>  urlNotificationMetadata: &#123;<br><span class="hljs-code">    url: &#x27;https://www.hancher.top/2025/02/11/exception-doris-stream-load-from-clickhouse-by-data-crash/&#x27;</span><br><span class="hljs-code">  &#125;</span><br><span class="hljs-code">&#125;</span><br></code></pre></td></tr></table></figure><p>å¦‚æ­¤ï¼Œæˆ‘ä»¬çš„ä¸»åŠ¨æäº¤urlåˆ°æœç´¢å¼•æ“çš„é…ç½®å°±å®Œæˆäº†ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://h.cjh0613.com/zh/posts/hexo-submit-urls-to-search-engine/">hexo-submit-urls-to-search-engineå®˜æ–¹æ–‡æ¡£åœ°å€</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç«™</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å»ºç«™</tag>
      
      <tag>seo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€æ–‡å¼„æ‡‚å•ç‚¹ç™»å½•çš„å‡ ç§æŠ€æœ¯é€‰å‹</title>
    <link href="/2025/02/12/architecture-sso-index/"/>
    <url>/2025/02/12/architecture-sso-index/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨æä¸€ä¸ªå•ç‚¹ç™»å½•çš„é¡¹ç›®ï¼Œé¡ºä¾¿æŠŠå•ç‚¹ç™»å½•çš„å‡ ç§æ–¹æ¡ˆç ”ç©¶äº†ä¸€ä¸‹,åœ¨è¿™é‡Œæ±‡æ€»åˆ†æä¸€ä¸‹ï¼Œè®©å¤§å®¶æœ‰ä¸€ä¸ªæ•´ä½“çš„è®¤è¯†ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯å•ç‚¹ç™»å½•"><a href="#ä»€ä¹ˆæ˜¯å•ç‚¹ç™»å½•" class="headerlink" title="ä»€ä¹ˆæ˜¯å•ç‚¹ç™»å½•"></a>ä»€ä¹ˆæ˜¯å•ç‚¹ç™»å½•</h2><p>åœ¨ä»‹ç»å•ç‚¹ç™»å½•çš„æ–¹æ¡ˆå‰ï¼Œå…ˆè¯´æ˜ä¸€ä¸‹ä»€ä¹ˆæ˜¯å•ç‚¹ç™»å½•ï¼Ÿ  </p><p>å•ç‚¹ç™»å½•ï¼ˆSingle Sign Onï¼Œç®€ç§° SSOï¼‰ï¼Œæ˜¯æŒ‡åœ¨å¤šç³»ç»Ÿåº”ç”¨ç¾¤ä¸­ç™»å½•ä¸€ä¸ªç³»ç»Ÿï¼Œä¾¿å¯åœ¨å…¶ä»–æ‰€æœ‰ç³»ç»Ÿä¸­å¾—åˆ°æˆæƒï¼Œæ— éœ€å†æ¬¡ç™»å½•ã€‚</p><p>å®ƒæ ¸å¿ƒè§£å†³äº†ä¸€ä¸ªé—®é¢˜ï¼šç”¨æˆ·åªéœ€è¦ç™»å½•ä¸€æ¬¡ï¼Œå°±å¯ä»¥è®¿é—®æ‰€æœ‰ç›¸äº’ä¿¡ä»»çš„åº”ç”¨ç³»ç»Ÿã€‚</p><p>å³ï¼Œåœ¨å•ç‚¹ç™»å½•ä½“ç³»ï¼ˆSSOï¼‰ä¸­ï¼Œå¿…ç„¶ä¼šæ¶‰åŠåˆ°ä¸‹é¢å‡ ç§è§’è‰²ï¼š</p><ul><li>å¤šå¥—ç³»ç»Ÿåº”ç”¨ï¼šå¦‚æœæ˜¯å•å¥—çš„è¯ï¼Œæ²¡å¿…è¦SSO</li><li>ç™»å½•ç”¨æˆ·ï¼šä¸€å¥—å…¨å±€é€šè¡Œçš„ç”¨æˆ·ä¸­å¿ƒ</li><li>SSOè®¤è¯ä¸­å¿ƒï¼šç”¨æ¥å®ç°ç™»å½•è®¤è¯çš„åœ°å€ï¼Œåªæœ‰è¿™é‡Œè¯´ç”¨æˆ·æ˜¯å¯ä¿¡çš„ï¼Œè¿™ä¸ªç”¨æˆ·æ‰æ˜¯å¯ä¿¡çš„ã€‚</li></ul><p>è€Œä¸”è¿›ä¸€æ­¥åˆ’åˆ†ï¼Œå•ç‚¹ç™»å½•è¿˜å¯ä»¥ç»†åŒ–åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šè®¤è¯å’Œæˆæƒã€‚  </p><blockquote><p>è®¤è¯ï¼šä¹Ÿå¯ä»¥ç§°ä¸ºé‰´æƒï¼Œå°±æ˜¯é‰´å®šè´¦å·æ˜¯å¦æ˜¯å¯ä¿¡çš„ï¼Œæ˜¯å¦ç³»ç»Ÿçº¦å®šçš„åˆæ³•è´¦å·ã€‚<br>æˆæƒï¼šå°±æ˜¯ç»™åˆæ³•çš„è´¦å·æˆäºˆä¸€å®šçš„æƒé™ï¼Œæ¯”å¦‚åªè¯»æƒé™ï¼Œæ¯”å¦‚è¯»å†™æƒé™ç­‰ã€‚</p></blockquote><p>åœ¨è¿™ä¸ªåŸºç¡€ä¸Šï¼Œ å•ç‚¹ç™»å½•çš„ç±»å‹åˆå¯ä»¥åˆ†ä¸ºç»†åˆ†ä¸ºä¸¤ç§: ä»…æ”¯æŒè®¤è¯ï¼Œå’Œè®¤è¯æˆæƒéƒ½æ”¯æŒã€‚</p><h2 id="å¸¸è§çš„å•ç‚¹ç™»å½•æ–¹æ¡ˆ"><a href="#å¸¸è§çš„å•ç‚¹ç™»å½•æ–¹æ¡ˆ" class="headerlink" title="å¸¸è§çš„å•ç‚¹ç™»å½•æ–¹æ¡ˆ"></a>å¸¸è§çš„å•ç‚¹ç™»å½•æ–¹æ¡ˆ</h2><p>ç®€å•ä»‹ç»ä¸€ä¸‹å½“å‰ä¸»æµçš„å•ç‚¹ç™»å½•æ–¹æ¡ˆï¼Œä»¥åŠé€‚ç”¨åœºæ™¯ã€‚</p><h3 id="CAS"><a href="#CAS" class="headerlink" title="CAS"></a>CAS</h3><p>CAS(Central Authentication Service): ä¸­å¿ƒæˆæƒæœåŠ¡ã€‚é¡¾åæ€ä¹‰å°±æ˜¯å…ˆæœ‰ä¸€ä¸ªä¸­å¿ƒæˆæƒæœåŠ¡å™¨ï¼Œ<br>å…¶ä»–çš„æ‰€æœ‰çš„ä¸šåŠ¡æœåŠ¡å™¨åœ¨éœ€è¦èº«ä»½è®¤è¯çš„æ—¶å€™ï¼Œéƒ½ä¼šå‘ <strong>ä¸­å¿ƒæˆæƒæœåŠ¡</strong> ç¡®è®¤èº«ä»½ï¼Œé‰´å®šæ˜¯å¦åˆæ³•ã€‚<br>è¿™ä¸ªè¿‡ç¨‹ä¸­ä¸€èˆ¬ä¸æ¶‰åŠæƒé™çš„ç®¡ç†ï¼Œæˆ–è€…è¯´æƒé™çš„ç®¡ç†åœ¨å„ä¸ªå­ç³»ç»Ÿå®ç°ã€‚</p><p>æ‰€ä»¥ï¼ŒCASæ˜¯ä¸€ç§ä»…æ”¯æŒè®¤è¯çš„è®¤è¯æ–¹æ¡ˆï¼ä½†ç›¸å¯¹å…¶ä»–è®¤è¯æˆæƒæ–¹æ¡ˆæ¥è¯´ï¼ŒCASä¹Ÿè¶³å¤Ÿç®€å•ã€‚</p><p>å¯¹äºå¤§éƒ¨åˆ†çš„åº”ç”¨åœºæ™¯æ¥è¯´ï¼Œè¿™å°±å¤Ÿäº†ã€‚å› ä¸ºCASè¶³å¤Ÿç®€å•ï¼Œå¾ˆå¤šåœºæ™¯ä¹Ÿä¸éœ€è¦æƒé™ç®¡ç†ï¼Œåªéœ€è¦é‰´å®šè®¿é—®æ˜¯å¦åˆæ³•å°±è¡Œäº†ã€‚</p><p>ä»¥ä¸‹æ˜¯casåè®®æ¶æ„ï¼š<br><img src="/../../images/tech/architecture/sso/cas_arch.png" alt="casåè®®æ¶æ„"></p><p>casè¯·æ±‚è®¤è¯çš„æ—¶åºå›¾ï¼š<br><img src="/../../images/tech/architecture/sso/cas_flow_diagram.png" alt="casè¯·æ±‚è®¤è¯çš„æ—¶åºå›¾"></p><p>åº”ç”¨åœºæ™¯ï¼šæ‰€æœ‰ä¸éœ€è¦æƒé™ç®¡ç†çš„åº”ç”¨é›†ç¾¤</p><ul><li>åå°æœåŠ¡å™¨é—´çš„è·¨æœåŠ¡è®¿é—®</li><li>æ™®é€šçš„ä¸€å¤„ç™»å½•ï¼Œå¤„å¤„è®¿é—®</li><li>å†…éƒ¨æœåŠ¡å†…éƒ¨é›†ç¾¤ï¼Œå› ä¸ºå†…ç½‘çš„ä¿æŠ¤ï¼Œå½¼æ­¤é—´å¤©ç„¶å°±æ˜¯å¯ä¿¡çš„</li></ul><h3 id="OAuth2"><a href="#OAuth2" class="headerlink" title="OAuth2"></a>OAuth2</h3><p>OAuth2(Open Authorizationï¼‰: å¼€å‘æˆæƒåè®®ã€‚ä»–çš„å®šä½æœ€å¼€å§‹æ˜¯ç”¨äºç¬¬ä¸‰æ–¹å…å¯†ç™»å½•å’Œèµ„æºæˆæƒï¼Œæ¯”å¦‚ä½¿ç”¨å¾®ä¿¡å…å¯†ç™»å½•å¾®åšã€‚<br>å› ä¸ºè¿™ä¸ªç‰¹æ€§ï¼Œå…¶å¤©ç„¶çš„ç®—æ˜¯ä¸€ç§å•ç‚¹ç™»å½•æ–¹æ¡ˆã€‚</p><p>OAuth2æ”¯æŒè®¤è¯å’Œæˆæƒã€‚ä¸caså¤§å¤šå®åœ¨ä¸€ä¸ªå¯ä¿¡çš„å†…ç½‘ç¯å¢ƒä¸åŒï¼Œ<br>OAuth2çš„æ ¸å¿ƒç›®çš„æ˜¯ä¸ºäº†è§£å†³åœ¨å®Œå…¨ä¸å¯ä¿¡çš„ç½‘ç»œç¯å¢ƒä¸‹è§£å†³ç™»å½•æ–¹ä¸åº”ç”¨æ–¹çš„ä¿¡ä»»é—®é¢˜ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šæä¾›äº†ä¸€å¥—æˆæƒåŠŸèƒ½ã€‚<br>æ‰€ä»¥ï¼ŒOAuth2çš„å®šä½å’ŒCASè¿˜æ˜¯ä¸åŒçš„ï¼Œé‚£ä¹ˆç›¸åº”çš„åº”ç”¨åœºæ™¯ä¹Ÿå°±æœ‰äº†åŒºåˆ«ï¼š</p><p>OAuth2çš„åº”ç”¨åœºæ™¯ï¼š</p><ul><li>ç¬¬ä¸‰æ–¹å…è´¹ç™»å½•æŸä¸ªåº”ç”¨ç³»ç»Ÿ</li><li>å¯¹äºä¸åŒæ¥æºçš„ç”¨æˆ·è®¾ç½®ä¸åŒçš„è®¿é—®çº§åˆ«</li><li>ä¼ä¸šå†…éƒ¨çš„å•ç‚¹ç™»å½•</li></ul><p>OAuth2ä½“ç³»çš„è§’è‰²åˆ’åˆ†ï¼š</p><ul><li>èµ„æºæ‹¥æœ‰è€…(resource owner)ï¼šæ¯”å¦‚ç™»å½•ç”¨æˆ·</li><li>èµ„æºæœåŠ¡(resource server)ï¼šç”¨æˆ·çš„èµ„æºæ‰€å­˜å‚¨çš„æœåŠ¡</li><li>å®¢æˆ·ç«¯(client)ï¼šç”¨æˆ·ç°åœ¨éœ€è¦ç™»å½•çš„åº”ç”¨</li><li>æˆæƒæœåŠ¡(authorization server)ï¼šæˆæƒè®¤è¯çš„æœåŠ¡</li></ul><p>è¿˜æ˜¯ä»¥ä¸Šé¢å¾®ä¿¡å…å¯†ç™»å½•å¾®åšä¸ºä¾‹ï¼Œä¸€èˆ¬åœ¨ç™»å½•è¿‡ç¨‹ä¸­ï¼Œä¼šæç¤ºæˆ‘ä»¬æˆæƒå¾®åšä½¿ç”¨å¾®ä¿¡çš„å¤´åƒç­‰ä¿¡æ¯ï¼Œç™»å½•æˆåŠŸåï¼Œå¾®åšçš„å¤´åƒå°±æ˜¯å¾®ä¿¡çš„å¤´åƒäº†ï¼š</p><ul><li>èµ„æºæ‹¥æœ‰è€…ï¼šå¾®ä¿¡ç”¨æˆ·</li><li>èµ„æºæœåŠ¡ï¼šå¾®ä¿¡ç”¨æˆ·çš„ä¸€äº›ä¿¡æ¯æä¾›æ–¹çš„æœåŠ¡ï¼Œæ¯”å¦‚å¾®ä¿¡çš„å¤´åƒã€æ˜µç§°ç­‰ä¿¡æ¯æœåŠ¡ã€‚ç®€å•æ¥è¯´å°±æ˜¯å¾®ä¿¡æœåŠ¡å™¨ã€‚</li><li>å®¢æˆ·ç«¯ï¼šå¾®ä¿¡ç”¨æˆ·ç°åœ¨è¦ç™»å½•çš„å¾®åšåº”ç”¨ã€‚</li><li>æˆæƒæœåŠ¡ï¼šå¾®ä¿¡çš„OAuth2æˆæƒæœåŠ¡ã€‚</li></ul><p>OAuth2åè®®çš„æ¶æ„å›¾ï¼š<br><img src="/../../images/tech/architecture/sso/oauth2_flow.png" alt="oauth2åè®®æ¶æ„"></p><p>OAuth2é€‰å‹æµç¨‹å›¾ï¼š<br><img src="/../../images/tech/architecture/sso/oauth2_grant_flowchart.png" alt="oauth2é€‰å‹æµç¨‹"></p><h3 id="JWT"><a href="#JWT" class="headerlink" title="JWT"></a>JWT</h3><p>JWT(JSON Web Token)ï¼Œæ˜¯ä¸€ç§ç”¨äºåœ¨åº”ç”¨ç¨‹åºä¹‹é—´ä½¿ç”¨jsonçš„æ–¹å¼ä¼ é€’æ•°æ®çš„å®‰å…¨ä»¤ç‰Œã€‚ä¸¥æ ¼æ¥è¯´ï¼ŒJWTä¸æ˜¯ä¸€ç§ssoåè®®ï¼Œè€Œæ˜¯ä¸€ç§æ•°æ®æ ¼å¼ã€‚</p><p>ä½†æ˜¯åœ¨ssoåè®®è¿‡ç¨‹ä¸­ï¼Œç”Ÿæˆçš„å¯ä¿¡å‡­è¯ï¼Œå¦‚æœæƒ³åœ¨äº’è”ç½‘è¿™ä¸ªä¸å¯ä¿¡çš„ç¯å¢ƒä¸‹ä¼ è¾“ï¼ŒJWTä¹Ÿå°±æ´¾ä¸Šäº†ç”¨åœºã€‚</p><h4 id="ç»“æ„"><a href="#ç»“æ„" class="headerlink" title="ç»“æ„"></a>ç»“æ„</h4><p>JWTç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š</p><ul><li>å¤´éƒ¨(Header)ï¼šåŒ…å«ç­¾åç®—æ³•ã€åŠ å¯†ç®—æ³•ç­‰ä¿¡æ¯ã€‚<ul><li>typï¼šä»¤ç‰Œçš„ç±»å‹ï¼Œé€šå¸¸æ˜¯JWT</li><li>algï¼šç­¾åç®—æ³•ï¼Œå¦‚HS256ã€RS256ç­‰ã€‚</li></ul></li><li>è´Ÿè½½(Payload)ï¼šåŒ…å«ç”¨æˆ·ä¿¡æ¯ã€æƒé™ä¿¡æ¯ç­‰,å¯ä»¥åŒ…å«ä»¥ä¸‹å­—æ®µä»¥åŠä»»æ„è‡ªå®šä¹‰çš„å­—æ®µã€‚<ul><li>iss: Issuerã€‚JWTçš„ç­¾å‘äººï¼Œéå¿…å¡«</li><li>sub: Subjectã€‚ä¸»é¢˜ï¼ŒJWTæ‰€é¢å‘çš„ç”¨æˆ·æˆ–å®ä½“çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œéå¿…å¡«</li><li>aud: Audienceã€‚å—ä¼—ï¼ŒJWTçš„é¢„æœŸæ¥æ”¶è€…ï¼Œéå¿…å¡«</li><li>exp: Expiration Timeã€‚è¿‡æœŸæ—¶é—´ï¼Œéå¿…å¡«</li><li>nbf: Not Beforeã€‚ç”Ÿæ•ˆæ—¶é—´ï¼ŒJWTåœ¨æ­¤æ—¶é—´ä¹‹å‰ä¸å¯ç”¨ï¼Œéå¿…å¡«</li><li>iat: Issued Atã€‚ç­¾å‘æ—¶é—´ï¼Œéå¿…å¡«</li><li>jti: JWT IDã€‚JWTçš„å”¯ä¸€æ ‡è¯†ï¼Œéå¿…å¡«</li></ul></li><li>ç­¾å(Signature)ï¼šå°†å¤´éƒ¨ã€è´Ÿè½½å’Œå¯†é’¥è¿›è¡Œç­¾åã€‚<ul><li>å‰é¢ç®—æ³•ï¼šsignature &#x3D; HS256ï¼ˆbase64UrlEncode(header) + â€œ.â€ + base64UrlEncode(payload), secretï¼‰</li></ul></li></ul><p>æœ€åå½¢æˆä¸€ä¸ªTokenå­—ç¬¦ä¸²ï¼š<code>xxx.yyy.zzz</code>ï¼Œ å³ï¼š</p><blockquote><p>base64UrlEncode(header).base64UrlEncode(payload).signature</p></blockquote><p>ç”±æ­¤å¯è§ï¼ŒJWTé‡Œçš„æ•°æ®è™½ç„¶ç»è¿‡base64ç¼–ç ï¼Œä½†æ˜¯æœªåŠ å¯†ï¼Œæ‰€ä»¥ä¸€èˆ¬ä»…æ”¾ä¸€äº›å…¬å…±ä¿¡æ¯ã€‚</p><p>ä¸è¿‡å› ä¸ºå…¶ä¸­ä¹Ÿæœ‰é€šè¿‡å¯†é’¥è¿›è¡Œç­¾åçš„ç¯èŠ‚ï¼Œå¦‚æœå†é…ä¸ŠåŠ å¯†ç®—æ³•å¯¹ä¸€äº›ä¿¡æ¯çš„åŠ å¯†ï¼Œä¹Ÿå¯ä»¥å½“åšä¸€ä¸ªæ— æœåŠ¡å™¨åŒ–çš„æç®€ç‰ˆssoå‡­è¯ï¼šå³èƒ½å¤Ÿæ­£ç¡®è§£å¯†è¯†åˆ«JWTçš„å‡­è¯éƒ½æ˜¯å¯ä¿¡å‡­è¯ã€‚</p><p>ä½†è¿™ä»…æ˜¯ç‰¹æ®Šåœºæ™¯çš„ä½¿ç”¨ï¼Œä¸€èˆ¬æƒ…å†µè¿˜æ˜¯å°†JWTå½“åšCAS æˆ– OAuth2 çš„å‡­è¯åœ¨äº’è”ç½‘ä¸­ä¼ è¾“çš„è½½ä½“ã€‚</p><h3 id="OIDC"><a href="#OIDC" class="headerlink" title="OIDC"></a>OIDC</h3><p>OIDCï¼ˆOpenID Connectï¼‰åè®®ï¼Œæ˜¯åœ¨OAuth2 çš„åŸºç¡€ä¸Šå‘å±•å‡ºæ¥çš„ä¸€ä¸ªåè®®ï¼Œä¸»è¦åº”ç”¨ä¸èº«ä»½çš„è®¤è¯ã€‚<br>ä¸OAuth2ç›¸æ¯”ï¼ŒOIDCè¡ç”Ÿå‡ºäº†ä¸€ä¸ª<code>ID Token</code>çš„æ¦‚å¿µï¼Œç”¨æ¥æ ‡è¯†ç™»å½•ç”¨æˆ·çš„èº«ä»½éªŒè¯ã€‚</p><p>OIDCçš„è§’è‰²åˆ’åˆ†ï¼š</p><ul><li>End Userï¼ˆEUï¼‰ï¼šèµ„æºæ‰€æœ‰è€…ï¼Œå³ç”¨æˆ·ï¼Œå¯¹åº”OAuth2ä¸­çš„èµ„æºæ‹¥æœ‰è€…ï¼›</li><li>Relying Partyï¼ˆRPï¼‰ï¼šæŒ‡ä»£åœ¨ OAuth 2.0 ä¸­ï¼Œå—ä¿¡ä»»çš„å®¢æˆ·ç«¯ï¼Œèº«ä»½è®¤è¯å’Œæˆæƒä¿¡æ¯çš„æ¶ˆè´¹æ–¹ï¼›</li><li>ID Tokenï¼šOIDCæ–°å¢ï¼ŒåŒ…å« EU èº«ä»½è®¤è¯ä¿¡æ¯çš„ JWT æ ¼å¼æ•°æ®ï¼Œæ˜¯ç”¨æˆ·çš„èº«ä»½å‡­è¯ï¼›</li><li>OpenID Providerï¼ˆOPï¼‰ï¼šæœ‰èƒ½åŠ›æä¾›èº«ä»½è®¤è¯çš„æœåŠ¡æ–¹ï¼Œ å¯¹åº”OAuth2ä¸­çš„æˆæƒæœåŠ¡ï¼›</li><li>UserInfo Endpointï¼šå— OAuth 2.0 ä¿æŠ¤çš„ç”¨æˆ·ä¿¡æ¯æ¥å£ï¼Œæ­¤æ¥å£å¿…é¡»ä½¿ç”¨ HTTPSï¼Œèƒ½å¤Ÿå½“ RP ä½¿ç”¨ ID Token è®¿é—®æ—¶è¿”å›ç”¨æˆ·çš„ä¿¡æ¯ã€‚</li></ul><p>æ‰€ä»¥ï¼Œç›¸å¯¹äºOAuth2ï¼ŒOIDCå…¶è®¾è®¡æ›´åŠ ç²¾ç®€ï¼Œä¹Ÿæ›´é€‚ç”¨äºssoçš„åœºæ™¯ã€‚ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¦‚æœå†³å®šé€‰å‹OAuth2ï¼Œé‚£ä¹ˆOIDCå¯èƒ½æ›´å¥½ä¸€ç‚¹ã€‚</p><p>OIDCçš„æ¶æ„å›¾ï¼š<br><img src="/../../images/tech/architecture/sso/oidc_arch.png" alt="oidcåè®®æ¶æ„"></p><h3 id="SAML"><a href="#SAML" class="headerlink" title="SAML"></a>SAML</h3><p>SAMLï¼ˆSecurity Assertion Markup Languageï¼‰æ˜¯ä¸€ç§åŸºäºXMLçš„æ ‡å‡†ï¼Œç”¨äºåœ¨ä¸åŒçš„å®‰å…¨åŸŸä¹‹é—´ä¼ é€’èº«ä»½éªŒè¯å’Œæˆæƒæ•°æ®ï¼Œä¾§é‡äºä¸åŒä¼ä¸šé—´èº«ä»½è®¤è¯ã€‚</p><p>æ¶‰åŠçš„è§’è‰²ï¼š</p><ul><li>Service Provider(SP)ï¼šæœåŠ¡æä¾›æ–¹ï¼Œ</li><li>Identity Provider(IdP)ï¼šèº«ä»½æä¾›æ–¹ï¼Œ</li></ul><p>SAML2çš„æ¶æ„å›¾ï¼š<br><img src="/../../images/tech/architecture/sso/saml-flow-overview.png" alt="saml-flow-overview.png"><br>ç”±å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼ŒSPå’ŒIdPä¹‹é—´çš„é€šä¿¡å¿…é¡»æ˜¯é€šè¿‡æµè§ˆå™¨æ¥å®ç°çš„ã€‚</p><p>SAML2çš„åº”ç”¨åœºæ™¯ï¼š</p><ul><li>ä¸åŒä¼ä¸šé—´çš„å•ç‚¹ç™»å½•åœºæ™¯</li><li>å› ä¸ºä½¿ç”¨äº†æµè§ˆå™¨çš„é‡å®šå‘æŠ€æœ¯ï¼Œé€‚ç”¨äºwebåœºæ™¯ï¼Œç§»åŠ¨ç«¯çš„ssoä¸è¦è€ƒè™‘</li><li>ä¼ä¸šå†…éƒ¨çš„ä¸åŒSaasé›†æˆï¼Œæ¯”å¦‚ä¸€ä¸ªè´¦å·ç™»å½•ä¸åŒçš„Saasåº”ç”¨</li><li>SAML 2.0 æ”¯æŒæ•°å­—ç­¾åã€åŠ å¯†æ–­è¨€ç­‰åŠŸèƒ½ï¼Œé€‚ç”¨äºå¯¹å®‰å…¨æ€§è¦æ±‚è¾ƒé«˜çš„ç³»ç»Ÿ</li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä»¥ä¸Šä¸‰ç§åè®®éƒ½æ”¯æŒå•ç‚¹ç™»å½•åŠŸèƒ½ã€‚</p><p>ä»åº”ç”¨å®šä½è§’åº¦è¿˜æ˜¯æœ‰äº›å·®å¼‚çš„ï¼š</p><ul><li>casæ›´é€‚ç”¨äºå…¬å¸å†…éƒ¨æ­å»ºè½»é‡æˆæƒæœåŠ¡ã€‚</li><li>OAuth&#x2F;OIDCï¼Œæ˜¯é¢å‘äºåœ¨éä¿¡è®¤æ¡ä»¶ä¸‹çš„ä¿¡ä»»æˆæƒé—®é¢˜ï¼Œæ—¢æ”¯æŒè®¤è¯ï¼Œåˆæ”¯æŒæˆæƒã€‚</li><li>SAMLï¼Œä¸‰è€…é‡Œé¢çš„è€å¤§å“¥ï¼ŒåŠŸèƒ½ä¸Šä¸OAuthæœ‰ç‚¹é‡å ã€‚æ›´é‡ï¼Œä½†ä¹Ÿæ›´å®‰å…¨,é€‚ç”¨äºè·¨ä¼ä¸šç«¯é€šä¿¡ã€‚</li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://auth0.com/intro-to-iam/saml-vs-oauth">SAMLä¸OAuthå¯¹æ¯”</a></p><p><a href="https://apereo.github.io/cas/7.1.x/index.html">CASå®˜æ–¹ä»‹ç»</a></p><p><a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-1-11">OAuth2å®˜æ–¹ä»‹ç»</a></p><p><a href="https://jwt.io/">JWTå®˜æ–¹ä»‹ç»</a><br><a href="https://datatracker.ietf.org/doc/html/rfc7519">JWTåè®®</a></p><p><a href="https://www.cnblogs.com/CKExp/p/16084545.html">ç†è§£OIDCåè®®å’Œè®¤è¯æœºåˆ¶</a></p><p><a href="https://docs.authing.cn/v2/concepts/saml/saml-flow.html">ç†è§£ SAML æµç¨‹</a></p>]]></content>
    
    
    <categories>
      
      <category>ç³»ç»Ÿè®¾è®¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¶æ„</tag>
      
      <tag>å•ç‚¹ç™»å½•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>dorisé€šè¿‡dataXå¯¼å…¥æ•°æ®å‘ç”Ÿå®•æœºé—®é¢˜è§£å†³</title>
    <link href="/2025/02/11/exception-doris-stream-load-from-clickhouse-by-data-crash/"/>
    <url>/2025/02/11/exception-doris-stream-load-from-clickhouse-by-data-crash/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¾èµ–ç‰ˆæœ¬"><a href="#ä¾èµ–ç‰ˆæœ¬" class="headerlink" title="ä¾èµ–ç‰ˆæœ¬"></a>ä¾èµ–ç‰ˆæœ¬</h2><ul><li>dorisï¼š 2.1.0</li><li>clickhouseï¼š 22.1.3.7</li><li>dataXï¼š ä½¿ç”¨ä»£ç è‡ªå·±ç¼–è¯‘çš„æœ€æ–°ç‰ˆæœ¬</li></ul><h2 id="é—®é¢˜å‘ç°"><a href="#é—®é¢˜å‘ç°" class="headerlink" title="é—®é¢˜å‘ç°"></a>é—®é¢˜å‘ç°</h2><p>åˆ›å»ºä¸€ä¸ªæ­£å¸¸çš„dataX é‡‡é›†ä»»åŠ¡ï¼Œä»clickhouseçš„ä¸€å¼ è¡¨é‡Œå‘dorisé‡Œå†™æ•°æ®ï¼Œ ä½¿ç”¨çš„æ˜¯<code>clickhousereader</code>å’Œ <code>doriswriter</code>ã€‚ </p><p>å¾ˆç®€å•çš„ä¸€ä¸ªä»»åŠ¡ï¼Œæ•°æ®é‡ç†è®ºä¸Šä¹Ÿä¸å¤šï¼Œæ‰16ä¸‡ï¼Œ60å¤šMçš„æ³¨è§£ï¼Œå¯æ˜¯ä¸€æ‰§è¡Œï¼Œdorisçš„beå°±å…¨éƒ¨å®•æœºäº†ã€‚</p><p>é—®é¢˜æ˜¯æˆ‘ä»¬ç”¨è¿™å¥—ç¯å¢ƒè·‘è¿‡å¾ˆå¤šç§æ•°æ®åº“çš„æ•°æ®é‡‡é›†ï¼Œæ¯”å¦‚mysqlï¼Œoracle, postgresqlç­‰ï¼Œç»“æœéƒ½æ­£å¸¸ã€‚åªæœ‰clickhouseæ•°æ®åº“çš„é‡‡é›†ä»»åŠ¡ï¼Œä¸€æ‰§è¡Œå°±æŠ¥é”™ï¼</p><p>æŠ¥çš„é”™æœ‰ä¸¤ç§å½¢å¼ï¼š<br>ä¸€ç§æ˜¯ç›´æ¥æç¤ºbeæœåŠ¡è¿æ¥å¤±è´¥ï¼š<br><img src="/../../images/tech/db/doris_from_datax_err.png" alt="doris beæ‹’æ¥è¿æ¥"><br>å¦ä¸€ç§è¿˜æœ‰è¿”å›å€¼ï¼Œä½†æ˜¯æç¤º<code>Label already exists</code>çš„é”™è¯¯ï¼š<br><img src="/../../images/tech/db/doris_from_datax_err2.png" alt="Label already exists"></p><h2 id="é—®é¢˜æ’æŸ¥"><a href="#é—®é¢˜æ’æŸ¥" class="headerlink" title="é—®é¢˜æ’æŸ¥"></a>é—®é¢˜æ’æŸ¥</h2><p>åœ¨æ’æŸ¥é—®é¢˜å‰ï¼Œæˆ‘ä»¬è¦å…ˆäº†è§£ä¸€ä¸‹dataXåŒæ­¥æ•°æ®åˆ°dorisçš„æ–¹å¼ï¼Œåªæœ‰å¦‚æ­¤æˆ‘ä»¬æ‰èƒ½æŒ‰å›¾ç´¢éª¥æ¥å®šä½é—®é¢˜ï¼Œè€Œä¸æ˜¯æ¼«æ— ç›®çš„çš„ä¹±çŒœã€‚</p><p>ä»¥ä¸‹æ˜¯dataXå®˜ç½‘å¯¹å…¶æ¶æ„çš„è®¾è®¡ç†å¿µï¼š</p><blockquote><p>ä¸ºäº†è§£å†³å¼‚æ„æ•°æ®æºåŒæ­¥é—®é¢˜ï¼ŒDataXå°†å¤æ‚çš„ç½‘çŠ¶çš„åŒæ­¥é“¾è·¯å˜æˆäº†æ˜Ÿå‹æ•°æ®é“¾è·¯ï¼ŒDataXä½œä¸ºä¸­é—´ä¼ è¾“è½½ä½“è´Ÿè´£è¿æ¥å„ç§æ•°æ®æºã€‚å½“éœ€è¦æ¥å…¥ä¸€ä¸ªæ–°çš„æ•°æ®æºçš„æ—¶å€™ï¼Œåªéœ€è¦å°†æ­¤æ•°æ®æºå¯¹æ¥åˆ°DataXï¼Œä¾¿èƒ½è·Ÿå·²æœ‰çš„æ•°æ®æºåšåˆ°æ— ç¼æ•°æ®åŒæ­¥ã€‚</p></blockquote><p><img src="/../../images/tech/datax/datax-etl-arch.png" alt="dataxæ¡†æ¶è®¾è®¡"></p><p>å¦‚æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£åˆ°ï¼Œåœ¨dataXçš„è®¾è®¡é‡Œï¼Œreaderå’Œwriterä¸¤ä¸ªç‹¬ç«‹çš„æ¨¡å—ï¼Œæ˜¯å¯ä»¥ä»»æ„ç»„åˆå¤ç”¨çš„ã€‚é€šè¿‡æ§åˆ¶å˜é‡æ³•ï¼Œæ—¢ç„¶å…¶ä»–æ•°æ®åº“çš„æ•°æ®èƒ½æ­£å¸¸å¯¼å…¥åˆ°dorisï¼Œé‚£è¯´æ˜<code>doriswriter</code>åº”è¯¥æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬çš„ç¬¬ä¸€æ€€ç–‘å¯¹è±¡æ˜¯clickhouseçš„é—®é¢˜ï¼Œè¦ä¹ˆæ˜¯clickhouseè¡¨çš„é—®é¢˜ï¼Œè¦ä¹ˆæ˜¯<code>clickhousereader</code>çš„é—®é¢˜ã€‚ä½†æ˜¯å½“æˆ‘ä»¬æŠŠclickhouseåŒæ ·çš„è¡¨æ¥å…¥åˆ°mysqlé‡Œæ—¶ï¼Œå´å‘ç°æ•°æ®é‡‡é›†æˆåŠŸäº†ï¼ï¼ç«Ÿç„¶æˆåŠŸäº†ï¼</p><p>è¿™ä¹ˆè¯´ï¼Œclickhouseé‡‡é›†ç«¯ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œé‚£é—®é¢˜å‡ºåœ¨å“ªé‡Œäº†ï¼Ÿ</p><p>æŒ‰ç…§ä¸Šé¢dataXçš„è®¾è®¡å›¾ï¼Œæˆ‘ä»¬å†æ¬¡æŠŠç›®å…‰çœ‹å‘äº†dorisï¼Œè¿™æ¬¡æˆ‘ä»¬ä¸å†æ€€ç–‘<code>doriswriter</code>ï¼Œè€Œæ˜¯ç›´æ¥æ€€ç–‘dorisæœ¬èº«ã€‚</p><p>è¿™æ¬¡æˆ‘ä»¬æŸ¥çœ‹dorisçš„æ•°æ®è¡¨ï¼Œå‘ç°åœ¨ç³»ç»Ÿå»ºè¡¨çš„æ—¶å€™å‡ºç°äº†å¤§é‡çš„<code>varchar(0)</code>çš„è¡¨å­—æ®µï¼Œé€šè¿‡å°†<code>varchar(0)</code>å­—æ®µæ”¹ä¸ºæ­£å¸¸çš„æœ‰é•¿åº¦çš„å­—æ®µï¼Œæ¯”å¦‚<code>varchar(2000)</code>ï¼Œé—®é¢˜å°±è§£å†³äº†ã€‚</p><p>ä½†æ˜¯é—®é¢˜çœŸçš„æ˜¯è¿™æ ·å—ï¼Ÿ</p><p>å› ä¸ºæˆ‘ä»¬å»ºè¡¨ç³»ç»Ÿbugçš„åŸå› ï¼Œå…¶ä»–æºé‡‡é›†æ•°æ®åˆ°dorisé‡Œæ—¶ï¼Œä¹Ÿæœ‰å¯èƒ½äº§ç”Ÿ<code>varchar(0)</code>çš„æƒ…å†µï¼Œè¯´æ˜<code>varchar(0)</code>å¹¶ä¸ä¼šçœŸæ­£çš„é˜»ç¢doris<code>stream load</code>æ•°æ®çš„å¯¼å…¥ã€‚ </p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°è¯•å¯¹æ¯ä¸ª<code>varchar(0)</code>å­—æ®µè¿›è¡Œä¿®å¤çš„æ–¹å¼ï¼Œé€ä¸ªå­—æ®µæ’æŸ¥ï¼Œæœ€åå®šä½åˆ°<code>syslogid</code>è¿™ä¸ªå­—æ®µï¼Œå…¶å¯¹åº”çš„å€¼æ˜¯<code>6f336347a90549789092b11d31b2197a</code>ã€‚<br>è¿™ä¸ªå­—æ®µåªè¦é•¿åº¦ä¸º0ï¼Œå³ä½¿æœ‰ä¸€æ¡æ•°æ®ï¼Œä¹Ÿèƒ½æŠŠdorisçš„beå…¨éƒ¨å¹²å´©æºƒï¼ˆå…¨éƒ¨å´©æºƒæ˜¯dataXé‡è¯•çš„é”…ï¼‰ã€‚</p><p>ç„¶ååœ¨be.outæ—¥å¿—é‡Œï¼Œæˆ‘ä»¬å‘ç°æŠ¥é”™ä¿¡æ¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs log">*** Query id: 5a4698a1afd40053-50e26699312ee9a5 ***<br>*** tablet id: 0 ***<br>*** Aborted at 1739168366 (unix time) try &quot;date -d @1739168366&quot; if you are using GNU date ***<br>*** Current BE git commitID: 91efb6a43d ***<br>*** SIGSEGV unknown detail explain (@0x0) received by PID 25235 (TID 26356 OR 0x7fbaf0c76700) from PID 0; stack trace: ***<br> 0# doris::signal::(anonymous namespace)::FailureSignalHandler(int, siginfo_t*, void*) at /home/zcp/repo_center/doris_release/doris/be/src/common/signal_handler.h:417<br> 1# os::Linux::chained_handler(int, siginfo*, void*) in /root/java/jdk1.8.0_221/jre/lib/amd64/server/libjvm.so<br> 2# JVM_handle_linux_signal in /root/java/jdk1.8.0_221/jre/lib/amd64/server/libjvm.so<br> 3# signalHandler(int, siginfo*, void*) in /root/java/jdk1.8.0_221/jre/lib/amd64/server/libjvm.so<br> 4# 0x00007FBE7F8FA400 in /lib64/libc.so.6<br> 5# __memcmp_sse4_1 in /lib64/libc.so.6<br> 6# doris::FieldTypeTraits&lt;(doris::FieldType)13&gt;::cmp(void const*, void const*) at /home/zcp/repo_center/doris_release/doris/be/src/olap/types.h:1349<br> 7# doris::segment_v2::TypedZoneMapIndexWriter&lt;(doris::PrimitiveType)10&gt;::flush() at /home/zcp/repo_center/doris_release/doris/be/src/olap/rowset/segment_v2/zone_map_index.cpp:90<br> 8# doris::segment_v2::ScalarColumnWriter::finish_current_page() at /home/zcp/repo_center/doris_release/doris/be/src/olap/rowset/segment_v2/column_writer.cpp:683<br> 9# doris::segment_v2::ScalarColumnWriter::finish() at /home/zcp/repo_center/doris_release/doris/be/src/olap/rowset/segment_v2/column_writer.cpp:593<br>10# doris::segment_v2::VerticalSegmentWriter::write_batch() at /home/zcp/repo_center/doris_release/doris/be/src/olap/rowset/segment_v2/vertical_segment_writer.cpp:719<br>11# doris::SegmentFlusher::_add_rows(std::unique_ptr&lt;doris::segment_v2::VerticalSegmentWriter, std::default_delete&lt;doris::segment_v2::VerticalSegmentWriter&gt; &gt;&amp;, doris::vectorized::Block const*, unsigned long, unsigned long) at /home/zcp/repo_center/doris_release/doris/be/src/olap/rowset/segment_creator.cpp:183<br>12# doris::SegmentFlusher::flush_single_block(doris::vectorized::Block const*, int, long*) at /home/zcp/repo_center/doris_release/doris/be/src/olap/rowset/segment_creator.cpp:76<br>13# doris::SegmentCreator::flush_single_block(doris::vectorized::Block const*, int, long*) at /home/zcp/repo_center/doris_release/doris/be/src/olap/rowset/segment_creator.cpp:422<br>14# doris::BaseBetaRowsetWriter::flush_memtable(doris::vectorized::Block*, int, long*) at /home/zcp/repo_center/doris_release/doris/be/src/olap/rowset/beta_rowset_writer.cpp:489<br>15# doris::FlushToken::_do_flush_memtable(doris::MemTable*, int, long*) at /home/zcp/repo_center/doris_release/doris/be/src/olap/memtable_flush_executor.cpp:144<br>16# doris::FlushToken::_flush_memtable(std::unique_ptr&lt;doris::MemTable, std::default_delete&lt;doris::MemTable&gt; &gt;, int, long) in /opt/module/doris/be/lib/doris_be<br>17# doris::MemtableFlushTask::run() at /home/zcp/repo_center/doris_release/doris/be/src/olap/memtable_flush_executor.cpp:59<br>18# doris::ThreadPool::dispatch_thread() in /opt/module/doris/be/lib/doris_be<br>19# doris::Thread::supervise_thread(void*) at /home/zcp/repo_center/doris_release/doris/be/src/util/thread.cpp:499<br>20# start_thread in /lib64/libpthread.so.0<br>21# clone in /lib64/libc.so.6<br><br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºæ˜¯<code>memcmp</code>å¯¼è‡´çš„crashï¼Œè¿™ä¸ªå°±æ˜¯dorisè‡ªèº«çš„é—®é¢˜äº†ã€‚</p><p>ç°åœ¨è¿™ä¸ªé—®é¢˜å·²ç»æç»™doriså®˜æ–¹äº†ï¼Œä¸è¿‡å®˜æ–¹ä¼šä¸ä¼šå¤„ç†å°±ä¸ç¡®å®šäº†ï¼Œå› ä¸ºé«˜ç‰ˆæœ¬å·²ç»æ²¡è¿™ä¸ªé—®é¢˜äº†ã€‚</p><h2 id="é—®é¢˜è§£å†³"><a href="#é—®é¢˜è§£å†³" class="headerlink" title="é—®é¢˜è§£å†³"></a>é—®é¢˜è§£å†³</h2><ol><li>ä¿®å¤å»ºè¡¨è¯­å¥ï¼Œé¿å…<code>varchar(0)</code>è¿™ç§éæ³•çš„å­—æ®µæ ¼å¼çš„å‡ºç°ã€‚</li><li>å‡çº§dorisï¼Œå®æµ‹doris3.0ç‰ˆæœ¬æ²¡æœ‰æ­¤é—®é¢˜</li></ol><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://github.com/alibaba/DataX/blob/master/introduction.md">dataXæŠ€æœ¯è®¾è®¡</a></p><p><a href="https://doris.apache.org/zh-CN/docs/data-operate/import/import-way/stream-load-manual">doris stream loadæœºåˆ¶</a></p><p><a href="https://github.com/apache/doris/issues/47684">æäº¤çš„doriså´©æºƒ bug</a></p>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹äººç”Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>clickhouse</tag>
      
      <tag>doris</tag>
      
      <tag>dataX</tag>
      
      <tag>å¼‚å¸¸</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å°†æˆ‘ä»¬çš„åšå®¢å½•å…¥bingæœç´¢å¼•æ“</title>
    <link href="/2025/01/22/site-bing-site-seo/"/>
    <url>/2025/01/22/site-bing-site-seo/</url>
    
    <content type="html"><![CDATA[<p>éšç€ChatGPTçš„åŠ æˆï¼Œ2024å¹´ï¼Œå¾®è½¯æ——ä¸‹çš„bingåœ¨pcç«¯å·²ç»å®Œå…¨è¶…è¿‡äº†ç™¾åº¦ï¼Œå·²ç»è¶…è¿‡äº†åŠæ•°ã€‚</p><p>æ‰€ä»¥ï¼Œä¸ºäº†èƒ½æœ‰æ›´å¤šäººè®¿é—®æˆ‘ä»¬çš„ä½œå“ï¼Œæˆ‘ä»¬ä¹Ÿè¦è€ƒè™‘å®ç°bingå¯¹æˆ‘ä»¬çš„åšå®¢ç«™ç‚¹æ”¶å½•çš„é—®é¢˜äº†ã€‚<br><img src="/../../images/site/seo/202412bing-statcounter-in-china-pc.jpeg" alt="2024å¹´12æœˆä¸­å›½pcç«¯æœç´¢å¼•æ“çš„å¸‚åœºå æœ‰ç‡"></p><h1 id="å®ç°åŸç†"><a href="#å®ç°åŸç†" class="headerlink" title="å®ç°åŸç†"></a>å®ç°åŸç†</h1><p>å…¶å®ï¼Œæœç´¢å¼•æ“æ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ï¼Ÿ</p><p>åœ¨ä»¥å‰ï¼Œæœç´¢å¼•æ“ä¼šæ ¹æ®ç½‘é¡µçš„é“¾æ¥æƒ…å†µæ¥é€’å½’çš„å¯¹æ‰€æœ‰èƒ½httpé“¾æ¥åˆ°çš„ç½‘é¡µè¿›è¡Œçˆ¬å–ï¼Œ åæ¥ä¸ºäº†é™åˆ¶çˆ¬è™«ï¼Œè¡ç”Ÿå‡ºäº†robotåè®®å’Œsitemapç½‘ç«™åœ°å›¾ï¼Œç”¨æ¥ä¸»åŠ¨é«˜é€Ÿæœç´¢å¼•æ“ï¼Œæˆ‘æœ‰å“ªäº›ä¸œè¥¿ä½ å¯ä»¥çˆ¬ã€‚</p><p>æˆ‘ä»¬è¿™é‡Œå°±åˆ©ç”¨sitemapç½‘ç«™åœ°å›¾çš„åŠæ³•æ¥å®ç°bingæ”¶å½•æˆ‘ä»¬çš„ç«™ç‚¹å†…å®¹ã€‚</p><h1 id="å®ç°æ­¥éª¤"><a href="#å®ç°æ­¥éª¤" class="headerlink" title="å®ç°æ­¥éª¤"></a>å®ç°æ­¥éª¤</h1><h2 id="åˆ›å»ºsitemap-xmlæ–‡ä»¶"><a href="#åˆ›å»ºsitemap-xmlæ–‡ä»¶" class="headerlink" title="åˆ›å»ºsitemap.xmlæ–‡ä»¶"></a>åˆ›å»ºsitemap.xmlæ–‡ä»¶</h2><p>æˆ‘ç°åœ¨ä½¿ç”¨çš„hexoä¸»é¢˜æ­å»ºçš„åšå®¢ç³»ç»Ÿ, æ‰€ä»¥æœ‰ç°æˆçš„æ’ä»¶å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç”Ÿæˆsitemap.xmlæ–‡ä»¶ã€‚</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">npm install hexo-generator-sitemap <span class="hljs-comment">--save</span><br></code></pre></td></tr></table></figure><p>è™½ç„¶ç‰ˆæœ¬æ¯”è¾ƒè€äº†ï¼Œä½†ä¾æ—§èƒ½ç”¨ã€‚</p><p>è¿˜å¯ä»¥åœ¨<code>_config.yml</code>æŒ‰å¦‚ä¸‹é…ç½®è°ƒæ•´ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># é»˜è®¤é…ç½®å¦‚ä¸‹</span><br><span class="hljs-attr">sitemap:</span><br>  <span class="hljs-attr">path:</span> <br>    <span class="hljs-bullet">-</span> <span class="hljs-string">sitemap.xml</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">sitemap.txt</span><br>  <span class="hljs-attr">template:</span> <span class="hljs-string">./sitemap_template.xml</span><br>  <span class="hljs-attr">template_txt:</span> <span class="hljs-string">./sitemap_template.txt</span><br>  <span class="hljs-attr">rel:</span> <span class="hljs-literal">false</span><br>  <span class="hljs-attr">tags:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">categories:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>å¦‚æœä¸æƒ³æŸä¸ªæ–‡ç« è¢«æ·»åŠ åˆ°sitemapä¸­ï¼Œå¯ä»¥åœ¨æ–‡ç« çš„front matterä¸­æ·»åŠ <code>sitemap: false</code>ã€‚</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs markdown">---<br>title: ä¸æƒ³åŠ å…¥sitemapçš„æ–‡ç« <br>date: 2025-01-22<br><span class="hljs-section">sitemap: false</span><br><span class="hljs-section">---</span><br></code></pre></td></tr></table></figure><p>å®‰è£…é…ç½®å®Œæˆåï¼Œåœ¨é¡¹ç›®è‡ªåŠ¨æ„å»ºçš„æ—¶å€™ï¼Œè¿™ä¸ªsitemapæ–‡ä»¶ä¹Ÿå°±ä¼šè‡ªåŠ¨ç”Ÿæˆäº†ï¼Œæ— éœ€é¢å¤–æ“ä½œï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼éªŒè¯ï¼š</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">https:</span><span class="hljs-comment">//your-blog-domain.com/sitemap.xml</span><br></code></pre></td></tr></table></figure><h2 id="bingç«™é•¿åå°æ·»åŠ ç½‘ç«™"><a href="#bingç«™é•¿åå°æ·»åŠ ç½‘ç«™" class="headerlink" title="bingç«™é•¿åå°æ·»åŠ ç½‘ç«™"></a>bingç«™é•¿åå°æ·»åŠ ç½‘ç«™</h2><p>æ‰“å¼€bingçš„ç«™ç‚¹ç®¡ç†å·¥å…·<a href="https://www.bing.com/webmasters">webmasters</a>é¡µé¢ï¼Œç¬¬ä¸€æ¬¡æ‰“å¼€éœ€è¦ç™»å½•ã€‚<br><img src="/../../images/site/seo/bing_tool_home.jpeg" alt="bingç«™ç‚¹ç®¡ç†å·¥å…·é¦–é¡µ"><br>é€‰æ‹©æ‰‹åŠ¨æ·»åŠ ç½‘ç«™ï¼š<br><img src="/../../images/site/seo/bing_site_tool.png" alt="æ‰‹åŠ¨æ·»åŠ ç½‘ç«™"></p><p>ç„¶åéœ€è¦åœ¨æˆ‘ä»¬çš„åšå®¢æ ¹ç›®å½•ä¸‹æ”¾ç½®ä¸€ä¸ªæ–‡ä»¶ï¼Œæ¥éªŒè¯è¿™ä¸ªç½‘ç«™çš„æœ‰æ•ˆæ€§ã€‚<br><img src="/../../images/site/seo/bing_verify_site_method.png" alt="éªŒè¯ç½‘ç«™æ–¹å¼"><br>å°†ä¸Šé¢çš„<code>BingSiteAuth.xml</code>ä¸‹è½½ä¸‹æ¥æ”¾åˆ°è‡ªå·±ç½‘ç«™çš„æ ¹ç›®å½•ä¸‹ï¼Œå‡ åˆ†é’Ÿåå°±å¯ä»¥éªŒè¯æˆåŠŸäº†ã€‚</p><p>åˆ°æ­¤ï¼Œæˆ‘ä»¬çš„ç«™ç‚¹ç®—æ˜¯åˆ›å»ºæˆåŠŸäº†ã€‚</p><h2 id="æäº¤sitemapæ–‡ä»¶åˆ°bing"><a href="#æäº¤sitemapæ–‡ä»¶åˆ°bing" class="headerlink" title="æäº¤sitemapæ–‡ä»¶åˆ°bing"></a>æäº¤sitemapæ–‡ä»¶åˆ°bing</h2><p>åœ¨å·¦ä¾§å¯¼èˆªæ é‡Œé€‰æ‹©<code>ç½‘ç«™åœ°å›¾</code>ï¼Œç„¶åæ·»åŠ ç½‘ç«™åœ°å›¾ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šç”¨åˆ°ä¸Šé¢ç”Ÿæˆçš„sitemapæ–‡ä»¶ã€‚<br><img src="/../../images/site/seo/bing_add_sitemap.png" alt="æ·»åŠ ç½‘ç«™åœ°å›¾"><br>æŠŠä¸Šé¢éªŒè¯è¿‡çš„sitemapåœ°å€è¾“å…¥ï¼Œç‚¹å‡»æäº¤ï¼Œå°±å®Œäº‹äº†ã€‚</p><h2 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h2><p>æœ€åï¼Œåœ¨bingæœç´¢æ¡†é‡Œè¾“å…¥<code>site:your-blog-domain.com</code>ï¼Œå¦‚æœèƒ½çœ‹åˆ°æˆ‘ä»¬çš„åšå®¢ï¼Œå°±è¯´æ˜æˆ‘ä»¬çš„ç«™ç‚¹å·²ç»è¢«bingæ”¶å½•äº†ã€‚</p><p>ä»¥åæˆ‘ä»¬åœ¨å†™æ–°çš„åšå®¢æ—¶ï¼Œæ–°çš„ç½‘é¡µä¼šåœ¨æ‰“åŒ…æ—¶è‡ªåŠ¨æ·»åŠ åˆ°sitemap.xmlä¸­ï¼Œç„¶åbingä¼šéš”ä¸€æ®µæ—¶é—´æ›´æ–°ä¸€ä¸‹ç«™ç‚¹åœ°å›¾ï¼Œè¿™æ ·æˆ‘ä»¬æ–°çš„æ–‡ç« å°±ä¼šè¢«bingæ”¶å½•å•¦ã€‚</p><p>å¦‚æ­¤ï¼Œä¸€åŠ³æ°¸é€¸ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®‰å®‰å¿ƒå¿ƒçš„å†™æ–‡ç« å•¦ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://github.com/hexojs/hexo-generator-sitemap">hexo-generator-sitemap githubåœ°å€</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç«™</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å»ºç«™</tag>
      
      <tag>seo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>hexoå»ºç«™å¢åŠ è‡ªå·±çš„è¯„è®ºæ¨¡å—</title>
    <link href="/2025/01/09/site-hexo-comment-feature/"/>
    <url>/2025/01/09/site-hexo-comment-feature/</url>
    
    <content type="html"><![CDATA[<h1 id="jekyllæ—¶ä»£"><a href="#jekyllæ—¶ä»£" class="headerlink" title="jekyllæ—¶ä»£"></a>jekyllæ—¶ä»£</h1><p>ä½¿ç”¨çš„æ˜¯beaudaræ’ä»¶, åœ¨æ›´æ–°åˆ°hexo-fluid åšå®¢æ¶æ„åä»ç„¶å¯ä»¥ä½¿ç”¨ï¼Œ<br>ä½†æ˜¯éœ€è¦ä»£ç ä¾µå…¥å¼æ”¹é€ ï¼Œä¸å¦‚fluidé€‚é…çš„è¯„è®ºä½“ç³»æ›´ä¼˜é›…ï¼Œæ‰€ä»¥è¿™æ¬¡æˆ‘ä»¬å°è¯•ä¸€äº›å…¶ä»–çš„è¯„è®ºæ’ä»¶ã€‚</p><p>è¯„è®ºæ’ä»¶çš„æŒ‘é€‰åŸåˆ™ï¼š</p><ul><li>å…è´¹ï¼šæˆ‘çš„åšå®¢é™¤äº†åŸŸåï¼Œå…¨éƒ½æ˜¯å…è´¹çš„ï¼Œä¸å¯èƒ½ä¸ºäº†ä¸€ä¸ªè¯„è®ºæ¨¡å—è€Œä»˜è´¹</li><li>æ˜“æ¥å…¥ï¼šæœ€åæ˜¯fluidä¸»é¢˜æ”¯æŒçš„ï¼Œä¸ç„¶è¿˜è¦ä¾µå…¥å¼æ”¹é€ ä»£ç </li><li>å“åº”é€Ÿåº¦ï¼šå¸Œæœ›è¯„è®ºæ¨¡å—å¿«é€Ÿå“åº”</li><li>å¯åŒ¿åï¼šå¯ä»¥åŒ¿åå‘è¡¨è¯„è®ºï¼Œæ³¨å†Œåˆ¶ä¼šæå¤§çš„å½±å“ç”¨æˆ·å‘è¨€çš„ç§¯ææ€§</li></ul><p>æ ¹æ®ä»¥ä¸ŠåŸåˆ™ï¼Œæˆ‘ä»¬å¯¹fluidå®˜æ–¹æ”¯æŒçš„è¯„è®ºæ’ä»¶è¿›è¡Œäº†ç­›é€‰ä¸è¯„æµ‹ï¼š</p><h1 id="beaudar"><a href="#beaudar" class="headerlink" title="beaudar"></a>beaudar</h1><p>åŸºäº GitHub Issues.åšå®¢çš„æ¯æ¬¡è¯„è®ºéƒ½ä¼šåœ¨githubä¸»ç«™ä¸Šç”Ÿæˆä¸€ä¸ªissueï¼Œè¯„è®ºå†…å®¹ä¼šä»¥markdownæ ¼å¼ä¿å­˜åœ¨issueçš„è¯„è®ºåŒºã€‚<br>å‚è€ƒä»¥å‰çš„æ–‡ç« ï¼š<a href="https://www.hancher.top/2022/09/09/site-beaudar-error/">beaudarè¯„è®ºæ’ä»¶å®‰è£…</a></p><h1 id="Gitalk"><a href="#Gitalk" class="headerlink" title="Gitalk"></a><a href="https://gitalk.github.io/">Gitalk</a></h1><p>åŸºäº GitHub Issues. é€šbeaudarä¸€æ ·ã€‚</p><p>è¿™ç§æ–¹å¼å®Œå…¨å…è´¹ï¼Œä¸”é€‚åˆé‚£äº›é€šè¿‡github pages éƒ¨ç½²çš„åšå®¢ã€‚</p><h2 id="å®‰è£…è¿‡ç¨‹"><a href="#å®‰è£…è¿‡ç¨‹" class="headerlink" title="å®‰è£…è¿‡ç¨‹"></a>å®‰è£…è¿‡ç¨‹</h2><ol><li><a href="https://github.com/settings/applications/new">ç‚¹å‡»è¿™é‡Œ</a>ç”³è¯·github çš„oauthæˆæƒåº”ç”¨<br><img src="/images/site/comment/github_oauth_app_register.png" alt="github oauth æ³¨å†Œ"><br>æŒ‰å›¾ä¸­é…ç½®å³å¯ï¼Œåœ°å€å†™è‡ªå·±åšå®¢çš„åœ°å€ï¼Œå…¶ä»–çš„éšä¾¿å†™ï¼Œåç»­è¿˜å¯ä»¥æ”¹ã€‚  </li><li>åˆ›å»ºappçš„å¯†é’¥<br><img src="/images/site/comment/github_oauth_app_gen_client_secret.png" alt="æˆæƒappçš„idå’Œå¯†é’¥">   </li><li><code>_config.yml</code>é‡Œæ’‡å˜´gitalkçš„é…ç½®<br><strong>fluidé…ç½®ï¼š</strong></li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">post:</span><br>  <span class="hljs-attr">comments:</span>  <span class="hljs-comment"># å¼€å¯è¯„è®º</span><br>    <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">type:</span> <span class="hljs-string">gitalk</span> <span class="hljs-comment"># é€‰æ‹©è¯„è®ºæ’ä»¶ç±»å‹</span><br><br><span class="hljs-attr">gitalk:</span><br>  <span class="hljs-attr">clientID:</span> <span class="hljs-string">xxxxxxxxx</span>           <span class="hljs-comment"># github åº”ç”¨idï¼Œå¿…é¡»</span><br>  <span class="hljs-attr">clientSecret:</span> <span class="hljs-string">6fcbc2edcfxxx</span>   <span class="hljs-comment"># github åº”ç”¨å¯†é’¥ï¼Œå¿…é¡»</span><br>  <span class="hljs-attr">repo:</span> <span class="hljs-string">hanchers.github.io</span>      <span class="hljs-comment"># github ä»“åº“ï¼Œ å¿…é¡»</span><br>  <span class="hljs-attr">owner:</span> <span class="hljs-string">hancher</span>                <span class="hljs-comment"># github ä»“åº“æ‰€æœ‰è€…ï¼Œ å¿…é¡»</span><br>  <span class="hljs-attr">admin:</span> [<span class="hljs-string">&#x27;admin&#x27;</span>]              <span class="hljs-comment"># github ä»“åº“æœ‰å†™æƒé™çš„è´¦å·</span><br>  <span class="hljs-attr">language:</span> <span class="hljs-string">zh-CN</span>               <span class="hljs-comment"># è¯­è¨€</span><br>  <span class="hljs-attr">labels:</span> [<span class="hljs-string">&#x27;Gitalk&#x27;</span>]            <span class="hljs-comment"># GitHub issue çš„æ ‡ç­¾ã€‚</span><br>  <span class="hljs-attr">perPage:</span> <span class="hljs-number">10</span>                   <span class="hljs-comment"># æ¯é¡µå¤§å°</span><br>  <span class="hljs-attr">pagerDirection:</span> <span class="hljs-string">last</span>          <span class="hljs-comment"># è¯„è®ºæ’åºæ–¹å¼ï¼Œ lastä¸ºæŒ‰è¯„è®ºåˆ›å»ºæ—¶é—´å€’å™ï¼Œfirstä¸ºæŒ‰åˆ›å»ºæ—¶é—´æ­£åº</span><br>  <span class="hljs-attr">distractionFreeMode:</span> <span class="hljs-literal">false</span>    <span class="hljs-comment"># ç±»ä¼¼Facebookè¯„è®ºæ¡†çš„å…¨å±é®ç½©æ•ˆæœ.</span><br>  <span class="hljs-attr">createIssueManually:</span> <span class="hljs-literal">true</span>     <span class="hljs-comment"># å¦‚æœå½“å‰é¡µé¢æ²¡æœ‰ç›¸åº”çš„ isssue ä¸”ç™»å½•çš„ç”¨æˆ·å±äº adminï¼Œåˆ™ä¼šè‡ªåŠ¨åˆ›å»º issueã€‚å¦‚æœè®¾ç½®ä¸º trueï¼Œåˆ™æ˜¾ç¤ºä¸€ä¸ªåˆå§‹åŒ–é¡µé¢</span><br>  <span class="hljs-comment"># åå‘ä»£ç†ï¼Œä¸ºäº†æ”¯æŒ CORS. é»˜è®¤çš„ä¸å¯ç”¨ï¼Œéœ€è¦è‡ªå·±é…ç½®ï¼Œå‚è€ƒä¸‹è¿°æ–‡æ¡£</span><br>  <span class="hljs-comment"># https://github.com/gitalk/gitalk/issues/429</span><br>  <span class="hljs-comment"># https://github.com/Zibri/cloudflare-cors-anywhere</span><br>  <span class="hljs-attr">proxy:</span> <span class="hljs-string">https://shielded-brushlands-08810.herokuapp.com/https://github.com/login/oauth/access_token</span> <span class="hljs-comment"># æœ‰äº›äººæ­å»ºçš„ä»£ç†</span><br><span class="hljs-comment">#  proxy: https://cors-server.68756978.xyz/github_access_token  # å¤‡ç”¨ä»£ç†åœ°å€1</span><br><br></code></pre></td></tr></table></figure><p>æ•ˆæœå¦‚å›¾ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥è¯„è®ºäº†<br><img src="/images/site/comment/gitalk_init_show.png" alt="gitalkè¯„è®ºæ•ˆæœå›¾"></p><h2 id="è¯„ä»·"><a href="#è¯„ä»·" class="headerlink" title="è¯„ä»·"></a>è¯„ä»·</h2><ol><li>éœ€è¦é…ç½®ä»£ç†åœ°å€ï¼Œè¿™é‡Œæœ‰ä¸€å®šçš„å¼€å‘æˆæœ¬ï¼Œå¦‚æœä½¿ç”¨å¼€æºçš„ï¼Œä¸ç¨³å®šæ€§è¿˜å¾ˆé«˜ï¼ˆæ”¾å¼ƒé€‰æ‹©çš„ä¸»è¦åŸå› ï¼‰ã€‚</li><li>ä½¿ç”¨ä¸Šéœ€è¦æ³¨å†Œgithub</li><li>å“åº”æœ‰ç‚¹æ…¢</li></ol><h1 id="utterances"><a href="#utterances" class="headerlink" title="utterances"></a><a href="https://utteranc.es/">utterances</a></h1><p>åŒæ ·ä¹Ÿæ˜¯åŸºäºGitHub Issueså®ç°ï¼ŒåŸç†é€šä¸Šé¢çš„ä¸€æ ·</p><h2 id="å®‰è£…è¿‡ç¨‹-1"><a href="#å®‰è£…è¿‡ç¨‹-1" class="headerlink" title="å®‰è£…è¿‡ç¨‹"></a>å®‰è£…è¿‡ç¨‹</h2><p>åŒbeaudarä¸€æ ·ï¼Œ<a href="https://github.com/apps/utterances">ç‚¹å‡»è¿™é‡Œåœ¨githubä¸Šå®‰è£…åº”ç”¨</a>ã€‚</p><p>é€‰æ‹©ä½ çš„githubåšå®¢ä»“åº“ã€‚<br><img src="/images/site/comment/utterances_install.png" alt="utteranceså®‰è£…é€‰æ‹©"><br>å®‰è£…å¥½åï¼Œåœ¨<code>_config.yml</code>é‡Œé…ç½®utterancesçš„é…ç½®å³å¯</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">post:</span><br>  <span class="hljs-attr">comments:</span>  <span class="hljs-comment"># å¼€å¯è¯„è®º</span><br>    <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">type:</span> <span class="hljs-string">gitalk</span> <span class="hljs-comment"># é€‰æ‹©è¯„è®ºæ’ä»¶ç±»å‹</span><br><br><span class="hljs-comment"># å…¶ä»–é…ç½®å¯ä»¥å‚è€ƒå®˜ç½‘</span><br><span class="hljs-attr">utterances:</span><br>  <span class="hljs-attr">repo:</span> <span class="hljs-string">Hanchers/Hanchers.github.io</span><br>  <span class="hljs-attr">issue_term:</span> <span class="hljs-string">pathname</span><br>  <span class="hljs-attr">label:</span> <span class="hljs-string">utterances</span><br>  <span class="hljs-attr">theme:</span> <span class="hljs-string">github-light</span><br>  <span class="hljs-attr">theme_dark:</span> <span class="hljs-string">github-dark</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœï¼š<br><img src="/images/site/comment/utterances_show.png" alt="utterancesæ•ˆæœ"></p><h2 id="è¯„ä»·-1"><a href="#è¯„ä»·-1" class="headerlink" title="è¯„ä»·"></a>è¯„ä»·</h2><ol><li>utterancesæ•´ä½“ä¸Šæ¯”gitalkè¦å¥½ä¸€äº›ï¼Œå®‰è£…ç®€å•å¾ˆå¤šï¼Œä¸”ä¸ç”¨ä»£ç†ã€‚</li><li>å®Œå…¨ä¾èµ–githubï¼Œè¿™ä¸€ç‚¹å’Œbeaudarä¸€æ ·ï¼Œèƒ½æ»¡è¶³æˆ‘è¯„ä»·æ•°æ®æŒä¹…åŒ–çš„éœ€æ±‚ã€‚</li><li>ä¸å¹¸çš„æ˜¯ï¼Œå“åº”ä¸Šï¼ŒåŒbeaudarä¸€æ ·ï¼Œéƒ½æ¯”è¾ƒæ…¢</li><li>fluidä¸»é¢˜æ”¯æŒï¼Œå®‰è£…å¾ˆç®€å•ã€‚</li><li>è¯„ä»·åŠŸèƒ½ä½¿ç”¨æ¯”è¾ƒå°‘ï¼Œä¸”ä¸å–œæ¬¢æŠ˜è…¾çš„ï¼Œè¿™æ¬¾æ’ä»¶å€¼å¾—æ¨èã€‚</li></ol><h1 id="giscus"><a href="#giscus" class="headerlink" title="giscus"></a><a href="https://giscus.app/zh-CN">giscus</a></h1><p>giscussæ˜¯åˆ©ç”¨ GitHub Discussions å®ç°çš„è¯„è®ºç³»ç»Ÿã€‚</p><p>åŒä¸Šçº§å‡ ä¸ªè¯„è®ºæ’ä»¶ä¸åŒçš„æ˜¯ï¼Œå‰é¢çš„æ˜¯åˆ©ç”¨çš„GitHub Issuesï¼Œè€Œgiscussæ˜¯åˆ©ç”¨GitHub Discussionsã€‚<br><img src="/images/site/comment/github_discussions.png" alt="githubè®¨è®ºæ¨¡å—"><br>giscus åŠ è½½æ—¶ï¼Œä¼šä½¿ç”¨ GitHub Discussions æœç´¢ API æ ¹æ®é€‰å®šçš„æ˜ å°„æ–¹å¼ï¼ˆå¦‚ URLã€pathnameã€title ç­‰ï¼‰æ¥æŸ¥æ‰¾ä¸å½“å‰é¡µé¢å…³è”çš„ discussionã€‚å¦‚æœæ‰¾ä¸åˆ°åŒ¹é…çš„ discussionï¼Œgiscus bot å°±ä¼šåœ¨ç¬¬ä¸€æ¬¡æœ‰äººç•™ä¸‹è¯„è®ºæˆ–å›åº”æ—¶è‡ªåŠ¨åˆ›å»ºä¸€ä¸ª discussionã€‚</p><p>è®¿å®¢å¦‚æœæƒ³è¦è¯„è®ºï¼Œå¿…é¡»æŒ‰ç…§ GitHub OAuth æµç¨‹æˆæƒ giscus app ä»£è¡¨ä»–å‘å¸ƒï¼Œæˆ–è€…å¯ä»¥ç›´æ¥åœ¨ GitHub Discussion é‡Œè¯„è®ºã€‚ä½ å¯ä»¥åœ¨ GitHub ä¸Šç®¡ç†è¯„è®ºã€‚</p><h2 id="å®‰è£…è¿‡ç¨‹-2"><a href="#å®‰è£…è¿‡ç¨‹-2" class="headerlink" title="å®‰è£…è¿‡ç¨‹"></a>å®‰è£…è¿‡ç¨‹</h2><ol><li><p>å¯ç”¨githubä»“åº“çš„DiscussionsåŠŸèƒ½</p></li><li><p><a href="https://github.com/apps/giscus">ç‚¹å‡»è¿™é‡Œ</a>å®‰è£…giscusåº”ç”¨ï¼Œç„¶åé€‰æ‹©ä½ å¼€å¯è®¨è®ºæ¨¡å—çš„ä»“åº“</p></li><li><p><a href="https://giscus.app/zh-CN">ç‚¹å‡»è¿™é‡Œ</a>æŒ‰ä¸‹å›¾é…ç½®ä»“åº“åç§°å’Œä½ çš„è¯„è®ºæ‰€æœ‰ç±»å‹<br><img src="/images/site/comment/giscus_config.png" alt="giscusé…ç½®"></p></li><li><p>giscus ä¼šè‡ªåŠ¨ä»githubè·å–å¯¹åº”çš„id<br><img src="/images/site/comment/giscus_config_show.png" alt="giscusé…ç½®ç»“æœ.png"></p></li><li><p>æ‹¿åˆ°idåï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨<code>_config.yml</code>é…ç½®äº†</p></li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">post:</span><br>  <span class="hljs-attr">comments:</span>  <span class="hljs-comment"># å¼€å¯è¯„è®º</span><br>    <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">type:</span> <span class="hljs-string">giscus</span> <span class="hljs-comment"># é€‰æ‹©è¯„è®ºæ’ä»¶ç±»å‹</span><br><br><span class="hljs-comment"># å…¶ä»–é…ç½®å¯ä»¥å‚è€ƒå®˜ç½‘</span><br><span class="hljs-attr">giscus:</span><br>  <span class="hljs-attr">repo:</span> <span class="hljs-string">Hanchers/Hanchers.github.io</span><br>  <span class="hljs-attr">repo-id:</span> <span class="hljs-string">Mxxx</span><br>  <span class="hljs-attr">category:</span> <span class="hljs-string">Q&amp;A</span><br>  <span class="hljs-attr">category-id:</span> <span class="hljs-string">Dxxxx</span><br>  <span class="hljs-attr">theme-light:</span> <span class="hljs-string">light</span><br>  <span class="hljs-attr">theme-dark:</span> <span class="hljs-string">dark</span><br>  <span class="hljs-attr">mapping:</span> <span class="hljs-string">pathname</span><br>  <span class="hljs-attr">reactions-enabled:</span> <span class="hljs-number">1</span><br>  <span class="hljs-attr">emit-metadata:</span> <span class="hljs-number">0</span><br>  <span class="hljs-attr">input-position:</span> <span class="hljs-string">top</span><br>  <span class="hljs-attr">lang:</span> <span class="hljs-string">zh-CN</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœï¼š<br><img src="/../../images/site/comment/giscus_show.png" alt="giscusæ•ˆæœå±•ç¤º.png"></p><h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><p>Qï¼šå‰é¢éƒ½é…ç½®å¥½åï¼Œå‘ç°è¯„è®ºæ¨¡å—åŠ è½½ä¸å‡ºæ¥ï¼Œæ‰“å¼€F12,å‘ç°è¯·æ±‚æ¥å£æŠ¥é”™äº†ï¼š<code>Discussion not found</code>.<br>A: å¾ˆå¤šäººéƒ½é‡åˆ°è¿‡è¿™ä¸ªé—®é¢˜ï¼Œè§£å†³åŠæ³•å°±æ˜¯å»ä»“åº“ä¸‹æ‰‹åŠ¨åŠ ä¸€æ¡è¯„è®ºï¼Œç­‰ä¸€ä¼šå°±å¥½äº†ã€‚ä¸ªäººç†è§£è¿™é‡Œæ˜¯githubå»¶è¿Ÿå¯¼è‡´çš„ã€‚</p><h2 id="è¯„ä»·-2"><a href="#è¯„ä»·-2" class="headerlink" title="è¯„ä»·"></a>è¯„ä»·</h2><ol><li>æ•´ä¸ªå®‰è£…è¿‡ç¨‹æŒºä¸æ»‘çš„</li><li>æ•°æ®å®Œå…¨æ‰˜ç®¡åˆ°githubï¼Œå®Œå…¨æ»¡è¶³æˆ‘çš„æ•°æ®æŒä¹…åŒ–å’Œå…è´¹å­˜å‚¨çš„éœ€æ±‚</li><li>æ•ˆæœä¹Ÿä¸é”™ï¼Œå“åº”é€Ÿåº¦ä¸­ç­‰</li><li>è¿˜æ”¯æŒè¡¨æƒ…ï¼ŒæŒºæƒŠå–œçš„</li><li>å”¯ä¸€çš„é—®é¢˜å°±æ˜¯å‘è¡¨è¯„è®ºéœ€è¦githubç™»å½•ï¼Œæ— æ³•åŒ¿åè¯„è®º</li><li>åŸºäºgithubæ‰˜ç®¡æ•°æ®çš„æ’ä»¶é‡Œæœ€æ¨èæ­¤æ¬¾</li></ol><p><strong>è‡³æ­¤ï¼ŒåŸºäºgithub,å®Œå…¨å…è´¹çš„è¯„è®ºæ’ä»¶éƒ½æ¯”è¾ƒå®Œäº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯éœ€è¦ç¬¬ä¸‰æ–¹ç½‘ç«™æ‰˜ç®¡æ•°æ®æˆ–è€…è‡ªå»ºæœåŠ¡æ‰˜ç®¡æ•°æ®çš„è¯„è®ºæ’ä»¶äº†ã€‚</strong></p><h1 id="livere"><a href="#livere" class="headerlink" title="livere"></a><a href="https://www.livere.com/">livere</a></h1><p>æ¥å¿…åŠ›ï¼Œæ²¡æƒ³åˆ°æ˜¯ä¸€ä¸ªéŸ©å›½çš„ç½‘ç«™ï¼Œç”¨æ¥åšè¯„è®ºæ•°æ®æ‰˜ç®¡ç­‰å†…å®¹ï¼Œéœ€è¦æ³¨å†Œã€‚</p><p>æ¥å¿…åŠ›å„ç‰ˆæœ¬çš„åŠŸèƒ½æ¯”è¾ƒï¼ˆ2025-01-09ï¼‰ï¼š<br><img src="/images/site/comment/livere_version_compare.png" alt="livereç‰ˆæœ¬æ¯”è¾ƒ"></p><h2 id="å®‰è£…è¿‡ç¨‹-3"><a href="#å®‰è£…è¿‡ç¨‹-3" class="headerlink" title="å®‰è£…è¿‡ç¨‹"></a>å®‰è£…è¿‡ç¨‹</h2><p><a href="https://www.livere.com/">ç‚¹å‡»è¿™é‡Œæ³¨å†Œlivere</a>  </p><p>æ³¨å†Œå¹¶ç™»å½•æˆåŠŸåï¼Œåœ¨è¿™ä¸ªé¡µé¢é€‰æ‹©cityæ¨¡å—ï¼Œç„¶åç‚¹å‡»â€œå®‰è£…ä½¿ç”¨â€<br><img src="/images/site/comment/livere_city_install.png" alt="livere city ç‰ˆæœ¬å®‰è£…"></p><p>å®‰è£…æˆåŠŸåï¼Œä¼šå¾—åˆ°ä¸€ä¸ªè„šæœ¬æ³¨å…¥ä»£ç ã€‚<br><img src="/images/site/comment/livere_script.png" alt="livereå®‰è£…ä»£ç "><br>å°†ä¸Šé¢çš„data-uidå¤åˆ¶å‡ºæ¥æ”¾åˆ°<code>_config.yml</code>é…ç½®é‡Œå³å¯ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">post:</span><br>  <span class="hljs-attr">comments:</span>  <span class="hljs-comment"># å¼€å¯è¯„è®º</span><br>    <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">type:</span> <span class="hljs-string">gitalk</span> <span class="hljs-comment"># é€‰æ‹©è¯„è®ºæ’ä»¶ç±»å‹</span><br><br><span class="hljs-comment"># å…¶ä»–é…ç½®å¯ä»¥å‚è€ƒå®˜ç½‘</span><br><span class="hljs-attr">livere:</span><br>  <span class="hljs-attr">uid:</span> <span class="hljs-string">&#x27;your uid&#x27;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœï¼š<br><img src="/images/site/comment/livere_show.png" alt="livereè¯„è®ºæ¨¡å—æ•ˆæœ"><br>ä½†æ˜¯ç‚¹å‡»åï¼Œä¼šå¼¹å‡ºç¬¬ä¸‰æ–¹è´¦å·ç™»å½•çª—å£ã€‚<br><img src="/images/site/comment/livere_show_register.png" alt="æç¤ºæ³¨å†Œ"></p><h2 id="è¯„ä»·-3"><a href="#è¯„ä»·-3" class="headerlink" title="è¯„ä»·"></a>è¯„ä»·</h2><ol><li>å…è´¹ï¼Œæ•°æ®èƒ½å¤ŸæŒä¹…ä¿å­˜</li><li>éŸ©å›½ç½‘ç«™ï¼Œæ³¨å†Œçš„è¿‡ç¨‹ä¸­éƒ½æ˜¯éŸ©æ–‡ï¼Œä¸å¤ªå‹å¥½</li><li>å“åº”é€Ÿåº¦ä¸Šï¼Œæœ‰ç‚¹æ…¢ï¼Œä½†æ˜¯æ¯”utteranceså¿«ä¸€ç‚¹</li><li>é¡µé¢æœ‰ç‚¹ä¸‘</li><li>éœ€è¦qqç­‰è´¦å·æ³¨å†Œæ‰èƒ½ä½¿ç”¨ï¼Œä¸å¤ªæ¨è</li></ol><h1 id="ç•…è¨€"><a href="#ç•…è¨€" class="headerlink" title="ç•…è¨€"></a><a href="https://changyan.kuaizhan.com/">ç•…è¨€</a></h1><p>ç•…è¨€ï¼Œä¸€ä¸ªå›½å†…æ¯”è¾ƒè€çš„è¯„è®ºæ’ä»¶ï¼Œéœ€è¦æ³¨å†Œï¼Œå¯ä»¥å…è´¹å­˜å‚¨æ•°æ®ã€‚</p><h2 id="å®‰è£…è¿‡ç¨‹-4"><a href="#å®‰è£…è¿‡ç¨‹-4" class="headerlink" title="å®‰è£…è¿‡ç¨‹"></a>å®‰è£…è¿‡ç¨‹</h2><ol><li>ç‚¹å‡»å®˜ç½‘ï¼Œæ³¨å†Œä¸€ä¸ªè´¦å·</li><li>å»å®˜ç½‘å·¥ä½œå°ï¼Œåˆ›å»ºä¸€ä¸ªã€ç•…è¨€äº‘è¯„ã€‘çš„åº”ç”¨</li><li>è¿›å…¥åº”ç”¨è¯¦æƒ…ï¼Œåœ¨åå°æ€»è§ˆé‡Œå¯ä»¥çœ‹åˆ°åº”ç”¨çš„idå’Œå¯†é’¥<br><img src="/../../images/site/comment/changyan_appid.png" alt="ç•…è¨€äº‘è¯„idå’Œå¯†é’¥"></li></ol><p>å°†ä¸Šé¢çš„idå’Œå¯†é’¥å¤åˆ¶å‡ºæ¥ï¼Œæ”¾åˆ°<code>_config.yml</code>é…ç½®é‡Œå³å¯ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">post:</span><br>  <span class="hljs-attr">comments:</span>  <span class="hljs-comment"># å¼€å¯è¯„è®º</span><br>    <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">type:</span> <span class="hljs-string">changyan</span> <span class="hljs-comment"># é€‰æ‹©è¯„è®ºæ’ä»¶ç±»å‹</span><br><br><span class="hljs-comment"># å…¶ä»–é…ç½®å¯ä»¥å‚è€ƒå®˜ç½‘</span><br><span class="hljs-attr">changyan:</span><br>  <span class="hljs-attr">appid:</span> <span class="hljs-string">&#x27;id&#x27;</span><br>  <span class="hljs-attr">appkey:</span> <span class="hljs-string">&#x27;secret&#x27;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœï¼š<br><img src="/../../images/site/comment/changyan_show.png" alt="ç•…è¨€äº‘è¯„æ•ˆæœ"></p><h2 id="è¯„ä»·-4"><a href="#è¯„ä»·-4" class="headerlink" title="è¯„ä»·"></a>è¯„ä»·</h2><ol><li>ç•…è¨€çš„ç½‘ç«™æ¯”è¾ƒè€äº†ï¼Œä½†æ˜¯æ³¨å†Œè¿‡ç¨‹è¿˜æ˜¯å¾ˆç®€å•çš„</li><li>ä»åå°æ¥çœ‹ï¼Œå¯¹äºè¯„è®ºçš„åŠŸèƒ½æ”¯æŒè¿˜æ˜¯æŒºå®Œå–„çš„ï¼Œå¯ä»¥æ§è¯„ï¼Œä¹Ÿæœ‰å¾ˆå¤šå…¶ä»–çš„æ’ä»¶</li><li>å¯ä»¥å…è´¹å­˜å‚¨æ•°æ®</li><li>å‘å¸ƒè¯„è®ºéœ€è¦ç™»å½•ï¼Œé—¨æ§›å¤ªé«˜ï¼Œpass.</li></ol><h1 id="twikooæ’ä»¶"><a href="#twikooæ’ä»¶" class="headerlink" title="twikooæ’ä»¶"></a><a href="https://twikoo.js.org/quick-start.html">twikooæ’ä»¶</a></h1><p>ä¸€ä¸ªç®€æ´ã€å®‰å…¨ã€å…è´¹çš„é™æ€ç½‘ç«™è¯„è®ºç³»ç»Ÿã€‚</p><ul><li>å…è´¹æ­å»ºï¼ˆä½¿ç”¨äº‘å¼€å‘ &#x2F; Vercel &#x2F; ç§æœ‰æœåŠ¡å™¨ä½œä¸ºè¯„è®ºåå°ï¼‰</li><li>ç®€å•éƒ¨ç½²ï¼ˆæ”¯æŒäº‘å¼€å‘ &#x2F; Vercel ä¸€é”®éƒ¨ç½²ï¼‰</li></ul><p>è¿™æ˜¯ä¸€æ¬¾ç§æœ‰åŒ–éƒ¨ç½²çš„è¯„è®ºæ’ä»¶ï¼Œå¯ä»¥åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šéƒ¨ç½²ï¼Œå®˜æ–¹ä¹Ÿæä¾›äº†ä¸€æ•´å¥—äº‘éƒ¨ç½²çš„å…è´¹æ–¹æ¡ˆï¼Œå¯ä»¥è‡ªè¡Œé€‰æ‹©ã€‚<br><img src="/../../images/site/comment/twioo_install_choose.png" alt="twikooçš„Nç§äº‘éƒ¨ç½²æ–¹å¼"></p><p>å› ä¸ºæ˜¯ç§æœ‰åŒ–éƒ¨ç½²çš„æ–¹æ¡ˆï¼Œè¿™å°±æ¶‰åŠåˆ°æ•°æ®å­˜å‚¨çš„é—®é¢˜ï¼Œå®˜æ–¹æä¾›çš„æ–¹æ¡ˆæ˜¯ä½¿ç”¨mongodbçš„å…è´¹å­˜å‚¨æœåŠ¡ï¼Œéœ€è¦è‡ªè¡Œæ³¨å†Œã€‚   </p><h2 id="å®‰è£…è¿‡ç¨‹-5"><a href="#å®‰è£…è¿‡ç¨‹-5" class="headerlink" title="å®‰è£…è¿‡ç¨‹"></a>å®‰è£…è¿‡ç¨‹</h2><p>æ— è®ºå“ªä¸€ç§æ–¹æ¡ˆéƒ½è®¾è®¡åˆ°mongodbæ•°æ®åº“çš„ç”³è¯·ï¼Œæ‰€ä»¥ç¬¬ä¸€æ­¥å°±æ˜¯è¦ç”³è¯·mongodbå…è´¹ç‰ˆã€‚</p><h3 id="mongodbç”³è¯·"><a href="#mongodbç”³è¯·" class="headerlink" title="mongodbç”³è¯·"></a>mongodbç”³è¯·</h3><p>å‚è€ƒ<a href="https://twikoo.js.org/mongodb-atlas.html">å®˜æ–¹æ–‡ç« </a>,å†™çš„å¾ˆè¯¦ç»†äº†ã€‚</p><h3 id="netlifyå®‰è£…"><a href="#netlifyå®‰è£…" class="headerlink" title="netlifyå®‰è£…"></a>netlifyå®‰è£…</h3><p>å› ä¸ºç½‘é€Ÿå’Œæµé‡çš„åŸå› ï¼Œæˆ‘é€‰æ‹©çš„æ˜¯netlifyåšæˆ‘çš„è¯„è®ºæ’ä»¶æ‰˜ç®¡äº‘æœåŠ¡ã€‚</p><ol><li>æ‰“å¼€ <a href="https://github.com/twikoojs/twikoo-netlify">twikoojs&#x2F;twikoo-netlify</a> ç‚¹å‡» fork å°†ä»“åº“ fork åˆ°è‡ªå·±çš„è´¦å·ä¸‹,åé¢netlifyéƒ¨ç½²çš„æ—¶å€™ä¼šç”¨åˆ°è¿™ä¸ªä»“åº“ã€‚</li><li><a href="https://app.netlify.com/">ç‚¹å‡»è¿™é‡Œ</a> æ³¨å†Œnetlifyè´¦å·ï¼Œå¯èƒ½éœ€è¦ç¿»å¢™ï¼Œä½¿ç”¨githubè´¦å·ç™»å½•ã€‚</li><li>netlifyæ³¨å†Œçš„æ—¶å€™å¯ä»¥é€‰æ‹©ä»…æˆæƒä¸Šé¢forkçš„ã€twikoo-netlifyã€‘åº“</li><li>è¿›å…¥netlifyæ§åˆ¶å°ï¼Œç‚¹å‡»ã€import an existing siteã€‘ï¼Œç„¶åé€‰æ‹©ä¸Šé¢forkçš„ã€twikoo-netlifyã€‘åº“.<br><img src="/../../images/site/comment/netlify_home.png" alt="netlifyæ–°å»ºsiteé¡µé¢"></li><li>é…ç½®ç¯å¢ƒå˜é‡ï¼Œé…ç½®ä½ çš„åŸŸåå’Œmongodbçš„<code>MONGODB_URI</code>ï¼Œå€¼å°±æ˜¯mongodb ç”³è¯·é‡Œè·å¾—çš„nodejs è¿æ¥url<br><img src="/../../images/site/comment/netlify_add_mongo_url.png" alt="é…ç½®mongodbç¯å¢ƒå˜é‡"></li><li>ç‚¹å‡»deployï¼Œç­‰å¾…éƒ¨ç½²å®Œæˆã€‚ ç„¶åè¯·æ±‚ä½ é…ç½®çš„åŸŸå<code>https://xxxxx.netlify.app/</code> ï¼Œå¦‚æœçœ‹åˆ°å¦‚ä¸‹å†…å®¹ï¼Œè¯´æ˜éƒ¨ç½²æˆåŠŸã€‚</li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;code&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">100</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Twikoo äº‘å‡½æ•°è¿è¡Œæ­£å¸¸ï¼Œè¯·å‚è€ƒ https://twikoo.js.org/frontend.html å®Œæˆå‰ç«¯çš„é…ç½®&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.6.41&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><ol start="7"><li>é…ç½®å®Œæˆåï¼Œå°±å¯ä»¥åœ¨<code>_config.yml</code>é…ç½®twikooäº†ã€‚</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">post:</span><br>  <span class="hljs-attr">comments:</span>  <span class="hljs-comment"># å¼€å¯è¯„è®º</span><br>    <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">type:</span> <span class="hljs-string">twikoo</span> <span class="hljs-comment"># é€‰æ‹©è¯„è®ºæ’ä»¶ç±»å‹</span><br><br><span class="hljs-comment"># å…¶ä»–é…ç½®å¯ä»¥å‚è€ƒå®˜ç½‘</span><br><span class="hljs-attr">twikoo:</span><br>  <span class="hljs-attr">envId:</span> <span class="hljs-string">https://xxxxxxxxxx.netlify.app/.netlify/functions/twikoo</span><br>  <span class="hljs-attr">region:</span> <span class="hljs-string">ap-shanghai</span><br>  <span class="hljs-attr">path:</span> <span class="hljs-string">window.location.pathname</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœï¼š<br><img src="/../../images/site/comment/twikoo_netlify_show.png" alt="twikooæ•ˆæœ"></p><h3 id="å…¶ä»–éƒ¨ç½²æ–¹å¼"><a href="#å…¶ä»–éƒ¨ç½²æ–¹å¼" class="headerlink" title="å…¶ä»–éƒ¨ç½²æ–¹å¼"></a>å…¶ä»–éƒ¨ç½²æ–¹å¼</h3><p><a href="https://blog.zhheo.com/p/2e6bbbd0.html">åŸºäºè…¾è®¯äº‘çš„twikooéƒ¨ç½²æ–¹æ¡ˆ</a>ï¼Œ æ³¨æ„å› ä¸ºè…¾è®¯äº‘å…è´¹é¢åº¦å·²ç»æ²¡æœ‰äº†ï¼Œè¿™ä¸ªæ–¹æ¡ˆå·²ç»å¤±æ•ˆï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒã€‚</p><h2 id="åå°é…ç½®"><a href="#åå°é…ç½®" class="headerlink" title="åå°é…ç½®"></a>åå°é…ç½®</h2><p>twikooå†…åµŒäº†ä¸€å¥—åå°é…ç½®é¡µé¢ï¼Œå¯ä»¥é…ç½®è¯„è®ºçš„æ˜¾ç¤ºï¼Œé‚®ä»¶æé†’ã€åƒåœ¾å†…å®¹è¿‡æ»¤ç­‰å†…å®¹ã€‚</p><p>å…¥å£å°±æ˜¯åˆ·æ–°æ—è¾¹çš„é…ç½®æŒ‰é’®ã€‚<br><img src="/../../images/site/comment/twikoo_config_entry.png" alt="twikoo_config_entry.png"><br>ç¬¬ä¸€æ¬¡æ‰“å¼€é…ç½®é¡µé¢ä¼šè¦æ±‚ä½ é…ç½®è´¦å·å¯†ç ï¼Œè¿™ä¸ªä¸€å®šè¦è®°å¥½ï¼Œä¸ç„¶æ‰¾å›ä¼šå¾ˆéº»çƒ¦ã€‚<br>é…ç½®å¥½å¯†ç åï¼Œåœ¨åå°å°±å¯ä»¥å¯¹è¯„è®ºåšä¸€äº›ç‰¹æ®Šé…ç½®äº†ã€‚</p><p>è¿™é‡Œå°±å¯¹ä¸€äº›ä¸»è¦çš„é…ç½®è¿›è¡Œä»‹ç»ã€‚</p><ul><li>SITE_NAMEï¼šä½ çš„ç½‘ç«™åç§°</li><li>SITE_URLï¼šä½ çš„ç½‘ç«™åœ°å€</li><li>BLOGGER_NICKï¼š ä½ çš„åšå®¢æ˜µç§°</li><li>BLOGGER_EMAILï¼šåšä¸»é‚®ç®±ï¼Œå½“è¯„è®ºé‚®ç®±åŒ¹é…åˆ°è¿™ä¸ªé‚®ç®±ï¼Œä¼šæ˜¾ç¤ºä¸ºåšä¸»ã€‚ å½“æœ‰æ–°å¢è¯„è®ºæ˜¯ï¼Œä¹Ÿä¼šç»™è¿™ä¸ªé‚®ç®±å‘é‚®ä»¶ã€‚</li><li>MASTER_TAGï¼šåšä¸»æ˜¾ç¤ºåç§°</li><li>HIDE_ADMIN_CRYPTï¼šéšè—ç®¡ç†é¢æ¿å…¥å£çš„æš—å·ï¼Œåªæœ‰åœ¨â€œæ˜µç§°â€ä¸€æ è¾“å…¥ç›¸åŒçš„â€œæš—å·â€æ—¶ï¼Œç®¡ç†é¢æ¿å…¥å£æ‰ä¼šæ˜¾ç¤ºã€‚è¿™ä¸ªæš—å·ä¸€å®šè¦ç‰¢è®°ã€‚</li><li>SHOW_IMAGEï¼šæ˜¯å¦æ”¯æŒè¯„è®ºå›¾ç‰‡</li><li>IMAGE_CDNï¼šæ’å…¥å›¾ç‰‡æ‰€ä½¿ç”¨çš„å›¾åºŠ</li><li>SHOW_EMOTIONï¼šæ˜¯å¦æ”¯æŒè¡¨æƒ…</li><li>SHOW_UAï¼šæ˜¯å¦æ˜¾ç¤ºç”¨æˆ·ç³»ç»Ÿå’Œæµè§ˆå™¨</li><li>SHOW_REGIONï¼šæ˜¯å¦æ˜¾ç¤ºç”¨æˆ· IP å±åœ°åˆ°çœ</li><li>SENDER_EMAILï¼šå‘é€é‚®ä»¶çš„é‚®ç®±åœ°å€ï¼Œä¸ºäº†ä¸å’Œæ—¥å¸¸çš„é‚®ç®±å¹²æ‰°ï¼Œè¿™é‡Œæˆ‘åˆæ–°ç”³è¯·äº†ä¸€ä¸ªã€‚<blockquote><p>è¯´æ˜ä¸€ä¸‹ï¼Œå½“æœ‰æ–°è¯„è®ºæ—¶ï¼Œä¼šå‘é‚®ä»¶ç»™åšä¸»ã€‚å°±æ˜¯è¿™ä¸ª SENDER_EMAIL å‘é€ç»™ BLOGGER_EMAIL</p></blockquote></li><li>SENDER_NAMEï¼š æ–°è¯„è®ºæ—¶çš„ä¸»é¢˜</li><li>SMTP_SERVICEï¼š é‚®ä»¶å‘é€çš„ SMTP æœåŠ¡å•†</li><li>SMTP_USERï¼š å’ŒSENDER_EMAILä¸€æ ·</li><li>SMTP_PASSï¼š é‚®ä»¶æœåŠ¡å™¨çš„è´¦å·å¯†ç ï¼Œå¯ä»¥åˆ°ä½ çš„é‚®ç®±è®¾ç½®é‡ŒæŸ¥çœ‹ï¼Œåœ¨å¼€å¯ä½ çš„smtpæ˜¯ä¼šæç¤ºã€‚<br>æœ€åä¼šæœ‰ä¸€ä¸ªé‚®ä»¶æµ‹è¯•ï¼Œå¯ä»¥å¡«ä¸Šè‡ªå·±çš„é‚®ç®±å»éªŒè¯ä¸€ä¸‹ã€‚</li></ul><p>è¿™äº›é…ç½®åœ¨ä¿å­˜åï¼Œä¼šåœ¨mongodbé‡Œåˆ›å»ºä¸€ä¸ªè¡¨ï¼Œç”¨æ¥å­˜å‚¨è¿™äº›é…ç½®ã€‚</p><h2 id="è¯„ä»·-5"><a href="#è¯„ä»·-5" class="headerlink" title="è¯„ä»·"></a>è¯„ä»·</h2><ol><li>å› ä¸ºæ˜¯ç§æœ‰åŒ–éƒ¨ç½²ï¼Œè¿‡ç¨‹æ¯”è¾ƒå¤æ‚</li><li>æ•´ä¸ªè¿‡ç¨‹éƒ½æ˜¯å…è´¹çš„èµ„æºï¼Œæ»¡è¶³æˆ‘çš„å…è´¹æŒä¹…åŒ–éœ€æ±‚</li><li>è¯„è®ºå¯ä»¥åŒ¿åï¼Œä¸ç”¨æ³¨å†Œï¼Œæ¯”è¾ƒå‹å¥½</li><li>é¡µé¢ä¹Ÿæ¯”è¾ƒç¾è§‚ï¼Œæ”¯æŒè¯„è®ºçš„è¯„è®ºï¼Œæœ€ç»ˆé€‰æ‹©äº†è¿™ä¸ªã€‚</li></ol><h1 id="æœ€åpassæ‰çš„æ’ä»¶"><a href="#æœ€åpassæ‰çš„æ’ä»¶" class="headerlink" title="æœ€åpassæ‰çš„æ’ä»¶"></a>æœ€åpassæ‰çš„æ’ä»¶</h1><ul><li>Valine: åŸºäº LeanCloudï¼Œè¿™ä¸ªæœ‰å…è´¹çš„å­˜å‚¨ç©ºé—´ã€‚ä½†æ˜¯å›½å†…çš„LeanCloud è´¦å·éœ€è¦åŸŸåå¤‡æ¡ˆï¼Œè¦ä½¿ç”¨èº«ä»½è¯ç­‰è®¤è¯ï¼Œæ¥å…¥å¾ˆéº»çƒ¦ï¼Œé‚æ”¾å¼ƒã€‚</li><li>Waline: ä» Valine è¡ç”Ÿè€Œæ¥ï¼Œæ”¾å¼ƒåŸå› åŒä¸Š</li><li>Disqus: å›½å†…ç”¨æˆ·ç›´æ¥ä½¿ç”¨å®¹æ˜“è¢«å¢™ï¼Œç›´æ¥æ”¾å¼ƒ</li><li>remark42: éœ€è¦è‡ªå»ºæ‰˜ç®¡æœåŠ¡ï¼Œç›´æ¥æ”¾å¼ƒ</li></ul><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æŠ˜è…¾äº†ä¸¤å¤©ï¼Œç»ˆäºæŠŠå‡ æ¬¾è¯„è®ºæ’ä»¶éªŒè¯å®Œäº†ã€‚</p><p>æ•´ä½“æ¥çœ‹ï¼Œæœ‰ä¸¤æ¬¾æ•ˆæœæ¯”è¾ƒå¥½ï¼Œåˆ†åˆ«æ˜¯twikooå’Œgiscusã€‚</p><ul><li>giscus: å®‰è£…æ¯”è¾ƒç®€å•ï¼Œæ•°æ®æ‰˜ç®¡åœ¨github, ä½†è¯„è®ºéœ€è¦githubè´¦å·ç™»å½•ï¼Œé€‚åˆé‚£äº›å¿«é€Ÿä¸Šæ‰‹çš„åšä¸»ã€‚</li><li>twikoo: å®‰è£…æ¯”è¾ƒå¤æ‚ï¼Œéœ€è¦ç”³è¯·mongodbæ•°æ®åº“ï¼Œç”³è¯·äº‘æœåŠ¡å…è´¹èµ„æºï¼Œé€‚åˆé‚£äº›å–œæ¬¢æŠ˜è…¾çš„åšä¸»ã€‚</li></ul><h1 id="todo"><a href="#todo" class="headerlink" title="todo"></a>todo</h1><ul><li><input disabled="" type="checkbox"> ç­‰æˆ‘çš„åŸŸåå¤‡æ¡ˆæˆåŠŸäº†ï¼Œå†å°è¯•ä¸€ä¸‹valineå’Œwaline</li><li><input disabled="" type="checkbox"> æ‰¾ä¸ªæ—¶é—´è¯•ä¸€ä¸‹twikooçš„ç§æœ‰åŒ–éƒ¨ç½²æ–¹å¼</li></ul><p>æœ€åï¼Œæ‚¨è§‰å¾—è¿˜æœ‰ä»€ä¹ˆè¦è¡¥å……çš„å—ï¼Ÿ</p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç«™</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å»ºç«™</tag>
      
      <tag>è¯„è®ºæ’ä»¶</tag>
      
      <tag>hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>jekyllè¿ç§»åˆ°Hexoåšå®¢æ¶æ„å…¨è¿‡ç¨‹</title>
    <link href="/2025/01/07/site-hexo-from-jekyll/"/>
    <url>/2025/01/07/site-hexo-from-jekyll/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸ºä»€ä¹ˆè¦è¿ç§»åˆ°hexo"><a href="#ä¸ºä»€ä¹ˆè¦è¿ç§»åˆ°hexo" class="headerlink" title="ä¸ºä»€ä¹ˆè¦è¿ç§»åˆ°hexo"></a>ä¸ºä»€ä¹ˆè¦è¿ç§»åˆ°hexo</h1><h2 id="ä»€ä¹ˆæ˜¯Hexo"><a href="#ä»€ä¹ˆæ˜¯Hexo" class="headerlink" title="ä»€ä¹ˆæ˜¯Hexo"></a>ä»€ä¹ˆæ˜¯Hexo</h2><p>Hexo æ˜¯ä¸€ä¸ªå¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶ï¼ˆä½¿ç”¨NodeJsï¼‰ã€‚ Hexo ä½¿ç”¨ Markdownï¼ˆæˆ–å…¶ä»–æ ‡è®°è¯­è¨€ï¼‰è§£ææ–‡ç« ï¼Œåœ¨å‡ ç§’å†…ï¼Œå³å¯åˆ©ç”¨é“ä¸½çš„ä¸»é¢˜ç”Ÿæˆé™æ€ç½‘é¡µã€‚</p><h2 id="ä¸ºä»€ä¹ˆé€‰æ‹©äº†Hexo"><a href="#ä¸ºä»€ä¹ˆé€‰æ‹©äº†Hexo" class="headerlink" title="ä¸ºä»€ä¹ˆé€‰æ‹©äº†Hexo"></a>ä¸ºä»€ä¹ˆé€‰æ‹©äº†Hexo</h2><ol><li>å¥½çœ‹ï¼Œå¥½çœ‹ï¼Œå¥½çœ‹</li><li>å…¶ä¸­çš„å½’æ¡£åŠŸèƒ½åšçš„å¾ˆå¥½ï¼Œæ”¯æŒåˆ†ç»„ã€ä¹Ÿæ”¯æŒæ ‡ç­¾</li><li>å¾ˆå¥½çš„é›†æˆäº†ç½‘ç«™ç»Ÿè®¡ç›¸å…³çš„åŠŸèƒ½</li></ol><h1 id="è¿ç§»è¿‡ç¨‹"><a href="#è¿ç§»è¿‡ç¨‹" class="headerlink" title="è¿ç§»è¿‡ç¨‹"></a>è¿ç§»è¿‡ç¨‹</h1><h2 id="Hexoç¯å¢ƒæ­å»º"><a href="#Hexoç¯å¢ƒæ­å»º" class="headerlink" title="Hexoç¯å¢ƒæ­å»º"></a>Hexoç¯å¢ƒæ­å»º</h2><ol><li>é¦–å…ˆç¡®ä¿å®‰è£…äº†nodejså’Œgit<br>å› ä¸º Hexo æ˜¯åŸºäº nodejs çš„ï¼Œæ‰€ä»¥éœ€è¦å…ˆå®‰è£… nodejsï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯ nvm ç®¡ç† nodejs ç‰ˆæœ¬ï¼Œå®‰è£…å¥½ nvm åï¼Œæ‰§è¡Œ nvm install nodejs å®‰è£… nodejsã€‚</li></ol><p>æˆ‘å®‰è£…çš„æ˜¯2025å¹´1æœˆæœ€æ–°ltsç‰ˆæœ¬çš„nodejs: <code>v22.12.0</code></p><ol start="2"><li>å®‰è£…Hexo</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install -g hexo-cli<br></code></pre></td></tr></table></figure><p>å› ä¸ºæˆ‘çš„nodejsæ˜¯æœ€æ–°ç‰ˆæœ¬ï¼Œæ‰€ä»¥æˆ‘çš„hexoç‰ˆæœ¬æ˜¯ä¹Ÿæ˜¯å½“å‰æœ€æ–°ç‰ˆæœ¬ï¼š<code> 7.3.0</code></p><h2 id="åˆ›å»ºHexoåšå®¢ç½‘ç«™"><a href="#åˆ›å»ºHexoåšå®¢ç½‘ç«™" class="headerlink" title="åˆ›å»ºHexoåšå®¢ç½‘ç«™"></a>åˆ›å»ºHexoåšå®¢ç½‘ç«™</h2><p>é€‰æ‹©ä¸€ä¸ªä½ æƒ³åˆ›å»ºé¡¹ç›®ä»£ç çš„ä½ç½®ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºHexoåšå®¢ç½‘ç«™ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># é€‰æ‹©åˆé€‚çš„nodejs ç‰ˆæœ¬</span><br>nvm use v22.12.0<br><span class="hljs-comment"># åˆ›å»ºé¡¹ç›®</span><br>hexo init my_blod<br><span class="hljs-built_in">cd</span> my_blod<br><span class="hljs-comment"># åˆå§‹åŒ–ä¾èµ–</span><br>npm install<br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ªé»˜è®¤çš„åšå®¢é¡¹ç›®<code>my_blog</code>ï¼Œå…¶ä¸­çš„package.jsonæ–‡ä»¶å¦‚ä¸‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;hexo-site&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;0.0.0&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;private&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;build&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;hexo generate&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;clean&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;hexo clean&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;deploy&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;hexo deploy&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;server&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;hexo server&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;hexo&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;7.3.0&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;dependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;hexo&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^7.3.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;hexo-generator-archive&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^2.0.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;hexo-generator-category&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^2.0.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;hexo-generator-index&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^4.0.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;hexo-generator-tag&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^2.0.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;hexo-renderer-ejs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^2.0.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;hexo-renderer-marked&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^7.0.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;hexo-renderer-stylus&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^3.0.1&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;hexo-server&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^3.0.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;hexo-theme-fluid&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^1.9.8&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;hexo-theme-landscape&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^1.0.0&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>åˆ°äº†è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯åŠ¨æœ€åŸå§‹ç‰ˆæœ¬çš„é¡¹ç›®äº†ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> my_blod<br>hexo server<br><span class="hljs-comment"># or </span><br>npm run server<br></code></pre></td></tr></table></figure><p>ç„¶åè®¿é—® <code>http://localhost:4000</code> å°±å¯ä»¥çœ‹åˆ°é»˜è®¤çš„åšå®¢äº†ã€‚<br><img src="/images/site/hexo_raw_init.png" alt="hexoé»˜è®¤ä¸»é¢˜é¡µé¢"><br>å®˜æ–¹ç»™æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª<code>hello world</code>çš„åšå®¢. æˆ‘ä»¬å¯ä»¥å‚è€ƒè¿™ä¸ªæ¥å†™æˆ‘ä»¬è‡ªå·±çš„åšå®¢äº†ã€‚</p><p>å¸¸ç”¨çš„hexoå‘½ä»¤å‚è€ƒ<a href="https://hexo.io/zh-cn/docs/commands">è¿™é‡Œ</a></p><h2 id="å®‰è£…æˆ‘å–œæ¬¢çš„ä¸»é¢˜Fluid"><a href="#å®‰è£…æˆ‘å–œæ¬¢çš„ä¸»é¢˜Fluid" class="headerlink" title="å®‰è£…æˆ‘å–œæ¬¢çš„ä¸»é¢˜Fluid"></a>å®‰è£…æˆ‘å–œæ¬¢çš„ä¸»é¢˜<a href="https://hexo.fluid-dev.com/docs/start/#%E4%B8%BB%E9%A2%98%E7%AE%80%E4%BB%8B">Fluid</a></h2><p>å½“ç„¶è¿™é‡Œå¯ä»¥ä½¿ç”¨ä»»ä½•ä½ å–œæ¬¢çš„ä¸»é¢˜ï¼Œå®‰è£…æ¨¡å¼å¤§åŒå°å¼‚ã€‚</p><ol><li>å®‰è£…Fluidä¸»é¢˜çš„æœ€æ–°ç‰ˆæœ¬</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> my_blod<br>npm install --save hexo-theme-fluid<br></code></pre></td></tr></table></figure><ol start="2"><li>é…ç½®ä¸»é¢˜<br> å¦‚ä¸‹ä¿®æ”¹ Hexo åšå®¢ç›®å½•ä¸­çš„ _config.ymlï¼š</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">theme:</span> <span class="hljs-string">fluid</span>  <span class="hljs-comment"># æŒ‡å®šä¸»é¢˜</span><br><br><span class="hljs-attr">language:</span> <span class="hljs-string">zh-CN</span>  <span class="hljs-comment"># æŒ‡å®šè¯­è¨€ï¼Œä¼šå½±å“ä¸»é¢˜æ˜¾ç¤ºçš„è¯­è¨€ï¼ŒæŒ‰éœ€ä¿®æ”¹</span><br></code></pre></td></tr></table></figure><ol start="3"><li>åˆ›å»ºã€å…³äºé¡µã€‘<br> é¦–æ¬¡ä½¿ç”¨ä¸»é¢˜çš„ã€Œå…³äºé¡µã€éœ€è¦æ‰‹åŠ¨åˆ›å»ºï¼š</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">hexo new page about<br></code></pre></td></tr></table></figure><p>åˆ›å»ºæˆåŠŸåä¿®æ”¹ &#x2F;source&#x2F;about&#x2F;index.mdï¼Œæ·»åŠ  <strong>layout</strong> å±æ€§ï¼Œã€‚</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs markdown">---<br>title: æ ‡é¢˜<br><span class="hljs-section">layout: about</span><br><span class="hljs-section">---</span><br><br>è¿™é‡Œå†™å…³äºé¡µçš„æ­£æ–‡ï¼Œæ”¯æŒ Markdown, HTML<br></code></pre></td></tr></table></figure><blockquote><p>layout: about å¿…é¡»å­˜åœ¨ï¼Œå¹¶ä¸”ä¸èƒ½ä¿®æ”¹æˆå…¶ä»–å€¼ï¼Œå¦åˆ™ä¸ä¼šæ˜¾ç¤ºå¤´åƒç­‰æ ·å¼ã€‚</p></blockquote><p><img src="/images/site/hexo_fluid_init.png" alt="fluidä¸»é¢˜å¯åŠ¨åçš„åšå®¢é¡µé¢"></p><h1 id="è¿ç§»jekyllåšå®¢æ–‡ç« "><a href="#è¿ç§»jekyllåšå®¢æ–‡ç« " class="headerlink" title="è¿ç§»jekyllåšå®¢æ–‡ç« "></a>è¿ç§»jekyllåšå®¢æ–‡ç« </h1><h2 id="æ–‡ç« è¿ç§»"><a href="#æ–‡ç« è¿ç§»" class="headerlink" title="æ–‡ç« è¿ç§»"></a>æ–‡ç« è¿ç§»</h2><ol><li>æŠŠ _posts æ–‡ä»¶å¤¹å†…çš„æ‰€æœ‰æ–‡ä»¶å¤åˆ¶åˆ° source&#x2F;_posts æ–‡ä»¶å¤¹</li><li>åœ¨ _config.yml ä¸­ä¿®æ”¹ new_post_name å‚æ•°</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">new_post_name:</span> <span class="hljs-string">:year-:month-:day-:title.md</span><br></code></pre></td></tr></table></figure><ol start="3"><li>å¦‚æœä¸æƒ³ä½¿ç”¨æ­¥éª¤2ï¼Œä¹Ÿå¯ä»¥æŠŠæ‰€æœ‰çš„æ–‡ç« çš„æ–‡ä»¶åçš„å¹´æœˆæ—¥å‰ç¼€å»æ‰ï¼Œä¹Ÿå¯ä»¥ï¼ˆä½œä¸ºè½»åº¦æ´ç™–æ‚£è€…ï¼Œæˆ‘é€‰çš„è¿™ç§æ–¹å¼ï¼‰ã€‚</li></ol><h2 id="å›¾ç‰‡è¿ç§»"><a href="#å›¾ç‰‡è¿ç§»" class="headerlink" title="å›¾ç‰‡è¿ç§»"></a>å›¾ç‰‡è¿ç§»</h2><p>åŸå…ˆæˆ‘çš„æ‰€æœ‰çš„å›¾ç‰‡èµ„æºéƒ½æ˜¯åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹çš„ <code>/images</code> è·¯å¾„ä¸‹ï¼Œç„¶ååœ¨æ–‡ç« é‡Œé€šè¿‡markdownçš„å›¾ç‰‡å¼•ç”¨æ–¹å¼å¼•ç”¨ã€‚</p><p>è¿ç§»åˆ°hexoåï¼Œåªéœ€å°†<code>images</code>ç›®å½• ç§»åŠ¨åˆ° <code>source</code> è·¯å¾„ä¸‹ï¼Œå…¶ä»–çš„éƒ½ä¸ç”¨åŠ¨ï¼Œå›¾ç‰‡å°±å¯ä»¥è‡ªåŠ¨è§£æäº†ã€‚</p><p>å› ä¸ºhexo ä¼šå°†sourceç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶éƒ½ç§»åŠ¨åˆ°ç½‘ç«™çš„æ ¹è·¯å¾„ä¸‹ï¼Œæ‰€ä»¥å›¾ç‰‡çš„æœ€ç»ˆå¼•ç”¨åœ°å€æ˜¯ä¸€æ ·çš„ã€‚</p><h2 id="ç½‘ç«™é…ç½®ä¿®æ”¹"><a href="#ç½‘ç«™é…ç½®ä¿®æ”¹" class="headerlink" title="ç½‘ç«™é…ç½®ä¿®æ”¹"></a>ç½‘ç«™é…ç½®ä¿®æ”¹</h2><p>é€šç”¨hexoé…ç½®æŒ‰ç…§å¦‚ä¸‹é…ç½®ä¿®æ”¹ <code>_config.yml</code> æ–‡ä»¶ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># ç½‘ç«™åç§°</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">å¯’æ¾ˆç¬”è®°</span><br><span class="hljs-attr">subtitle:</span> <span class="hljs-string">&#x27;ä¸€ä¸ªç¨‹åºå‘˜çœ¼ä¸­çš„ä¸–ç•Œ&#x27;</span><br><span class="hljs-comment"># ç½‘ç«™è·¯å¾„</span><br><span class="hljs-attr">url:</span> <span class="hljs-string">https://www.hancher.top</span><br></code></pre></td></tr></table></figure><p>fluidä¸»é¢˜é…ç½®ç‰¹æ€§é…ç½®ä¿®æ”¹å¦‚ä¸‹æ–‡ä»¶<code>_config.fluid.yml</code>ï¼Œ ä¼šæ ¹æ®ä¸»é¢˜é…ç½®è‡ªåŠ¨é€‰æ‹©ç›¸åº”ä¸»é¢˜çš„é…ç½®ã€‚<br>è€Œä¸”è¿™é‡Œçš„é…ç½®ä¼˜å…ˆçº§æœ€é«˜ï¼Œä¼šè¦†ç›–<code>_config.yml</code>é…ç½®ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># fluid ä¸»é¢˜é…ç½®</span><br><br><span class="hljs-comment"># ç½‘ç«™é…ç½®</span><br><span class="hljs-comment">## å¤´éƒ¨</span><br><span class="hljs-attr">navbar:</span><br>  <span class="hljs-comment"># åšå®¢æ ‡é¢˜</span><br>  <span class="hljs-attr">blog_title:</span> <span class="hljs-string">å¯’æ¾ˆç¬”è®°</span><br>  <span class="hljs-comment"># å¯ä»¥è‡ªå®šä¹‰å¯¼èˆªæ </span><br><span class="hljs-comment">#  menu:</span><br><span class="hljs-comment">#    - &#123; key: &#x27;home&#x27;, link: &#x27;/&#x27;, icon: &#x27;iconfont icon-home-fill&#x27; &#125;</span><br><span class="hljs-comment">#    - &#123; key: &#x27;tag&#x27;, link: &#x27;/tags/&#x27;, icon: &#x27;iconfont icon-tags-fill&#x27; &#125;</span><br><span class="hljs-comment">#    - &#123; key: &#x27;about&#x27;, link: &#x27;/about/&#x27;, icon: &#x27;iconfont icon-user-fill&#x27;, name: &#x27;è”ç³»æˆ‘&#x27; &#125;</span><br><br><span class="hljs-comment">## åº•éƒ¨</span><br><span class="hljs-attr">footer:</span><br>  <span class="hljs-attr">statistics:</span><br>    <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">source:</span> <span class="hljs-string">&quot;busuanzi&quot;</span>  <span class="hljs-comment"># å¯é€‰ leancloud | busuanzi  æ ¹æ®è‡ªå·±éœ€æ±‚é€‰æ‹©</span><br>    <span class="hljs-attr">pv_format:</span> <span class="hljs-string">&quot;æ€»è®¿é—®é‡ &#123;&#125; æ¬¡&quot;</span>  <span class="hljs-comment"># æ˜¾ç¤ºçš„æ–‡æœ¬ï¼Œ&#123;&#125;æ˜¯æ•°å­—çš„å ä½ç¬¦ï¼ˆå¿…é¡»åŒ…å«)ï¼Œä¸‹åŒ</span><br>    <span class="hljs-attr">uv_format:</span> <span class="hljs-string">&quot;æ€»è®¿å®¢æ•° &#123;&#125; äºº&quot;</span><br><br><span class="hljs-attr">force_https:</span> <span class="hljs-literal">false</span>  <span class="hljs-comment"># å¼ºåˆ¶https</span><br><br><span class="hljs-comment"># å†…å®¹é…ç½®</span><br><span class="hljs-comment">## é¦–é¡µ</span><br><span class="hljs-attr">index:</span><br>  <span class="hljs-attr">slogan:</span><br>    <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">text:</span> <span class="hljs-string">äººç”Ÿæ€»æœ‰ä¸€äº›ä¸œè¥¿å€¼å¾—å›å¿†</span><br><br><span class="hljs-attr">about:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">&quot;å¯’æ¾ˆ&quot;</span><br>  <span class="hljs-attr">intro:</span> <span class="hljs-string">&quot;ä¸€åå–œæ¬¢æ–‡å²å“²çš„ç¨‹åºå‘˜&quot;</span><br>  <span class="hljs-attr">icons:</span>  <span class="hljs-comment"># ä¸è¦æŠŠ icon æ³¨é‡Šæ‰ï¼Œå¦åˆ™æ— æ³•è¦†ç›–é…ç½®</span><br>   <span class="hljs-bullet">-</span> &#123; <span class="hljs-attr">class:</span> <span class="hljs-string">&#x27;iconfont icon-github-fill&#x27;</span>, <span class="hljs-attr">link:</span> <span class="hljs-string">&#x27;https://github.com/Hanchers/hanchers.github.io&#x27;</span> &#125;<br>   <span class="hljs-bullet">-</span> &#123; <span class="hljs-attr">class:</span> <span class="hljs-string">&#x27;iconfont icon-zhihu-fill&#x27;</span>, <span class="hljs-attr">link:</span> <span class="hljs-string">&#x27;https://www.zhihu.com/people/bh.zhi&#x27;</span> &#125;<br>   <span class="hljs-bullet">-</span> &#123; <span class="hljs-attr">class:</span> <span class="hljs-string">&#x27;iconfont icon-wechat2-fill&#x27;</span>, <span class="hljs-attr">qrcode:</span> <span class="hljs-string">&#x27;/images/about/see-history.jpg&#x27;</span> &#125;<br><br><span class="hljs-comment">## æ–‡ç« </span><br><span class="hljs-attr">post:</span><br>  <span class="hljs-attr">meta:</span><br>    <span class="hljs-attr">author:</span>  <span class="hljs-comment"># ä½œè€…ï¼Œä¼˜å…ˆæ ¹æ® front-matter é‡Œ author å­—æ®µï¼Œå…¶æ¬¡æ˜¯ hexo é…ç½®ä¸­ author å€¼</span><br>      <span class="hljs-attr">enable:</span> <span class="hljs-literal">false</span><br>    <span class="hljs-attr">date:</span>  <span class="hljs-comment"># æ–‡ç« æ—¥æœŸï¼Œä¼˜å…ˆæ ¹æ® front-matter é‡Œ date å­—æ®µï¼Œå…¶æ¬¡æ˜¯ md æ–‡ä»¶æ—¥æœŸ</span><br>      <span class="hljs-attr">enable:</span> <span class="hljs-literal">false</span><br>      <span class="hljs-attr">format:</span> <span class="hljs-string">&quot;dddd, MMMM Do YYYY, h:mm a&quot;</span>  <span class="hljs-comment"># æ ¼å¼å‚ç…§ ISO-8601 æ—¥æœŸæ ¼å¼åŒ–</span><br>    <span class="hljs-attr">wordcount:</span>  <span class="hljs-comment"># å­—æ•°ç»Ÿè®¡</span><br>      <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br>      <span class="hljs-attr">format:</span> <span class="hljs-string">&quot;&#123;&#125; å­—&quot;</span>  <span class="hljs-comment"># æ˜¾ç¤ºçš„æ–‡æœ¬ï¼Œ&#123;&#125;æ˜¯æ•°å­—çš„å ä½ç¬¦ï¼ˆå¿…é¡»åŒ…å«)ï¼Œä¸‹åŒ</span><br>    <span class="hljs-attr">min2read:</span>  <span class="hljs-comment"># é˜…è¯»æ—¶é—´</span><br>      <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br>      <span class="hljs-attr">format:</span> <span class="hljs-string">&quot;&#123;&#125; åˆ†é’Ÿ&quot;</span><br>    <span class="hljs-attr">views:</span>  <span class="hljs-comment"># é˜…è¯»æ¬¡æ•°</span><br>      <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br>      <span class="hljs-attr">source:</span> <span class="hljs-string">&quot;busuanzi&quot;</span>  <span class="hljs-comment"># ç»Ÿè®¡æ•°æ®æ¥æºï¼Œå¯é€‰ï¼šleancloud | busuanzi   æ³¨æ„ä¸è’œå­ä¼šé—´æ­‡æŠ½é£</span><br>      <span class="hljs-attr">format:</span> <span class="hljs-string">&quot;&#123;&#125; æ¬¡&quot;</span><br>  <span class="hljs-attr">copyright:</span>  <span class="hljs-comment"># ç‰ˆæƒå£°æ˜</span><br>    <span class="hljs-attr">license:</span> <span class="hljs-string">&#x27;BY-NC-ND&#x27;</span><br>    <span class="hljs-attr">update_date:</span>   <span class="hljs-comment"># æ¥æº front-matter é‡Œ updated å­—æ®µ</span><br>      <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br><br></code></pre></td></tr></table></figure><h1 id="github-pages-é…ç½®ä¿®æ”¹"><a href="#github-pages-é…ç½®ä¿®æ”¹" class="headerlink" title="github pages é…ç½®ä¿®æ”¹"></a>github pages é…ç½®ä¿®æ”¹</h1><p>æˆ‘æ˜¯ç”¨çš„ç§æœ‰é¡¹ç›®ï¼Œç„¶åé€šè¿‡github actionçš„æ–¹å¼æ¥è‡ªåŠ¨ç¼–è¯‘éƒ¨ç½²github pagesçš„ï¼Œ å…·ä½“å¯ä»¥å‚è€ƒæˆ‘çš„å†å²æ–‡ç« ï¼Œæœ‰è®°å½•ã€‚</p><p>è¿™é‡Œè¦åšçš„æ˜¯åœ¨github ä¸Šé‡æ–°é…ç½®hexoç¯å¢ƒå’Œ æ‰“åŒ…è„šæœ¬ã€‚</p><p>è¿›å…¥æœ¬åœ°é¡¹ç›®çš„ <code>.github/workflows</code>ç›®å½•ä¸‹ï¼Œåˆ é™¤ä»¥å‰çš„workflowæ–‡ä»¶ï¼Œç„¶åæ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶åéšæ„ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># ci name</span><br><span class="hljs-comment"># ci è„šæœ¬åç§°</span><br><span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">Hexo</span> <span class="hljs-string">site</span> <span class="hljs-string">to</span> <span class="hljs-string">public</span> <span class="hljs-string">github</span> <span class="hljs-string">repos</span><br><br><span class="hljs-attr">on:</span><br>  <span class="hljs-comment"># Runs on pushes targeting the default branch</span><br>  <span class="hljs-comment"># å½“ä»£ç  push åˆ° main åˆ†æ”¯æ—¶, æ‰§è¡Œè¯¥è„šæœ¬</span><br>  <span class="hljs-attr">push:</span><br>    <span class="hljs-attr">branches:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">main</span><br><br>  <span class="hljs-comment"># Allows you to run this workflow manually from the Actions tab</span><br>  <span class="hljs-comment"># å…è®¸ä½  æ‰‹åŠ¨æ‰§è¡Œ è¿™ä¸ªè„šæœ¬</span><br>  <span class="hljs-attr">workflow_dispatch:</span><br><br><span class="hljs-comment"># Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages</span><br><span class="hljs-comment"># GITHUB_TOKEN çš„æ“ä½œæƒé™</span><br><span class="hljs-attr">permissions:</span><br>  <span class="hljs-attr">contents:</span> <span class="hljs-string">read</span><br>  <span class="hljs-attr">pages:</span> <span class="hljs-string">write</span><br>  <span class="hljs-attr">id-token:</span> <span class="hljs-string">write</span><br><br><span class="hljs-comment"># Allow one concurrent deployment</span><br><span class="hljs-attr">concurrency:</span><br>  <span class="hljs-attr">group:</span> <span class="hljs-string">&quot;pages&quot;</span><br>  <span class="hljs-attr">cancel-in-progress:</span> <span class="hljs-literal">true</span><br><br><span class="hljs-comment"># job æ‰§è¡Œä»»åŠ¡, å¯ä»¥æœ‰å¤šä¸ª, é»˜è®¤å¹¶è¡Œè¿è¡Œ, å¯ä»¥é€šè¿‡ needs å…³é”®å­—æ¥è®¾ç½®ä¾èµ–çš„å…¶ä»– jobs</span><br><span class="hljs-comment"># step : ä»»åŠ¡ä¸‹çš„æ‰§è¡Œæ­¥éª¤, ä¸€ä¸ªjob ä¼šæœ‰å¤šä¸ªæ­¥éª¤</span><br><span class="hljs-comment"># æ“ä½œ:  ä¸€ä¸ªstep ä¸‹å¯ä»¥æ‰§è¡Œå¤šä¸ªæ“ä½œ, é€šå¸¸ä¸€è¡Œè„šæœ¬ä¸ºä¸€ä¸ªæ“ä½œ</span><br><span class="hljs-attr">jobs:</span><br>  <span class="hljs-comment"># Build job</span><br>  <span class="hljs-attr">build:</span><br>    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span><br>    <span class="hljs-attr">steps:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Checkoutç‰ˆæœ¬</span><br>        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v4</span><br>      <span class="hljs-comment"># å‡†å¤‡ruby ç¯å¢ƒ</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">ä½¿ç”¨Nodeï¼š</span> <span class="hljs-string">v22.12.0</span><br>        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-node@v4</span><br>        <span class="hljs-attr">with:</span><br>          <span class="hljs-comment"># Examples: 20, 18.19, &gt;=16.20.2, lts/Iron, lts/Hydrogen, *, latest, current, node</span><br>          <span class="hljs-comment"># Ref: https://github.com/actions/setup-node#supported-version-syntax</span><br>          <span class="hljs-attr">node-version:</span> <span class="hljs-string">&quot;22.12&quot;</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">ç¼“å­˜</span> <span class="hljs-string">NPM</span> <span class="hljs-string">ä¾èµ–</span><br>        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/cache@v4</span><br>        <span class="hljs-attr">with:</span><br>          <span class="hljs-attr">path:</span> <span class="hljs-string">node_modules</span><br>          <span class="hljs-attr">key:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">runner.OS</span> <span class="hljs-string">&#125;&#125;-npm-cache</span><br>          <span class="hljs-attr">restore-keys:</span> <span class="hljs-string">|</span><br><span class="hljs-string">            $&#123;&#123; runner.OS &#125;&#125;-npm-cache</span><br><span class="hljs-string"></span>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">å®‰è£…npmä¾èµ–</span><br>        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">install</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">æ„å»ºåšå®¢å†…å®¹</span><br>        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">build</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">æ›´æ–°åšå®¢ç½‘ç«™åˆ°publicç›®å½•</span><br>        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/upload-pages-artifact@v3</span><br>        <span class="hljs-attr">with:</span><br>          <span class="hljs-attr">path:</span> <span class="hljs-string">./public</span><br><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">éƒ¨ç½²_siteåˆ°åšå®¢ç½‘ç«™ä»“åº“</span><br>        <span class="hljs-attr">working-directory:</span> <span class="hljs-string">./public</span><br>        <span class="hljs-attr">run:</span> <span class="hljs-string">|</span><br><span class="hljs-string">          git init</span><br><span class="hljs-string">          git checkout -b main</span><br><span class="hljs-string">          git add -A</span><br><span class="hljs-string">          git -c user.name=&#x27;hancher&#x27; -c user.email=&#x27;hanchers@outlook.com&#x27; commit -m &#x27;update blog&#x27; </span><br><span class="hljs-string">          git push &quot;https://$&#123;&#123;github.actor&#125;&#125;:$&#123;&#123;secrets.PUB_BLOG&#125;&#125;@github.com/Hanchers/hanchers.github.io&quot; HEAD:main -f -q</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><p>å¦‚æœä¸æ˜¯ç§æœ‰é¡¹ç›®éƒ¨ç½²çš„è¯ï¼Œä½¿ç”¨å®˜æ–¹çš„é…ç½®å³å¯ã€‚å®˜æ–¹é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">Hexo</span> <span class="hljs-string">åšå®¢éƒ¨ç½²</span><br><br><span class="hljs-attr">on:</span><br>  <span class="hljs-attr">push:</span><br>    <span class="hljs-attr">branches:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">main</span> <span class="hljs-comment"># default branch</span><br><br><span class="hljs-attr">jobs:</span><br>  <span class="hljs-attr">build:</span><br>    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span><br>    <span class="hljs-attr">steps:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v4</span><br>        <span class="hljs-attr">with:</span><br>          <span class="hljs-attr">token:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.GITHUB_TOKEN</span> <span class="hljs-string">&#125;&#125;</span><br>          <span class="hljs-comment"># If your repository depends on submodule, please see: https://github.com/actions/checkout</span><br>          <span class="hljs-attr">submodules:</span> <span class="hljs-string">recursive</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Use</span> <span class="hljs-string">Node.js</span> <span class="hljs-number">20</span><br>        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-node@v4</span><br>        <span class="hljs-attr">with:</span><br>          <span class="hljs-comment"># Examples: 20, 18.19, &gt;=16.20.2, lts/Iron, lts/Hydrogen, *, latest, current, node</span><br>          <span class="hljs-comment"># Ref: https://github.com/actions/setup-node#supported-version-syntax</span><br>          <span class="hljs-attr">node-version:</span> <span class="hljs-string">&quot;20&quot;</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Cache</span> <span class="hljs-string">NPM</span> <span class="hljs-string">dependencies</span><br>        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/cache@v4</span><br>        <span class="hljs-attr">with:</span><br>          <span class="hljs-attr">path:</span> <span class="hljs-string">node_modules</span><br>          <span class="hljs-attr">key:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">runner.OS</span> <span class="hljs-string">&#125;&#125;-npm-cache</span><br>          <span class="hljs-attr">restore-keys:</span> <span class="hljs-string">|</span><br><span class="hljs-string">            $&#123;&#123; runner.OS &#125;&#125;-npm-cache</span><br><span class="hljs-string"></span>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">Dependencies</span><br>        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">install</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Build</span><br>        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">build</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Upload</span> <span class="hljs-string">Pages</span> <span class="hljs-string">artifact</span><br>        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/upload-pages-artifact@v3</span><br>        <span class="hljs-attr">with:</span><br>          <span class="hljs-attr">path:</span> <span class="hljs-string">./public</span><br>  <span class="hljs-attr">deploy:</span><br>    <span class="hljs-attr">needs:</span> <span class="hljs-string">build</span><br>    <span class="hljs-attr">permissions:</span><br>      <span class="hljs-attr">pages:</span> <span class="hljs-string">write</span><br>      <span class="hljs-attr">id-token:</span> <span class="hljs-string">write</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-attr">name:</span> <span class="hljs-string">github-pages</span><br>      <span class="hljs-attr">url:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">steps.deployment.outputs.page_url</span> <span class="hljs-string">&#125;&#125;</span><br>    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span><br>    <span class="hljs-attr">steps:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">GitHub</span> <span class="hljs-string">Pages</span><br>        <span class="hljs-attr">id:</span> <span class="hljs-string">deployment</span><br>        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/deploy-pages@v4</span><br></code></pre></td></tr></table></figure><p>ç„¶åå°±å¯ä»¥åˆ° hanchers.github.io ä»“åº“ä¸‹æŸ¥çœ‹åšå®¢å†…å®¹æ˜¯å¦æ›´æ–°æˆåŠŸäº†ã€‚</p><p>å¦‚æœåšå®¢å†…å®¹æ›´æ–°äº†ï¼Œå°±å¯ä»¥å®‰è£…ä½ çš„åšå®¢åœ°å€å»è®¿é—®åšå®¢äº†ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://hexo.io/zh-cn/docs/">hexo å»ºç«™å®˜æ–¹æ–‡æ¡£</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://hexo.fluid-dev.com/docs/start">fluidä¸»é¢˜å®˜æ–¹æ–‡æ¡£</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://hexo.io/zh-cn/docs/migration">jekyllåšå®¢è¿ç§»åˆ°hexo</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç«™</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å»ºç«™</tag>
      
      <tag>hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2025å¹´åšå®¢æ›´æ–°è®¡åˆ’</title>
    <link href="/2025/01/03/site-plan-in-2025/"/>
    <url>/2025/01/03/site-plan-in-2025/</url>
    
    <content type="html"><![CDATA[<h1 id="2025å¹´åšå®¢æ›´æ–°è®¡åˆ’"><a href="#2025å¹´åšå®¢æ›´æ–°è®¡åˆ’" class="headerlink" title="2025å¹´åšå®¢æ›´æ–°è®¡åˆ’"></a>2025å¹´åšå®¢æ›´æ–°è®¡åˆ’</h1><p>2024å¹´å·²ç»è¿‡å»ï¼Œ2025å¹´å·²ç»åˆ°æ¥ã€‚</p><p>åœ¨è¿‡å»çš„ä¸€å¹´äº†ï¼Œå› ä¸ºç»å†äº†å¾ˆå¤šé‡å¤§çš„äº‹æƒ…ï¼Œæ¯”å¦‚æ¢å·¥ä½œã€æ¯”å¦‚ç»“å©šã€å†æ¯”å¦‚å…¬ä¼—å·ç­‰åŸå› ï¼Œå¯¼è‡´è¿™ä¸ªåšå®¢æ›´æ–°çš„é¢‘ç‡æ¯”è¾ƒæ…¢ã€‚</p><p>ç°åœ¨ï¼Œ2025å¹´äº†ï¼Œæ–°çš„å¼€å§‹ï¼Œæˆ‘ä¹Ÿæ‰“ç®—é‡æ–°æ¢å¤åšå®¢çš„æ›´æ–°è®¡åˆ’ï¼Œå¹¶åˆ¶å®šä¸€äº›è§„åˆ’ï¼Œæ—¢æ˜¯æˆ‘è¿™ä¸€å¹´åŠªåŠ›çš„æ–¹å‘ï¼Œä¹Ÿæ–¹ä¾¿åœ¨2025å¹´æœ«çš„æ—¶å€™å›æ¥å¤ç›˜ã€‚</p><h1 id="æ›´æ–°è®¡åˆ’"><a href="#æ›´æ–°è®¡åˆ’" class="headerlink" title="æ›´æ–°è®¡åˆ’"></a>æ›´æ–°è®¡åˆ’</h1><h2 id="ç½‘ç«™éƒ¨åˆ†"><a href="#ç½‘ç«™éƒ¨åˆ†" class="headerlink" title="ç½‘ç«™éƒ¨åˆ†"></a>ç½‘ç«™éƒ¨åˆ†</h2><ul><li><input checked="" disabled="" type="checkbox"> ç°åœ¨çš„ä¸»é¢˜æ„Ÿè§‰æœ‰ç‚¹ä¸‘ï¼Œè€Œä¸”åœ¨æ–‡æ¡£å½’æ¡£æ–¹é¢æœ‰ç‚¹ä¸è¶³ï¼Œçœ‹åˆ°ä¸€ä¸ªæ–°çš„<a href="https://github.com/fluid-dev/hexo-theme-fluid?tab=readme-ov-file">ä¸»é¢˜</a>å¾ˆå–œæ¬¢ï¼Œè®¡åˆ’æ”¹é€ ä¸€ä¸‹ï¼Œå¯èƒ½ä¼šä¼¤ç­‹åŠ¨éª¨</li><li><input disabled="" type="checkbox"> å½»åº•è§£å†³å›½å†…è®¿é—®æœ¬ç½‘ç«™çš„é—®é¢˜ï¼Œç›®å‰å‘ç°çš„<a href="https://github.com/xingpingcn/enhanced-FaaS-in-China">å‚è€ƒæ–‡ç« </a>,æœ‰ç©ºç ”ç©¶ä¸€ä¸‹</li><li><input checked="" disabled="" type="checkbox"> ç ”ç©¶ä¸€ä¸‹ï¼Œå¦‚ä½•è®©åšå®¢æ‹¥æœ‰<strong>æ›´æ–°æ—¶é—´</strong>çš„åŠŸèƒ½,è®°å½•æˆ‘å¯¹åšå®¢å†…å®¹çš„ä¿®æ”¹</li><li><input disabled="" type="checkbox"> ä¸ºäº†åŠ å¿«ç½‘ç«™çš„è®¿é—®é€Ÿåº¦ï¼Œè€ƒè™‘å¼•å…¥å›¾åºŠåŠŸèƒ½</li><li><input disabled="" type="checkbox"> å°†ä¸Šè¿°æ”¹é€ æ•´ç†æˆæ–‡æ¡£ï¼Œå¹¶åˆ†äº«åˆ°åšå®¢</li></ul><h2 id="å†…å®¹éƒ¨åˆ†"><a href="#å†…å®¹éƒ¨åˆ†" class="headerlink" title="å†…å®¹éƒ¨åˆ†"></a>å†…å®¹éƒ¨åˆ†</h2><ul><li><input disabled="" type="checkbox"> åšå®¢çš„å®šä½ä»çº¯æŠ€æœ¯åšå®¢ï¼Œå˜æ›´ä¸ºä¸€ä¸ªæŠ€æœ¯+ç”Ÿæ´»ç±»å‹æ¨¡å—ï¼Œå¢åŠ ä¸€äº›éæŠ€æœ¯ç±»çš„å†…å®¹</li><li><input disabled="" type="checkbox"> æˆ‘çš„éƒ¨åˆ†æ”¹é€ å‡çº§ï¼Œæ‰“é€šæˆ‘çš„æ‰€æœ‰çš„å†…å®¹ç”Ÿæ€ä½“ç³»ï¼Œæå‡æˆ‘çš„ä¸ªäººå“ç‰Œ</li><li><input disabled="" type="checkbox"> è®¡åˆ’å¼€å‘ä¸€å¥—ä¸ªäººçš„å°ç¨‹åºï¼Œå¹¶è®°å½•å°ç¨‹åºä¸Šçº¿çš„å…¨è¿‡ç¨‹</li><li><input disabled="" type="checkbox"> å¢åŠ ä¸€äº›æ”¶é›†çš„èµ„æºåˆ†äº«åŠŸèƒ½ï¼Œå¼€æºåˆ†äº«çš„ç²¾ç¥æ€»è¦æœ‰äººæ¥ç»§æ‰¿</li><li><input disabled="" type="checkbox"> æŠ€æœ¯æ–¹é¢ï¼Œé™¤äº†æ—¥å¸¸é—®é¢˜çš„æ€»ç»“å¤–ï¼Œç»§ç»­å‘ä¸Šæ¸¸ç†è®ºéƒ¨åˆ†æ¢ç´¢</li></ul><h1 id="è®¡åˆ’å®Œæˆ"><a href="#è®¡åˆ’å®Œæˆ" class="headerlink" title="è®¡åˆ’å®Œæˆ"></a>è®¡åˆ’å®Œæˆ</h1><ul><li>2025å¹´01æœˆ11æ—¥ å®Œæˆäº†åšå®¢ä»jekyll åˆ° hexo çš„æ”¹é€ ï¼ŒåŒæ—¶æ”¯æŒäº†æ›´æ–°æ—¶é—´çš„æ˜¾ç¤º</li></ul><h1 id="ç”Ÿå‘½ä¸æ¯ï¼ŒæŠ˜è…¾ä¸æ­¢"><a href="#ç”Ÿå‘½ä¸æ¯ï¼ŒæŠ˜è…¾ä¸æ­¢" class="headerlink" title="ç”Ÿå‘½ä¸æ¯ï¼ŒæŠ˜è…¾ä¸æ­¢"></a>ç”Ÿå‘½ä¸æ¯ï¼ŒæŠ˜è…¾ä¸æ­¢</h1><p>å‘ç°æˆ‘å°±æ˜¯ä¸€ä¸ªå–œæ¬¢æŠ˜è…¾çš„äºº</p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç«™</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å»ºç«™</tag>
      
      <tag>æ›´æ–°è®¡åˆ’</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è¥¿éƒ¨æ•°æ®æä¾›å…è´¹ç‰ˆParagonå®ç°ä¸macç”µè„‘çš„è¯»å†™</title>
    <link href="/2024/12/30/life-ntfs-for-mac-free/"/>
    <url>/2024/12/30/life-ntfs-for-mac-free/</url>
    
    <content type="html"><![CDATA[<h2 id="ç°è±¡"><a href="#ç°è±¡" class="headerlink" title="ç°è±¡"></a>ç°è±¡</h2><p>ä¿—å¥—çš„ç°è±¡ï¼šä¹°äº†ä¸€ä¸ªè¥¿éƒ¨æ•°æ®çš„ç§»åŠ¨ç¡¬ç›˜ï¼Œç„¶ååˆä¹°äº†ä¸€ä¸ªmacç”µè„‘ï¼Œå°†ç¡¬ç›˜æ’å…¥åˆ°ç”µè„‘åå‘ç°ç¡¬ç›˜é‡Œçš„æ•°æ®å¯ä»¥è¯»ï¼Œä½†æ˜¯æ— æ³•å°†ç”µè„‘é‡Œçš„æ–‡ä»¶å†™å…¥ã€‚</p><p>å…¶å®æœ¬è´¨ä¸Šçš„åŸå› å°±æ˜¯ wbçš„ç¡¬ç›˜æ˜¯ntfsæ ¼å¼çš„, macç”µè„‘ä¸æ”¯æŒntfsæ ¼å¼çš„è¯»å†™.</p><p>æœ¬äººç”µè„‘ï¼šmacbook pro m1ç‰ˆ   </p><p>ç³»ç»Ÿç‰ˆæœ¬ï¼šmacos 14</p><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>å¦‚æœä¸ºäº†ä¿æŒå’Œwindowsç³»ç»Ÿçš„å…¼å®¹æ€§ï¼Œwbçš„ç¡¬ç›˜å¿…é¡»ä½¿ç”¨ntfsæ ¼å¼ï¼Œé‚£ä¹ˆé€šè¿‡å®‰è£…ntfsè½¬æ¢è½¯ä»¶ä¹Ÿèƒ½å®ç°ã€‚macåº”ç”¨å•†åº—é‡Œæœ‰å¾ˆå¤šè¿™ç§è½¯ä»¶ï¼Œä½†æ˜¯è¦æ”¶è´¹ã€‚</p><p>åº”ç”¨å•†åº—ä¹‹å¤–å¸¸ç”¨çš„è½¯ä»¶å°±æ˜¯ <code>uxera</code>å’Œ<code>Paragon</code>ï¼Œä¹Ÿè¦æ”¶è´¹ã€‚</p><p>åæ¥æ‰¾äº†å¥½ä¹…ï¼Œåœ¨è¥¿éƒ¨æ•°æ®çš„å®˜æ–¹å¸–å­ä¸Šæ‰¾åˆ°ä¸€ä¸ªå…è´¹å®ç°çš„æ³•å­ï¼ŒåŸæ¥è¥¿éƒ¨æ•°æ®å®˜æ–¹ä¹Ÿæä¾›äº†ä¸€å¥—macç‰ˆè¯»å†™æ•°æ®çš„é©±åŠ¨ã€‚</p><p>ä»¥ä¸‹æ˜¯å®˜æ–¹å¸–å­çš„é“¾æ¥ï¼š<br><a href="https://support-eu.wd.com/app/answers/detailweb/a_id/34871/~/external-drive%3A-paragon-ntfs-driver-for-mac">Steps to Install Paragon NTFS Driver for macOS for WD and SanDisk Professional</a></p><h3 id="å¤§æ¦‚å®‰è£…æ­¥éª¤å¦‚ä¸‹ï¼š"><a href="#å¤§æ¦‚å®‰è£…æ­¥éª¤å¦‚ä¸‹ï¼š" class="headerlink" title="å¤§æ¦‚å®‰è£…æ­¥éª¤å¦‚ä¸‹ï¼š"></a>å¤§æ¦‚å®‰è£…æ­¥éª¤å¦‚ä¸‹ï¼š</h3><ol><li><p>ä¸‹è½½é©±åŠ¨<br><a href="https://downloads.wdc.com/wdapp/Paragon_NTFS_Driver_for_Mac.zip">Paragon_NTFS_Driver_for_Mac</a><br>è§£å‹ååŒå‡»è½¯ä»¶å¼€å§‹å®‰è£…ã€‚</p></li><li><p>é€‰æ‹©:å®‰è£…ntfs for mac<br><img src="/images/others/ntfs_for_mac_1.png" alt="s1"><br>ç„¶åæ¥ç€æŒ‰ç…§æ­¥éª¤ä¸€ç›´ä¸‹ä¸€æ­¥å°±å¯ä»¥äº†<br><img src="/images/others/ntfs_for_mac_2.png" alt="s2"><br><img src="/images/others/ntfs_for_mac_3.png" alt="s3"><br><img src="/images/others/ntfs_for_mac_4.png" alt="s4"><br><img src="/images/others/ntfs_for_mac_5.png" alt="s5"><br><img src="/images/others/ntfs_for_mac_6.png" alt="s6"></p></li><li><p>åœ¨æœ€åä¸€æ­¥ï¼Œä¼šè¦æ±‚åœ¨ç³»ç»Ÿé…ç½®é‡Œä»£å¼€å¯ä¿¡ä»»æƒé™ï¼Œå…³æœºé‡å¯ã€‚<br>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œä¸ä»…ä»…æ˜¯è¦æ±‚åœ¨macçš„ç³»ç»Ÿå®‰å…¨è®¾ç½®é‡Œæ‰“å¼€ç¬¬ä¸‰æ–¹è½¯ä»¶ä¿¡ä»»é¡¹ï¼Œè¿˜è¦åœ¨ç³»ç»Ÿçš„å®‰å…¨æ¨¡å‹é‡Œå¼€å¯å¯¹ç¬¬ä¸‰æ–¹è½¯ä»¶çš„ä¿¡ä»»é¡¹ã€‚</p></li></ol><p>å¦‚æœä»¥å‰æ²¡æœ‰ä¿®æ”¹è¿‡å®‰å…¨æ¨¡å‹ä¸‹çš„é…ç½®ï¼Œå¤§æ¦‚ç‡ä¼šæç¤ºéœ€è¦åœ¨â€œæ¢å¤â€ç¯å¢ƒä¸­ä¿®æ”¹å®‰å…¨æ€§è®¾ç½®ã€‚</p><p>è¿™ä¸ªéœ€è¦åœ¨ç”µè„‘å…³æœºåï¼Œé•¿æŒ‰è§¦æ§IDæˆ–ç”µæºæŒ‰é’®å°±èƒ½è¿›å…¥å®‰å…¨é…ç½®ç¯å¢ƒï¼Œé€‰æ‹©è®¾ç½®é…ç½®ï¼Œç„¶ååœ¨ä¸Šé¢çš„èœå•é€‰æ‹©é‡Œæ‰¾åˆ°å®‰å…¨é…ç½®ç›¸å…³èœå•ï¼Œå‹¾é€‰ä¿¡ä»»ç¬¬ä¸‰æ–¹è½¯ä»¶ä¿®æ”¹ç³»ç»Ÿå†…æ ¸å°±å¯ä»¥äº†ï¼ˆå› ä¸ºæ˜¯å®‰å…¨æ¨¡å¼ï¼Œæ²¡æœ‰æˆªå›¾ï¼ŒæŒ‰ç…§è¿™ä¸ªæ­¥éª¤æ‰¾å°±å¯ä»¥äº†ï¼‰ã€‚</p><p>å¦‚æœå¯¹ç”µè„‘å®‰å…¨æœ‰æ´ç™–çš„ç”¨æˆ·ï¼Œè¿™ä¸€æ­¥æ“ä½œè¦æ…é‡ï¼Œä¹Ÿå¯ä»¥è½¬æŠ•ä»˜è´¹é˜µè¥ã€‚</p><h2 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h2><p>å› ä¸ºç½‘ç»œçš„åŸå› ï¼Œä¸Šé¢çš„é©±åŠ¨å¯èƒ½æ˜¯ä¸‹è½½å¤±è´¥ï¼Œè¿™é‡Œæä¾›ä¸€ä¸ªå¤‡ç”¨åœ°å€ï¼š<br><a href="https://url41.ctfile.com/f/62647441-1442742761-6dcabd?p=45td">Paragon_NTFS_Driver_for_Mac.zip 17.0.246</a>  (è®¿é—®å¯†ç : 45td)</p><p><a href="https://support-en.wd.com/app/answers/detailweb/a_id/29957">é©±åŠ¨ç‰ˆæœ¬åˆ—è¡¨</a></p>]]></content>
    
    
    <categories>
      
      <category>ç”Ÿæ´»</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç”Ÿæ´»</tag>
      
      <tag>é—®é¢˜è§£å†³</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>linuxå®‰è£…ClamAVæ€æ¯’è½¯ä»¶ç„¶åæ‰«æ¯’</title>
    <link href="/2024/12/25/safe-clamav-and-scan/"/>
    <url>/2024/12/25/safe-clamav-and-scan/</url>
    
    <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>æœ€è¿‘åœ¨ä¸€ä¸ªé¡¹ç›®ä¸Šè¦æ±‚åœ¨linuxæœåŠ¡å™¨ä¸Šå®‰è£…æ€æ¯’è½¯ä»¶ï¼Œç„¶åå¼€å¯ç³»ç»Ÿæ‰«æï¼Œç„¶ååˆ é™¤ç—…æ¯’ã€‚</p><p>ç„¶åæ‰¾äº†æ‰¾äº†ä¸€äº›èµ„æ–™ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æœ‰<strong>ClamAV</strong> å’Œ <strong>Comodo</strong>, å› ä¸ºClamAVå¼€æºï¼Œä¸”ä½¿ç”¨æ¯”è¾ƒå¹¿æ³›ï¼Œæœ€ç»ˆé€‰æ‹©äº†ClamAVã€‚</p><p>æˆ‘ä»¬çš„æœåŠ¡å™¨æ˜¯centos7.9, ä¸‹é¢å°±æ˜¯åœ¨CentOSä¸Šå®‰è£…ClamAVçš„è¿‡ç¨‹ï¼Œæ¯”è¾ƒç®€å•ã€‚</p><h2 id="CentOS-ä¸Šå®‰è£…ClamAV"><a href="#CentOS-ä¸Šå®‰è£…ClamAV" class="headerlink" title="CentOS ä¸Šå®‰è£…ClamAV"></a>CentOS ä¸Šå®‰è£…ClamAV</h2><p>ä»¥ä¸‹æ˜¯åœ¨ CentOS ä¸Šå®‰è£… <strong>ClamAV</strong> æ­¥éª¤ï¼š</p><h3 id="æ­¥éª¤-1ï¼šå®‰è£…-EPEL-ä»“åº“"><a href="#æ­¥éª¤-1ï¼šå®‰è£…-EPEL-ä»“åº“" class="headerlink" title="æ­¥éª¤ 1ï¼šå®‰è£… EPEL ä»“åº“"></a><strong>æ­¥éª¤ 1ï¼šå®‰è£… EPEL ä»“åº“</strong></h3><p>ClamAV é€šå¸¸é€šè¿‡ <strong>EPEL</strong>ï¼ˆExtra Packages for Enterprise Linuxï¼‰ä»“åº“æä¾›ï¼Œå› æ­¤é¦–å…ˆéœ€è¦ç¡®ä¿ EPEL ä»“åº“å·²å®‰è£…ã€‚</p><p>å¦‚æœå¤±è´¥å¯ä»¥è€ƒè™‘ä½¿ç”¨é˜¿é‡Œäº‘çš„æº <a href="https://www.cnblogs.com/qingqingyuntian/articles/18414842">yum ä»“åº“æ›´æ¢é˜¿é‡Œäº‘</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> yum install epel-release -y<br></code></pre></td></tr></table></figure><h3 id="æ­¥éª¤-2ï¼šå®‰è£…-ClamAV"><a href="#æ­¥éª¤-2ï¼šå®‰è£…-ClamAV" class="headerlink" title="æ­¥éª¤ 2ï¼šå®‰è£… ClamAV"></a><strong>æ­¥éª¤ 2ï¼šå®‰è£… ClamAV</strong></h3><p>å®‰è£… EPEL ä»“åº“åï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å®‰è£… ClamAVï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> yum install clamav clamav-update clamd -y<br></code></pre></td></tr></table></figure><ul><li><code>clamav</code> åŒ…å«å‘½ä»¤è¡Œå·¥å…·ï¼ˆå¦‚ <code>clamscan</code>ï¼‰ã€‚</li><li><code>clamav-update</code> æ˜¯æ›´æ–°ç—…æ¯’åº“æ‰€éœ€çš„å·¥å…·ï¼ˆå³ <code>freshclam</code>ï¼‰ã€‚</li><li><code>clamd</code> æ˜¯clamçš„ç³»ç»ŸæœåŠ¡ã€‚</li></ul><p>éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">clamscan --version<br></code></pre></td></tr></table></figure><h3 id="æ­¥éª¤-3ï¼šæ›´æ–°ç—…æ¯’åº“"><a href="#æ­¥éª¤-3ï¼šæ›´æ–°ç—…æ¯’åº“" class="headerlink" title="æ­¥éª¤ 3ï¼šæ›´æ–°ç—…æ¯’åº“"></a><strong>æ­¥éª¤ 3ï¼šæ›´æ–°ç—…æ¯’åº“</strong></h3><p>å®‰è£…å®Œæˆåï¼Œé¦–å…ˆéœ€è¦æ›´æ–° ClamAV çš„ç—…æ¯’åº“ï¼Œä»¥ç¡®ä¿å®ƒèƒ½è¯†åˆ«æœ€æ–°çš„æ¶æ„è½¯ä»¶ã€‚è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> freshclam<br></code></pre></td></tr></table></figure><p><code>freshclam</code> ä¼šä» ClamAV çš„æœåŠ¡å™¨ä¸‹è½½å¹¶æ›´æ–°ç—…æ¯’åº“ï¼Œå¦‚æœè¶…æ—¶ï¼Œç­‰ä¸€ä¼šå†å¤šè¯•å‡ æ¬¡ï¼Œæˆ‘è¯•äº†3æ¬¡æˆåŠŸäº†ã€‚</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs subunit">ClamAV update process started at Wed Dec 25 16:33:20 2024<br>WARNING: Your ClamAV installation is OUTDATED!<br>WARNING: Local version: 0.103.11 Recommended version: 0.103.12<br>DON&#x27;T PANIC! Read https://docs.clamav.net/manual/Installing.html<br>daily database available for download (remote version: 27497)<br><span class="hljs-keyword">Time:</span>   14.0s, ETA:    0.0s [========================&gt;]   61.48MiB/61.48MiB<br><span class="hljs-keyword">Testing </span>database: &#x27;/var/lib/clamav/tmp.8095e9d84b/clamav<span class="hljs-string">-0</span>e8a55acea5c8848d6871677901e577d.tmp-daily.cvd&#x27; ...<br>Database test passed.<br>daily.cvd updated (version: 27497, sigs: 2071426, f-level: 90, builder: raynman)<br>main database available for download (remote version: 62)<br><span class="hljs-keyword">Time:</span>   50.6s, ETA:    0.0s [========================&gt;]  162.58MiB/162.58MiBBB<br><span class="hljs-keyword">Testing </span>database: &#x27;/var/lib/clamav/tmp.8095e9d84b/clamav-ac7f382ef620ff4ad4d10aaed27f9dce.tmp-main.cvd&#x27; ...<br>Database test passed.<br>main.cvd updated (version: 62, sigs: 6647427, f-level: 90, builder: sigmgr)<br>bytecode database available for download (remote version: 335)<br><span class="hljs-keyword">Time:</span>    1.5s, ETA:    0.0s [========================&gt;]  282.94KiB/282.94KiB<br><span class="hljs-keyword">Testing </span>database: &#x27;/var/lib/clamav/tmp.8095e9d84b/clamav-bbc727f2e5a1bc6a0e835c65fb9cf566.tmp-bytecode.cvd&#x27; ...<br>Database test passed.<br>bytecode.cvd updated (version: 335, sigs: 86, f-level: 90, builder: raynman)<br></code></pre></td></tr></table></figure><h3 id="æ­¥éª¤-4ï¼šå¯åŠ¨-ClamAV-å®ˆæŠ¤è¿›ç¨‹ï¼ˆå¯é€‰ï¼‰"><a href="#æ­¥éª¤-4ï¼šå¯åŠ¨-ClamAV-å®ˆæŠ¤è¿›ç¨‹ï¼ˆå¯é€‰ï¼‰" class="headerlink" title="æ­¥éª¤ 4ï¼šå¯åŠ¨ ClamAV å®ˆæŠ¤è¿›ç¨‹ï¼ˆå¯é€‰ï¼‰"></a><strong>æ­¥éª¤ 4ï¼šå¯åŠ¨ ClamAV å®ˆæŠ¤è¿›ç¨‹ï¼ˆå¯é€‰ï¼‰</strong></h3><p>å¦‚æœä½ å¸Œæœ›ä½¿ç”¨ ClamAV çš„å®ˆæŠ¤è¿›ç¨‹ï¼ˆ<code>clamd</code>ï¼‰ï¼Œä½ éœ€è¦å¯åŠ¨å®ƒã€‚å®ˆæŠ¤è¿›ç¨‹ä¼šæé«˜æ‰«ææ•ˆç‡ï¼Œç‰¹åˆ«æ˜¯å¯¹äºè¾ƒå¤§çš„æ–‡ä»¶ã€‚</p><ol><li>å¯ç”¨clamé»˜è®¤é…ç½®</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cp</span> /etc/clamd.d/scan.conf /etc/clamd.d/scan.conf.bak<br>sed -i -e <span class="hljs-string">&quot;s/^Example/#Example/&quot;</span> /etc/clamd.d/scan.conf<br>vim /etc/clamd.d/scan.conf<br></code></pre></td></tr></table></figure><p>æ”¾å¼€å¦‚ä¸‹çš„æ³¨é‡Š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># LocalSocket /run/clamd.scan/clamd.sock</span><br></code></pre></td></tr></table></figure><ol start="2"><li>é‡å‘½åclamæœåŠ¡çš„@æ–‡ä»¶</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mv</span> /usr/lib/systemd/system/clamd\@.service /usr/lib/systemd/system/clamd.service<br></code></pre></td></tr></table></figure><ol start="3"><li>ä¿®æ”¹æœåŠ¡é…ç½®</li></ol><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[Unit]</span><br><span class="hljs-attr">Description</span> = clamd scanner daemon<br><span class="hljs-attr">After</span> = syslog.target nss-lookup.target network.target<br><span class="hljs-section">[Service]</span><br><span class="hljs-attr">Type</span> = forking<br><span class="hljs-attr">ExecStart</span> = /usr/sbin/clamd -c /etc/clamd.d/scan.conf<br><span class="hljs-comment"># Reload the database</span><br><span class="hljs-attr">ExecReload</span>=/bin/kill -USR2 <span class="hljs-variable">$MAINPID</span><br><span class="hljs-attr">Restart</span> = <span class="hljs-literal">on</span>-failure<br><span class="hljs-attr">TimeoutStartSec</span>=<span class="hljs-number">420</span><br><span class="hljs-section">[Install]</span><br><span class="hljs-attr">WantedBy</span> = multi-user.target<br></code></pre></td></tr></table></figure><ol start="4"><li><p>å¯åŠ¨ <code>clamd</code> æœåŠ¡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl daemon-reload<br><span class="hljs-built_in">sudo</span> systemctl start clamd.service<br></code></pre></td></tr></table></figure></li><li><p>è®¾ç½® <code>clamd</code> åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl <span class="hljs-built_in">enable</span> clamd.service<br></code></pre></td></tr></table></figure></li></ol><h3 id="æ­¥éª¤-5ï¼šè¿è¡Œ-ClamAV-æ‰§è¡Œç—…æ¯’æ‰«æ"><a href="#æ­¥éª¤-5ï¼šè¿è¡Œ-ClamAV-æ‰§è¡Œç—…æ¯’æ‰«æ" class="headerlink" title="æ­¥éª¤ 5ï¼šè¿è¡Œ ClamAV æ‰§è¡Œç—…æ¯’æ‰«æ"></a><strong>æ­¥éª¤ 5ï¼šè¿è¡Œ ClamAV æ‰§è¡Œç—…æ¯’æ‰«æ</strong></h3><p>ä½ å¯ä»¥ä½¿ç”¨ <code>clamscan</code> æ‰§è¡Œç—…æ¯’æ‰«æã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ç”¨æ³•ï¼š</p><ul><li><p><strong>æ‰«æå•ä¸ªæ–‡ä»¶</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">clamscan /path/to/file<br></code></pre></td></tr></table></figure></li><li><p><strong>æ‰«ææ•´ä¸ªç›®å½•</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">clamscan -r /path/to/directory<br></code></pre></td></tr></table></figure></li><li><p><strong>æ‰«æå¹¶åˆ é™¤æ„ŸæŸ“æ–‡ä»¶</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">clamscan -r --remove /path/to/directory<br></code></pre></td></tr></table></figure></li><li><p><strong>æ‰«æå¹¶æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">clamscan -r -v /path/to/directory<br></code></pre></td></tr></table></figure></li><li><p><strong>å°†ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">clamscan -r /path/to/directory --<span class="hljs-built_in">log</span>=clamav_scan_results.txt<br><span class="hljs-comment"># or</span><br>clamscan -r /path/to/directory &gt; clamav_scan_results.txt<br><span class="hljs-comment"># åå°è¿è¡Œ</span><br><span class="hljs-built_in">nohup</span> clamscan -r /path/to/directory --<span class="hljs-built_in">log</span>=clamav_scan_results.txt &amp;<br></code></pre></td></tr></table></figure><p>ç»“æœï¼š</p></li></ul><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs text">----------- SCAN SUMMARY -----------<br>Known viruses: 8702931<br>Engine version: 0.103.11<br>Scanned directories: 44573<br>Scanned files: 66053<br>Infected files: 0<br>Total errors: 21600<br>Data scanned: 4565.67 MB<br>Data read: 27114.51 MB (ratio 0.17:1)<br>Time: 1178.142 sec (19 m 38 s)<br>Start Date: 2024:12:25 17:12:38<br>End Date:   2024:12:25 17:32:17<br></code></pre></td></tr></table></figure><h3 id="æ­¥éª¤-6ï¼šé…ç½®-ClamAV-å¯é€‰"><a href="#æ­¥éª¤-6ï¼šé…ç½®-ClamAV-å¯é€‰" class="headerlink" title="æ­¥éª¤ 6ï¼šé…ç½® ClamAV (å¯é€‰)"></a><strong>æ­¥éª¤ 6ï¼šé…ç½® ClamAV (å¯é€‰)</strong></h3><p>å¦‚æœéœ€è¦ï¼Œä½ å¯ä»¥é…ç½® ClamAV æ¥è°ƒæ•´å…¶è¡Œä¸ºã€‚ClamAV çš„é…ç½®æ–‡ä»¶ä½äºï¼š</p><ul><li><strong><code>clamd</code> é…ç½®æ–‡ä»¶</strong>ï¼š<code>/etc/clamd.d/scan.conf</code></li><li><strong><code>freshclam</code> é…ç½®æ–‡ä»¶</strong>ï¼š<code>/etc/freshclam.conf</code></li></ul><p>ä½ å¯ä»¥ç¼–è¾‘è¿™äº›é…ç½®æ–‡ä»¶ï¼Œè°ƒæ•´æ—¥å¿—æ–‡ä»¶è·¯å¾„ã€æ‰«æé€‰é¡¹ç­‰ã€‚ä¾‹å¦‚ï¼Œç¼–è¾‘ <code>clamd</code> é…ç½®æ–‡ä»¶æ¥å¯ç”¨è¯¦ç»†æ—¥å¿—ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> vi /etc/clamd.d/scan.conf<br></code></pre></td></tr></table></figure><p>ä¿®æ”¹ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">LogFile /var/log/clamd.log<br>LogTime <span class="hljs-built_in">yes</span><br></code></pre></td></tr></table></figure><h3 id="æ­¥éª¤-7ï¼šå®šæœŸæ›´æ–°ç—…æ¯’åº“"><a href="#æ­¥éª¤-7ï¼šå®šæœŸæ›´æ–°ç—…æ¯’åº“" class="headerlink" title="æ­¥éª¤ 7ï¼šå®šæœŸæ›´æ–°ç—…æ¯’åº“"></a><strong>æ­¥éª¤ 7ï¼šå®šæœŸæ›´æ–°ç—…æ¯’åº“</strong></h3><p>ä¸ºäº†ç¡®ä¿ ClamAV èƒ½åŠæ—¶è¯†åˆ«æœ€æ–°çš„å¨èƒï¼Œä½ éœ€è¦å®šæœŸæ›´æ–°ç—…æ¯’åº“ã€‚ä½ å¯ä»¥é€šè¿‡è®¾ç½® <strong>cron ä»»åŠ¡</strong> æ¥è‡ªåŠ¨æ›´æ–°ç—…æ¯’åº“ã€‚</p><ol><li><p>ç¼–è¾‘ <code>crontab</code> æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> crontab -e<br></code></pre></td></tr></table></figure></li><li><p>æ·»åŠ ä»¥ä¸‹è¡Œæ¥æ¯å¤©æ›´æ–°ç—…æ¯’åº“ï¼ˆæ­¤ä¾‹ä¸ºæ¯å¤©å‡Œæ™¨ 2 ç‚¹ï¼‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">0 2 * * * /usr/bin/freshclam --quiet<br></code></pre></td></tr></table></figure></li></ol><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h2><ol><li>å®‰è£… EPEL ä»“åº“å¹¶é€šè¿‡ <code>yum</code> å®‰è£… ClamAVã€‚</li><li>ä½¿ç”¨ <code>freshclam</code> æ›´æ–°ç—…æ¯’åº“ã€‚</li><li>å¯åŠ¨å¹¶é…ç½® <code>clamd</code> å®ˆæŠ¤è¿›ç¨‹ï¼ˆå¯é€‰ï¼‰ã€‚</li><li>ä½¿ç”¨ <code>clamscan</code> æ‰§è¡Œç—…æ¯’æ‰«æã€‚</li><li>é…ç½®å®šæ—¶ä»»åŠ¡è‡ªåŠ¨æ›´æ–°ç—…æ¯’åº“ã€‚</li></ol><p>é€šè¿‡è¿™äº›æ­¥éª¤ï¼Œä½ å¯ä»¥åœ¨ CentOS ä¸ŠæˆåŠŸå®‰è£…å’Œé…ç½® ClamAVï¼Œå¸®åŠ©ä½ æ‰«æå’Œæ¸…ç†ç³»ç»Ÿä¸­çš„ç—…æ¯’å’Œæ¶æ„è½¯ä»¶ã€‚</p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="https://docs.clamav.net/manual/Usage/Scanning.html">clamav å®˜æ–¹æ–‡æ¡£</a></p><p><a href="https://www.cnblogs.com/qingqingyuntian/articles/18414842">yum ä»“åº“æ›´æ¢é˜¿é‡Œäº‘</a></p><p><a href="https://gist.github.com/fernandoaleman/50b134b987297f97c803c91b591e5c52">centos7 é…ç½®ClamAV</a></p>]]></content>
    
    
    <categories>
      
      <category>å®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>å®‰å…¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mysqlå‡ºç°äº†waiting for global read lock å…¨å±€äº‹åŠ¡ç­‰å¾…é—®é¢˜æ’æŸ¥</title>
    <link href="/2024/08/01/db-mysql-waiting-for-global-read-lock/"/>
    <url>/2024/08/01/db-mysql-waiting-for-global-read-lock/</url>
    
    <content type="html"><![CDATA[<h2 id="é—®é¢˜å‘ç°"><a href="#é—®é¢˜å‘ç°" class="headerlink" title="é—®é¢˜å‘ç°"></a>é—®é¢˜å‘ç°</h2><p>åœ¨ä¸€ä¸ªæ™®é€šçš„æ—¥å­é‡Œï¼Œå¯’æ¾ˆåœ¨æ“ä½œä»–è´Ÿè´£çš„ä¸€ä¸ªå†…éƒ¨ç³»ç»Ÿçš„æ—¶å€™ï¼Œçªç„¶å‘ç°ä¸€ä¸ªä¿®æ”¹çŠ¶æ€çš„æ“ä½œä¸èƒ½æ“ä½œäº†ã€‚ æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—ï¼Œå‘ç°æ•°æ®åº“è¿æ¥è¶…æ—¶äº†ï¼š<br><img src="/images/tech/db/mysql-read-timeout.jpg" alt="mysqlè¿æ¥è¶…æ—¶"><br>ç¬¬ä¸€ååº”æ˜¯æ•°æ®åº“æŒ‚äº†ï¼Œå¯¼è‡´æ•°æ®åº“è¿ä¸ä¸Šäº†ã€‚</p><p>å¯æ˜¯ï¼Œç¥å¥‡çš„æ˜¯ï¼Œæ¥ä¸‹æ¥å‘ç°æ•°æ®åº“çš„æŸ¥è¯¢åŠŸèƒ½è¿˜èƒ½ç”¨ï¼Œä½†æ˜¯æ‰€æœ‰çš„çŠ¶æ€ä¿®æ”¹ç±»çš„å†™æ“ä½œéƒ½ä¸èƒ½ç”¨äº†ã€‚ è¿™ä¸‹çŸ¥é“é‡åˆ°éº»çƒ¦äº†ï¼Œè‚¯å®šæ˜¯mysqlæ•°æ®åº“çš„äº§ç”Ÿé”äº†ï¼ŒæŠŠæ‰€æœ‰çš„å†™æ“ä½œé˜»å¡äº†ã€‚</p><p>æŒ‰ç…§ç°åœ¨çš„è¿™ä¸ªæƒ…å†µï¼Œmysqlè¯»æ²¡æœ‰é—®é¢˜ï¼Œå†™è¢«é˜»å¡ï¼Œå‡ºé—®é¢˜çš„é”è‚¯å®šæ˜¯è¯»é”ï¼ˆå…±äº«é”ï¼‰ï¼Œè€Œä¸”è¿˜æ˜¯å…¨å±€æ€§è´¨çš„ï¼Œå› ä¸ºæ‰€æœ‰çš„å†™éƒ½è¢«å½±å“äº†ã€‚</p><h2 id="é—®é¢˜å®šä½"><a href="#é—®é¢˜å®šä½" class="headerlink" title="é—®é¢˜å®šä½"></a>é—®é¢˜å®šä½</h2><p>æŒ‰ç…§ä¸Šé¢çš„æ€è·¯å»æ•°æ®åº“é‡Œæ‰§è¡Œä¸€ä¸‹<code>SHOW ENGINE INNODB STATUS</code>, æŸ¥çœ‹ä¸€ä¸‹æ•°æ®åº“çš„çŠ¶æ€ã€‚ ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs log">*** WE ROLL BACK TRANSACTION (2)<br>------------<br>TRANSACTIONS<br>------------<br>Trx id counter 48415098<br>Purge done for trx&#x27;s n:o &lt; 48412278 undo n:o &lt; 0 state: running but idle<br>History list length 0<br>LIST OF TRANSACTIONS FOR EACH SESSION:<br>---TRANSACTION 421386947297640, not started<br>0 lock struct(s), heap size 1128, 0 row lock(s)<br>---TRANSACTION 421386947296832, not started<br>0 lock struct(s), heap size 1128, 0 row lock(s)<br>---TRANSACTION 421386947296024, not started<br>0 lock struct(s), heap size 1128, 0 row lock(s)<br>---TRANSACTION 421386947295216, not started<br>0 lock struct(s), heap size 1128, 0 row lock(s)<br>---TRANSACTION 421386947294408, not started<br>0 lock struct(s), heap size 1128, 0 row lock(s)<br>---TRANSACTION 421386947293600, not started<br>0 lock struct(s), heap size 1128, 0 row lock(s)<br>---TRANSACTION 421386947291984, not started<br>0 lock struct(s), heap size 1128, 0 row lock(s)<br>---TRANSACTION 421386947288752, not started<br>0 lock struct(s), heap size 1128, 0 row lock(s)<br>---TRANSACTION 421386947287944, not started<br>0 lock struct(s), heap size 1128, 0 row lock(s)<br>---TRANSACTION 421386947287136, not started<br>0 lock struct(s), heap size 1128, 0 row lock(s)<br>---TRANSACTION 421386947283904, not started<br>0 lock struct(s), heap size 1128, 0 row lock(s)<br>---TRANSACTION 421386947280672, not started<br>0 lock struct(s), heap size 1128, 0 row lock(s)<br></code></pre></td></tr></table></figure><p>å‘ç°äº†å¤§é‡çš„å¦‚ä¸Šçš„äº‹åŠ¡åœ¨ç§¯å‹ï¼Œæ²¡æœ‰æ‰§è¡Œã€‚ ä¸é¢„æœŸä¸€è‡´ï¼Œå°±æ˜¯æŸä¸ªé”å¯¼è‡´äº‹åŠ¡é˜»å¡äº†ã€‚</p><p>æ³¨æ„è¿™é‡Œä¸ä¼šæ˜¯æ­»é”é—®é¢˜ï¼Œå› ä¸ºæ­»é”æ˜¯é”å†²çªï¼Œmysqlä¼šè‡ªåŠ¨è§£å†³çš„ï¼Œä¸ä¼šå¯¼è‡´äº‹åŠ¡é•¿æ—¶é—´é˜»å¡ã€‚</p><p>æŸ¥è¯¢ä¸€ä¸‹mysqlçš„æ‰§è¡Œè¿›ç¨‹ï¼Œçœ‹çœ‹æƒ…å†µï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"># æŸ¥è¯¢ä¸€ä¸ªè€—æ—¶æœ€ä¹…çš„ è¿›ç¨‹<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> information_schema.PROCESSLIST <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-type">time</span> <span class="hljs-keyword">desc</span>;<br></code></pre></td></tr></table></figure><p>å‘ç°äº†å¦‚ä¸‹åœºæ™¯<br><img src="/images/tech/db/mysql_waiting_for_global_read_lock.jpg" alt="waiting for global read lock"></p><p>ç”±æ­¤æˆ‘ä»¬çŸ¥é“ï¼š</p><ol><li>ç¡®å®å‘ç”Ÿäº†ä¸€ä¸ªå…¨å±€æ€§çš„è¯»é”<code>waiting for global read lock</code>å¯¼è‡´äº†åç»­å†™æ“ä½œçš„è¿›è¡Œã€‚ åé¢çš„äº‹åŠ¡éƒ½åœ¨ç­‰å¾…è¿™ä¸ªè¯»é”çš„é‡Šæ”¾ã€‚</li><li>æƒ…å†µæ¯”æˆ‘ä»¬æƒ³è±¡çš„ä¸¥é‡ï¼Œè¿™ä¸ªè¯»é”ä¸ä»…å½±å“äº†æˆ‘ä»¬è‡ªå·±çš„å®ä¾‹ï¼Œè¿˜æŠŠæ•´ä¸ªmysqlä¸‹æ‰€æœ‰çš„åº“å®ä¾‹éƒ½å½±å“äº†ã€‚</li><li>é—®é¢˜çš„åŸå› ä¹Ÿå‘ç°äº†ï¼Œå°±æ˜¯æœ‰ä¸€ä¸ªbinlog dumpåæ²¡æœ‰ç»“æŸå¯¼è‡´çš„ã€‚ä¹Ÿå°±æ˜¯é‚£ä¸ªè€—æ—¶æœ€ä¹…çš„è¿›ç¨‹ã€‚</li></ol><h2 id="é—®é¢˜è§£å†³"><a href="#é—®é¢˜è§£å†³" class="headerlink" title="é—®é¢˜è§£å†³"></a>é—®é¢˜è§£å†³</h2><p>æ—¢ç„¶å‘ç°äº†è¿™ä¸ªé”äº§ç”Ÿçš„åŸå› ï¼Œç›´æ¥æŠŠè¿™ä¸ªè¿›ç¨‹killæ‰å°±å¯ä»¥äº†</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">kill <span class="hljs-number">3518815</span><br></code></pre></td></tr></table></figure><p>binlogçš„è¿›ç¨‹æ€æ‰åï¼Œåé¢é˜»å¡çš„ä»»åŠ¡æœç„¶éƒ½æ²¡äº†ã€‚</p><p>è®°å½•ä¸€ä¸‹æ’æŸ¥é—®é¢˜è¿‡ç¨‹ä¸­å¸¸ç”¨çš„sql</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sql"># æŸ¥è¯¢å½“å‰å…ƒæ•°æ®é”åŠå…³è”çš„çº¿ç¨‹å’Œäº‹åŠ¡<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> performance_schema.metadata_locks l<br><span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> performance_schema.threads t <span class="hljs-keyword">on</span> t.THREAD_ID <span class="hljs-operator">=</span> l.OWNER_THREAD_ID <br><span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> performance_schema.events_transactions_current  et <span class="hljs-keyword">on</span> et.THREAD_ID  <span class="hljs-operator">=</span> t.THREAD_ID <br><span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> information_schema.INNODB_TRX  trx <span class="hljs-keyword">on</span> t.PROCESSLIST_ID <span class="hljs-operator">=</span> trx.trx_mysql_thread_id  <br><br># å½“å‰ç³»ç»Ÿå†…çš„äº‹åŠ¡<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> information_schema.innodb_trx;<br><br># æŸ¥è¯¢ä¸€ä¸ªè€—æ—¶æœ€ä¹…çš„ è¿›ç¨‹<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> information_schema.PROCESSLIST <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-type">time</span> <span class="hljs-keyword">desc</span>;<br><br># æŸ¥è¯¢innodb çŠ¶æ€<br><span class="hljs-keyword">SHOW</span> ENGINE INNODB STATUS<br></code></pre></td></tr></table></figure><h2 id="é—®é¢˜é¿å…"><a href="#é—®é¢˜é¿å…" class="headerlink" title="é—®é¢˜é¿å…"></a>é—®é¢˜é¿å…</h2><p>å‘ç°é—®é¢˜ï¼Œè§£å†³é—®é¢˜ï¼Œé¿å…é—®é¢˜æ‰æ˜¯æˆ‘ä»¬æ’æŸ¥é—®é¢˜æœ€ç»ˆè¦çš„ç›®çš„ã€‚</p><p>æˆ‘ä»¬è¿™ä¸ªé—®é¢˜æ˜¯flink cdc æ•°æ®çš„æ—¶å€™å¯¼è‡´çš„ï¼Œåç»­çš„è§£å†³åŠæ³•å¾ˆç®€å•ï¼š<br>ç¬¬ä¸€ï¼š ä»¥åflink ä¸è¦cdcä¸»åº“äº†ï¼Œé¿å…å¯¹ä¸šåŠ¡äº§ç”Ÿå½±å“ã€‚<br>ç¬¬äºŒï¼šflink cdc ä¸€å®šè¦åšå¥½å¼‚å¸¸æ‹¦æˆªå¤„ç†ï¼Œæˆ‘ä»¬è¿™å°±æ˜¯å› ä¸ºå¼‚å¸¸å¯¼è‡´finké€€å‡ºäº†ï¼Œæ— æ³•é‡Šæ”¾é”<br>ç¬¬ä¸‰ï¼šå¦‚æœå¯ä»¥çš„è¯ï¼Œå°½é‡ä½¿ç”¨flinkçš„æ— é”cdcç‰ˆæœ¬</p><h3 id="å…³äºè¿™ä¸ªglobal-read-lockæ˜¯æ€ä¹ˆäº§ç”Ÿçš„"><a href="#å…³äºè¿™ä¸ªglobal-read-lockæ˜¯æ€ä¹ˆäº§ç”Ÿçš„" class="headerlink" title="å…³äºè¿™ä¸ªglobal read lockæ˜¯æ€ä¹ˆäº§ç”Ÿçš„"></a>å…³äºè¿™ä¸ª<code>global read lock</code>æ˜¯æ€ä¹ˆäº§ç”Ÿçš„</h3><p>å½“mysqlåœ¨dumpæ•´ä¸ªæ•°æ®åº“çš„æ—¶å€™ï¼Œä¼šå¯¹æ•°æ®åº“æ‰§è¡Œä¸€ä¸ª<code>FLUSH TABLES WITH READ LOCK</code>å‘½ä»¤æ¥åŠ é”ï¼Œè¿™ä¸ªå‘½ä»¤ä¼šåœæ­¢å¯¹æ‰€æœ‰è¡¨çš„å†™æ“ä½œï¼Œâ€Œå¹¶å…è®¸è¯»æ“ä½œç»§ç»­ã€‚<br>ç­‰å¤‡ä»½å®Œæˆï¼Œä¼šä½¿ç”¨<code>UNLOCK TABLES</code>æ¥è§£é”ï¼Œ</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://dev.mysql.com/doc/refman/8.4/en/flush.html">mysql åŠ  global read lock æœºåˆ¶</a></p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mysql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¦‚æœè®©ç™¾åº¦çˆ¬è™«çˆ¬æˆ‘çš„githubåšå®¢</title>
    <link href="/2024/05/22/site-how-baidu-spide-github-site/"/>
    <url>/2024/05/22/site-how-baidu-spide-github-site/</url>
    
    <content type="html"><![CDATA[<p>æˆ‘ä»¬è¾›è¾›è‹¦è‹¦çš„é€šè¿‡github pageså»ºå¥½æˆ‘ä»¬çš„åšå®¢ä¹‹åã€‚æ¥ä¸‹æ¥å¯èƒ½ä¼šæƒ³è¦æ›´å¤šçš„äººæ¥è®¿é—®æˆ‘ä»¬çš„åšå®¢ï¼Œ<br>ç„¶åä¸€é¡¿æ“ä½œåå‘ç°ï¼Œgithub æŠŠç™¾åº¦çš„çˆ¬è™«å±è”½äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ç½‘ç«™ä¹Ÿå°±ä¸èƒ½è¢«ç™¾åº¦æœç´¢äº†ï¼Œæˆ‘ä»¬çš„åšå®¢ä¹Ÿå°±æ²¡æ³•è¢«ç™¾åº¦æœç´¢åˆ°äº†ã€‚</p><p>è¿™æ€ä¹ˆè¡Œå‘¢ï¼Ÿ æˆ‘ä»¬çš„åšå®¢ä¸»è¦ç¾¤ä½“è¿˜æ˜¯å›½å†…çš„ç¨‹åºå‘˜çš„ï¼Œå°‘äº†ç™¾åº¦è¿™ä¸ªæ¥æºï¼Œè®¿é—®é‡ä¸€ä¸‹å­å°‘äº†ä¸€å¤§åŠã€‚</p><p>ä½œä¸ºä¸€åç¨‹åºå‘˜ï¼Œæˆ‘ä»¬æ€ä¹ˆèƒ½è¢«è¿™ä¸ªäº‹æƒ…éš¾å€’å‘¢ï¼Ÿ</p><p>è®©æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ï¼Œgithub æŠŠç™¾åº¦çš„çˆ¬è™«å±è”½äº†ï¼Œè¿™å¯¼è‡´äº†æˆ‘ä»¬çš„åšå®¢ä¸èƒ½è¢«ç™¾åº¦æ”¶å½•ã€‚æ—¢ç„¶ç™¾åº¦ä¸èƒ½çˆ¬githubäº†ï¼Œæˆ‘ä»¬å¯ä»¥è®©ç™¾åº¦å»åˆ«çš„åœ°æ–¹çˆ¬æˆ‘ä»¬çš„åšå®¢å‘€ã€‚</p><p>æ€è·¯ä¸€å¼€å¤©åœ°å®½ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡CDNçš„æœºåˆ¶æ¥æŠŠæˆ‘ä»¬çš„åšå®¢æ¬åˆ°CDNä¸Šï¼Œç„¶åè®©ç™¾åº¦è®¿é—®CDNå°±å¯ä»¥äº†å‘€ã€‚</p><p>å¯æƒœï¼Œè¯•è¿‡ä¸ƒç‰›äº‘ç­‰ä¸€äº›å›½å†…çš„CDNï¼Œå‘ç°åŒæ­¥ç½‘ç«™è¿˜è¦å¤‡æ¡ˆï¼Œè¿™ä¸ªæˆ‘è¦æ˜¯æœ‰ï¼Œä¹Ÿå°±ä¸ç”¨è¿™ä¹ˆéº»çƒ¦çš„æƒ³åŠæ³•åŒæ­¥å†…å®¹åˆ°ç™¾åº¦äº†ï¼Œè¿™ä¸€æ­¥æ˜¯èµ°ä¸é€šäº†ã€‚</p><p>æœ€åï¼Œæˆ‘å‘ç°äº†<a href="https://vercel.com/">vercel</a>è¿™ä¸ªç½‘ç«™ï¼Œå¯ä»¥é•œåƒæˆ‘ä»¬çš„github åšå®¢ï¼Œè€Œåˆæ²¡æœ‰å±è”½ç™¾åº¦çš„çˆ¬è™«ï¼Œå®Œç¾çš„è§£å†³äº†æˆ‘çš„é—®é¢˜ã€‚</p><h1 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h1><ul><li>githubåšå®¢ç«™å»ºå¥½</li><li>ä¸€ä¸ªåŸŸåï¼Œæˆ‘ä»¬éœ€è¦åŸŸåæ¥åšåšå®¢çš„è·³è½¬ã€‚</li></ul><h1 id="æ“ä½œ"><a href="#æ“ä½œ" class="headerlink" title="æ“ä½œ"></a>æ“ä½œ</h1><h2 id="å…³è”vercel"><a href="#å…³è”vercel" class="headerlink" title="å…³è”vercel"></a>å…³è”vercel</h2><ol><li>æ³¨å†Œç™»å½•<a href="https://vercel.com/">vercel</a></li><li>æ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼ˆadd new projectï¼‰, å…³è”åˆ°è‡ªå·±githubä¸Šçš„ åšå®¢ä»“åº“<br><img src="/images/site/vercel-import-github-project.jpg" alt="vercelå…³è”github"></li><li>æ·»åŠ æŒ‡å‘vercelé¡¹ç›®çš„äºŒçº§åŸŸåï¼Œæ¯”å¦‚æˆ‘çš„<code>blog.hancher.top</code><br><img src="/images/site/vercel-domain.jpg" alt="vercelé…ç½®åŸŸå"></li><li>æ­¤æ—¶ï¼Œæˆ‘ä»¬åœ¨Vercelé‡Œçš„é¡¹ç›®å·²ç»æ„å»ºå¥½äº†ï¼Œä¸‹æ¬¡ GitHub é¡¹ç›®çš„ä»»ä½•æ›´æ–°éƒ½ä¼šè§¦å‘ Vercel é¡¹ç›®æ›´æ–°<br><img src="/images/site/vercel-project-view.jpg" alt="vercelæ•ˆæœ"></li></ol><h2 id="é…ç½®åŸŸåè§£æ"><a href="#é…ç½®åŸŸåè§£æ" class="headerlink" title="é…ç½®åŸŸåè§£æ"></a>é…ç½®åŸŸåè§£æ</h2><p>å»åŸŸåçš„è§£æåå°ï¼Œæ·»åŠ åŸŸåçš„CNAMEè§£æï¼Œè®°å½•å€¼<code>cname-china.vercel-dns.com</code> æ­¤æ—¶ï¼Œé€šè¿‡<code>blog.hancher.top</code>å°±å¯ä»¥è®¿é—®vercel CDNä¸Šçš„é™æ€ç½‘ç«™äº†ã€‚</p><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥å°†è®°å½•å€¼æ”¹ä¸ºVercelçš„è‡ªå·±é¡¹ç›®çš„vercel.app åŸŸåã€‚å°†çº¿è·¯è§£æç±»å‹æ”¹ä¸º<code>ç™¾åº¦</code> äº¦å¯ã€‚</p><h2 id="å…³è”ç™¾åº¦è§£æ"><a href="#å…³è”ç™¾åº¦è§£æ" class="headerlink" title="å…³è”ç™¾åº¦è§£æ"></a>å…³è”ç™¾åº¦è§£æ</h2><ol><li>å»<a href="https://ziyuan.baidu.com/">ç™¾åº¦ç«™ç‚¹ç®¡ç†</a> é‡Œæ³¨å†Œè´¦å·ï¼Œåˆ›å»º<code>blog.hancher.top</code>åŸŸåçš„ç½‘ç«™ï¼Œå³å¯ä»¥æŠ“å–æˆ‘ä»¬çš„åšå®¢ç«™ç‚¹äº†ã€‚</li><li>å°†ç™¾åº¦ç»™çš„ä¸€ä¸ªç­¾åæ”¾åˆ°ç½‘ç«™çš„æ ¹ç›®å½•ä¸‹<br><img src="/images/site/baidu-ziyuan-config.jpg" alt="ç™¾åº¦ç«™ç‚¹"></li><li>é€šè¿‡<strong>æŠ“å–è¯Šæ–­</strong> æ¥éªŒè¯æˆ‘ä»¬çš„åšå®¢æ˜¯å¦å¯ä»¥æ­£å¸¸æŠ“å–<br><img src="/images/site/baidu-ziyuan-fetch-test.jpg" alt="æŠ“å–è¯Šæ–­"></li><li>è€å¿ƒç­‰å¾…å‡ å¤©ï¼Œåœ¨ç™¾åº¦æœç´¢æ¡†é‡Œæœç´¢ <code>site:blog.hancher.top</code>æ¥éªŒè¯æˆ‘ä»¬çš„é…ç½®æ˜¯å¦ç”Ÿæ•ˆï¼Œæ­¤æ—¶å¤§æ¦‚ç‡å°±èƒ½æœåˆ°è‡ªå·±çš„åšå®¢æ–‡ç« äº†ã€‚<br><img src="/images/site/baidu-site-search.jpg" alt="éªŒè¯åšå®¢"></li></ol><h2 id="2024å¹´æ›´æ–°"><a href="#2024å¹´æ›´æ–°" class="headerlink" title="2024å¹´æ›´æ–°"></a>2024å¹´æ›´æ–°</h2><p>å› ä¸ºVercelè¢«å¢™ï¼ˆdnsæ±¡æŸ“æ–¹å¼ï¼‰, è¯¥æ–¹æ³•æš‚æ—¶å¤±æ•ˆã€‚ç­‰å¾…åç»­è§£å†³ã€‚</p><h2 id="ä½¿ç”¨ä¸»åŠ¨æäº¤çš„æ–¹æ³•æ¥æäº¤ç½‘ç«™url"><a href="#ä½¿ç”¨ä¸»åŠ¨æäº¤çš„æ–¹æ³•æ¥æäº¤ç½‘ç«™url" class="headerlink" title="ä½¿ç”¨ä¸»åŠ¨æäº¤çš„æ–¹æ³•æ¥æäº¤ç½‘ç«™url"></a>ä½¿ç”¨ä¸»åŠ¨æäº¤çš„æ–¹æ³•æ¥æäº¤ç½‘ç«™url</h2><p>è¯·è·³è½¬ <a href="/2025/02/18/site-hexo-site-url-auto-submit/">ä¸»åŠ¨æ¨é€æˆ‘ä»¬çš„åšå®¢åˆ°æœç´¢å¼•æ“</a></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.zhihu.com/question/30898326">çŸ¥ä¹-å¦‚ä½•è§£å†³ç™¾åº¦çˆ¬è™«æ— æ³•çˆ¬å–æ­å»ºåœ¨Githubä¸Šçš„ä¸ªäººåšå®¢çš„é—®é¢˜</a><br><a href="https://blog.csdn.net/weixin_40026797/article/details/126919662">å»ºç«™è¿‡ç¨‹ä¸­çš„è¸©å‘è®°å½•ï¼šè‡ªå®šä¹‰åŸŸåã€ç™¾åº¦æ”¶å½•ä¸å¤‡æ¡ˆ</a><br><a href="https://h.cjh0613.com/zh/posts/hexo-submit-urls-to-search-engine/">hexo-submit-urls-to-search-engineæ“ä½œæ–‡æ¡£</a></p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç«™</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å»ºç«™</tag>
      
      <tag>seo</tag>
      
      <tag>vercel</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¾½æ¯›çƒå­¦ä¹ èµ„æº</title>
    <link href="/2024/01/12/favorite-badminton/"/>
    <url>/2024/01/12/favorite-badminton/</url>
    
    <content type="html"><![CDATA[<h2 id="è§†é¢‘"><a href="#è§†é¢‘" class="headerlink" title="è§†é¢‘"></a>è§†é¢‘</h2><p>æåœ¨ç¦ç³»åˆ—ï¼š</p><ol><li><a href="https://www.bilibili.com/video/BV1Yx411W7nJ">è¿½çƒï¼ˆåŸºç¡€ç³»åˆ—ï¼‰</a></li><li><a href="https://www.bilibili.com/video/BV1Yx411W7sS">åŒæ‰“</a></li><li><a href="https://www.bilibili.com/video/BV1Zx411W7AH">æ··åŒ</a></li><li><a href="https://www.bilibili.com/video/BV1Zx411W7FC">æ€çƒæŠ€å·§</a></li><li><a href="https://www.bilibili.com/video/BV1hx411V7we">ç½‘å‰æ‰‘çƒ</a></li><li><a href="https://www.bilibili.com/video/BV1hx411V7cZ">åæ‰‹ååœºé«˜çƒ</a></li><li><a href="https://www.bilibili.com/video/BV1hx411V7cK">æ­¥ä¼</a></li><li><a href="https://www.bilibili.com/video/BV1hx411V7cL">æ­¥ä¼è®­ç»ƒ</a></li><li><a href="https://www.bilibili.com/video/BV1hx411V7uY">è®ºçƒ</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>ç”Ÿæ´»</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>springdoc-openapiçš„é›†æˆä¸å¸¸è§é—®é¢˜</title>
    <link href="/2023/11/29/spring-springdoc-openapi/"/>
    <url>/2023/11/29/spring-springdoc-openapi/</url>
    
    <content type="html"><![CDATA[<p>åœ¨é¡¹ç›®ä¸­ç»å¸¸ä½¿ç”¨swaggeræ¥ä½œä¸ºé¡¹ç›®æ¥å£çš„è‡ªåŠ¨åŒ–apiæ–‡æ¡£ï¼Œå°¤å…¶æ˜¯springbooté¡¹ç›®ï¼Œä¸€èˆ¬éƒ½æ˜¯é€šè¿‡<code>springfox-boot-starter</code>æ¥é›†æˆswaggerçš„ä½¿ç”¨ã€‚<br><code>springfox-boot-starter</code> åœ¨2.xæ—¶ä»£ç”¨ç€å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯éšç€é¡¹ç›®çš„å‘å±•ï¼Œå°¤å…¶æ˜¯springé¡¹ç›®çš„ä¸æ–­æ¨å‡ºæ–°ç‰ˆæœ¬ï¼Œ<br><code>springfox-boot-starter</code>åœ¨3.0ç‰ˆæœ¬å°±å·²ç»æ˜æ˜¾å­˜åœ¨å…¼å®¹æ€§é—®é¢˜äº†ï¼Œè€Œä¸”å·²ç»3å¹´å¤šæ²¡ç»´æŠ¤äº†ï¼Œæ‰€ä»¥å¯»æ‰¾æ›¿ä»£å“æ˜¯ä¸€ç§è™½ç„¶ä¸ç´§è¿«ä½†å¾ˆå¿…é¡»çš„äº‹é¡¹äº†ã€‚<br>è€Œspringdoc-openapiå°±æ˜¯springfox-boot-starterçš„æ›¿ä»£å“ï¼Œä¸”è·å¾—äº†swaggerçš„å®˜æ–¹æ”¯æŒï¼Œç®—æ˜¯springfoxåœ¨springbooté«˜ç‰ˆæœ¬çš„å¤©çƒ­æ›¿ä»£å“ã€‚<br><img src="/images/tech/spring/springfox-stop-update.jpg" alt="springfoxå·²ç»3å¹´æœªæ›´æ–°äº†"></p><p>æœ¬æ–‡å°±ä»‹ç»springdoc-openapiçš„é›†æˆä¸å¸¸è§é—®é¢˜ã€‚</p><h2 id="é¡¹ç›®ä¾èµ–"><a href="#é¡¹ç›®ä¾èµ–" class="headerlink" title="é¡¹ç›®ä¾èµ–"></a>é¡¹ç›®ä¾èµ–</h2><p>å¦‚æœä½ çš„é¡¹ç›®æ˜¯springboot2.xç‰ˆæœ¬ï¼Œè¯·ä½¿ç”¨springdoc-openapiçš„1.xç‰ˆæœ¬ã€‚<br>å¦‚æœä½ çš„é¡¹ç›®æ˜¯springboot3.xç‰ˆæœ¬ï¼Œè¯·ä½¿ç”¨springdoc-openapiçš„2.xç‰ˆæœ¬ã€‚</p><p>æœ¬æ–‡æ¡ˆä¾‹çš„ç¯å¢ƒæ˜¯ï¼š</p><ul><li>java 17</li><li>springboot 2.7.18</li></ul><h2 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h2><p>ä½¿ç”¨ideaåˆ›å»ºä¸€ä¸ªæ–°çš„maven springbooté¡¹ç›®ï¼Œæ·»åŠ å¦‚ä¸‹ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springdoc<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>springdoc-openapi-ui<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.7.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>åˆ›å»ºä¸€ä¸ªController</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@RequestMapping(&quot;/hello&quot;)</span><br><span class="hljs-meta">@Tag(name=&quot;openapi demo&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloWorldController</span> &#123;<br><br>    <span class="hljs-meta">@GetMapping(&quot;/world&quot;)</span><br>    <span class="hljs-meta">@Operation(summary = &quot;helloWorldæ¥å£&quot;,description = &quot;æ¥å£æè¿°ä¿¡æ¯&quot;)</span><br>    <span class="hljs-meta">@Parameter(name = &quot;name&quot;, description = &quot;åç§°&quot;, required = true,  in = ParameterIn.QUERY)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">helloWorld</span><span class="hljs-params">(String name)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Hello &quot;</span>+ Optional.of(name).orElse(<span class="hljs-string">&quot;world&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * éšè—çš„apiï¼Œä¸å†swagger æ˜¾ç¤º</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@GetMapping(&quot;/hidden&quot;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">hiddenApi</span><span class="hljs-params">(String name)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Hello &quot;</span>+ Optional.of(name).orElse(<span class="hljs-string">&quot;world&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç„¶åå°±å¯ä»¥ç›´æ¥å¯åŠ¨äº†ï¼Œä¸ç”¨ä»»ä½•é…ç½®ï¼Œå°±å¯ä»¥çœ‹åˆ°swaggerçš„ç•Œé¢äº†ã€‚<br>swaggeré»˜è®¤åœ°å€ï¼š <a href="http://localhost:8080/swagger-ui/index.html#/">http://localhost:8080/swagger-ui/index.html#/</a><br><img src="/images/tech/spring/springdoc-swagger-default.jpg" alt="springdocç‰ˆçš„swaggerçš„é»˜è®¤é¡µé¢"></p><h3 id="é€šè¿‡é…ç½®æ–‡ä»¶ä¿®æ”¹ç›¸å…³é…ç½®"><a href="#é€šè¿‡é…ç½®æ–‡ä»¶ä¿®æ”¹ç›¸å…³é…ç½®" class="headerlink" title="é€šè¿‡é…ç½®æ–‡ä»¶ä¿®æ”¹ç›¸å…³é…ç½®"></a>é€šè¿‡é…ç½®æ–‡ä»¶ä¿®æ”¹ç›¸å…³é…ç½®</h3><p>å¦‚æœä½ ä¸æƒ³ä½¿ç”¨é»˜è®¤çš„é…ç½®ï¼Œå¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶ä¿®æ”¹ç›¸å…³é…ç½®ã€‚æ¯”å¦‚æˆ‘é€šè¿‡ä¸‹é¢é…ç½®å¯¹swaggerçš„ç•Œé¢è¿›è¡Œäº†å¾®è°ƒã€‚</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment"># application.properties</span><br><span class="hljs-attr">springdoc.swagger-ui.disable-swagger-default-url</span>=<span class="hljs-string">true</span><br><span class="hljs-comment"># å¸ƒå±€ StandaloneLayoutï¼ŒBaseLayout</span><br><span class="hljs-attr">springdoc.swagger-ui.layout</span>=<span class="hljs-string">BaseLayout</span><br><span class="hljs-attr">springdoc.swagger-ui.path</span>=<span class="hljs-string">/v3/swagger-ui.html</span><br><span class="hljs-comment"># swagger-ui é»˜è®¤å…³è”çš„apiæ¥å£é…ç½®, è¦ä¸api-docs.path ä¸€è‡´ã€‚ ä¸é…ç½®é»˜è®¤å–api-docs.pathé…ç½®</span><br><span class="hljs-attr">springdoc.swagger-ui.url</span>=<span class="hljs-string">/v3/test/api-docs</span><br><span class="hljs-comment"># api json æ¥å£é…ç½®, å¯ä»¥è‡ªå®šä¹‰å…¶ä»–jsonæ¥å£</span><br><span class="hljs-attr">springdoc.api-docs.path</span>=<span class="hljs-string">/v3/test/api-docs</span><br></code></pre></td></tr></table></figure><p>å› ä¸ºä¿®æ”¹äº†swaggeré¡µé¢çš„è®¿é—®åœ°å€ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„è®¿é—®åœ°å€å˜æˆäº†ï¼š<br><a href="http://localhost:8080/v3/swagger-ui/index.html#/">http://localhost:8080/v3/swagger-ui/index.html#/</a><br>æ•ˆæœå¦‚å›¾ï¼š<br><img src="/images/tech/spring/springdoc-swagger-properties.jpg" alt="springdocç‰ˆçš„swaggerçš„propertiesé…ç½®ç‰ˆ"></p><h2 id="é€šè¿‡è‡ªå®šä¹‰é…ç½®ç±»ä¿®æ”¹ç›¸å…³é…ç½®"><a href="#é€šè¿‡è‡ªå®šä¹‰é…ç½®ç±»ä¿®æ”¹ç›¸å…³é…ç½®" class="headerlink" title="é€šè¿‡è‡ªå®šä¹‰é…ç½®ç±»ä¿®æ”¹ç›¸å…³é…ç½®"></a>é€šè¿‡è‡ªå®šä¹‰é…ç½®ç±»ä¿®æ”¹ç›¸å…³é…ç½®</h2><p>å¦‚æœæˆ‘ä»¬æƒ³è¦æ›´è‡ªæœ‰çš„é…ç½®ï¼Œå¯ä»¥é€šè¿‡è‡ªå®šä¹‰é…ç½®ç±»æ¥ä¿®æ”¹ç›¸å…³é…ç½®ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SwaggerConfig</span> &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ·»åŠ æ‘˜è¦ä¿¡æ¯</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> OpenAPI <span class="hljs-title function_">openAPI</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenAPI</span>()<br>                .info(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>().title(<span class="hljs-string">&quot;hancher demo open api&quot;</span>)<br>                        .description(<span class="hljs-string">&quot;helloWorldæ¥å£æ–‡æ¡£&quot;</span>)<br>                        .version(<span class="hljs-string">&quot;v3.0.0&quot;</span>)<br>                        <span class="hljs-comment">// è”ç³»äºº</span><br>                        .contact(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Contact</span>().name(<span class="hljs-string">&quot;å¯’æ¾ˆ&quot;</span>).url(<span class="hljs-string">&quot;https://www.hancher.top/&quot;</span>))<br>                )<br>                <span class="hljs-comment">// å…¶ä»–æ–‡æ¡£ä¿¡æ¯</span><br>                .externalDocs(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ExternalDocumentation</span>()<br>                        .description(<span class="hljs-string">&quot;å¯’æ¾ˆç¬”è®°&quot;</span>)<br>                        .url(<span class="hljs-string">&quot;https://www.hancher.top/&quot;</span>));<br>    &#125;<br><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ¨¡å¼ä¸‰ï¼š è‡ªå®šä¹‰apiåˆ†ç»„</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     */</span><br><span class="hljs-comment">//    @Bean</span><br>    <span class="hljs-keyword">public</span> GroupedOpenApi <span class="hljs-title function_">publicApi</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> GroupedOpenApi.builder()<br>                .packagesToScan(<span class="hljs-string">&quot;com.hancher.demo.springbootopenapi.controller&quot;</span>) <span class="hljs-comment">// æ‰«æåŒ…</span><br>                .displayName(<span class="hljs-string">&quot;å¯’æ¾ˆopenapi&quot;</span>)<br>                .addOpenApiMethodFilter(method -&gt; method.isAnnotationPresent(Operation.class))<br>                .build();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿˜æ˜¯é»˜è®¤è®¿é—®åœ°å€ï¼š<a href="http://localhost:8080/swagger-ui/index.html#/">http://localhost:8080/swagger-ui/index.html#/</a><br><img src="/images/tech/spring/springdoc-swagger-openApi.jpg" alt="springdocç‰ˆçš„swaggerçš„openapié…ç½®ç‰ˆ"></p><h2 id="è¿ç§»æˆæœ¬"><a href="#è¿ç§»æˆæœ¬" class="headerlink" title="è¿ç§»æˆæœ¬"></a>è¿ç§»æˆæœ¬</h2><p>é™¤äº†å°†è€ç‰ˆæœ¬çš„æ³¨è§£æ›¿æ¢æˆæ–°çš„æ³¨è§£ä¹‹å¤–ï¼Œæ²¡æœ‰ä»»ä½•å…¶ä»–æ”¹çš„ã€‚<br><img src="/images/tech/spring/springdoc-from-springfox.jpg" alt="springfoxè¿ç§»åˆ°springdocçš„æ³¨è§£å˜åŠ¨"></p><h2 id="é›†æˆä¸­é‡åˆ°çš„é—®é¢˜"><a href="#é›†æˆä¸­é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é›†æˆä¸­é‡åˆ°çš„é—®é¢˜"></a>é›†æˆä¸­é‡åˆ°çš„é—®é¢˜</h2><p>æˆ‘åœ¨é›†æˆè¿‡ç¨‹ä¸­é‡åˆ°çš„æœ€å¤§çš„é—®é¢˜å°±æ˜¯æ˜æ˜é›†æˆå¥½äº†ï¼Œä½†æ˜¯swaggerçš„è®¿é—®é¡µé¢è¿˜æ˜¯swaggerçš„é»˜è®¤petStoreçš„é¡µé¢ï¼Œè€Œä¸æ˜¯æˆ‘é…ç½®çš„controllerçš„é¡µé¢ã€‚è¿™ä¸ªé—®é¢˜è®©æˆ‘æ’æŸ¥äº†å¥½ä¹…ã€‚<br><img src="/images/tech/spring/springdoc-petstore-page.jpg" alt="springdocæ€»æ˜¯æ˜¾ç¤ºé»˜è®¤petstoreæ¥å£"></p><p>é¦–å…ˆï¼Œæˆ‘ä»¬æˆ‘ä»¬è¦å…ˆäº†è§£çš„æ˜¯ï¼Œswagger-uiæ˜¯ä¸€å¥—apiå±•ç¤ºé¡µé¢ï¼Œä»–çš„æ•°æ®æ˜¯ä»<code>v3/api-docs</code>æ¥å£è·å–çš„jsonæ•°æ®ã€‚<br>æ‰€ä»¥æ’æŸ¥é—®é¢˜ï¼Œæˆ‘ä»¬é¦–å…ˆè¦çœ‹é¡µé¢æœ‰æ²¡æœ‰è°ƒç”¨è¿™ä¸ªæ¥å£ï¼ˆæœ‰å¯èƒ½æˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶äº†å°†è¿™ä¸ªæ¥å£æ”¹äº†ï¼‰ï¼Œå†æ¬¡çœ‹çœ‹è¿™ä¸ªæ¥å£æœ‰æ²¡æœ‰è¿”å›æ­£å¸¸çš„jsonç»“æœã€‚<br><img src="/images/tech/spring/springdoc-v3-apidocs.jpg" alt="springdocçš„æ•°æ®æ¥å£"><br>å¦‚æœè¿™è¿™ä¸ªæ¥å£è¿”å›äº†æ­£å¸¸çš„æ•°æ®ï¼Œä¸”æ˜¯æˆ‘ä»¬çš„é…ç½®çš„æ¥å£æ•°æ®ï¼Œé‚£ä¹ˆé—®é¢˜å¾ˆå¯èƒ½æ˜¯æˆ‘ä»¬çš„ä¸€äº›å®‰å…¨é…ç½®å°†swaggerçš„ç›¸å…³æ¥å£ç»™å±è”½äº†ã€‚<br>æ¯”å¦‚<code>WebSecurityConfigurerAdapter</code>, æˆ‘å°±æ˜¯åœ¨è¿™ä¸ªç¯èŠ‚ä¸Šå‡ºçš„é—®é¢˜</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@EnableGlobalMethodSecurity(prePostEnabled = true, securedEnabled = true)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SecurityConfig</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">WebSecurityConfigurerAdapter</span><br>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">configure</span><span class="hljs-params">(HttpSecurity httpSecurity)</span> <span class="hljs-keyword">throws</span> Exception<br>    &#123;<br>        <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="é¡¹ç›®demo"><a href="#é¡¹ç›®demo" class="headerlink" title="é¡¹ç›®demo"></a>é¡¹ç›®demo</h2><p>é›†æˆäº†applicationï¼Œjava bean config ä¸¤ç§æ–¹å¼çš„demo<br><a href="https://github.com/Hanchers/spring-boot-demo/tree/master/springdoc-openapi">springdoc-demo</a></p>]]></content>
    
    
    <categories>
      
      <category>spring</category>
      
    </categories>
    
    
    <tags>
      
      <tag>spring</tag>
      
      <tag>openapi</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>linuxå®šæ—¶ä»»åŠ¡crontabä¸æ‰§è¡Œçš„é—®é¢˜æ’æŸ¥è¿‡ç¨‹</title>
    <link href="/2023/10/13/linux-linux-crontab-not-work/"/>
    <url>/2023/10/13/linux-linux-crontab-not-work/</url>
    
    <content type="html"><![CDATA[<h3 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h3><p>æœ€è¿‘åœ¨æä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„crontab å®šæ—¶ä»»åŠ¡ï¼Œ æ ¸å¿ƒæ€è·¯å°±æ˜¯é€šè¿‡crontabè§¦å‘ä¸€ä¸ªbashè„šæœ¬ï¼Œè°ƒç”¨dockerå†…çš„ä¸€ä¸ªæŒ‡ä»¤ï¼Œæ¥å®ç°dockerç§¯å‹æ—¥å¿—çš„åˆ é™¤æ¸…ç†æ“ä½œã€‚</p><p>ç„¶åé—®é¢˜å°±æ¥äº†ï¼šæˆ‘é€šè¿‡å‘½ä»¤è¡Œè°ƒç”¨è„šæœ¬ï¼Œèƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œï¼Œä½†æ˜¯é€šè¿‡crontabï¼Œè„šæœ¬å°±æ­»æ´»è°ƒç”¨ä¸æˆåŠŸã€‚</p><p>ä»¥ä¸‹å°±æ˜¯è®°å½•çš„æ’æŸ¥crontabè°ƒç”¨ä¸æˆåŠŸçš„è¿‡ç¨‹ï¼š</p><h3 id="æ¡ˆå‘ç°åœº"><a href="#æ¡ˆå‘ç°åœº" class="headerlink" title="æ¡ˆå‘ç°åœº"></a>æ¡ˆå‘ç°åœº</h3><p>crontabä¸Šé…ç½®å®šæ—¶ä»»åŠ¡,æŠŠè¯¥æœ‰çš„ç¯å¢ƒå˜é‡éƒ½é…ç½®ä¸Šï¼Œè„šæœ¬çš„å¼€å¤´ä¹ŸåŠ ä¸Šäº†<code>source /etc/profile</code> ä¸ºäº†æ–¹ä¾¿æ’æŸ¥ï¼Œè°ƒåº¦æ”¹ä¸º2åˆ†é’Ÿä¸€æ¬¡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crontab">*/2 * * * *  /usr/bin/docker exec -it container-name bash  -c &#x27;sh /var/log/del_overdue_log.sh&#x27; <br></code></pre></td></tr></table></figure><p>ä¸å‡ºæ„å¤–çš„è¯ï¼Œå®šæ—¶ä»»åŠ¡è°ƒåº¦å¤±è´¥äº†ã€‚ </p><p>é€šè¿‡<code>tail -f /var/log/cron</code>  å»cronè°ƒåº¦æ—¥å¿—é‡ŒæŸ¥çœ‹è°ƒç”¨æƒ…å†µï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">Oct 13 10:58:01 : CROND[27764]: (root) CMD (/usr/bin/docker <span class="hljs-built_in">exec</span> -it container-name bash  -c <span class="hljs-string">&#x27;sh /var/log/del_overdue_log.sh&#x27;</span>)<br>Oct 13 10:58:01 : (root) MAIL (mailed 54 bytes of output but got status 0x004b#012)<br></code></pre></td></tr></table></figure><p>æ—¥å¿—è¡¨ç¤ºï¼Œæˆ‘ä»¬çš„cronä»»åŠ¡è°ƒåº¦äº†ï¼Œä½†æ˜¯æ²¡æœ‰æˆåŠŸã€‚ å¤±è´¥åŸå› æœ¬æ¥æƒ³é€šè¿‡mailå‘ç»™å½“å‰rootç”¨æˆ·çš„ï¼Œä½†å‘é€å¤±è´¥äº†ï¼ŒåŸå› æ˜¯è·å¾—äº†ä¸€ä¸ªå¤±è´¥çŠ¶æ€å—ã€‚</p><p>å¦‚ä½•è§£å†³è¿™ä¸ªmailå‘é€å¤±è´¥çš„é—®é¢˜å‘¢?</p><h4 id="å¯ç”¨postfix-æ¥æ”¶ç³»ç»Ÿé‚®ä»¶"><a href="#å¯ç”¨postfix-æ¥æ”¶ç³»ç»Ÿé‚®ä»¶" class="headerlink" title="å¯ç”¨postfix æ¥æ”¶ç³»ç»Ÿé‚®ä»¶"></a>å¯ç”¨postfix æ¥æ”¶ç³»ç»Ÿé‚®ä»¶</h4><p>å»<code>/etc/postfix/main.cf</code> é…ç½®æ–‡ä»¶,æœç´¢inet_interfacesï¼Œæ”¹æˆå¦‚ä¸‹é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">inet_interfaces = all<br><span class="hljs-comment"># inet_interfaces = localhost</span><br></code></pre></td></tr></table></figure><p>é‡å¯postfix </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">systemctl restart postfix<br></code></pre></td></tr></table></figure><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ”¶åˆ°cronè°ƒåº¦å¤±è´¥çš„ç³»ç»Ÿé€šçŸ¥é‚®ä»¶äº†ã€‚</p><p><code>tail -f /var/spool/mail/root </code> æŸ¥çœ‹é‚®ä»¶ä¿¡æ¯ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">From</span> root@host.localdomain  Fri Oct <span class="hljs-number">13</span> <span class="hljs-number">12</span>:<span class="hljs-number">56</span>:<span class="hljs-number">01</span> <span class="hljs-number">2023</span><br><span class="hljs-attribute">Return</span>-Path: &lt;root@host.localdomain&gt;<br><span class="hljs-attribute">X</span>-Original-To: root<br><span class="hljs-attribute">Delivered</span>-To: root@host.localdomain<br><span class="hljs-attribute">Received</span>: by host.localdomain (Postfix, from userid <span class="hljs-number">0</span>)<br><span class="hljs-attribute">id</span> D94301329A7; Fri, <span class="hljs-number">13</span> Oct <span class="hljs-number">2023</span> <span class="hljs-number">12</span>:<span class="hljs-number">56</span>:<span class="hljs-number">01</span> +<span class="hljs-number">0800</span> (CST)<br><span class="hljs-attribute">From</span>: <span class="hljs-string">&quot;(Cron Daemon)&quot;</span> &lt;root@host.localdomain&gt;<br><span class="hljs-attribute">To</span>: root@host.localdomain<br><span class="hljs-attribute">Subject</span>: Cron &lt;root@host&gt; /usr/bin/docker exec -it container-name bash  -c &#x27;sh /var/log/del_overdue_log.sh&#x27;<br><span class="hljs-attribute">Content</span>-Type: text/plain; charset=UTF-<span class="hljs-number">8</span><br><span class="hljs-attribute">Auto</span>-Submitted: auto-generated<br><span class="hljs-attribute">Precedence</span>: bulk<br><span class="hljs-attribute">X</span>-Cron-Env: &lt;XDG_SESSION_ID=<span class="hljs-number">2387</span>&gt;<br><span class="hljs-attribute">X</span>-Cron-Env: &lt;XDG_RUNTIME_DIR=/run/user/<span class="hljs-number">0</span>&gt;<br><span class="hljs-attribute">X</span>-Cron-Env: &lt;LANG=en_US.UTF-<span class="hljs-number">8</span>&gt;<br><span class="hljs-attribute">X</span>-Cron-Env: &lt;SHELL=/bin/sh&gt;<br><span class="hljs-attribute">X</span>-Cron-Env: &lt;HOME=/root&gt;<br><span class="hljs-attribute">X</span>-Cron-Env: &lt;PATH=/usr/bin:/bin&gt;<br><span class="hljs-attribute">X</span>-Cron-Env: &lt;LOGNAME=root&gt;<br><span class="hljs-attribute">X</span>-Cron-Env: &lt;USER=root&gt;<br><span class="hljs-attribute">Message</span>-Id: &lt;<span class="hljs-number">20231013045601</span>.D94301329A7@host.localdomain&gt;<br><span class="hljs-attribute">Date</span>: Fri, <span class="hljs-number">13</span> Oct <span class="hljs-number">2023</span> <span class="hljs-number">12</span>:<span class="hljs-number">56</span>:<span class="hljs-number">01</span> +<span class="hljs-number">0800</span> (CST)<br><br><span class="hljs-attribute">the</span> input device is not a TTY<br></code></pre></td></tr></table></figure><p>ä¼šå‘ç°ï¼Œå¤±è´¥çš„åŸå› æ˜¯æˆ‘ä»¬çš„è„šæœ¬è°ƒåº¦å™¨ä¸æ˜¯TTY(ç»ˆç«¯)ï¼Œæ‰€ä»¥å¤±è´¥äº†ã€‚</p><blockquote><p>æ³¨æ„ï¼Œé—®é¢˜å®šä½åè®°å¾—æŠŠpostfixé…ç½®æ¢å¤åŸçŠ¶</p></blockquote><h4 id="é—®é¢˜å®šä½"><a href="#é—®é¢˜å®šä½" class="headerlink" title="é—®é¢˜å®šä½"></a>é—®é¢˜å®šä½</h4><p>æ‰¾åˆ°æ—¥å¿—äº†ï¼Œä»»åŠ¡è°ƒåº¦å¤±è´¥çš„åŸå› ä¹Ÿæ‰¾åˆ°äº†ï¼Œåˆ†æä¸€ä¸‹æˆ‘ä»¬çš„ä»»åŠ¡æŒ‡ä»¤ï¼Œå‘ç°æˆ‘ä»¬åœ¨è„šæœ¬è°ƒåº¦å‘½ä»¤é‡Œå­˜åœ¨é€‰é¡¹<code> docker exec -it</code> é…ç½®ã€‚</p><p>é—®é¢˜å°±åœ¨è¿™ä¸ª<code>-it</code> ä¸Šé¢äº†ï¼Œè¿™è¦æ±‚æˆ‘ä»¬å¼€å¯ä¸€ä¸ªäº¤äº’å¼ç»ˆç«¯æ¥æ§åˆ¶dockeræŒ‡ä»¤ï¼Œè€Œcrontabè°ƒåº¦å™¨æ˜æ˜¾ä¸æ˜¯ä¸€ä¸ªç»ˆç«¯ï¼Œæ‰€ä»¥å¤±è´¥äº†ã€‚</p><h3 id="é—®é¢˜è§£å†³"><a href="#é—®é¢˜è§£å†³" class="headerlink" title="é—®é¢˜è§£å†³"></a>é—®é¢˜è§£å†³</h3><p>æŠŠå‘½ä»¤è¡Œé‡Œçš„<code>-it</code>å»æ‰ï¼Œæ”¹ä¸º<code>-d</code>åç«¯è°ƒç”¨å°±å¯ä»¥äº†ã€‚ä»¥ä¸‹æ˜¯æœ€ç»ˆç‰ˆé…ç½®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crontab">* 1 * * *  /usr/bin/docker exec -d container-name bash  -c &#x27;sh /var/log/del_overdue_log.sh&#x27; &gt;/dev/null 2&gt;$1 <br></code></pre></td></tr></table></figure><p>æœ€ç»ˆæŒ‡ä»¤æ”¹äº†ä¸¤ç‚¹:</p><ol><li>å°†<code>-it</code>æ”¹ä¸º<code>-d</code>ï¼Œ è§£å†³crontabè°ƒåº¦å¤±è´¥çš„é—®é¢˜ã€‚</li><li>åœ¨crontabå‘½ä»¤ä¸Šå¢åŠ  <code>&gt;/dev/null 2&gt;$1</code> é…ç½®ï¼Œè¿™æ˜¯ä¸ºäº†å–æ¶ˆä»»åŠ¡è°ƒåº¦çš„ç³»ç»Ÿæ—¥å¿—äº§ç”Ÿï¼Œé˜²æ­¢ç³»ç»Ÿæ—¥å¿—çˆ†ç‚¸ï¼Œä¹Ÿå¯ä»¥ä¸åŠ ã€‚</li></ol><h3 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h3><p>æˆä¹‹ä»¥æ¸”ä¸å¦‚æˆä¹‹ä»¥æ¸”ï¼Œ å‡ºç°é—®é¢˜ä¸å¯æ€•ï¼Œåªè¦æˆ‘ä»¬æŒæ¡äº†ä¸€äº›è§£å†³é—®é¢˜çš„æ–¹æ³•è®ºï¼Œ ä»»ä½•é—®é¢˜éƒ½èƒ½è¿åˆƒè€Œè§£ã€‚</p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="https://www.geeksforgeeks.org/crontab-in-linux-with-examples/">â€˜crontabâ€™ in Linux with Examples</a></p><p><a href="https://zhangge.net/5093.html">crontabä¸æ‰§è¡Œæ’æŸ¥</a></p>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹äººç”Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>é—®é¢˜è§£å†³</tag>
      
      <tag>centos</tag>
      
      <tag>crontab</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>javaåº”ç”¨è¿æ¥dockerå†…çš„oracleæ—¶æŠ¥ORA-01882é”™è¯¯</title>
    <link href="/2023/08/18/exception-java-oracle-docker-timezone-not-find/"/>
    <url>/2023/08/18/exception-java-oracle-docker-timezone-not-find/</url>
    
    <content type="html"><![CDATA[<h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><p>æ•°æ®åº“å‡çº§ï¼Œç”¨dockerå®¹å™¨å®‰è£…oracle11gæ•°æ®åº“ï¼Œåº”ç”¨è¿æ¥çš„æ—¶å€™æŠ¥ORA-01882é”™è¯¯</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus">java<span class="hljs-selector-class">.sql</span><span class="hljs-selector-class">.SQLException</span>: ORA-<span class="hljs-number">00604</span>: error occurred at recursive SQL level <span class="hljs-number">1</span><br>ORA-<span class="hljs-number">01882</span>: timezone region not found<br><br>        at oracle<span class="hljs-selector-class">.jdbc</span><span class="hljs-selector-class">.driver</span><span class="hljs-selector-class">.T4CTTIoer11</span><span class="hljs-selector-class">.processError</span>(T4CTTIoer11<span class="hljs-selector-class">.java</span>:<span class="hljs-number">509</span>)<br>        at oracle<span class="hljs-selector-class">.jdbc</span><span class="hljs-selector-class">.driver</span><span class="hljs-selector-class">.T4CTTIoer11</span><span class="hljs-selector-class">.processError</span>(T4CTTIoer11<span class="hljs-selector-class">.java</span>:<span class="hljs-number">456</span>)<br>        at oracle<span class="hljs-selector-class">.jdbc</span><span class="hljs-selector-class">.driver</span><span class="hljs-selector-class">.T4CTTIoer11</span><span class="hljs-selector-class">.processError</span>(T4CTTIoer11<span class="hljs-selector-class">.java</span>:<span class="hljs-number">451</span>)<br></code></pre></td></tr></table></figure><p>ç¯å¢ƒï¼š</p><ul><li>jdk ï¼š openjdk8</li><li>oracle: 11g</li></ul><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>é—®é¢˜æœ¬è´¨ä¸Šæ˜¯javaåº”ç”¨ç¨‹åºå¯åŠ¨æ—¶, æ‰¾ä¸åˆ°æœ¬åœ°ç³»ç»Ÿçš„æ—¶åŒºç¯å¢ƒå˜é‡å¯¼è‡´ã€‚ æˆ‘ä»¬åªæœ‰æŠŠæ—¶åŒºç¯å¢ƒå˜é‡é…ç½®ä¸Šå°±å¯ä»¥äº†ã€‚</p><p>è§£å†³åŠæ³•æœ‰äºŒï¼š</p><ol><li>javaåº”ç”¨ç¨‹åºå¯åŠ¨æ—¶å¢åŠ ç¯å¢ƒå˜é‡é…ç½®</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">-Duser.timezone=xxxï¼ˆxxxä¸ºoracleæ—¶åŒºIDï¼‰<br></code></pre></td></tr></table></figure><ol start="2"><li>ç›´æ¥ä¿®æ”¹æœåŠ¡å™¨çš„ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼ˆæ›´å½»åº•ï¼‰</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æ—¶é—´æ›´æ–°ä¸ºä¸œå…«åŒºæ—¶é—´</span><br><span class="hljs-built_in">cp</span> /usr/share/zoneinfo/Asia/Shanghai /etc/localtime<br><span class="hljs-comment"># é…ç½®æ—¶åŒºä¸ºä¸œå…«åŒºã€‚ Javaå¯ä»¥é€šè¿‡Timezoneè·å–æ—¶åŒºçš„ï¼Œä¿®æ”¹å®Œé‡å¯æœåŠ¡å³å¯ã€‚</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;Asia/Shanghai&#x27;</span> &gt;/etc/timezone<br></code></pre></td></tr></table></figure><p>å¦‚æœæ˜¯dockerçš„è¯ï¼Œå°†å®¿ä¸»æœºæ”¹ä¸ºä¸Šè¿°é…ç½®åï¼Œdockerå®¹å™¨å¯åŠ¨(run)å¢åŠ æŒ‚è½½é…ç½®å°±å¯ä»¥äº†</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade">-v /etc/localtime:<span class="hljs-regexp">/etc/</span>localtime<br>-v /etc/<span class="hljs-built_in">timezone</span>:<span class="hljs-regexp">/etc/</span><span class="hljs-built_in">timezone</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹äººç”Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>å¼‚å¸¸</tag>
      
      <tag>oracle</tag>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>gitä¼˜é›…è¿åº“çš„æ–¹å¼</title>
    <link href="/2023/07/31/git-mirror/"/>
    <url>/2023/07/31/git-mirror/</url>
    
    <content type="html"><![CDATA[<p>åœ¨æˆ‘ä»¬å¼€å‘é¡¹ç›®çš„æ—¶å€™ï¼Œç»å¸¸ä¼šé‡åˆ°å°†ä¸€ä¸ªgitä»“åº“è¿ç§»åˆ°ä¸€ä¸ªæ–°çš„gitä»“åº“çš„æƒ…å†µã€‚ è¿™ä¸ªæ—¶å€™å¾ˆå¤šäººä¼šæŠŠåŸå§‹çš„ä»“åº“æœ€æ–°ä»£ç å¤åˆ¶åˆ°æ–°åº“ç›®å½•ä¸‹ï¼Œç„¶åforce pushå³å¯ã€‚</p><p>ä½†æ˜¯è¿™æ ·ä¼šäº§ç”Ÿä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ–°åº“ä¼šæŠŠæˆ‘ä»¬çš„å†å²æäº¤è®°å½•ç­‰ä¿¡æ¯å…¨éƒ¨ä¸¢å¤±äº†ï¼Œå½“åšä¸€ä¸ªå…¨æ–°çš„ä»“åº“æ¥å¤„ç†ï¼Œè¿™æ ·ç»™æˆ‘ä»¬åç»­çš„é—®é¢˜è¿½è¸ªå›æº¯å¸¦æ¥äº†ä¸€äº›é—®é¢˜ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬ä»‹ç»ä¸€ä¸‹gitä¼˜é›…è¿åº“çš„ä¸‰ç§æ–¹å¼ã€‚</p><h3 id="è£¸åº“æ–¹å¼-æ¨è"><a href="#è£¸åº“æ–¹å¼-æ¨è" class="headerlink" title="è£¸åº“æ–¹å¼(æ¨è)"></a>è£¸åº“æ–¹å¼(æ¨è)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">// ä½¿ç”¨--bareå…‹éš†è£¸ä»“åº“<br>git <span class="hljs-built_in">clone</span> --bare git@url1<br>// æ¨é€åˆ°æ–°åº“<br>git push  git@url2<br></code></pre></td></tr></table></figure><h3 id="é•œåƒåº“æ–¹å¼"><a href="#é•œåƒåº“æ–¹å¼" class="headerlink" title="é•œåƒåº“æ–¹å¼"></a>é•œåƒåº“æ–¹å¼</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">// ä½¿ç”¨--mirrorå…‹éš†è£¸ä»“åº“<br>git <span class="hljs-built_in">clone</span> --mirror git@url1<br>// æ¨é€åˆ°æ–°åº“<br>git push  git@url2<br></code></pre></td></tr></table></figure><p>é•œåƒåº“æ˜¯è£¸åº“çš„ä¸€ç§ç®€å†™,ç­‰åŒäºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ git <span class="hljs-built_in">clone</span> --bare <span class="hljs-variable">$URL</span><br>$ (<span class="hljs-built_in">cd</span> $(<span class="hljs-built_in">basename</span> <span class="hljs-variable">$URL</span>) &amp;&amp; git remote add --mirror=fetch origin <span class="hljs-variable">$URL</span>)<br></code></pre></td></tr></table></figure><p>ç”±æ­¤å¯çŸ¥ï¼Œè£¸åº“æ–¹å¼cloneä¸‹çš„æ˜¯gitä»“åº“çš„åŸºæœ¬ä¿¡æ¯ã€‚é•œåƒåº“ä¸ä»…æŠŠåŸºæœ¬ä¿¡æ¯cloneä¸‹æ¥äº†ï¼Œè¿˜æ‹‰å»äº†æœ€æ–°çš„åˆ†æ”¯ä»£ç ã€‚</p><h3 id="æ–°å¢remoteæ–¹å¼"><a href="#æ–°å¢remoteæ–¹å¼" class="headerlink" title="æ–°å¢remoteæ–¹å¼"></a>æ–°å¢remoteæ–¹å¼</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">git remote add origin2 [repo-url]<br>git push origin2<br></code></pre></td></tr></table></figure><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="https://stackoverflow.com/questions/3959924/whats-the-difference-between-git-clone-mirror-and-git-clone-bare">git clone â€“mirror å’Œ â€“bareçš„åŒºåˆ«</a></p>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹äººç”Ÿ</category>
      
      <category>git</category>
      
    </categories>
    
    
    <tags>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>jdbcååºåˆ—åŒ–æ¼æ´ä¿®å¤</title>
    <link href="/2023/07/04/safe-mysql-jdbc-object-serial/"/>
    <url>/2023/07/04/safe-mysql-jdbc-object-serial/</url>
    
    <content type="html"><![CDATA[<h2 id="å®‰å…¨æ¼æ´æè¿°"><a href="#å®‰å…¨æ¼æ´æè¿°" class="headerlink" title="å®‰å…¨æ¼æ´æè¿°"></a>å®‰å…¨æ¼æ´æè¿°</h2><p>Jdbcååºåˆ—åŒ–æ¼æ´å‘ç”Ÿåœ¨åå°ä»£ç ä½¿ç”¨mysql-connectorç»„ä»¶è¿æ¥æ•°æ®åº“ä¸”æ”»å‡»è€…å¯æ§åˆ¶è¿æ¥å‚æ•°çš„æƒ…å†µä¸‹ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„mysqlæ•°æ®åº“ä½¿æœåŠ¡å™¨å»è®¿é—®é“¾æ¥å®ƒä»è€Œè§¦å‘ååºåˆ—åŒ–æ¼æ´å¯¼è‡´å‘½ä»¤æ‰§è¡Œ</p><p>mysql è¿æ¥å‚æ•°é£é™©ç‚¹ï¼šautoDeserializeï¼ŒstatementInterceptors</p><h2 id="é£é™©ç­‰çº§ï¼šé«˜"><a href="#é£é™©ç­‰çº§ï¼šé«˜" class="headerlink" title="é£é™©ç­‰çº§ï¼šé«˜"></a>é£é™©ç­‰çº§ï¼šé«˜</h2><h2 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h2><ul><li>å‡çº§mysqlç‰ˆæœ¬åˆ°8.0.27+ï¼Œå®˜æ–¹å·²ç»ä¿®å¤æ­¤é—®é¢˜</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>8.0.27<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><ul><li>è¿‡æ»¤æ‰é£é™©å‚æ•°<br> ä¸€èˆ¬æƒ…å†µä¸‹ä¸éœ€è¦å¯¹autoDeserializeå’ŒstatementInterceptorså‚æ•°è¿›è¡Œè®¾ç½®ã€‚åœ¨åç«¯ä»£ç è®¾ç½®è¿æ¥å­—ç¬¦å‚æ•°ç™½åå•,æˆ–è€…å°†è¿™ä¸¤ä¸ªå‚æ•°ç›´æ¥æ›¿æ¢æ‰ã€‚<br> æ›¿æ¢ä»£ç å‚è€ƒï¼š</li></ul><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs applescript">Properties <span class="hljs-keyword">prop</span> = new Properties();<br><span class="hljs-keyword">prop</span>.<span class="hljs-keyword">put</span>(<span class="hljs-string">&quot;autoDeserialize&quot;</span>, <span class="hljs-string">&quot;false&quot;</span>);<br><span class="hljs-keyword">prop</span>.<span class="hljs-keyword">put</span>(<span class="hljs-string">&quot;allowLoadLocalInfile&quot;</span>, <span class="hljs-string">&quot;false&quot;</span>);<br><span class="hljs-keyword">prop</span>.<span class="hljs-keyword">put</span>(<span class="hljs-string">&quot;allowUrlInLocalInfile&quot;</span>, <span class="hljs-string">&quot;false&quot;</span>);<br><span class="hljs-keyword">prop</span>.<span class="hljs-keyword">put</span>(<span class="hljs-string">&quot;allowLoadLocalInfileInPath&quot;</span>, <span class="hljs-string">&quot;&quot;</span>);<br><span class="hljs-keyword">prop</span>.<span class="hljs-keyword">put</span>(<span class="hljs-string">&quot;statementInterceptors&quot;</span>, <span class="hljs-string">&quot;&quot;</span>);<br><br>Connectionconn=DriverManager.getConnection(DB_URL,<span class="hljs-keyword">prop</span>);<br></code></pre></td></tr></table></figure><h2 id="å®‰å…¨æ— å°äº‹ï¼ï¼ï¼"><a href="#å®‰å…¨æ— å°äº‹ï¼ï¼ï¼" class="headerlink" title="å®‰å…¨æ— å°äº‹ï¼ï¼ï¼"></a>å®‰å…¨æ— å°äº‹ï¼ï¼ï¼</h2><p><a href="https://cloud.tencent.com/developer/article/1822662">Jdbcååºåˆ—åŒ–æ¼æ´å¤ç°æµ…æ</a></p><p><a href="https://www.anquanke.com/post/id/237357#h3-13">æ¢æ¢JDBCååºåˆ—åŒ–æ¼æ´</a></p><p><a href="https://wiki.wgpsec.org/knowledge/ctf/JDBC-Unserialize.html">ç‹¼ç»„-JDBCååºåˆ—åŒ–æ¼æ´</a></p>]]></content>
    
    
    <categories>
      
      <category>å®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mysql</tag>
      
      <tag>å®‰å…¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CORSè·¨åŸŸæ”»å‡»ä¸ä¿®å¤</title>
    <link href="/2023/06/21/safe-cors-attack/"/>
    <url>/2023/06/21/safe-cors-attack/</url>
    
    <content type="html"><![CDATA[<p>CORSè·¨åŸŸçš„é€†å‘æ“ä½œï¼Œå¦‚ä½•æ”¶å›æ”¾å¼€çš„è·¨åŸŸæƒé™ã€‚</p><p>ä»¥ä¸‹æ˜¯CORSæ¼æ´çš„ä¸€äº›å†…å®¹ï¼š</p><h2 id="å®‰å…¨æ¼æ´æè¿°"><a href="#å®‰å…¨æ¼æ´æè¿°" class="headerlink" title="å®‰å…¨æ¼æ´æè¿°"></a>å®‰å…¨æ¼æ´æè¿°</h2><p>WebæœåŠ¡ç«¯CORSï¼ˆè·¨åŸŸèµ„æºå…±äº«ï¼‰é”™è¯¯é…ç½®ï¼Œæ— æ³•æ­£ç¡®éªŒè¯Originå¤´ï¼Œä»»ä½•ç½‘ç«™éƒ½å¯ä»¥å‘å‡ºä½¿ç”¨ç”¨æˆ·å‡­æ®å‘å‡ºçš„è¯·æ±‚ï¼Œå¹¶è¯»å–å¯¹è¿™äº›è¯·æ±‚çš„å“åº”ï¼Œä¿¡ä»»ä»»æ„æ¥æºå¯ä»¥æœ‰æ•ˆåœ°ç¦ç”¨åŒæºç­–ç•¥ï¼Œä»è€Œå…è®¸ç¬¬ä¸‰æ–¹ç½‘ç«™è¿›è¡ŒåŒå‘äº¤äº’ï¼Œæ˜“å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²</p><p><img src="/images/tech/safe/safe_cros_attack.png" alt="swagger-switch"></p><h2 id="é£é™©ç­‰çº§ï¼šé«˜"><a href="#é£é™©ç­‰çº§ï¼šé«˜" class="headerlink" title="é£é™©ç­‰çº§ï¼šé«˜"></a>é£é™©ç­‰çº§ï¼šé«˜</h2><h2 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h2><p>éœ€è¦ä¿®å¤ä¸¤å¤„ï¼š<br>1ï¼Œä»£ç çº§åˆ«ï¼ˆå¿…ä¿®ï¼‰<br>ç¨‹åºé»˜è®¤æ˜¯ç¦æ­¢è·¨åŸŸçš„ï¼Œä¹Ÿå¯ä»¥å»æ‰ç›¸å…³é€»è¾‘ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs code">// æ¯”å¦‚ï¼š *.domain.com, 127.0.0.1  <br>@Value(&quot;$&#123;cros.allow-origin:*&#125;&quot;)<br>private String crosAllowOrigin;<br><br>@Bean<br>public CorsFilter corsFilter()<br>&#123;<br>    CorsConfiguration config = new CorsConfiguration();<br>    config.setAllowCredentials(false);<br>    // è®¾ç½®è®¿é—®æºåœ°å€ï¼Œ   <br>    for (String origin : crosAllowOrigin.split(&quot;,&quot;)) &#123;<br>        config.addAllowedOriginPattern(origin);<br>    &#125;<br>    // è®¾ç½®è®¿é—®æºè¯·æ±‚å¤´ , ä¹Ÿå¯ä»¥é…ç½®  <br>    config.addAllowedHeader(&quot;*&quot;);<br>    // è®¾ç½®è®¿é—®æºè¯·æ±‚æ–¹æ³• , ä¹Ÿå¯ä»¥é…ç½®   <br>    config.addAllowedMethod(&quot;*&quot;);<br>    // æœ‰æ•ˆæœŸ 1800ç§’    <br>    config.setMaxAge(1800L);<br>    // æ·»åŠ æ˜ å°„è·¯å¾„ï¼Œæ‹¦æˆªä¸€åˆ‡è¯·æ±‚    <br>    UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();<br>    source.registerCorsConfiguration(&quot;/**&quot;, config);<br>    // è¿”å›æ–°çš„CorsFilter    <br>    return new CorsFilter(source);<br>&#125;<br></code></pre></td></tr></table></figure><p>2ï¼ŒnginxæœåŠ¡<br>å¢åŠ ç›¸å…³å¤´é…ç½®</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">add_header</span> <span class="hljs-string">Access-Control-Allow-Origin your.domain.com;</span><br></code></pre></td></tr></table></figure><h2 id="å®‰å…¨æ— å°äº‹ï¼ï¼ï¼"><a href="#å®‰å…¨æ— å°äº‹ï¼ï¼ï¼" class="headerlink" title="å®‰å…¨æ— å°äº‹ï¼ï¼ï¼"></a>å®‰å…¨æ— å°äº‹ï¼ï¼ï¼</h2>]]></content>
    
    
    <categories>
      
      <category>å®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>spring</tag>
      
      <tag>å®‰å…¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å­˜å‚¨XSSé—®é¢˜ä¸ä¿®å¤</title>
    <link href="/2023/06/21/safe-xss-reactive/"/>
    <url>/2023/06/21/safe-xss-reactive/</url>
    
    <content type="html"><![CDATA[<h2 id="å®‰å…¨æ¼æ´æè¿°"><a href="#å®‰å…¨æ¼æ´æè¿°" class="headerlink" title="å®‰å…¨æ¼æ´æè¿°"></a>å®‰å…¨æ¼æ´æè¿°</h2><p>æ¶æ„æ”»å‡»è€…å¾€Webé¡µé¢é‡Œæ’å…¥æ¶æ„Scriptä»£ç ï¼Œå½“ç”¨æˆ·æµè§ˆè¯¥é¡µæ—¶ï¼ŒåµŒå…¥å…¶ä¸­Webé‡Œé¢çš„Scriptä»£ç ä¼šè¢«æ‰§è¡Œï¼Œè¿›è€Œçªƒå–åˆ°ç®¡ç†å‘˜ç”¨æˆ·æƒé™ç­‰ã€‚</p><h2 id="é£é™©ç­‰çº§ï¼šé«˜"><a href="#é£é™©ç­‰çº§ï¼šé«˜" class="headerlink" title="é£é™©ç­‰çº§ï¼šé«˜"></a>é£é™©ç­‰çº§ï¼šé«˜</h2><h2 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h2><ol><li>å¯¹ç½‘é¡µç«¯è¾“å…¥çš„ç‰¹æ®Šå­—ç¬¦è¿‡æ»¤<br>å»ºè®®è¿‡æ»¤çš„å…³é”®å­—ä¸ºï¼š<br>[1]â€™å•å¼•å·<br>[2]â€åŒå¼•å·<br>[3]&#x2F;æ–œæ <br>[4]åæ–œæ <br>[5])æ‹¬å·<br>[6];åˆ†å·<br>[7][ä¸­æ‹¬å·<br>[8]&lt;å°–æ‹¬å·<br>[9]&gt;å°–æ‹¬å·<br>æ¯”å¦‚æŠŠ&lt;ç¼–ç ä¸º&lt;   </li><li>åœ¨cookieä¸­åŠ å…¥httponlyå±æ€§å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¿æŠ¤ç”¨æˆ·çš„cookieï¼Œå‡å°‘å‡ºç°XSSæ—¶æŸå¤±ã€‚</li></ol><p>ä¸€æ®µç®€æ˜“çš„å­—ç¬¦è¿‡æ»¤ç¨‹åº</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">function</span> htmlEncode(str)&#123;<br>    var s = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">if</span> (str.length == 0) <span class="hljs-built_in">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>    s = str.replace(/&amp;/g, <span class="hljs-string">&quot;&amp;&quot;</span>);<br>    s = s.replace(//g, <span class="hljs-string">&quot;&gt;&quot;</span>);<br>    s = s.replace(/ /g, <span class="hljs-string">&quot; &quot;</span>);<br>    s = s.replace(/\&#x27;/g, <span class="hljs-string">&quot;&#x27;&quot;</span>);<br>    s = s.replace(/\&quot;/g, <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;);</span><br><span class="hljs-string">    return s;</span><br><span class="hljs-string">&#125;</span><br></code></pre></td></tr></table></figure><ol start="3"><li>åœ¨æœåŠ¡ç«¯å¢åŠ filterè¿‡æ»¤<br>é€šè¿‡è‡ªå®šä¹‰filterçš„æ–¹å¼æ‹¦æˆªè¿‡æ»¤è¯·æ±‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">XssFilter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Filter</span><br>&#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ’é™¤é“¾æ¥</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> List&lt;String&gt; excludes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">(FilterConfig filterConfig)</span> <span class="hljs-keyword">throws</span> ServletException<br>    &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">tempExcludes</span> <span class="hljs-operator">=</span> filterConfig.getInitParameter(<span class="hljs-string">&quot;excludes&quot;</span>);<br>        <span class="hljs-keyword">if</span> (StringUtils.isNotEmpty(tempExcludes))<br>        &#123;<br>            String[] url = tempExcludes.split(<span class="hljs-string">&quot;,&quot;</span>);<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; url != <span class="hljs-literal">null</span> &amp;&amp; i &lt; url.length; i++)<br>            &#123;<br>                excludes.add(url[i]);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doFilter</span><span class="hljs-params">(ServletRequest request, ServletResponse response, FilterChain chain)</span><br>            <span class="hljs-keyword">throws</span> IOException, ServletException<br>    &#123;<br>        <span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">req</span> <span class="hljs-operator">=</span> (HttpServletRequest) request;<br>        <span class="hljs-type">HttpServletResponse</span> <span class="hljs-variable">resp</span> <span class="hljs-operator">=</span> (HttpServletResponse) response;<br>        <span class="hljs-keyword">if</span> (handleExcludeURL(req, resp))<br>        &#123;<br>            chain.doFilter(request, response);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-type">XssHttpServletRequestWrapper</span> <span class="hljs-variable">xssRequest</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">XssHttpServletRequestWrapper</span>((HttpServletRequest) request);<br>        chain.doFilter(xssRequest, response);<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">handleExcludeURL</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span><br>    &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> request.getServletPath();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> request.getMethod();<br>        <span class="hljs-comment">// GET DELETE ä¸è¿‡æ»¤</span><br>        <span class="hljs-keyword">if</span> (method == <span class="hljs-literal">null</span> || HttpMethod.GET.matches(method) || HttpMethod.DELETE.matches(method))<br>        &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> StringUtils.matches(url, excludes);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨wrapperé‡Œè¿‡æ»¤å‚æ•°   </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">XssHttpServletRequestWrapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HttpServletRequestWrapper</span><br>&#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> request</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">XssHttpServletRequestWrapper</span><span class="hljs-params">(HttpServletRequest request)</span><br>    &#123;<br>        <span class="hljs-built_in">super</span>(request);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String[] getParameterValues(String name)<br>    &#123;<br>        String[] values = <span class="hljs-built_in">super</span>.getParameterValues(name);<br>        <span class="hljs-keyword">if</span> (values != <span class="hljs-literal">null</span>)<br>        &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">length</span> <span class="hljs-operator">=</span> values.length;<br>            String[] escapesValues = <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[length];<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; length; i++)<br>            &#123;<br>                <span class="hljs-comment">// é˜²xssæ”»å‡»å’Œè¿‡æ»¤å‰åç©ºæ ¼</span><br>                escapesValues[i] = EscapeUtil.clean(values[i]).trim();<br>            &#125;<br>            <span class="hljs-keyword">return</span> escapesValues;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.getParameterValues(name);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> ServletInputStream <span class="hljs-title function_">getInputStream</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException<br>    &#123;<br>        <span class="hljs-comment">// éjsonç±»å‹ï¼Œç›´æ¥è¿”å›</span><br>        <span class="hljs-keyword">if</span> (!isJsonRequest())<br>        &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.getInputStream();<br>        &#125;<br><br>        <span class="hljs-comment">// ä¸ºç©ºï¼Œç›´æ¥è¿”å›</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">json</span> <span class="hljs-operator">=</span> IOUtils.toString(<span class="hljs-built_in">super</span>.getInputStream(), <span class="hljs-string">&quot;utf-8&quot;</span>);<br>        <span class="hljs-keyword">if</span> (StringUtils.isEmpty(json))<br>        &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.getInputStream();<br>        &#125;<br><br>        <span class="hljs-comment">// xssè¿‡æ»¤</span><br>        json = EscapeUtil.clean(json).trim();<br>        <span class="hljs-type">byte</span>[] jsonBytes = json.getBytes(<span class="hljs-string">&quot;utf-8&quot;</span>);<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">ByteArrayInputStream</span> <span class="hljs-variable">bis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayInputStream</span>(jsonBytes);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServletInputStream</span>()<br>        &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isFinished</span><span class="hljs-params">()</span><br>            &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isReady</span><span class="hljs-params">()</span><br>            &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">available</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException<br>            &#123;<br>                <span class="hljs-keyword">return</span> jsonBytes.length;<br>            &#125;<br><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setReadListener</span><span class="hljs-params">(ReadListener readListener)</span><br>            &#123;<br>            &#125;<br><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">read</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException<br>            &#123;<br>                <span class="hljs-keyword">return</span> bis.read();<br>            &#125;<br>        &#125;;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ˜¯å¦æ˜¯Jsonè¯·æ±‚</span><br><span class="hljs-comment">     * </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> request</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isJsonRequest</span><span class="hljs-params">()</span><br>    &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">header</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">super</span>.getHeader(HttpHeaders.CONTENT_TYPE);<br>        <span class="hljs-keyword">return</span> StringUtils.startsWithIgnoreCase(header, MediaType.APPLICATION_JSON_VALUE);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>xssUtil</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EscapeUtil</span><br>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">RE_HTML_MARK</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;(&lt;[^&lt;]*?&gt;)|(&lt;[\\s]*?/[^&lt;]*?&gt;)|(&lt;[^&lt;]*?/[\\s]*?&gt;)&quot;</span>;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">char</span>[][] TEXT = <span class="hljs-keyword">new</span> <span class="hljs-title class_">char</span>[<span class="hljs-number">64</span>][];<br><br>    <span class="hljs-keyword">static</span><br>    &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">64</span>; i++)<br>        &#123;<br>            TEXT[i] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">char</span>[] &#123; (<span class="hljs-type">char</span>) i &#125;;<br>        &#125;<br><br>        <span class="hljs-comment">// special HTML characters</span><br>        TEXT[<span class="hljs-string">&#x27;\&#x27;&#x27;</span>] = <span class="hljs-string">&quot;&amp;#039;&quot;</span>.toCharArray(); <span class="hljs-comment">// å•å¼•å·</span><br>        TEXT[<span class="hljs-string">&#x27;&quot;&#x27;</span>] = <span class="hljs-string">&quot;&amp;#34;&quot;</span>.toCharArray(); <span class="hljs-comment">// åŒå¼•å·</span><br>        TEXT[<span class="hljs-string">&#x27;&amp;&#x27;</span>] = <span class="hljs-string">&quot;&amp;#38;&quot;</span>.toCharArray(); <span class="hljs-comment">// &amp;ç¬¦</span><br>        TEXT[<span class="hljs-string">&#x27;&lt;&#x27;</span>] = <span class="hljs-string">&quot;&amp;#60;&quot;</span>.toCharArray(); <span class="hljs-comment">// å°äºå·</span><br>        TEXT[<span class="hljs-string">&#x27;&gt;&#x27;</span>] = <span class="hljs-string">&quot;&amp;#62;&quot;</span>.toCharArray(); <span class="hljs-comment">// å¤§äºå·</span><br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è½¬ä¹‰æ–‡æœ¬ä¸­çš„HTMLå­—ç¬¦ä¸ºå®‰å…¨çš„å­—ç¬¦</span><br><span class="hljs-comment">     * </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> text è¢«è½¬ä¹‰çš„æ–‡æœ¬</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> è½¬ä¹‰åçš„æ–‡æœ¬</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">escape</span><span class="hljs-params">(String text)</span><br>    &#123;<br>        <span class="hljs-keyword">return</span> encode(text);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è¿˜åŸè¢«è½¬ä¹‰çš„HTMLç‰¹æ®Šå­—ç¬¦</span><br><span class="hljs-comment">     * </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> content åŒ…å«è½¬ä¹‰ç¬¦çš„HTMLå†…å®¹</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> è½¬æ¢åçš„å­—ç¬¦ä¸²</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">unescape</span><span class="hljs-params">(String content)</span><br>    &#123;<br>        <span class="hljs-keyword">return</span> decode(content);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ¸…é™¤æ‰€æœ‰HTMLæ ‡ç­¾ï¼Œä½†æ˜¯ä¸åˆ é™¤æ ‡ç­¾å†…çš„å†…å®¹</span><br><span class="hljs-comment">     * </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> content æ–‡æœ¬</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æ¸…é™¤æ ‡ç­¾åçš„æ–‡æœ¬</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">clean</span><span class="hljs-params">(String content)</span><br>    &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HTMLFilter</span>().filter(content);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Escapeç¼–ç </span><br><span class="hljs-comment">     * </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> text è¢«ç¼–ç çš„æ–‡æœ¬</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> ç¼–ç åçš„å­—ç¬¦</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">encode</span><span class="hljs-params">(String text)</span><br>    &#123;<br>        <span class="hljs-keyword">if</span> (StringUtils.isEmpty(text))<br>        &#123;<br>            <span class="hljs-keyword">return</span> StringUtils.EMPTY;<br>        &#125;<br><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">tmp</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>(text.length() * <span class="hljs-number">6</span>);<br>        <span class="hljs-type">char</span> c;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; text.length(); i++)<br>        &#123;<br>            c = text.charAt(i);<br>            <span class="hljs-keyword">if</span> (c &lt; <span class="hljs-number">256</span>)<br>            &#123;<br>                tmp.append(<span class="hljs-string">&quot;%&quot;</span>);<br>                <span class="hljs-keyword">if</span> (c &lt; <span class="hljs-number">16</span>)<br>                &#123;<br>                    tmp.append(<span class="hljs-string">&quot;0&quot;</span>);<br>                &#125;<br>                tmp.append(Integer.toString(c, <span class="hljs-number">16</span>));<br>            &#125;<br>            <span class="hljs-keyword">else</span><br>            &#123;<br>                tmp.append(<span class="hljs-string">&quot;%u&quot;</span>);<br>                <span class="hljs-keyword">if</span> (c &lt;= <span class="hljs-number">0xfff</span>)<br>                &#123;<br>                    <span class="hljs-comment">// issue#I49JU8@Gitee</span><br>                    tmp.append(<span class="hljs-string">&quot;0&quot;</span>);<br>                &#125;<br>                tmp.append(Integer.toString(c, <span class="hljs-number">16</span>));<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> tmp.toString();<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Escapeè§£ç </span><br><span class="hljs-comment">     * </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> content è¢«è½¬ä¹‰çš„å†…å®¹</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> è§£ç åçš„å­—ç¬¦ä¸²</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">decode</span><span class="hljs-params">(String content)</span><br>    &#123;<br>        <span class="hljs-keyword">if</span> (StringUtils.isEmpty(content))<br>        &#123;<br>            <span class="hljs-keyword">return</span> content;<br>        &#125;<br><br>        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">tmp</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>(content.length());<br>        <span class="hljs-type">int</span> <span class="hljs-variable">lastPos</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>, pos = <span class="hljs-number">0</span>;<br>        <span class="hljs-type">char</span> ch;<br>        <span class="hljs-keyword">while</span> (lastPos &lt; content.length())<br>        &#123;<br>            pos = content.indexOf(<span class="hljs-string">&quot;%&quot;</span>, lastPos);<br>            <span class="hljs-keyword">if</span> (pos == lastPos)<br>            &#123;<br>                <span class="hljs-keyword">if</span> (content.charAt(pos + <span class="hljs-number">1</span>) == <span class="hljs-string">&#x27;u&#x27;</span>)<br>                &#123;<br>                    ch = (<span class="hljs-type">char</span>) Integer.parseInt(content.substring(pos + <span class="hljs-number">2</span>, pos + <span class="hljs-number">6</span>), <span class="hljs-number">16</span>);<br>                    tmp.append(ch);<br>                    lastPos = pos + <span class="hljs-number">6</span>;<br>                &#125;<br>                <span class="hljs-keyword">else</span><br>                &#123;<br>                    ch = (<span class="hljs-type">char</span>) Integer.parseInt(content.substring(pos + <span class="hljs-number">1</span>, pos + <span class="hljs-number">3</span>), <span class="hljs-number">16</span>);<br>                    tmp.append(ch);<br>                    lastPos = pos + <span class="hljs-number">3</span>;<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">else</span><br>            &#123;<br>                <span class="hljs-keyword">if</span> (pos == -<span class="hljs-number">1</span>)<br>                &#123;<br>                    tmp.append(content.substring(lastPos));<br>                    lastPos = content.length();<br>                &#125;<br>                <span class="hljs-keyword">else</span><br>                &#123;<br>                    tmp.append(content.substring(lastPos, pos));<br>                    lastPos = pos;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> tmp.toString();<br>    &#125;<br>&#125;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HTMLFilter</span><br>&#123;<br>   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * regex flag union representing /si modifiers in php</span><br><span class="hljs-comment">    **/</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">REGEX_FLAGS_SI</span> <span class="hljs-operator">=</span> Pattern.CASE_INSENSITIVE | Pattern.DOTALL;<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_COMMENTS</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;&lt;!--(.*?)--&gt;&quot;</span>, Pattern.DOTALL);<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_COMMENT</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;^!--(.*)--$&quot;</span>, REGEX_FLAGS_SI);<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_TAGS</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;&lt;(.*?)&gt;&quot;</span>, Pattern.DOTALL);<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_END_TAG</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;^/([a-z0-9]+)&quot;</span>, REGEX_FLAGS_SI);<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_START_TAG</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;^([a-z0-9]+)(.*?)(/?)$&quot;</span>, REGEX_FLAGS_SI);<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_QUOTED_ATTRIBUTES</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;([a-z0-9]+)=([\&quot;&#x27;])(.*?)\\2&quot;</span>, REGEX_FLAGS_SI);<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_UNQUOTED_ATTRIBUTES</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;([a-z0-9]+)(=)([^\&quot;\\s&#x27;]+)&quot;</span>, REGEX_FLAGS_SI);<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_PROTOCOL</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;^([^:]+):&quot;</span>, REGEX_FLAGS_SI);<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_ENTITY</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;&amp;#(\\d+);?&quot;</span>);<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_ENTITY_UNICODE</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;&amp;#x([0-9a-f]+);?&quot;</span>);<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_ENCODE</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;%([0-9a-f]&#123;2&#125;);?&quot;</span>);<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_VALID_ENTITIES</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;&amp;([^&amp;;]*)(?=(;|&amp;|$))&quot;</span>);<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_VALID_QUOTES</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;(&gt;|^)([^&lt;]+?)(&lt;|$)&quot;</span>, Pattern.DOTALL);<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_END_ARROW</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;^&gt;&quot;</span>);<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_BODY_TO_END</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;&lt;([^&gt;]*?)(?=&lt;|$)&quot;</span>);<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_XML_CONTENT</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;(^|&gt;)([^&lt;]*?)(?=&gt;)&quot;</span>);<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_STRAY_LEFT_ARROW</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;&lt;([^&gt;]*?)(?=&lt;|$)&quot;</span>);<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_STRAY_RIGHT_ARROW</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;(^|&gt;)([^&lt;]*?)(?=&gt;)&quot;</span>);<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_AMP</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;&amp;&quot;</span>);<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_QUOTE</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;\&quot;&quot;</span>);<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_LEFT_ARROW</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;&lt;&quot;</span>);<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_RIGHT_ARROW</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;&gt;&quot;</span>);<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">P_BOTH_ARROWS</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">&quot;&lt;&gt;&quot;</span>);<br><br>   <span class="hljs-comment">// @xxx could grow large... maybe use sesat&#x27;s ReferenceMap</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ConcurrentMap&lt;String, Pattern&gt; P_REMOVE_PAIR_BLANKS = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ConcurrentMap&lt;String, Pattern&gt; P_REMOVE_SELF_BLANKS = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();<br><br>   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * set of allowed html elements, along with allowed attributes for each element</span><br><span class="hljs-comment">    **/</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;String, List&lt;String&gt;&gt; vAllowed;<br>   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * counts of open tags for each (allowable) html element</span><br><span class="hljs-comment">    **/</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;String, Integer&gt; vTagCounts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br><br>   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * html elements which must always be self-closing (e.g. &quot;&lt;img /&gt;&quot;)</span><br><span class="hljs-comment">    **/</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String[] vSelfClosingTags;<br>   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * html elements which must always have separate opening and closing tags (e.g. &quot;&lt;b&gt;&lt;/b&gt;&quot;)</span><br><span class="hljs-comment">    **/</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String[] vNeedClosingTags;<br>   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * set of disallowed html elements</span><br><span class="hljs-comment">    **/</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String[] vDisallowed;<br>   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * attributes which should be checked for valid protocols</span><br><span class="hljs-comment">    **/</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String[] vProtocolAtts;<br>   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * allowed protocols</span><br><span class="hljs-comment">    **/</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String[] vAllowedProtocols;<br>   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * tags which should be removed if they contain no content (e.g. &quot;&lt;b&gt;&lt;/b&gt;&quot; or &quot;&lt;b /&gt;&quot;)</span><br><span class="hljs-comment">    **/</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String[] vRemoveBlanks;<br>   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * entities allowed within html markup</span><br><span class="hljs-comment">    **/</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String[] vAllowedEntities;<br>   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * flag determining whether comments are allowed in input String.</span><br><span class="hljs-comment">    */</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> stripComment;<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> encodeQuotes;<br>   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * flag determining whether to try to make tags when presented with &quot;unbalanced&quot; angle brackets (e.g. &quot;&lt;b text &lt;/b&gt;&quot;</span><br><span class="hljs-comment">    * becomes &quot;&lt;b&gt; text &lt;/b&gt;&quot;). If set to false, unbalanced angle brackets will be html escaped.</span><br><span class="hljs-comment">    */</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> alwaysMakeTags;<br><br>   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * Default constructor.</span><br><span class="hljs-comment">    */</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">HTMLFilter</span><span class="hljs-params">()</span><br>   &#123;<br>      vAllowed = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br><br>      <span class="hljs-keyword">final</span> ArrayList&lt;String&gt; a_atts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>      a_atts.add(<span class="hljs-string">&quot;href&quot;</span>);<br>      a_atts.add(<span class="hljs-string">&quot;target&quot;</span>);<br>      vAllowed.put(<span class="hljs-string">&quot;a&quot;</span>, a_atts);<br><br>      <span class="hljs-keyword">final</span> ArrayList&lt;String&gt; img_atts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>      img_atts.add(<span class="hljs-string">&quot;src&quot;</span>);<br>      img_atts.add(<span class="hljs-string">&quot;width&quot;</span>);<br>      img_atts.add(<span class="hljs-string">&quot;height&quot;</span>);<br>      img_atts.add(<span class="hljs-string">&quot;alt&quot;</span>);<br>      vAllowed.put(<span class="hljs-string">&quot;img&quot;</span>, img_atts);<br><br>      <span class="hljs-keyword">final</span> ArrayList&lt;String&gt; no_atts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>      vAllowed.put(<span class="hljs-string">&quot;b&quot;</span>, no_atts);<br>      vAllowed.put(<span class="hljs-string">&quot;strong&quot;</span>, no_atts);<br>      vAllowed.put(<span class="hljs-string">&quot;i&quot;</span>, no_atts);<br>      vAllowed.put(<span class="hljs-string">&quot;em&quot;</span>, no_atts);<br><br>      vSelfClosingTags = <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[] &#123; <span class="hljs-string">&quot;img&quot;</span> &#125;;<br>      vNeedClosingTags = <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[] &#123; <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;strong&quot;</span>, <span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-string">&quot;em&quot;</span> &#125;;<br>      vDisallowed = <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[] &#123;&#125;;<br>      vAllowedProtocols = <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[] &#123; <span class="hljs-string">&quot;http&quot;</span>, <span class="hljs-string">&quot;mailto&quot;</span>, <span class="hljs-string">&quot;https&quot;</span> &#125;; <span class="hljs-comment">// no ftp.</span><br>      vProtocolAtts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[] &#123; <span class="hljs-string">&quot;src&quot;</span>, <span class="hljs-string">&quot;href&quot;</span> &#125;;<br>      vRemoveBlanks = <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[] &#123; <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;strong&quot;</span>, <span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-string">&quot;em&quot;</span> &#125;;<br>      vAllowedEntities = <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[] &#123; <span class="hljs-string">&quot;amp&quot;</span>, <span class="hljs-string">&quot;gt&quot;</span>, <span class="hljs-string">&quot;lt&quot;</span>, <span class="hljs-string">&quot;quot&quot;</span> &#125;;<br>      stripComment = <span class="hljs-literal">true</span>;<br>      encodeQuotes = <span class="hljs-literal">true</span>;<br>      alwaysMakeTags = <span class="hljs-literal">false</span>;<br>   &#125;<br><br>   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * Map-parameter configurable constructor.</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> conf map containing configuration. keys match field names.</span><br><span class="hljs-comment">    */</span><br>   <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">HTMLFilter</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Map&lt;String, Object&gt; conf)</span><br>   &#123;<br><br>      <span class="hljs-keyword">assert</span> conf.containsKey(<span class="hljs-string">&quot;vAllowed&quot;</span>) : <span class="hljs-string">&quot;configuration requires vAllowed&quot;</span>;<br>      <span class="hljs-keyword">assert</span> conf.containsKey(<span class="hljs-string">&quot;vSelfClosingTags&quot;</span>) : <span class="hljs-string">&quot;configuration requires vSelfClosingTags&quot;</span>;<br>      <span class="hljs-keyword">assert</span> conf.containsKey(<span class="hljs-string">&quot;vNeedClosingTags&quot;</span>) : <span class="hljs-string">&quot;configuration requires vNeedClosingTags&quot;</span>;<br>      <span class="hljs-keyword">assert</span> conf.containsKey(<span class="hljs-string">&quot;vDisallowed&quot;</span>) : <span class="hljs-string">&quot;configuration requires vDisallowed&quot;</span>;<br>      <span class="hljs-keyword">assert</span> conf.containsKey(<span class="hljs-string">&quot;vAllowedProtocols&quot;</span>) : <span class="hljs-string">&quot;configuration requires vAllowedProtocols&quot;</span>;<br>      <span class="hljs-keyword">assert</span> conf.containsKey(<span class="hljs-string">&quot;vProtocolAtts&quot;</span>) : <span class="hljs-string">&quot;configuration requires vProtocolAtts&quot;</span>;<br>      <span class="hljs-keyword">assert</span> conf.containsKey(<span class="hljs-string">&quot;vRemoveBlanks&quot;</span>) : <span class="hljs-string">&quot;configuration requires vRemoveBlanks&quot;</span>;<br>      <span class="hljs-keyword">assert</span> conf.containsKey(<span class="hljs-string">&quot;vAllowedEntities&quot;</span>) : <span class="hljs-string">&quot;configuration requires vAllowedEntities&quot;</span>;<br><br>      vAllowed = Collections.unmodifiableMap((HashMap&lt;String, List&lt;String&gt;&gt;) conf.get(<span class="hljs-string">&quot;vAllowed&quot;</span>));<br>      vSelfClosingTags = (String[]) conf.get(<span class="hljs-string">&quot;vSelfClosingTags&quot;</span>);<br>      vNeedClosingTags = (String[]) conf.get(<span class="hljs-string">&quot;vNeedClosingTags&quot;</span>);<br>      vDisallowed = (String[]) conf.get(<span class="hljs-string">&quot;vDisallowed&quot;</span>);<br>      vAllowedProtocols = (String[]) conf.get(<span class="hljs-string">&quot;vAllowedProtocols&quot;</span>);<br>      vProtocolAtts = (String[]) conf.get(<span class="hljs-string">&quot;vProtocolAtts&quot;</span>);<br>      vRemoveBlanks = (String[]) conf.get(<span class="hljs-string">&quot;vRemoveBlanks&quot;</span>);<br>      vAllowedEntities = (String[]) conf.get(<span class="hljs-string">&quot;vAllowedEntities&quot;</span>);<br>      stripComment = conf.containsKey(<span class="hljs-string">&quot;stripComment&quot;</span>) ? (Boolean) conf.get(<span class="hljs-string">&quot;stripComment&quot;</span>) : <span class="hljs-literal">true</span>;<br>      encodeQuotes = conf.containsKey(<span class="hljs-string">&quot;encodeQuotes&quot;</span>) ? (Boolean) conf.get(<span class="hljs-string">&quot;encodeQuotes&quot;</span>) : <span class="hljs-literal">true</span>;<br>      alwaysMakeTags = conf.containsKey(<span class="hljs-string">&quot;alwaysMakeTags&quot;</span>) ? (Boolean) conf.get(<span class="hljs-string">&quot;alwaysMakeTags&quot;</span>) : <span class="hljs-literal">true</span>;<br>   &#125;<br><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reset</span><span class="hljs-params">()</span><br>   &#123;<br>      vTagCounts.clear();<br>   &#125;<br><br>   <span class="hljs-comment">// ---------------------------------------------------------------</span><br>   <span class="hljs-comment">// my versions of some PHP library functions</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">chr</span><span class="hljs-params">(<span class="hljs-keyword">final</span> <span class="hljs-type">int</span> decimal)</span><br>   &#123;<br>      <span class="hljs-keyword">return</span> String.valueOf((<span class="hljs-type">char</span>) decimal);<br>   &#125;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">htmlSpecialChars</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String s)</span><br>   &#123;<br>      <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> s;<br>      result = regexReplace(P_AMP, <span class="hljs-string">&quot;&amp;amp;&quot;</span>, result);<br>      result = regexReplace(P_QUOTE, <span class="hljs-string">&quot;&amp;quot;&quot;</span>, result);<br>      result = regexReplace(P_LEFT_ARROW, <span class="hljs-string">&quot;&amp;lt;&quot;</span>, result);<br>      result = regexReplace(P_RIGHT_ARROW, <span class="hljs-string">&quot;&amp;gt;&quot;</span>, result);<br>      <span class="hljs-keyword">return</span> result;<br>   &#125;<br><br>   <span class="hljs-comment">// ---------------------------------------------------------------</span><br><br>   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * given a user submitted input String, filter out any invalid or restricted html.</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@param</span> input text (i.e. submitted by a user) than may contain html</span><br><span class="hljs-comment">    * <span class="hljs-doctag">@return</span> &quot;clean&quot; version of input, with only valid, whitelisted html elements allowed</span><br><span class="hljs-comment">    */</span><br>   <span class="hljs-keyword">public</span> String <span class="hljs-title function_">filter</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String input)</span><br>   &#123;<br>      reset();<br>      <span class="hljs-type">String</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> input;<br><br>      s = escapeComments(s);<br><br>      s = balanceHTML(s);<br><br>      s = checkTags(s);<br><br>      s = processRemoveBlanks(s);<br><br>      <span class="hljs-comment">// s = validateEntities(s);</span><br><br>      <span class="hljs-keyword">return</span> s;<br>   &#125;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isAlwaysMakeTags</span><span class="hljs-params">()</span><br>   &#123;<br>      <span class="hljs-keyword">return</span> alwaysMakeTags;<br>   &#125;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isStripComments</span><span class="hljs-params">()</span><br>   &#123;<br>      <span class="hljs-keyword">return</span> stripComment;<br>   &#125;<br><br>   <span class="hljs-keyword">private</span> String <span class="hljs-title function_">escapeComments</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String s)</span><br>   &#123;<br>      <span class="hljs-keyword">final</span> <span class="hljs-type">Matcher</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> P_COMMENTS.matcher(s);<br>      <span class="hljs-keyword">final</span> <span class="hljs-type">StringBuffer</span> <span class="hljs-variable">buf</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuffer</span>();<br>      <span class="hljs-keyword">if</span> (m.find())<br>      &#123;<br>         <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">match</span> <span class="hljs-operator">=</span> m.group(<span class="hljs-number">1</span>); <span class="hljs-comment">// (.*?)</span><br>         m.appendReplacement(buf, Matcher.quoteReplacement(<span class="hljs-string">&quot;&lt;!--&quot;</span> + htmlSpecialChars(match) + <span class="hljs-string">&quot;--&gt;&quot;</span>));<br>      &#125;<br>      m.appendTail(buf);<br><br>      <span class="hljs-keyword">return</span> buf.toString();<br>   &#125;<br><br>   <span class="hljs-keyword">private</span> String <span class="hljs-title function_">balanceHTML</span><span class="hljs-params">(String s)</span><br>   &#123;<br>      <span class="hljs-keyword">if</span> (alwaysMakeTags)<br>      &#123;<br>         <span class="hljs-comment">//</span><br>         <span class="hljs-comment">// try and form html</span><br>         <span class="hljs-comment">//</span><br>         s = regexReplace(P_END_ARROW, <span class="hljs-string">&quot;&quot;</span>, s);<br>         <span class="hljs-comment">// ä¸è¿½åŠ ç»“æŸæ ‡ç­¾</span><br>         s = regexReplace(P_BODY_TO_END, <span class="hljs-string">&quot;&lt;$1&gt;&quot;</span>, s);<br>         s = regexReplace(P_XML_CONTENT, <span class="hljs-string">&quot;$1&lt;$2&quot;</span>, s);<br><br>      &#125;<br>      <span class="hljs-keyword">else</span><br>      &#123;<br>         <span class="hljs-comment">//</span><br>         <span class="hljs-comment">// escape stray brackets</span><br>         <span class="hljs-comment">//</span><br>         s = regexReplace(P_STRAY_LEFT_ARROW, <span class="hljs-string">&quot;&amp;lt;$1&quot;</span>, s);<br>         s = regexReplace(P_STRAY_RIGHT_ARROW, <span class="hljs-string">&quot;$1$2&amp;gt;&lt;&quot;</span>, s);<br><br>         <span class="hljs-comment">//</span><br>         <span class="hljs-comment">// the last regexp causes &#x27;&lt;&gt;&#x27; entities to appear</span><br>         <span class="hljs-comment">// (we need to do a lookahead assertion so that the last bracket can</span><br>         <span class="hljs-comment">// be used in the next pass of the regexp)</span><br>         <span class="hljs-comment">//</span><br>         s = regexReplace(P_BOTH_ARROWS, <span class="hljs-string">&quot;&quot;</span>, s);<br>      &#125;<br><br>      <span class="hljs-keyword">return</span> s;<br>   &#125;<br><br>   <span class="hljs-keyword">private</span> String <span class="hljs-title function_">checkTags</span><span class="hljs-params">(String s)</span><br>   &#123;<br>      <span class="hljs-type">Matcher</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> P_TAGS.matcher(s);<br><br>      <span class="hljs-keyword">final</span> <span class="hljs-type">StringBuffer</span> <span class="hljs-variable">buf</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuffer</span>();<br>      <span class="hljs-keyword">while</span> (m.find())<br>      &#123;<br>         <span class="hljs-type">String</span> <span class="hljs-variable">replaceStr</span> <span class="hljs-operator">=</span> m.group(<span class="hljs-number">1</span>);<br>         replaceStr = processTag(replaceStr);<br>         m.appendReplacement(buf, Matcher.quoteReplacement(replaceStr));<br>      &#125;<br>      m.appendTail(buf);<br><br>      <span class="hljs-comment">// these get tallied in processTag</span><br>      <span class="hljs-comment">// (remember to reset before subsequent calls to filter method)</span><br>      <span class="hljs-keyword">final</span> <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sBuilder</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>(buf.toString());<br>      <span class="hljs-keyword">for</span> (String key : vTagCounts.keySet())<br>      &#123;<br>         <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">ii</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; ii &lt; vTagCounts.get(key); ii++)<br>         &#123;<br>            sBuilder.append(<span class="hljs-string">&quot;&lt;/&quot;</span>).append(key).append(<span class="hljs-string">&quot;&gt;&quot;</span>);<br>         &#125;<br>      &#125;<br>      s = sBuilder.toString();<br><br>      <span class="hljs-keyword">return</span> s;<br>   &#125;<br><br>   <span class="hljs-keyword">private</span> String <span class="hljs-title function_">processRemoveBlanks</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String s)</span><br>   &#123;<br>      <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> s;<br>      <span class="hljs-keyword">for</span> (String tag : vRemoveBlanks)<br>      &#123;<br>         <span class="hljs-keyword">if</span> (!P_REMOVE_PAIR_BLANKS.containsKey(tag))<br>         &#123;<br>            P_REMOVE_PAIR_BLANKS.putIfAbsent(tag, Pattern.compile(<span class="hljs-string">&quot;&lt;&quot;</span> + tag + <span class="hljs-string">&quot;(\\s[^&gt;]*)?&gt;&lt;/&quot;</span> + tag + <span class="hljs-string">&quot;&gt;&quot;</span>));<br>         &#125;<br>         result = regexReplace(P_REMOVE_PAIR_BLANKS.get(tag), <span class="hljs-string">&quot;&quot;</span>, result);<br>         <span class="hljs-keyword">if</span> (!P_REMOVE_SELF_BLANKS.containsKey(tag))<br>         &#123;<br>            P_REMOVE_SELF_BLANKS.putIfAbsent(tag, Pattern.compile(<span class="hljs-string">&quot;&lt;&quot;</span> + tag + <span class="hljs-string">&quot;(\\s[^&gt;]*)?/&gt;&quot;</span>));<br>         &#125;<br>         result = regexReplace(P_REMOVE_SELF_BLANKS.get(tag), <span class="hljs-string">&quot;&quot;</span>, result);<br>      &#125;<br><br>      <span class="hljs-keyword">return</span> result;<br>   &#125;<br><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">regexReplace</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Pattern regex_pattern, <span class="hljs-keyword">final</span> String replacement, <span class="hljs-keyword">final</span> String s)</span><br>   &#123;<br>      <span class="hljs-type">Matcher</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> regex_pattern.matcher(s);<br>      <span class="hljs-keyword">return</span> m.replaceAll(replacement);<br>   &#125;<br><br>   <span class="hljs-keyword">private</span> String <span class="hljs-title function_">processTag</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String s)</span><br>   &#123;<br>      <span class="hljs-comment">// ending tags</span><br>      <span class="hljs-type">Matcher</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> P_END_TAG.matcher(s);<br>      <span class="hljs-keyword">if</span> (m.find())<br>      &#123;<br>         <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> m.group(<span class="hljs-number">1</span>).toLowerCase();<br>         <span class="hljs-keyword">if</span> (allowed(name))<br>         &#123;<br>            <span class="hljs-keyword">if</span> (!inArray(name, vSelfClosingTags))<br>            &#123;<br>               <span class="hljs-keyword">if</span> (vTagCounts.containsKey(name))<br>               &#123;<br>                  vTagCounts.put(name, vTagCounts.get(name) - <span class="hljs-number">1</span>);<br>                  <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&lt;/&quot;</span> + name + <span class="hljs-string">&quot;&gt;&quot;</span>;<br>               &#125;<br>            &#125;<br>         &#125;<br>      &#125;<br><br>      <span class="hljs-comment">// starting tags</span><br>      m = P_START_TAG.matcher(s);<br>      <span class="hljs-keyword">if</span> (m.find())<br>      &#123;<br>         <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> m.group(<span class="hljs-number">1</span>).toLowerCase();<br>         <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">body</span> <span class="hljs-operator">=</span> m.group(<span class="hljs-number">2</span>);<br>         <span class="hljs-type">String</span> <span class="hljs-variable">ending</span> <span class="hljs-operator">=</span> m.group(<span class="hljs-number">3</span>);<br><br>         <span class="hljs-comment">// debug( &quot;in a starting tag, name=&#x27;&quot; + name + &quot;&#x27;; body=&#x27;&quot; + body + &quot;&#x27;; ending=&#x27;&quot; + ending + &quot;&#x27;&quot; );</span><br>         <span class="hljs-keyword">if</span> (allowed(name))<br>         &#123;<br>            <span class="hljs-keyword">final</span> <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">params</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br><br>            <span class="hljs-keyword">final</span> <span class="hljs-type">Matcher</span> <span class="hljs-variable">m2</span> <span class="hljs-operator">=</span> P_QUOTED_ATTRIBUTES.matcher(body);<br>            <span class="hljs-keyword">final</span> <span class="hljs-type">Matcher</span> <span class="hljs-variable">m3</span> <span class="hljs-operator">=</span> P_UNQUOTED_ATTRIBUTES.matcher(body);<br>            <span class="hljs-keyword">final</span> List&lt;String&gt; paramNames = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>            <span class="hljs-keyword">final</span> List&lt;String&gt; paramValues = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>            <span class="hljs-keyword">while</span> (m2.find())<br>            &#123;<br>               paramNames.add(m2.group(<span class="hljs-number">1</span>)); <span class="hljs-comment">// ([a-z0-9]+)</span><br>               paramValues.add(m2.group(<span class="hljs-number">3</span>)); <span class="hljs-comment">// (.*?)</span><br>            &#125;<br>            <span class="hljs-keyword">while</span> (m3.find())<br>            &#123;<br>               paramNames.add(m3.group(<span class="hljs-number">1</span>)); <span class="hljs-comment">// ([a-z0-9]+)</span><br>               paramValues.add(m3.group(<span class="hljs-number">3</span>)); <span class="hljs-comment">// ([^\&quot;\\s&#x27;]+)</span><br>            &#125;<br><br>            String paramName, paramValue;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">ii</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; ii &lt; paramNames.size(); ii++)<br>            &#123;<br>               paramName = paramNames.get(ii).toLowerCase();<br>               paramValue = paramValues.get(ii);<br><br>               <span class="hljs-comment">// debug( &quot;paramName=&#x27;&quot; + paramName + &quot;&#x27;&quot; );</span><br>               <span class="hljs-comment">// debug( &quot;paramValue=&#x27;&quot; + paramValue + &quot;&#x27;&quot; );</span><br>               <span class="hljs-comment">// debug( &quot;allowed? &quot; + vAllowed.get( name ).contains( paramName ) );</span><br><br>               <span class="hljs-keyword">if</span> (allowedAttribute(name, paramName))<br>               &#123;<br>                  <span class="hljs-keyword">if</span> (inArray(paramName, vProtocolAtts))<br>                  &#123;<br>                     paramValue = processParamProtocol(paramValue);<br>                  &#125;<br>                  params.append(<span class="hljs-string">&#x27; &#x27;</span>).append(paramName).append(<span class="hljs-string">&quot;=\\\&quot;&quot;</span>).append(paramValue).append(<span class="hljs-string">&quot;\\\&quot;&quot;</span>);<br>               &#125;<br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (inArray(name, vSelfClosingTags))<br>            &#123;<br>               ending = <span class="hljs-string">&quot; /&quot;</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (inArray(name, vNeedClosingTags))<br>            &#123;<br>               ending = <span class="hljs-string">&quot;&quot;</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (ending == <span class="hljs-literal">null</span> || ending.length() &lt; <span class="hljs-number">1</span>)<br>            &#123;<br>               <span class="hljs-keyword">if</span> (vTagCounts.containsKey(name))<br>               &#123;<br>                  vTagCounts.put(name, vTagCounts.get(name) + <span class="hljs-number">1</span>);<br>               &#125;<br>               <span class="hljs-keyword">else</span><br>               &#123;<br>                  vTagCounts.put(name, <span class="hljs-number">1</span>);<br>               &#125;<br>            &#125;<br>            <span class="hljs-keyword">else</span><br>            &#123;<br>               ending = <span class="hljs-string">&quot; /&quot;</span>;<br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&lt;&quot;</span> + name + params + ending + <span class="hljs-string">&quot;&gt;&quot;</span>;<br>         &#125;<br>         <span class="hljs-keyword">else</span><br>         &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>         &#125;<br>      &#125;<br><br>      <span class="hljs-comment">// comments</span><br>      m = P_COMMENT.matcher(s);<br>      <span class="hljs-keyword">if</span> (!stripComment &amp;&amp; m.find())<br>      &#123;<br>         <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&lt;&quot;</span> + m.group() + <span class="hljs-string">&quot;&gt;&quot;</span>;<br>      &#125;<br><br>      <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>   &#125;<br><br>   <span class="hljs-keyword">private</span> String <span class="hljs-title function_">processParamProtocol</span><span class="hljs-params">(String s)</span><br>   &#123;<br>      s = decodeEntities(s);<br>      <span class="hljs-keyword">final</span> <span class="hljs-type">Matcher</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> P_PROTOCOL.matcher(s);<br>      <span class="hljs-keyword">if</span> (m.find())<br>      &#123;<br>         <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">protocol</span> <span class="hljs-operator">=</span> m.group(<span class="hljs-number">1</span>);<br>         <span class="hljs-keyword">if</span> (!inArray(protocol, vAllowedProtocols))<br>         &#123;<br>            <span class="hljs-comment">// bad protocol, turn into local anchor link instead</span><br>            s = <span class="hljs-string">&quot;#&quot;</span> + s.substring(protocol.length() + <span class="hljs-number">1</span>);<br>            <span class="hljs-keyword">if</span> (s.startsWith(<span class="hljs-string">&quot;#//&quot;</span>))<br>            &#123;<br>               s = <span class="hljs-string">&quot;#&quot;</span> + s.substring(<span class="hljs-number">3</span>);<br>            &#125;<br>         &#125;<br>      &#125;<br><br>      <span class="hljs-keyword">return</span> s;<br>   &#125;<br><br>   <span class="hljs-keyword">private</span> String <span class="hljs-title function_">decodeEntities</span><span class="hljs-params">(String s)</span><br>   &#123;<br>      <span class="hljs-type">StringBuffer</span> <span class="hljs-variable">buf</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuffer</span>();<br><br>      <span class="hljs-type">Matcher</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> P_ENTITY.matcher(s);<br>      <span class="hljs-keyword">while</span> (m.find())<br>      &#123;<br>         <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">match</span> <span class="hljs-operator">=</span> m.group(<span class="hljs-number">1</span>);<br>         <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">decimal</span> <span class="hljs-operator">=</span> Integer.decode(match).intValue();<br>         m.appendReplacement(buf, Matcher.quoteReplacement(chr(decimal)));<br>      &#125;<br>      m.appendTail(buf);<br>      s = buf.toString();<br><br>      buf = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuffer</span>();<br>      m = P_ENTITY_UNICODE.matcher(s);<br>      <span class="hljs-keyword">while</span> (m.find())<br>      &#123;<br>         <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">match</span> <span class="hljs-operator">=</span> m.group(<span class="hljs-number">1</span>);<br>         <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">decimal</span> <span class="hljs-operator">=</span> Integer.valueOf(match, <span class="hljs-number">16</span>).intValue();<br>         m.appendReplacement(buf, Matcher.quoteReplacement(chr(decimal)));<br>      &#125;<br>      m.appendTail(buf);<br>      s = buf.toString();<br><br>      buf = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuffer</span>();<br>      m = P_ENCODE.matcher(s);<br>      <span class="hljs-keyword">while</span> (m.find())<br>      &#123;<br>         <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">match</span> <span class="hljs-operator">=</span> m.group(<span class="hljs-number">1</span>);<br>         <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">decimal</span> <span class="hljs-operator">=</span> Integer.valueOf(match, <span class="hljs-number">16</span>).intValue();<br>         m.appendReplacement(buf, Matcher.quoteReplacement(chr(decimal)));<br>      &#125;<br>      m.appendTail(buf);<br>      s = buf.toString();<br><br>      s = validateEntities(s);<br>      <span class="hljs-keyword">return</span> s;<br>   &#125;<br><br>   <span class="hljs-keyword">private</span> String <span class="hljs-title function_">validateEntities</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String s)</span><br>   &#123;<br>      <span class="hljs-type">StringBuffer</span> <span class="hljs-variable">buf</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuffer</span>();<br><br>      <span class="hljs-comment">// validate entities throughout the string</span><br>      <span class="hljs-type">Matcher</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> P_VALID_ENTITIES.matcher(s);<br>      <span class="hljs-keyword">while</span> (m.find())<br>      &#123;<br>         <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">one</span> <span class="hljs-operator">=</span> m.group(<span class="hljs-number">1</span>); <span class="hljs-comment">// ([^&amp;;]*)</span><br>         <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">two</span> <span class="hljs-operator">=</span> m.group(<span class="hljs-number">2</span>); <span class="hljs-comment">// (?=(;|&amp;|$))</span><br>         m.appendReplacement(buf, Matcher.quoteReplacement(checkEntity(one, two)));<br>      &#125;<br>      m.appendTail(buf);<br><br>      <span class="hljs-keyword">return</span> encodeQuotes(buf.toString());<br>   &#125;<br><br>   <span class="hljs-keyword">private</span> String <span class="hljs-title function_">encodeQuotes</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String s)</span><br>   &#123;<br>      <span class="hljs-keyword">if</span> (encodeQuotes)<br>      &#123;<br>         <span class="hljs-type">StringBuffer</span> <span class="hljs-variable">buf</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuffer</span>();<br>         <span class="hljs-type">Matcher</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> P_VALID_QUOTES.matcher(s);<br>         <span class="hljs-keyword">while</span> (m.find())<br>         &#123;<br>            <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">one</span> <span class="hljs-operator">=</span> m.group(<span class="hljs-number">1</span>); <span class="hljs-comment">// (&gt;|^)</span><br>            <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">two</span> <span class="hljs-operator">=</span> m.group(<span class="hljs-number">2</span>); <span class="hljs-comment">// ([^&lt;]+?)</span><br>            <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">three</span> <span class="hljs-operator">=</span> m.group(<span class="hljs-number">3</span>); <span class="hljs-comment">// (&lt;|$)</span><br>            <span class="hljs-comment">// ä¸æ›¿æ¢åŒå¼•å·ä¸º&amp;quot;ï¼Œé˜²æ­¢jsonæ ¼å¼æ— æ•ˆ regexReplace(P_QUOTE, &quot;&amp;quot;&quot;, two)</span><br>            m.appendReplacement(buf, Matcher.quoteReplacement(one + two + three));<br>         &#125;<br>         m.appendTail(buf);<br>         <span class="hljs-keyword">return</span> buf.toString();<br>      &#125;<br>      <span class="hljs-keyword">else</span><br>      &#123;<br>         <span class="hljs-keyword">return</span> s;<br>      &#125;<br>   &#125;<br><br>   <span class="hljs-keyword">private</span> String <span class="hljs-title function_">checkEntity</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String preamble, <span class="hljs-keyword">final</span> String term)</span><br>   &#123;<br><br>      <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;;&quot;</span>.equals(term) &amp;&amp; isValidEntity(preamble) ? <span class="hljs-string">&#x27;&amp;&#x27;</span> + preamble : <span class="hljs-string">&quot;&amp;amp;&quot;</span> + preamble;<br>   &#125;<br><br>   <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isValidEntity</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String entity)</span><br>   &#123;<br>      <span class="hljs-keyword">return</span> inArray(entity, vAllowedEntities);<br>   &#125;<br><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">inArray</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String s, <span class="hljs-keyword">final</span> String[] array)</span><br>   &#123;<br>      <span class="hljs-keyword">for</span> (String item : array)<br>      &#123;<br>         <span class="hljs-keyword">if</span> (item != <span class="hljs-literal">null</span> &amp;&amp; item.equals(s))<br>         &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>         &#125;<br>      &#125;<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>   &#125;<br><br>   <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">allowed</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String name)</span><br>   &#123;<br>      <span class="hljs-keyword">return</span> (vAllowed.isEmpty() || vAllowed.containsKey(name)) &amp;&amp; !inArray(name, vDisallowed);<br>   &#125;<br><br>   <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">allowedAttribute</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String name, <span class="hljs-keyword">final</span> String paramName)</span><br>   &#123;<br>      <span class="hljs-keyword">return</span> allowed(name) &amp;&amp; (vAllowed.isEmpty() || vAllowed.get(name).contains(paramName));<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å‰åç«¯ç»„åˆä½¿ç”¨ï¼Œå¯è§£å†³xssé—®é¢˜</p><h2 id="å®‰å…¨æ— å°äº‹ï¼ï¼ï¼"><a href="#å®‰å…¨æ— å°äº‹ï¼ï¼ï¼" class="headerlink" title="å®‰å…¨æ— å°äº‹ï¼ï¼ï¼"></a>å®‰å…¨æ— å°äº‹ï¼ï¼ï¼</h2><p><a href="https://security.tencent.com/index.php/blog/msg/53">å­˜å‚¨å‹XSSæ¼æ´è§£å†³æ–¹æ¡ˆ</a></p>]]></content>
    
    
    <categories>
      
      <category>å®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>spring</tag>
      
      <tag>å®‰å…¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç½‘ç«™ä»»æ„æ–‡ä»¶ä¸‹è½½æˆ–è¯»å–</title>
    <link href="/2023/06/20/safe-http-any-file-download/"/>
    <url>/2023/06/20/safe-http-any-file-download/</url>
    
    <content type="html"><![CDATA[<p>é¡¹ç›®ä¸­ä¸‹è½½æ–¹æ³•æ²¡æœ‰å®‰å…¨æ ¡éªŒï¼Œå¯¼è‡´è„šæœ¬æ³¨å…¥ï¼Œå¯ä»¥ä¸‹è½½æœåŠ¡å™¨ä»»æ„è·¯å¾„ä¸‹çš„æ–‡ä»¶ã€‚<br>å¯¹æ­¤æ€»ç»“äº†ä¸€ä¸‹ä¿®å¤åŠæ³•ï¼Œæ–¹ä¾¿å¤§å®¶å‚è€ƒï¼Œä¿®å¤ã€‚</p><p>ä»¥ä¸‹æ˜¯æ¼æ´çš„ä¸€äº›å†…å®¹ï¼š</p><h2 id="å®‰å…¨æ¼æ´æè¿°"><a href="#å®‰å…¨æ¼æ´æè¿°" class="headerlink" title="å®‰å…¨æ¼æ´æè¿°"></a>å®‰å…¨æ¼æ´æè¿°</h2><p>ä»»æ„æ–‡ä»¶ä¸‹è½½æˆ–è¯»å–æ¼æ´ä¸»è¦æ˜¯ç”±äºåº”ç”¨ç³»ç»Ÿåœ¨æä¾›æ–‡ä»¶ä¸‹è½½æˆ–è¯»å–åŠŸèƒ½æ—¶ï¼Œåœ¨æ–‡ä»¶è·¯å¾„å‚æ•°ä¸­ç›´æ¥æŒ‡å®šæ–‡ä»¶è·¯å¾„çš„åŒæ—¶å¹¶æ²¡æœ‰å¯¹æ–‡ä»¶è·¯å¾„çš„åˆæ³•æ€§è¿›è¡Œæ ¡éªŒï¼Œ<br>å¯¼è‡´æ”»å‡»è€…å¯é€šè¿‡ç›®å½•è·³è½¬(..\æˆ–..&#x2F;)çš„æ–¹å¼ä¸‹è½½æˆ–è¯»å–åˆ°åŸå§‹æŒ‡å®šè·¯å¾„ä¹‹å¤–çš„æ–‡ä»¶ã€‚<br>æ”»å‡»è€…æœ€ç»ˆå¯é€šè¿‡è¯¥æ¼æ´ä¸‹è½½æˆ–è¯»å–ç³»ç»Ÿä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œå¦‚æ•°æ®åº“æ–‡ä»¶ã€åº”ç”¨ç³»ç»Ÿæºä»£ç ã€å¯†ç é…ç½®ä¿¡æ¯ç­‰é‡è¦æ•æ„Ÿä¿¡æ¯ï¼Œé€ æˆç³»ç»Ÿçš„æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚</p><h3 id="é‡ç°æ–¹æ³•"><a href="#é‡ç°æ–¹æ³•" class="headerlink" title="é‡ç°æ–¹æ³•"></a>é‡ç°æ–¹æ³•</h3><p>å¯¹å­˜åœ¨æ–‡ä»¶ä¸‹è½½æˆ–æ–‡ä»¶è¯»å–åŠŸèƒ½çš„é¡µé¢è¿›è¡Œæµ‹è¯•ï¼ŒæŸ¥çœ‹æ‰€æäº¤çš„å‚æ•°ä¸­æ˜¯å¦åŒ…å«æ–‡ä»¶åæˆ–æ–‡ä»¶ç›®å½•ï¼Œå°è¯•æäº¤å‚æ•°å€¼æŸ¥çœ‹æ˜¯å¦å¯ä¸‹è½½æˆ–è¯»å–å…¶ä»–ç›®å½•çš„æ–‡ä»¶å†…å®¹ï¼›  </p><p>å¦‚ï¼š</p><p>åŸå§‹ä¸‹è½½åŠŸèƒ½è·¯å¾„ä¸º<br><a href="http://www.example.com/donwload.jsp?filename=test123456789.pdf">http://www.example.com/donwload.jsp?filename=test123456789.pdf</a></p><p>å…¶ä¸­æ–‡ä»¶è·¯å¾„å‚æ•°ä¸ºfilenameï¼Œé€šè¿‡..&#x2F;å¯¹è·¯å¾„è¿›è¡Œè·³è½¬å°è¯•ä¸‹è½½å…¶ä»–ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œä¿®æ”¹filenameå‚æ•°ä¸º..&#x2F;..&#x2F;WEB-INF&#x2F;web.xmlå°è¯•ä¸‹è½½JSPç½‘ç«™çš„é…ç½®æ–‡ä»¶ï¼ˆæµ‹è¯•è¿‡ç¨‹ä¸­éœ€é€‚å½“å¢åŠ ..&#x2F;è·³è½¬å­—ç¬¦ä¸²ï¼‰ï¼›å¦‚æäº¤<br><a href="http://www.example.com/donwload.jsp?filename=../../WEB-INF/web.xml">http://www.example.com/donwload.jsp?filename=../../WEB-INF/web.xml</a></p><p>æŸ¥çœ‹æ˜¯å¦æˆåŠŸä¸‹è½½web.xmlæ–‡ä»¶ã€‚</p><p>å¦ä¸€ç§æƒ…å†µå¦‚ä¸‹ï¼š<br><a href="http://www.example.com/donwload.jsp?filepath=uploadfile&filename=test123.pdf">http://www.example.com/donwload.jsp?filepath=uploadfile&amp;filename=test123.pdf</a><br>è¯¥åŠŸèƒ½é€šè¿‡filepathä»¥åŠfilenameæŒ‡å®šä¸‹è½½ç›®å½•ä»¥åŠä¸‹è½½æ–‡ä»¶åï¼Œå¯ä¿®æ”¹filepathå‚æ•°å€¼è¿›è¡Œè·¯å¾„è·³è½¬ï¼Œ<br>åŒæ—¶ä¿®æ”¹filenameå€¼æŒ‡å®šæ–‡ä»¶åï¼›å¦‚æäº¤<br><a href="http://www.example.com/donwload.jsp?filepath=../../WEB-INF&filename=web.xml">http://www.example.com/donwload.jsp?filepath=../../WEB-INF&amp;filename=web.xml</a></p><p>æŸ¥çœ‹æ˜¯å¦æˆåŠŸä¸‹è½½web.xmlæ–‡ä»¶ã€‚</p><h2 id="é£é™©ç­‰çº§ï¼šé«˜"><a href="#é£é™©ç­‰çº§ï¼šé«˜" class="headerlink" title="é£é™©ç­‰çº§ï¼šé«˜"></a>é£é™©ç­‰çº§ï¼šé«˜</h2><h2 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h2><p>çŸ¥é“äº†é—®é¢˜ï¼Œä¸€èˆ¬å¯ä»¥é€šè¿‡åœ¨ä»£ç å±‚çº§å¢åŠ å…³é”®å­—ç¬¦è¿‡æ»¤æ¥ä¿®å¤ã€‚<br>æ¯”å¦‚ï¼š</p><ol><li>å¯¹pathå‚æ•°è¿›è¡Œè¿‡æ»¤ï¼Œä¾æ¬¡è¿‡æ»¤â€œ.â€ã€â€œ..â€ã€â€œ&#x2F;â€ã€â€œâ€ç­‰å­—ç¬¦ã€‚</li><li>æˆ–è€…å¯¹äºä¸‹è½½æ–‡ä»¶çš„ç›®å½•åšå¥½é™åˆ¶ï¼Œåªèƒ½ä¸‹è½½æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œ</li><li>æˆ–è€…å°†è¦ä¸‹è½½çš„èµ„æºæ–‡ä»¶è·¯å¾„å­˜å…¥æ•°æ®åº“ï¼Œé™„ä»¶ä¸‹è½½æ—¶æŒ‡å®šæ•°æ®åº“ä¸­çš„idå³å¯ï¼Œidå³å¯¹åº”çš„èµ„æºã€‚<br>æœåŠ¡å™¨çº§å»ºè®®</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs code">private Pair&lt;Boolean,String&gt; checkFileAttack(String filePath) &#123;<br>    if (StringUtils.isEmpty(filePath)) &#123;<br>        return Pair.of(false, &quot;æ–‡ä»¶åä¸ºç©º&quot;);<br>    &#125;<br><br>    if (filePath.startsWith(&quot;/&quot;)) &#123;<br>        return Pair.of(false, &quot;æ–‡ä»¶åä¸èƒ½ä»¥/å¼€å§‹&quot;);<br>    &#125;<br><br>    // ç¦æ­¢æ–‡ä»¶åä¸­åŒ…å«  â€œ%00â€ï¼Œâ€œ..â€ï¼Œâ€œ./â€ï¼Œâ€œ#/â€ ï¼Œ&quot;~/&quot; , &quot;^/&quot;    Pattern pattern = Pattern.compile(&quot;(\\.\\.|~/|^/|\\./|#/|%00)&quot;);<br>    if (pattern.matcher(filePath).matches()) &#123;<br>        return Pair.of(false, &quot;æ–‡ä»¶åä¸åˆæ³•&quot;);<br>    &#125;<br><br>    if (!ArrayUtils.contains(MimeTypeUtils.DEFAULT_ALLOWED_EXTENSION, FileTypeUtils.getFileType(filePath)))<br>    &#123;<br>        return Pair.of(false, &quot;éæ³•æ ¼å¼&quot;);<br>    &#125;<br><br>    return Pair.of(true, &quot;æ ¡éªŒæˆåŠŸ&quot;);<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ–è€…ï¼Œåœ¨æœåŠ¡éƒ¨ç½²çš„æ—¶å€™ï¼Œé€šè¿‡ä¸‹é¢çš„ç›®å½•å›ºåŒ–éƒ¨ç½²è·¯å¾„ï¼Œä»¤webè¯·æ±‚ä¸èƒ½é€ƒé€¸åˆ°æ•´ä¸ªæœåŠ¡å™¨ã€‚</p><ul><li>ä½¿ç”¨chroot å‘½ä»¤ï¼Œå›ºåŒ–æœåŠ¡è·¯å¾„</li></ul><h2 id="å®‰å…¨æ— å°äº‹ï¼ï¼ï¼"><a href="#å®‰å…¨æ— å°äº‹ï¼ï¼ï¼" class="headerlink" title="å®‰å…¨æ— å°äº‹ï¼ï¼ï¼"></a>å®‰å…¨æ— å°äº‹ï¼ï¼ï¼</h2>]]></content>
    
    
    <categories>
      
      <category>å®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>spring</tag>
      
      <tag>å®‰å…¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>URLå­˜åœ¨http hostå¤´æ”»å‡»æ¼æ´çš„è§£å†³åŠæ³•</title>
    <link href="/2023/06/20/safe-http-url-header-attack/"/>
    <url>/2023/06/20/safe-http-url-header-attack/</url>
    
    <content type="html"><![CDATA[<p>é¡¹ç›®ä¸­é‡åˆ°http hostå¤´æ”»å‡»çš„è§£å†³åŠæ³•ï¼Œæ”¯æŒnginxï¼Œapache ä¸¤ç§åŠæ³•ã€‚</p><p>ä»¥ä¸‹æ˜¯æ¼æ´çš„ä¸€äº›å†…å®¹ï¼š</p><h2 id="å®‰å…¨æ¼æ´æè¿°"><a href="#å®‰å…¨æ¼æ´æè¿°" class="headerlink" title="å®‰å…¨æ¼æ´æè¿°"></a>å®‰å…¨æ¼æ´æè¿°</h2><p>ä¸ºäº†æ–¹ä¾¿çš„è·å¾—ç½‘ç«™åŸŸåï¼Œå¼€å‘äººå‘˜ä¸€èˆ¬ä¾èµ–äºHTTP Host headerã€‚ä¾‹å¦‚ï¼Œåœ¨phpé‡Œç”¨_SERVER[â€œHTTP_HOSTâ€]ã€‚<br>ä½†æ˜¯è¿™ä¸ªheaderæ˜¯ä¸å¯ä¿¡èµ–çš„ï¼Œå¦‚æœåº”ç”¨ç¨‹åºæ²¡æœ‰å¯¹host headerå€¼è¿›è¡Œå¤„ç†ï¼Œå°±æœ‰å¯èƒ½é€ æˆæ¶æ„ä»£ç çš„ä¼ å…¥ã€‚</p><p><img src="/images/tech/safe/safe-http-host-attack.png" alt="http-host-attack"></p><h2 id="é£é™©ç­‰çº§ï¼šé«˜"><a href="#é£é™©ç­‰çº§ï¼šé«˜" class="headerlink" title="é£é™©ç­‰çº§ï¼šé«˜"></a>é£é™©ç­‰çº§ï¼šé«˜</h2><h2 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h2><p>webåº”ç”¨ç¨‹åºåº”è¯¥ä½¿ç”¨SERVER_NAMEè€Œä¸æ˜¯host headerã€‚ åœ¨Apacheå’ŒNginxé‡Œå¯ä»¥é€šè¿‡è®¾ç½®ä¸€ä¸ªè™šæ‹Ÿæœºæ¥è®°å½•æ‰€æœ‰çš„éæ³•host headerã€‚<br>åœ¨Nginxé‡Œè¿˜å¯ä»¥é€šè¿‡æŒ‡å®šä¸€ä¸ªSERVER_NAMEåå•ï¼ŒApacheä¹Ÿå¯ä»¥é€šè¿‡æŒ‡å®šä¸€ä¸ªSERVER_NAMEåå•å¹¶å¼€å¯UseCanonicalNameé€‰é¡¹ã€‚</p><p>æœ¬è´¨ä¸Šå°±æ˜¯åœ¨æœåŠ¡ä¾§é‰´å®šè¯·æ±‚æ¥æºï¼Œ éæ³•æ¥æºç›´æ¥è¿‡æ»¤æ‰ã€‚</p><h3 id="nginx-è§£å†³æ–¹æ¡ˆ"><a href="#nginx-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="nginx è§£å†³æ–¹æ¡ˆ"></a>nginx è§£å†³æ–¹æ¡ˆ</h3><p>æ‰“å¼€nginxçš„ç½‘ç«™é…ç½®æ–‡ä»¶ï¼Œä¸€èˆ¬ä¸º <code>/etc/nginx/conf.d/xxx.conf</code><br>æ·»åŠ å¦‚ä¸‹é…ç½®</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">server</span> &#123;<br>    <span class="hljs-attribute">listen</span>       <span class="hljs-number">80</span>;<br>    <span class="hljs-attribute">server_name</span>  <span class="hljs-number">127.0.0.1</span>;<br>    <span class="hljs-comment"># é˜²æ­¢http host æ”»å‡»çš„é…ç½®ï¼š ä»…å…è®¸ æŒ‡å®šåŸŸåè®¿é—®ï¼Œå…¶ä»–åŸŸåè¿”å›403</span><br>    <span class="hljs-attribute">if</span> (<span class="hljs-variable">$http_Host</span> !<span class="hljs-regexp">~* ^domain.com|127.0.0.1:80$)</span> &#123;<br>        <span class="hljs-attribute">return</span> <span class="hljs-number">403</span>;<br>    &#125;<br>    <span class="hljs-comment"># å…¶ä»–é…ç½®</span><br>&#125;<br></code></pre></td></tr></table></figure><p>é‡å¯nginxå³å¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nginx -s reload<br></code></pre></td></tr></table></figure><h3 id="Apacheè§£å†³æ–¹æ¡ˆ"><a href="#Apacheè§£å†³æ–¹æ¡ˆ" class="headerlink" title="Apacheè§£å†³æ–¹æ¡ˆ"></a>Apacheè§£å†³æ–¹æ¡ˆ</h3><p>æ‰“å¼€Apacheçš„é…ç½® ï¼Œ ä¸€èˆ¬ä¸º <code>/conf/httpd.conf</code><br>æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs conf">RewriteEngine on<br>RewriteCond %&#123;HTTP_HOST&#125; !^www.domain.com$ [NC]<br>RewriteRule ^(.*)$ /403.html<br><br></code></pre></td></tr></table></figure><p>é‡å¯apacheå³å¯</p><h2 id="å®‰å…¨æ— å°äº‹ï¼ï¼ï¼"><a href="#å®‰å…¨æ— å°äº‹ï¼ï¼ï¼" class="headerlink" title="å®‰å…¨æ— å°äº‹ï¼ï¼ï¼"></a>å®‰å…¨æ— å°äº‹ï¼ï¼ï¼</h2><p><a href="https://m.freebuf.com/articles/web/336709.html">Webæ¼æ´ä¹‹HOSTå¤´æ”»å‡»</a></p><p><a href="https://www.wangan.com/p/7fy7475771d68df5">hostå¤´æ”»å‡»</a></p>]]></content>
    
    
    <categories>
      
      <category>å®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nginx</tag>
      
      <tag>å®‰å…¨</tag>
      
      <tag>apache</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸­é—´ä»¶ç‰ˆæœ¬å·æ³„éœ²é—®é¢˜ä¿®å¤</title>
    <link href="/2023/06/19/safe-dev-info-leak/"/>
    <url>/2023/06/19/safe-dev-info-leak/</url>
    
    <content type="html"><![CDATA[<p>å¼€å‘è¿‡ç¨‹ä¸­çš„ä¸€äº›ä¿¡æ¯å¸¦åˆ°äº†çº¿ä¸Šï¼Œè¦åŠæ—¶ä¿®å¤ï¼Œä¸å¦‚åäººå°±é¡ºè—¤æ‘¸ç“œæ‰¾æ¥äº†ã€‚</p><p>ä»¥ä¸‹æ˜¯æ¼æ´çš„ä¸€äº›å†…å®¹ï¼š</p><h2 id="å®‰å…¨æ¼æ´æè¿°"><a href="#å®‰å…¨æ¼æ´æè¿°" class="headerlink" title="å®‰å…¨æ¼æ´æè¿°"></a>å®‰å…¨æ¼æ´æè¿°</h2><p>ä¿¡æ¯æ³„éœ²ä¸»è¦æ˜¯ç”±äºå¼€å‘äººå‘˜æˆ–è¿ç»´ç®¡ç†äººå‘˜çš„ç–å¿½æ‰€å¯¼è‡´ã€‚å¦‚æœªåŠæ—¶åˆ é™¤è°ƒè¯•é¡µé¢ã€æœªå…³é—­ç¨‹åºè°ƒè¯•åŠŸèƒ½ã€æœªå±è”½ç¨‹åºé”™è¯¯ä¿¡æ¯ã€å¤‡ä»½æ–‡ä»¶æœªåˆ é™¤ã€æ•°æ®åº“å¤‡ä»½æ–‡ä»¶æœªåˆ é™¤ã€æœªå±è”½æ•æ„Ÿæ•°æ®ä¿¡æ¯ç­‰å¤šä¸ªæ–¹é¢æ‰€å¯¼è‡´çš„ä¸åŒä¸¥é‡ç¨‹åº¦çš„ä¿¡æ¯æ³„éœ²ã€‚æ”»å‡»è€…å¯é€šè¿‡æ‰€æŒæ¡çš„ä¿¡æ¯è¿›ä¸€æ­¥åˆ†ææ”»å‡»ç›®æ ‡ï¼Œä»è€Œæœ‰æ•ˆå‘èµ·ä¸‹ä¸€æ­¥çš„æœ‰æ•ˆæ”»å‡»ã€‚</p><p>å¸¸è§çš„é—®é¢˜æœ‰ï¼š</p><ol><li>swagger æ¥å£æœªå…³é—­</li><li>druidç›‘æ§å°æœªå…³é—­</li><li>ç­‰</li></ol><h2 id="é£é™©ç­‰çº§ï¼šä½"><a href="#é£é™©ç­‰çº§ï¼šä½" class="headerlink" title="é£é™©ç­‰çº§ï¼šä½"></a>é£é™©ç­‰çº§ï¼šä½</h2><h2 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h2><p>å…³é—­ç›¸å…³æ¥å£çš„çº¿ä¸Šæƒé™ï¼Œæˆ–å¢åŠ æƒé™æ§åˆ¶  </p><p>1ï¼Œswagger å…³é—­å…¥å£çš„æ–¹å¼<br>æ–¹æ³•a: ä½¿ç”¨æ³¨è§£ @Value() æ¨èä½¿ç”¨ï¼Œ ç„¶ååœ¨ä¸åŒçš„é…ç½®æ–‡ä»¶é‡ŒæŒ‡å®šå¼€å…³</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs code">@Value(&quot;$&#123;swagger.enabled&#125;&quot;)<br>private boolean enabled;<br><br>@Bean<br>public Docket createRestApi()<br>&#123;<br>    return new Docket(DocumentationType.V1)<br>            // æ˜¯å¦å¯ç”¨Swagger           <br>             .enable(enabled)<br>            // ç”¨æ¥åˆ›å»ºè¯¥APIçš„åŸºæœ¬ä¿¡æ¯ï¼Œå±•ç¤ºåœ¨æ–‡æ¡£çš„é¡µé¢ä¸­ï¼ˆè‡ªå®šä¹‰å±•ç¤ºçš„ä¿¡æ¯ï¼‰            <br>            .apiInfo(apiInfo())<br>            // è®¾ç½®å“ªäº›æ¥å£æš´éœ²ç»™Swaggerå±•ç¤º           <br>             .select()<br>            // æ‰«ææ‰€æœ‰æœ‰æ³¨è§£çš„apiï¼Œç”¨è¿™ç§æ–¹å¼æ›´çµæ´»           <br>             .apis(RequestHandlerSelectors.withMethodAnnotation(ApiOperation.class))<br>            // æ‰«ææŒ‡å®šåŒ…ä¸­çš„swaggeræ³¨è§£            <br>            // .apis(RequestHandlerSelectors.basePackage(&quot;com.ruoyi.project.tool.swagger&quot;))           <br>             // æ‰«ææ‰€æœ‰ .apis(RequestHandlerSelectors.any())            <br>             .paths(PathSelectors.any())<br>            .build()<br>            /* è®¾ç½®å®‰å…¨æ¨¡å¼ï¼Œswaggerå¯ä»¥è®¾ç½®è®¿é—®token */          <br>            .securitySchemes(securitySchemes())<br>            .securityContexts(securityContexts())<br>            .pathMapping(pathMapping);<br>&#125;<br></code></pre></td></tr></table></figure><p>æ–¹æ³•b:  ä½¿ç”¨æ³¨è§£@Profile({â€œdevâ€,â€œtestâ€}) è¡¨ç¤ºåœ¨å¼€å‘æˆ–æµ‹è¯•ç¯å¢ƒå¼€å¯ï¼Œè€Œåœ¨ç”Ÿäº§å…³é—­<br><img src="/images/tech/safe/swagger-switch2.png" alt="swagger-switch"><br>å…¶å®ab çš„æ–¹å¼æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯ä¸åŒçš„ç¯å¢ƒå¼€å…³ä¸åŒã€‚</p><p>2ï¼Œ druidå…³é—­ç›‘æ§å°çš„æ–¹å¼</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">spring.datasource.druid.webStatFilter.enabled</span>=<span class="hljs-string">false</span><br><span class="hljs-attr">spring.datasource.druid.statViewServlet.enabled</span>=<span class="hljs-string">false</span><br></code></pre></td></tr></table></figure><p>3ï¼Œ ä¸€äº›å…¶ä»–æ¥å£å¢åŠ æƒé™è®¤è¯<br>é€šè¿‡springçš„httpSecurity å¢åŠ è·¯å¾„é‰´æƒ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs code">protected void configure(HttpSecurity httpSecurity) throws Exception &#123;<br>    // something<br>    // druid æ¥å£è¦é‰´æƒ<br>    httpSecurity..antMatchers(&quot;/druid/**&quot;).authenticated()<br>    // something<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å®‰å…¨æ— å°äº‹ï¼ï¼ï¼"><a href="#å®‰å…¨æ— å°äº‹ï¼ï¼ï¼" class="headerlink" title="å®‰å…¨æ— å°äº‹ï¼ï¼ï¼"></a>å®‰å…¨æ— å°äº‹ï¼ï¼ï¼</h2>]]></content>
    
    
    <categories>
      
      <category>å®‰å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>spring</tag>
      
      <tag>å®‰å…¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>AntPathMatcher VS PathPattern</title>
    <link href="/2023/05/21/spring-spring-path-matcher/"/>
    <url>/2023/05/21/spring-spring-path-matcher/</url>
    
    <content type="html"><![CDATA[<p>springè·¯å¾„åŒ¹é…ï¼Œåœ¨spring5ä»¥åï¼Œæœ‰äº†AntPathMatcher å’Œ PathPattern ä¸¤ç§æ–¹å¼ã€‚</p><p>PathPatternæ˜¯åœ¨spring 5 ä»¥åæ–°å¢çš„ã€‚æœ¬æ–‡å°±ä»‹ç» AntPathMatcher å’Œ PathPattern çš„å¼‚åŒï¼Œä»¥åŠè¿™ä¸¤è€…çš„ä½¿ç”¨åœºæ™¯å’Œæ–¹å¼ã€‚</p><h1 id="åˆ›å»ºå®ä¾‹"><a href="#åˆ›å»ºå®ä¾‹" class="headerlink" title="åˆ›å»ºå®ä¾‹"></a>åˆ›å»ºå®ä¾‹</h1><p>AntPathMatcheråœ¨1.xç‰ˆæœ¬å°±å­˜åœ¨äº†ï¼Œåœ¨spring5ä»¥å‰ï¼Œä¸€ç›´ä½œä¸ºspringçš„è·¯å¾„åŒ¹é…å™¨å­˜åœ¨ã€‚</p><p>AntPathMatcheråœ¨springä¸­æ˜¯ä½œä¸ºå·¥å…·ç±»å­˜åœ¨çš„ï¼Œæ‰€ä»¥ç›´æ¥<code>new</code>å¯¹è±¡å³å¯ã€‚</p><p>PathPatternå‡ºç°åœ¨spring5.xç‰ˆæœ¬ä¸­, æ—¨åœ¨ç”¨äºæ›¿æ¢æ‰è¾ƒä¸ºâ€œå¤è€â€çš„AntPathMatcherã€‚</p><p>PathPatternæ˜¯springä¸€ä¸ªå†…éƒ¨ç±»ï¼Œä¸èƒ½é€šè¿‡publicçš„æ–¹å¼æ¥åˆ›å»ºã€‚ä¸è¿‡spring å®˜æ–¹æä¾›äº†ä¸€ä¸ª<code>parser</code>å¼€æä¾›PathPatternçš„é»˜è®¤å®ä¾‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ„å»ºAntPathMatcher å®ä¾‹</span><br><span class="hljs-type">AntPathMatcher</span> <span class="hljs-variable">antPathMatcher</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AntPathMatcher</span>();<br><span class="hljs-comment">// æ„å»ºPathPattern å®ä¾‹</span><br><span class="hljs-type">PathPatternParser</span> <span class="hljs-variable">patternParser</span> <span class="hljs-operator">=</span> PathPatternParser.defaultInstance;<br></code></pre></td></tr></table></figure><h1 id="åŒ¹é…è§„åˆ™"><a href="#åŒ¹é…è§„åˆ™" class="headerlink" title="åŒ¹é…è§„åˆ™"></a>åŒ¹é…è§„åˆ™</h1><p>AntPathMatcher å®˜æ–¹æ–‡æ¡£ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs awk">æ˜ å°„ä½¿ç”¨ä»¥ä¸‹è§„åˆ™åŒ¹é… URLï¼š <br>? åŒ¹é…ä¸€ä¸ªå­—ç¬¦<br>* åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå­—ç¬¦<br>** åŒ¹é…è·¯å¾„ä¸­çš„é›¶ ä¸ª æˆ–å¤šä¸ªç›®å½•<br>&#123;spring:[a-z]+&#125; å°†æ­£åˆ™è¡¨è¾¾ [a-z]+ å¼åŒ¹é…ä¸ºåä¸ºâ€œspringâ€çš„è·¯å¾„å˜é‡<br>        <br>ä¾‹å­<br>com<span class="hljs-regexp">/t?st.jsp â€” åŒ¹é… com/</span>test.jsp ï¼Œä½†ä¹Ÿ com<span class="hljs-regexp">/tast.jsp åŒ¹é…æˆ– com/</span>txst.jsp<br>com/*.jspâ€” åŒ¹é…ç›®å½•ä¸­comçš„æ‰€æœ‰.jspæ–‡ä»¶<br>com<span class="hljs-regexp">/**/</span>test.jspâ€” åŒ¹é…è·¯å¾„ä¸‹comçš„æ‰€æœ‰test.jspæ–‡ä»¶<br>org<span class="hljs-regexp">/springframework/</span>**<span class="hljs-regexp">/*.jspâ€” åŒ¹é…è·¯å¾„ä¸‹org/</span>springframeworkçš„æ‰€æœ‰.jspæ–‡ä»¶<br>org<span class="hljs-regexp">/**/</span>servlet<span class="hljs-regexp">/bla.jsp â€” åŒ¹é… org/</span>springframework<span class="hljs-regexp">/servlet/</span>bla.jsp ï¼Œä½†ä¹Ÿ org<span class="hljs-regexp">/springframework/</span>testing<span class="hljs-regexp">/servlet/</span>bla.jsp å’Œ org<span class="hljs-regexp">/servlet/</span>bla.jsp<br>com<span class="hljs-regexp">/&#123;filename:\\w+&#125;.jspå°†åŒ¹é…com/</span>test.jspè¯¥å€¼testfilenameå¹¶å°†å…¶åˆ†é…ç»™å˜é‡<br>æ³¨æ„ï¼š æ¨¡å¼å’Œè·¯å¾„å¿…é¡»éƒ½æ˜¯ç»å¯¹çš„ï¼Œæˆ–è€…å¿…é¡»éƒ½æ˜¯ç›¸å¯¹çš„ï¼Œæ‰èƒ½ä½¿ä¸¤è€…åŒ¹é…ã€‚å› æ­¤ï¼Œå»ºè®®æ­¤å®ç°çš„ç”¨æˆ·æ¸…ç†æ¨¡å¼ï¼Œä»¥ä¾¿åœ¨ä½¿ç”¨æ¨¡å¼çš„ä¸Šä¸‹æ–‡ä¸­ä¸ºâ€œ/â€ä½œä¸ºå‰ç¼€ã€‚<br></code></pre></td></tr></table></figure><p>PathPattern å®˜æ–¹æ–‡æ¡£</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">PathPattern ä½¿ç”¨ä»¥ä¸‹è§„åˆ™åŒ¹é… URL è·¯å¾„ï¼š <br>? åŒ¹é…ä¸€ä¸ªå­—ç¬¦<br>* åŒ¹é…è·¯å¾„æ®µä¸­çš„é›¶ä¸ªæˆ–å¤šä¸ªå­—ç¬¦<br>** åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ª è·¯å¾„æ®µ ï¼Œç›´åˆ°è·¯å¾„ç»“æŸ<br>&#123;spring&#125; åŒ¹é… è·¯å¾„æ®µ å¹¶å°†å…¶æ•è·ä¸ºåä¸ºâ€œspringâ€çš„å˜é‡<br>&#123;spring:[a-z]+&#125; å°†æ­£åˆ™è¡¨è¾¾ [a-z]+ å¼åŒ¹é…ä¸ºåä¸ºâ€œspringâ€çš„è·¯å¾„å˜é‡<br>&#123;*spring&#125; åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ª è·¯å¾„æ®µ ï¼Œç›´åˆ°è·¯å¾„çš„æœ«å°¾ï¼Œå¹¶å°†å…¶æ•è·ä¸ºåä¸ºâ€œspringâ€çš„å˜é‡<br>æ³¨æ„ï¼š ä¸ org.springframework.util.AntPathMatcherç›¸åï¼Œ ** ä»…åœ¨æ¨¡å¼çš„æœ«å°¾å—æ”¯æŒã€‚ä¾‹å¦‚ <span class="hljs-string">/pages/</span>&#123;**&#125; ï¼Œæ˜¯æœ‰æ•ˆçš„ï¼Œä½†ä¸æ˜¯ <span class="hljs-string">/pages/</span>&#123;**&#125;<span class="hljs-string">/details</span> ã€‚è¿™åŒæ ·é€‚ç”¨äºæ•è·å˜ä½“ &#123;*spring&#125;ã€‚ç›®çš„æ˜¯åœ¨æ¯”è¾ƒæ¨¡å¼çš„ç‰¹å¼‚æ€§æ—¶æ¶ˆé™¤æ­§ä¹‰ã€‚<br><br>ä¾‹å­<br><span class="hljs-string">/pages/t</span>?st.html â€” åŒ¹é… <span class="hljs-string">/pages/test.html</span> ï¼Œ <span class="hljs-string">/pages/tXst.html</span> ä½†ä¸æ˜¯ <span class="hljs-string">/pages/toast.html</span><br><span class="hljs-string">/resources/</span>*<span class="hljs-string">.png</span>â€” åŒ¹é…ç›®å½•ä¸­resourcesçš„æ‰€æœ‰<span class="hljs-string">.png</span>æ–‡ä»¶<br><span class="hljs-string">/resources/</span>** â€” åŒ¹é…è·¯å¾„ä¸‹ <span class="hljs-string">/resources/</span> çš„æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬ <span class="hljs-string">/resources/image.png</span> å’Œ <span class="hljs-string">/resources/css/spring.css</span><br><span class="hljs-string">/resources/</span>&#123;*path&#125; â€” åŒ¹é… å’Œ ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ <span class="hljs-string">/resources/</span>ï¼Œ <span class="hljs-string">/resources</span>å¹¶åœ¨åä¸º â€œpathâ€ çš„å˜é‡ä¸­æ•è·å®ƒä»¬çš„ç›¸å¯¹è·¯å¾„; <span class="hljs-string">/resources/image.png</span> å°†ä¸ â€œpathâ€ åŒ¹é… â†’ â€œ<span class="hljs-string">/image.png</span>â€ï¼Œå¹¶å°† <span class="hljs-string">/resources/css/spring.css</span> ä¸ â€œpathâ€ åŒ¹é… â†’ â€œ<span class="hljs-string">/css/spring.css</span>â€<br><span class="hljs-string">/resources/</span>&#123;filename:\\w+&#125;<span class="hljs-string">.dat</span>å°†åŒ¹é…<span class="hljs-string">/resources/spring.dat</span>è¯¥å€¼<span class="hljs-string">&quot;spring&quot;</span>filenameå¹¶å°†å…¶åˆ†é…ç»™å˜é‡<br></code></pre></td></tr></table></figure><p>å¯è§ï¼ŒAntPathMatcher å’Œ PathPattern çš„åŒ¹é…è§„åˆ™æ˜¯å·®ä¸å¤šçš„ï¼Œéƒ½æ”¯æŒ<code>?</code> <code>*</code> <code>**</code> å·²ç»éƒ¨åˆ†æ­£åˆ™åŒ¹é…ã€‚</p><p>ä½†PathPatternå¢åŠ äº†è·¯å¾„åŒ¹é…å¹¶æå–ç»“æœçš„èƒ½åŠ›ï¼ŒåŒæ—¶ä¸ºäº†æ¶ˆé™¤æ­§ä¹‰ï¼Œä¸å†æ”¯æŒè·¯å¾„ä¸­é—´çš„<code>**</code>åŒ¹é…ï¼Œå…¶ä»–ä¸€æ ·ã€‚</p><p>demo:   </p><p>*åŒ¹é…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestPathMatch</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">AntPathMatcher</span> <span class="hljs-variable">antPathMatcher</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AntPathMatcher</span>();<br>        <span class="hljs-type">PathPatternParser</span> <span class="hljs-variable">patternParser</span> <span class="hljs-operator">=</span> PathPatternParser.defaultInstance;<br><br>        List&lt;String&gt; list = List.of(<span class="hljs-string">&quot;aaa_1.csv&quot;</span>, <span class="hljs-string">&quot;aaa_2.csv&quot;</span>, <span class="hljs-string">&quot;aaa_3.csv&quot;</span>, <span class="hljs-string">&quot;aaa_1.xlsx&quot;</span>, <span class="hljs-string">&quot;aaa&quot;</span>, <span class="hljs-string">&quot;aaa.pdf&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">pattern1</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;a*.csv&quot;</span>;<br><br>        System.out.println(<span class="hljs-string">&quot;by antPathMatcher..&quot;</span>);<br>        <span class="hljs-keyword">for</span> (String s : list) &#123;<br>            System.out.printf(<span class="hljs-string">&quot;pattern %s match %s is %s %n&quot;</span>, pattern1,s, antPathMatcher.match(pattern1,s));<br>        &#125;<br>        System.out.println(<span class="hljs-string">&quot;by patternParser..&quot;</span>);<br>        <span class="hljs-keyword">for</span> (String s : list) &#123;<br>            System.out.printf(<span class="hljs-string">&quot;pattern %s match %s is %s %n&quot;</span>, pattern1,s, patternParser.parse(pattern1).matches(PathContainer.parsePath(s)));<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// ç»“æœ</span><br><span class="hljs-comment">// by antPathMatcher..</span><br><span class="hljs-comment">// pattern a*.csv match aaa_1.csv is true</span><br><span class="hljs-comment">// pattern a*.csv match aaa_2.csv is true</span><br><span class="hljs-comment">// pattern a*.csv match aaa_3.csv is true</span><br><span class="hljs-comment">// pattern a*.csv match aaa_1.xlsx is false</span><br><span class="hljs-comment">// pattern a*.csv match aaa is false</span><br><span class="hljs-comment">// pattern a*.csv match aaa.pdf is false</span><br><span class="hljs-comment">// by patternParser..</span><br><span class="hljs-comment">// pattern a*.csv match aaa_1.csv is true</span><br><span class="hljs-comment">// pattern a*.csv match aaa_2.csv is true</span><br><span class="hljs-comment">// pattern a*.csv match aaa_3.csv is true</span><br><span class="hljs-comment">// pattern a*.csv match aaa_1.xlsx is false</span><br><span class="hljs-comment">// pattern a*.csv match aaa is false</span><br><span class="hljs-comment">// pattern a*.csv match aaa.pdf is false </span><br></code></pre></td></tr></table></figure><p>PathPattern è·¯å¾„æå–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestPathMatch</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">AntPathMatcher</span> <span class="hljs-variable">antPathMatcher</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AntPathMatcher</span>();<br>        <span class="hljs-type">PathPatternParser</span> <span class="hljs-variable">patternParser</span> <span class="hljs-operator">=</span> PathPatternParser.defaultInstance;<br><br>        <span class="hljs-type">String</span> <span class="hljs-variable">pattern</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;/api/hancher/&#123;*spring&#125;&quot;</span>;<br>        List&lt;String&gt; list = List.of(<span class="hljs-string">&quot;/api/hancher/a/b/c&quot;</span>, <span class="hljs-string">&quot;/api/hancher/a&quot;</span>, <span class="hljs-string">&quot;/api/hancher/a/&quot;</span>, <span class="hljs-string">&quot;/api/hancher/a/b/c.csv&quot;</span>,<span class="hljs-string">&quot;/api/test/a/b/c&quot;</span>);<br><br>        <span class="hljs-keyword">for</span> (String s : list) &#123;<br>            System.out.printf(<span class="hljs-string">&quot;pattern %s match %s is %s %n&quot;</span>, pattern,s, patternParser.parse(pattern).matches(PathContainer.parsePath(s)));<br>            System.out.printf(<span class="hljs-string">&quot;pattern %s match %s result %s %n&quot;</span>, pattern,s, patternParser.parse(pattern).matchAndExtract(PathContainer.parsePath(s)));<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// ç»“æœ</span><br><span class="hljs-comment">//pattern /api/hancher/&#123;*spring&#125; match /api/hancher/a/b/c is true </span><br><span class="hljs-comment">//pattern /api/hancher/&#123;*spring&#125; match /api/hancher/a/b/c result PathMatchInfo[uriVariables=&#123;spring=/a/b/c&#125;, matrixVariables=&#123;&#125;] </span><br><span class="hljs-comment">//pattern /api/hancher/&#123;*spring&#125; match /api/hancher/a is true </span><br><span class="hljs-comment">//pattern /api/hancher/&#123;*spring&#125; match /api/hancher/a result PathMatchInfo[uriVariables=&#123;spring=/a&#125;, matrixVariables=&#123;&#125;] </span><br><span class="hljs-comment">//pattern /api/hancher/&#123;*spring&#125; match /api/hancher/a/ is true </span><br><span class="hljs-comment">//pattern /api/hancher/&#123;*spring&#125; match /api/hancher/a/ result PathMatchInfo[uriVariables=&#123;spring=/a/&#125;, matrixVariables=&#123;&#125;] </span><br><span class="hljs-comment">//pattern /api/hancher/&#123;*spring&#125; match /api/hancher/a/b/c.csv is true </span><br><span class="hljs-comment">//pattern /api/hancher/&#123;*spring&#125; match /api/hancher/a/b/c.csv result PathMatchInfo[uriVariables=&#123;spring=/a/b/c.csv&#125;, matrixVariables=&#123;&#125;] </span><br><span class="hljs-comment">//pattern /api/hancher/&#123;*spring&#125; match /api/test/a/b/c is false </span><br><span class="hljs-comment">//pattern /api/hancher/&#123;*spring&#125; match /api/test/a/b/c result null </span><br></code></pre></td></tr></table></figure><h1 id="æ€§èƒ½"><a href="#æ€§èƒ½" class="headerlink" title="æ€§èƒ½"></a>æ€§èƒ½</h1><p>å®˜æ–¹è¯´PathPattern æ¯” AntPathMatcher æ›´å¿«ä¸€äº›ï¼Œæ‰€ä»¥å’±ä»¬éªŒè¯ä¸€ä¸‹ï¼š</p><p>æµ‹è¯•ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestPathMatch</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">AntPathMatcher</span> <span class="hljs-variable">antPathMatcher</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AntPathMatcher</span>();<br>        <span class="hljs-type">PathPatternParser</span> <span class="hljs-variable">patternParser</span> <span class="hljs-operator">=</span> PathPatternParser.defaultInstance;<br><br>        <span class="hljs-type">long</span> <span class="hljs-variable">start</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">pattern</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;/api/hanc?er/**&quot;</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100000</span>; i++) &#123;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">path</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;/api/hancher/&quot;</span> + i + <span class="hljs-string">&quot;/&quot;</span> + i + <span class="hljs-string">&quot;/a.txt&quot;</span>;<br>            System.out.println(antPathMatcher.match(pattern, path));<br><span class="hljs-comment">//            System.out.println(patternParser.parse(pattern).matches(PathContainer.parsePath(path)));</span><br>        &#125;<br>        System.out.println(System.currentTimeMillis() - start);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åˆ†åˆ«è·‘äº†5æ¬¡ã€‚<br>AntPathMatcher å¹³å‡è€—æ—¶ï¼š392ms<br>PathPattern å¹³å‡è€—æ—¶ï¼š323.4ms<br>å®˜æ–¹æ‰€è¨€ä¸è™šï¼  </p><h1 id="é€‰æ‹©"><a href="#é€‰æ‹©" class="headerlink" title="é€‰æ‹©"></a>é€‰æ‹©</h1><ol><li>åœ¨æ»¡è¶³éœ€æ±‚çš„æƒ…å†µä¸‹ï¼Œå°½é‡é€‰PathPatternï¼Œæ›´å¿«</li><li>å¦‚æœéœ€è¦é€šè¿‡*<em>åŒ¹é…ä¸­é—´è·¯å¾„ï¼Œæˆ–è€…é€šè¿‡</em>åŒ¹é…æ–‡ä»¶æ‰©å±•åè¿™ç§åœºæ™¯ï¼Œç”¨AntPathMatcherï¼Œ å› ä¸ºPathPatternä¸æ”¯æŒã€‚</li></ol>]]></content>
    
    
    <categories>
      
      <category>spring</category>
      
    </categories>
    
    
    <tags>
      
      <tag>spring</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>springæœåŠ¡formè¡¨å•å†…å®¹è¿‡å¤§å¯¼è‡´åç«¯å‚æ•°æ¥æ”¶ä¸ºnullæƒ…å†µ</title>
    <link href="/2023/04/28/exception-spring-http-form-too-big-err/"/>
    <url>/2023/04/28/exception-spring-http-form-too-big-err/</url>
    
    <content type="html"><![CDATA[<h2 id="é—®é¢˜ç°çŠ¶"><a href="#é—®é¢˜ç°çŠ¶" class="headerlink" title="é—®é¢˜ç°çŠ¶"></a>é—®é¢˜ç°çŠ¶</h2><p>ä»Šå¤©å¼€å‘é‡åˆ°ä¸€ä¸ªå¥‡æ€ªçš„é—®é¢˜ï¼Œå‰ç«¯çš„formè¡¨å•æ•°æ®æäº¤çš„æ—¶å€™ï¼Œæ•°æ®é‡æ¯”è¾ƒå°çš„æ—¶å€™ï¼Œå†…å®¹èƒ½æ­£å¸¸ä¿å­˜ã€‚  </p><p>å½“æ•°æ®é‡è¾¾åˆ°1.6Mçš„æ—¶å€™ï¼Œåç«¯å°±å¼€å§‹æŠ¥npeå¼‚å¸¸ï¼Œå‚æ•°å­—æ®µå°±å¼€å§‹æ¥æ”¶ä¸åˆ°äº†ã€‚</p><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>ç»è¿‡æ’æŸ¥ï¼Œå‘ç°è¿™ä¸ªå’Œç¼–ç¨‹æ— å…³ã€‚<br>springboot é»˜è®¤é›†æˆäº†tomcatå®¹å™¨ï¼Œtomcatå¯¹formè¡¨å•çš„å¤§å°æœ‰é™åˆ¶ï¼Œé»˜è®¤2Mã€‚</p><p>çŸ¥é“äº†é—®é¢˜æ‰€åœ¨ï¼Œè§£å†³èµ·æ¥å°±å¾ˆç®€å•äº†ã€‚<br>æ–¹æ¡ˆ1ï¼š å¢åŠ tomcatçš„formè¡¨å•å®¹é‡é…ç½®</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">server.tomcat.max-http-form-post-size</span>=<span class="hljs-string">10MB</span><br></code></pre></td></tr></table></figure><p>æ–¹æ¡ˆ2ï¼šå»æ‰tomcatçš„formå®¹é‡é…ç½®</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">server.tomcat.max-http-form-post-size</span>=<span class="hljs-string">-1</span><br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/application-properties.html#application-properties.server.server.tomcat.max-http-form-post-size">springå®˜æ–¹é…ç½®</a></p>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹äººç”Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>å¼‚å¸¸</tag>
      
      <tag>spring</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¦‚ä½•ç»™bashè„šæœ¬è¿›è¡ŒåŠ å¯†ï¼Ÿ</title>
    <link href="/2023/04/20/bash-shc/"/>
    <url>/2023/04/20/bash-shc/</url>
    
    <content type="html"><![CDATA[<p>å½“æˆ‘ä»¬å†™çš„bashè„šæœ¬ï¼Œæœ‰çš„æ—¶å€™éœ€è¦åˆ†äº«ç»™åˆ«äººç”¨ï¼Œä½†æ˜¯åˆä¸å¤ªæƒ³è®©åˆ«äººçœ‹åˆ°å®ç°é€»è¾‘ã€‚æ²¡åˆ°è¿™ä¸ªæ—¶å€™ï¼Œå°±æƒ³ç€è¦æ˜¯èƒ½ç»™è¿™ä¸ªè„šæœ¬åŠ å¯†ä¸€ä¸‹å°±å¥½äº†ã€‚<br>ä»…åŠ å¯†è„šæœ¬çš„å†…å®¹ï¼Œåˆä¸å½±å“è„šæœ¬çš„è¿è¡Œï¼Œå¤šå¥½ã€‚è¦çŸ¥é“åœ¨è®¡ç®—æœºçš„ä¸–ç•Œï¼Œåªæœ‰æƒ³ä¸åˆ°ï¼Œæ²¡æœ‰åšä¸åˆ°ï¼<br>ä½ ä¸æ˜¯ç¬¬ä¸€ä¸ªé‡åˆ°è¿™ä¸ªé—®é¢˜çš„äººï¼Œè€Œä¸”æœ‰æ¯”ä½ æ›´æœ‰è¡ŒåŠ¨åŠ›çš„äººæŠŠè¿™ä¸ªé—®é¢˜è§£å†³äº†ã€‚  </p><p>ä»Šå¤©æˆ‘ä»¬å°±ä»‹ç»ä¸¤ä¸ªå·¥å…·æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><h1 id="gzexe"><a href="#gzexe" class="headerlink" title="gzexe"></a>gzexe</h1><p>macç³»ç»Ÿä¸Šè‡ªå¸¦çš„ä¸€ä¸ªå·¥å…·ï¼Œå¯ä»¥åœ¨macç³»ç»Ÿä¸Šå°†ä¸€ä¸ªå¯æ‰§è¡Œçš„bashè„šæœ¬åŠ å¯†ã€‚<br>ä½¿ç”¨æ–¹å¼ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">usage: gzexe [-d] file ...<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬ä»¥hello.sh è„šæœ¬ä¸ºä¾‹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Hello World &quot;</span><br></code></pre></td></tr></table></figure><p>æ“ä½œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">mac % gzexe hello.sh <br>gzexe: cannot compress hello.sh, it is not executable <span class="hljs-comment"># hello.sh å¿…é¡»æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶</span><br><br><span class="hljs-comment"># ä¿®æ”¹hello.sh ä¸ºå¯æ‰§è¡Œæ–‡ä»¶</span><br>mac % <span class="hljs-built_in">chmod</span> 744 hello.sh <br><br>mac % gzexe hello.sh <br>hello.sh:   -4.3%  <br><br><span class="hljs-comment"># æˆåŠŸï¼Œå¹¶ä¸”ä½“æ£€å‹ç¼©äº†4.3% æˆ‘ä»¬æ‰§è¡Œä¸€ä¸‹ls çœ‹çœ‹å‘ç”Ÿäº†ä»€ä¹ˆ</span><br>mac % <span class="hljs-built_in">ls</span><br>hello.shhello.sh~<br><br><span class="hljs-comment"># è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å‘ç°hello.shå·²ç»åŠ å¯†äº†ï¼Œä½†æˆ‘ä»¬å‘ç°å¤šäº†ä¸€ä¸ªhello.sh~æ–‡ä»¶ã€‚ è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬çš„åŠ å¯†å‰çš„æºæ–‡ä»¶ã€‚</span><br><span class="hljs-comment"># æºæ–‡ä»¶è¿˜åœ¨ï¼Ÿæˆ‘ä»¬æŠŠhello.sh~åˆ äº† ï¼Œ çœ‹çœ‹è¿˜ä¸èƒ½è¿è¡Œã€‚</span><br>mac % <span class="hljs-built_in">rm</span> hello.sh~<br>mac % sh hello.sh <br>Hello World <span class="hljs-comment"># ä¾ç„¶å¯ä»¥è¿è¡Œ</span><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯æˆ‘ä»¬æŠŠhello.shæ”¾åˆ°å…¶ä»–ç³»ç»Ÿä¸Šæ‰§è¡Œæ—¶ï¼Œä¼šå‘ç°å¤±è´¥ã€‚ä½†æ˜¯åœ¨macæœ¬åœ°ç³»ç»Ÿæ‰§è¡Œæ—¶ï¼Œè¿˜æ˜¯å¯ä»¥çš„.</p><h1 id="shc-Shell-Script-Compiler"><a href="#shc-Shell-Script-Compiler" class="headerlink" title="shc (Shell Script Compiler)"></a>shc (Shell Script Compiler)</h1><p>shell(bash) è„šæœ¬ç¼–è¯‘æŒ‡ä»¤ã€‚macç³»ç»ŸåŸç”Ÿä¸æ”¯æŒï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢æ–¹å¼å®‰è£…ã€‚  </p><h3 id="å®‰è£…æ­¥éª¤"><a href="#å®‰è£…æ­¥éª¤" class="headerlink" title="å®‰è£…æ­¥éª¤"></a>å®‰è£…æ­¥éª¤</h3><ol><li>æ£€æŸ¥æœ¬åœ°æ˜¯å¦è£…æœ‰shcï¼Œ ç›´æ¥è¾“å…¥shcå‘½ä»¤</li><li>å®‰è£…</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># linux </span><br>yum install shc<br><br><span class="hljs-comment"># mac</span><br>brew install shc<br></code></pre></td></tr></table></figure><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>ä½¿ç”¨æ–¹å¼ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">mac % shc -h<br>shc Version 4.0.3, Generic Shell Script Compiler<br>shc GNU GPL Version 3 Md Jahidul Hamid &lt;jahidulhamid@yahoo.com&gt;<br>shc Usage: shc [-e <span class="hljs-built_in">date</span>] [-m addr] [-i iopt] [-x cmnd] [-l lopt] [-o outfile] [-rvDSUHCABh] -f script<br><br>    -e %s  Expiration <span class="hljs-built_in">date</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">dd</span>/mm/yyyy format [none]<br>    -m %s  Message to display upon expiration [<span class="hljs-string">&quot;Please contact your provider&quot;</span>]<br>    -f %s  File name of the script to compile<br>    -i %s  Inline option <span class="hljs-keyword">for</span> the shell interpreter i.e: -e<br>    -x %s  eXec <span class="hljs-built_in">command</span>, as a <span class="hljs-built_in">printf</span> format i.e: <span class="hljs-built_in">exec</span>(<span class="hljs-string">&#x27;%s&#x27;</span>,@ARGV);<br>    -l %s  Last shell option i.e: --<br>    -o %s  output filename<br>    -r     Relax security. Make a redistributable binary<br>    -v     Verbose compilation<br>    -S     Switch ON setuid <span class="hljs-keyword">for</span> root callable programs [OFF]<br>    -D     Switch ON debug <span class="hljs-built_in">exec</span> calls [OFF]<br>    -U     Make binary untraceable [no]<br>    -H     Hardening : extra security protection [no]<br>           Require bourne shell (sh) and parameters are not supported<br>    -C     Display license and <span class="hljs-built_in">exit</span><br>    -A     Display abstract and <span class="hljs-built_in">exit</span><br>    -B     Compile <span class="hljs-keyword">for</span> busybox<br>    -h     Display <span class="hljs-built_in">help</span> and <span class="hljs-built_in">exit</span><br></code></pre></td></tr></table></figure><p>åŒæ ·ä»¥hello.shè„šæœ¬ä¸ºä¾‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æ™®é€šåŠ å¯†</span><br>mac % shc -v -f hello.sh<br>mac % <span class="hljs-built_in">ls</span> <br>hello.sh <span class="hljs-comment"># åŸå§‹è„šæœ¬</span><br>hello.sh.x<span class="hljs-comment"># å¯æ‰§è¡Œè„šæœ¬</span><br>hello.sh.x.c <span class="hljs-comment"># å¯æ‰§è¡Œè„šæœ¬cè¯­éŸ³æ–‡ä»¶</span><br><br><span class="hljs-comment"># è®¾ç½®è¿‡æœŸæ—¶é—´çš„åŠ å¯†è„šæœ¬</span><br>mac % shc -v -e 20/04/2023 -m <span class="hljs-string">&quot;è¿‡æœŸäº†&quot;</span> -f hello.sh -o hello_expir.sh <br>shc -e Thu Apr 20 00:00:00 2023<br>shc -e Thu Apr 20 00:00:00 2023<br>shc shll=bash<br>shc [-i]=-c<br>shc [-x]=<span class="hljs-built_in">exec</span> <span class="hljs-string">&#x27;%s&#x27;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$@</span>&quot;</span><br>shc [-l]=<br>shc opts=<br>shc: cc   hello.sh.x.c -o hello_expir.sh<br>shc: strip hello_expir.sh<br>shc: <span class="hljs-built_in">chmod</span> ug=rwx,o=rx hello_expir.sh<br><br><span class="hljs-comment"># æŸ¥çœ‹ç»“æœ</span><br>mac % <span class="hljs-built_in">ls</span> <br>hello.shhello.sh.x.chello_expir.sh<br><br><span class="hljs-comment"># è¿‡æœŸæ•ˆæœ</span><br>mac % ./hello_expir.sh <br>./hello_expir.sh: has expired!<br>è¿‡æœŸäº†<br><br></code></pre></td></tr></table></figure><p>åŒgzexeä¸€æ ·ï¼ŒåŠ å¯†åçš„è„šæœ¬ä¸€æ ·ä¸æ”¯æŒè·¨å¹³å°è¿è¡Œï¼Œå³ä½¿æ˜¯ç¼–è¯‘æˆcè¯­è¨€çš„äºŒè¿›åˆ¶è„šæœ¬ã€‚å› ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ä¼šä¾èµ–ä¸åŒç³»ç»Ÿçš„åŠ¨æ€é“¾æ¥åº“ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://opensource.apple.com/source/file_cmds/file_cmds-272/gzip/gzexe.auto.html">gzexe æºç </a></p><p><a href="https://www.geeksforgeeks.org/gzexe-command-in-linux-with-examples/">gzexe examples</a></p><p><a href="https://www.linux-magazine.com/Online/Features/SHC-Shell-Compiler">SHC-Shell-Compiler</a></p><p><a href="https://github.com/neurobin/shc">shcå®˜ç½‘</a></p>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>bash</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JDK 20æ–°ç‰¹æ€§ç®€ä»‹</title>
    <link href="/2023/04/04/java-jdk-v20/"/>
    <url>/2023/04/04/java-jdk-v20/</url>
    
    <content type="html"><![CDATA[<p><img src="/images/tech/java/jdk20-new-feature.jpeg" alt="jdk20"><br>æŒ‰ç…§JDKæ¯åŠå¹´å‘å¸ƒä¸€æ¬¡ç‰ˆæœ¬çš„èŠ‚å¥, JDK20åœ¨2023å¹´3æœˆå‘å¸ƒäº†, æœ¬æ–‡å°±æ˜¯ç®€å•ä»‹ç»ä¸€ä¸‹è¿™æ¬¡æ›´æ–°çš„æ–°ç‰¹æ€§ä¸æ”¹åŠ¨.</p><p>ä¸€å¥è¯æ€»ç»“, è¿™ä»ç„¶æ˜¯jdkçš„ä¸€ä¸ªçŸ­æœŸæ”¯æŒç‰ˆæœ¬,æ­¤ç‰ˆæœ¬åŒ…æ‹¬7ä¸ª JEPï¼ˆjdkå¢å¼ºå»ºè®®ï¼‰ï¼Œä»¥åŠæ•°ç™¾ä¸ªè¾ƒå°çš„åŠŸèƒ½å¢å¼ºå’Œæ•°åƒä¸ªé”™è¯¯ä¿®å¤.</p><h2 id="æ–°ç‰¹æ€§æ±‡æ€»"><a href="#æ–°ç‰¹æ€§æ±‡æ€»" class="headerlink" title="æ–°ç‰¹æ€§æ±‡æ€»"></a>æ–°ç‰¹æ€§æ±‡æ€»</h2><h3 id="é¢„è§ˆç‰¹æ€§"><a href="#é¢„è§ˆç‰¹æ€§" class="headerlink" title="é¢„è§ˆç‰¹æ€§"></a>é¢„è§ˆç‰¹æ€§</h3><h4 id="è¯­è¨€ç‰¹æ€§"><a href="#è¯­è¨€ç‰¹æ€§" class="headerlink" title="è¯­è¨€ç‰¹æ€§:"></a>è¯­è¨€ç‰¹æ€§:</h4><ul><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8294078">JEP 432</a> Record Patterns</strong>(è®°å½•æ¨¡å¼) :  ç¬¬2é¢„è§ˆé˜¶æ®µ. è®°å½•æ¨¡å¼æ˜¯javaè¯­è¨€çš„ä¸€ä¸ªæ–°è¯­è¨€ç‰¹æ€§.å…¶ç›®çš„æ˜¯å°†æˆ‘ä»¬ä»javaå¤æ‚çš„ç±»æ„é€ ä¸­è§£æ”¾å‡ºæ¥,æ›´å…³æ³¨äºæ•°æ®. ä¸€èˆ¬ç”¨äºä¸€ç»„æ•°æ®æ„æˆçš„ä¸€ä¸ªæ•´ä½“,æ¯”å¦‚åæ ‡point(x,y).</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8294285">JEP 433</a> Pattern Matching for switch</strong>(switchè®°å½•æ¨¡å¼):ç¬¬4æ¬¡é¢„è§ˆ, switchè¯­æ³•æ”¯æŒè®°å½•æ¨¡å¼.</li></ul><h4 id="APIåº“æ‰©å……"><a href="#APIåº“æ‰©å……" class="headerlink" title="APIåº“æ‰©å……:"></a>APIåº“æ‰©å……:</h4><ul><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8293649">JEP 434</a> Foreign Function &amp;Memory AP</strong>(è®¿é—®jvmå¤–éƒ¨å‡½æ•°æˆ–å†…å­˜çš„API) : å¼•å…¥ä¸€ä¸ªAPIï¼Œé€šè¿‡è¯¥APIï¼ŒJavaç¨‹åºå¯ä»¥åœ¨Javaè¿è¡Œæ—¶ä¹‹å¤–ä¸ä»£ç å’Œæ•°æ®è¿›è¡Œäº’æ“ä½œã€‚é€šè¿‡æœ‰æ•ˆåœ°è°ƒç”¨å¤–éƒ¨å‡½æ•°ï¼ˆå³JVMå¤–éƒ¨çš„ä»£ç ï¼‰ï¼Œå¹¶é€šè¿‡å®‰å…¨è®¿é—®å¤–éƒ¨å†…å­˜ï¼ˆå³ä¸ç”±JVMç®¡ç†çš„å†…å­˜ï¼‰ï¼ŒAPIä½¿Javaç¨‹åºèƒ½å¤Ÿè°ƒç”¨æœ¬æœºåº“å¹¶å¤„ç†æœ¬æœºæ•°æ®ï¼Œè€Œæ²¡æœ‰JNIçš„è„†æ€§å’Œå±é™©æ€§ã€‚</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8303262">JEP 438</a> Vector API</strong>(å‘é‡API): ç¬¬5å­µåŒ–é˜¶æ®µ.å‘é‡è®¡ç®—ç”±å¯¹å‘é‡çš„ä¸€ç³»åˆ—æ“ä½œç»„æˆã€‚å‘é‡ API ç”¨æ¥è¡¨è¾¾å‘é‡è®¡ç®—ï¼Œè¯¥è®¡ç®—å¯ä»¥åœ¨è¿è¡Œæ—¶å¯é åœ°ç¼–è¯‘ä¸ºæ”¯æŒçš„ CPU æ¶æ„ä¸Šçš„æœ€ä½³å‘é‡æŒ‡ä»¤ï¼Œä»è€Œå®ç°ä¼˜äºç­‰æ•ˆæ ‡é‡è®¡ç®—çš„æ€§èƒ½ã€‚å‘é‡ API çš„ç›®æ ‡æ˜¯ä¸ºç”¨æˆ·æä¾›ç®€æ´æ˜“ç”¨ä¸”ä¸å¹³å°æ— å…³çš„è¡¨è¾¾èŒƒå›´å¹¿æ³›çš„å‘é‡è®¡ç®—.</li></ul><h4 id="å¹¶å‘å¢å¼º"><a href="#å¹¶å‘å¢å¼º" class="headerlink" title="å¹¶å‘å¢å¼º:"></a>å¹¶å‘å¢å¼º:</h4><ul><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8263012">JEP 429</a> Scoped Values</strong>(ä½œç”¨åŸŸå€¼) : å­µåŒ–é˜¶æ®µ.å¼•å…¥èŒƒå›´å€¼ï¼Œå…è®¸åœ¨çº¿ç¨‹å†…å’Œçº¿ç¨‹ä¹‹é—´å…±äº«ä¸å¯å˜çš„æ•°æ®ã€‚å®ƒä»¬ä¼˜äºçº¿ç¨‹æœ¬åœ°å˜é‡ï¼Œç‰¹åˆ«æ˜¯åœ¨ä½¿ç”¨å¤§é‡è™šæ‹Ÿçº¿ç¨‹æ—¶ã€‚å› ä¸ºå˜é‡æ˜¯ä¸å¯å˜çš„,ä¹Ÿå°±é¿å…äº†å¹¶å‘é—®é¢˜.</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8295817">JEP 436</a> Virtual Threads</strong>(è™šæ‹Ÿçº¿ç¨‹) : ç¬¬2é¢„è§ˆé˜¶æ®µ. å°†è™šæ‹Ÿçº¿ç¨‹å¼•å…¥Javaå¹³å°ã€‚è™šæ‹Ÿçº¿ç¨‹æ˜¯è½»é‡çº§çº¿ç¨‹ï¼Œå¤§å¤§å‡å°‘äº†ç¼–å†™ã€ç»´æŠ¤å’Œè§‚å¯Ÿé«˜ååé‡å¹¶å‘åº”ç”¨ç¨‹åºçš„å·¥ä½œé‡. æœ¬æ¬¡ä¸»è¦æ˜¯ä¸€äº›æ ¸å¿ƒåŠŸèƒ½å‡çº§.</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8296037">JEP 437</a> Structured Concurrency</strong>(ç»“æ„åŒ–å¹¶å‘) : ç¬¬2å­µåŒ–é˜¶æ®µ. é€šè¿‡å¼•å…¥ç»“æ„åŒ–å¹¶å‘çš„APIæ¥ç®€åŒ–å¤šçº¿ç¨‹ç¼–ç¨‹ã€‚ç»“æ„åŒ–å¹¶å‘å°†åœ¨ä¸åŒçº¿ç¨‹ä¸­è¿è¡Œçš„å¤šä¸ªä»»åŠ¡è§†ä¸ºå•ä¸ªå·¥ä½œå•å…ƒï¼Œä»è€Œç®€åŒ–é”™è¯¯å¤„ç†å’Œå–æ¶ˆï¼Œæé«˜å¯é æ€§å¹¶æé«˜å¯è§‚å¯Ÿæ€§ã€‚</li></ul><h3 id="ä¸»è¦ç‰¹æ€§"><a href="#ä¸»è¦ç‰¹æ€§" class="headerlink" title="ä¸»è¦ç‰¹æ€§"></a>ä¸»è¦ç‰¹æ€§</h3><h4 id="æ ¸å¿ƒåº“"><a href="#æ ¸å¿ƒåº“" class="headerlink" title="æ ¸å¿ƒåº“"></a>æ ¸å¿ƒåº“</h4><ul><li><strong>Support Unicode 15.0</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8284842">JDK-8284842</a>) : æ”¯æŒUnicode15.0 .</li><li><strong>Print Warning to Standard Error If Bad java.io.tmpdir Setting Is Detected</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8290313">JDK-8290313</a>) : æ–°å¢ä¸€ç§è­¦å‘Šè¾“å‡ºåœºæ™¯</li></ul><h4 id="å®‰å…¨"><a href="#å®‰å…¨" class="headerlink" title="å®‰å…¨"></a>å®‰å…¨</h4><ul><li><strong>New JFR Event: jdk.InitialSecurityProperty</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8292177">JDK-8292177</a>) : æ–°å¢ä¸€ä¸ªæ–°çš„JFR(Java Flight Recorder)äº‹ä»¶.</li><li><strong>New JFR Event: jdk.SecurityProviderService</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8254711">JDK-8254711</a>) : æ–°å¢ä¸€ä¸ªæ–°çš„JFR(Java Flight Recorder)äº‹ä»¶.</li><li><strong>Provide Poly1305 Intrinsic on x86_64 platforms with AVX512 instructions</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8288047">JDK-8288047</a>) : æ­¤åŠŸèƒ½åœ¨x86_64å¹³å°ä¸Šä½¿ç”¨AVX512æŒ‡ä»¤ä¸ºSunJCEæä¾›å•†çš„Poly1305æ¶ˆæ¯èº«ä»½éªŒè¯ä»£ç ç®—æ³•æä¾›ä¼˜åŒ–ã€‚</li><li><strong>Provide ChaCha20 Intrinsics on x86_64 and aarch64 Platforms</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8247645">JDK-8247645</a>) : æ­¤åŠŸèƒ½ä¸ºSunJCEæä¾›å•†æä¾›çš„ChaCha20å¯†ç æä¾›äº†ä¼˜åŒ–çš„å†…åœ¨å®ç°ã€‚è¿™äº›ä¼˜åŒ–çš„ä¾‹ç¨‹ä¸“ä¸ºæ”¯æŒAVXã€AVX2å’Œ&#x2F;æˆ–AVX512æŒ‡ä»¤é›†çš„x86_64èŠ¯ç‰‡ç»„ä»¥åŠæ”¯æŒé«˜çº§SIMDæŒ‡ä»¤é›†çš„aarch64èŠ¯ç‰‡ç»„è€Œè®¾è®¡ã€‚</li><li><strong>(D)TLS Key Exchange Named Groups</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8281236">JDK-8281236</a>) : åŠ å¯†åŠŸèƒ½å¢å¼º.</li><li><strong>DTLS Resumption Uses HelloVerifyRequest Messages</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8287411">JDK-8287411</a>) : åŠ å¯†åŠŸèƒ½å¢å¼º.</li></ul><h4 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h4><ul><li><strong>Javac Warns about Type Casts in Compound Assignments with Possible Lossy Conversions</strong>(<a href="https://bugs.openjdk.org/browse/JDK-8244681">JDK-8244681</a>) : javacå‘½ä»¤å¢åŠ äº†æœ‰æŸç±»å‹å¼ºè½¬è­¦å‘Š.</li><li><strong>New â€˜jmod â€“compressâ€™ Command Line Option</strong>(<a href="https://bugs.openjdk.org/browse/JDK-8293499">JDK-8293499</a>) : åœ¨jmodå·¥å…·ä¸­æ·»åŠ äº†ä¸€ä¸ªæ–°çš„â€“compresså‘½ä»¤è¡Œé€‰é¡¹ï¼Œä»¥ä¾¿åœ¨åˆ›å»ºJMODå­˜æ¡£æ—¶æŒ‡å®šå‹ç¼©çº§åˆ«ã€‚æ¥å—çš„å€¼æ˜¯zip-[0-9]ï¼Œå…¶ä¸­zip-0ä¸æä¾›å‹ç¼©ï¼Œzip-9æä¾›æœ€ä½³å‹ç¼©ã€‚é»˜è®¤æ˜¯zip-6ã€‚</li></ul><p>jdk20 å·¥å…·ç®±å…¨é›†<br><img src="/images/tech/java/java-bin-desc.png" alt="java-bin"></p><h4 id="è™šæ‹Ÿæœº"><a href="#è™šæ‹Ÿæœº" class="headerlink" title="è™šæ‹Ÿæœº"></a>è™šæ‹Ÿæœº</h4><ul><li><strong>add bean for Remark and Cleanup Pause Time in G1</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8297247">JDK-8297247</a>) : G1åƒåœ¾å›æ”¶åœ¨æ ‡è®°å’Œæ¸…ç†é˜¶æ®µå¼•å…¥äº†ä¸€ä¸ªæ–°çš„å›æ”¶bean : â€œG1 Concurrent GCâ€</li></ul><h3 id="ç§»å‡ºåŠŸèƒ½"><a href="#ç§»å‡ºåŠŸèƒ½" class="headerlink" title="ç§»å‡ºåŠŸèƒ½"></a>ç§»å‡ºåŠŸèƒ½</h3><ul><li><strong>Thread.suspend&#x2F;resume Changed to Throw UnsupportedOperationException</strong>  (<a href="https://bugs.openjdk.org/browse/JDK-8249627">JDK-8249627</a>) : åœ¨æ­¤ç‰ˆæœ¬ä¸­ï¼Œä½¿ç”¨Thread.suspend()å’ŒThread.resume()æ–¹æ³•æš‚åœæˆ–æ¢å¤çº¿ç¨‹çš„èƒ½åŠ›å·²è¢«åˆ é™¤ã€‚æ–¹æ³•å·²æ›´æ”¹ä¸ºæŠ›å‡ºUnsupportedOperationExceptionã€‚è¿™äº›æ–¹æ³•æœ¬è´¨ä¸Šå®¹æ˜“é™·å…¥åƒµå±€ï¼Œè‡ªJDK 1.2ï¼ˆ1998å¹´ï¼‰ä»¥æ¥å·²è¢«å¼ƒç”¨ã€‚ThreadGroupä¸­çš„ç›¸åº”æ–¹æ³•ï¼Œå³æš‚åœæˆ–æ¢å¤ä¸€ç»„çº¿ç¨‹ï¼Œå·²æ›´æ”¹ä¸ºåœ¨Java 19ä¸­æŠ›å‡ºUnsupportedOperationExceptionã€‚</li><li><strong>Thread.Stop Changed to Throw UnsupportedOperationException</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8289610">JDK-8289610</a>) : åœ¨æ­¤ç‰ˆæœ¬ä¸­ï¼Œä½¿ç”¨Thread.stop()æ–¹æ³•â€œåœæ­¢â€çº¿ç¨‹çš„åŠŸèƒ½å·²è¢«åˆ é™¤ã€‚è¯¥æ–¹æ³•å·²æ›´æ”¹ä¸ºæŠ›å‡ºUnsupportedOperationExceptionã€‚é€šè¿‡ä½¿å…¶æŠ›å‡ºjava.lang.ThreadDeathæ¥é˜»æ­¢çº¿ç¨‹æœ¬è´¨ä¸Šæ˜¯ä¸å®‰å…¨çš„ã€‚è‡ªJDK 1.2ï¼ˆ1998ï¼‰ä»¥æ¥ï¼Œåœæ­¢æ–¹æ³•å·²è¢«å¼ƒç”¨ã€‚ThreadGroupä¸­çš„ç›¸åº”æ–¹æ³•â€œåœæ­¢â€ä¸€ç»„çº¿ç¨‹ï¼Œå·²æ›´æ”¹ä¸ºåœ¨Java 19ä¸­æŠ›å‡ºUnsupportedOperationExceptionã€‚åŒæ—¶, java.lang.ThreadDeathä¹Ÿè¢«æ ‡è®°ä¸ºåºŸå¼ƒ.</li><li><strong>Remove Support for javac -source&#x2F;-target&#x2F;â€“release 7</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8173605">JDK-8173605</a>) : javacç§»å‡ºäº†ä¸€äº›é€‰é¡¹</li><li><strong>Improved Control of G1 Concurrent Refinement Threads</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8137022">JDK-8137022</a>): G1å¹¶å‘ç»†åŒ–çº¿ç¨‹çš„æ§åˆ¶å·²è¢«å®Œå…¨å–ä»£ã€‚æ–°æ§åˆ¶å™¨é€šå¸¸åˆ†é…æ›´å°‘çš„çº¿ç¨‹ã€‚å®ƒåœ¨ç»†åŒ–çº¿ç¨‹æ´»åŠ¨ä¸­çš„å³°å€¼å¾€å¾€è¾ƒå°‘ã€‚å®ƒè¿˜å€¾å‘äºå»¶è¿Ÿç»†åŒ–ï¼Œå½“å¯¹ç›¸åŒæˆ–é™„è¿‘ä½ç½®æœ‰å¤šä¸ªå†™å…¥æ—¶ï¼Œå…è®¸é€šè¿‡å†™å…¥å±éšœè¿›è¡Œæ›´å¤šè¿‡æ»¤ï¼Œä»è€Œæé«˜å±éšœçš„æ•ˆç‡ã€‚</li></ul><h3 id="åºŸå¼ƒåŠŸèƒ½"><a href="#åºŸå¼ƒåŠŸèƒ½" class="headerlink" title="åºŸå¼ƒåŠŸèƒ½"></a>åºŸå¼ƒåŠŸèƒ½</h3><ul><li><strong>java.net.URL Constructors Are Deprecated</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8294241">JDK-8294241</a>) : åºŸå¼ƒURLæ„é€ æ–¹æ³•,æ¨èä½¿ç”¨ java.net.URI æ¥æ„å»ºURL.</li><li><strong>Deprecate JMX Management Applets for Removal</strong> (<a href="https://bugs.openjdk.org/browse/DK-8297794">DK-8297794</a>) : åºŸå¼ƒJMX</li></ul><h2 id="å°ä¼˜åŒ–"><a href="#å°ä¼˜åŒ–" class="headerlink" title="å°ä¼˜åŒ–"></a>å°ä¼˜åŒ–</h2><p>è¿™é‡Œä¸»è¦ä»‹ç»ä¸€äº›å°çš„ä¼˜åŒ–, å¤ªé•¿å¯ä»¥ä¸çœ‹.</p><ul><li><strong>HTTP Response Input Streams Will Throw an IOException on Interrupt</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8294047">JDK-8294047</a>) :  httpè¯·æ±‚ä¸­æ–­æŠ›å‡ºå¼‚å¸¸</li><li><strong>HttpClient Default Keep Alive Time is 30 Seconds</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8297030">JDK-8297030</a>) : ç”±java.net.http.HttpClientåˆ›å»ºçš„HTTP&#x2F;1.1å’ŒHTTP&#x2F;2è¿æ¥çš„é»˜è®¤ç©ºé—²è¿æ¥è¶…æ—¶å€¼å·²ä»1200ç§’å‡å°‘åˆ°30ç§’</li><li><strong>Idle Connection Timeouts for HTTP&#x2F;2</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8288717">JDK-8288717</a>) : æ­¤ç‰ˆæœ¬ä¸­æ·»åŠ äº†HTTP&#x2F;2çš„ç©ºé—²è¿æ¥è¶…æ—¶ã€‚</li><li><strong>FileChannel Positional Write Is Unspecified in APPEND Mode</strong> (<a href="https://bugs.openjdk.org/browse/JDK-6924219">JDK-6924219</a>) : appendæ¨¡å¼ä¸‹,FileChannelå†™å…¥ä½ç½®å› æ“ä½œç³»ç»Ÿè€Œå®š</li><li><strong>Update Timezone Data to 2022c</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8292579">JDK-8292579</a>) : æ­¤ç‰ˆæœ¬åŒ…æ‹¬2022bçš„æ›´æ”¹ï¼Œå°†1970å¹´åå…·æœ‰ç›¸åŒæ—¶é—´æˆ³æ•°æ®çš„å¤šä¸ªåŒºåŸŸåˆå¹¶åˆ°å•ä¸ªæ—¶åŒºæ•°æ®åº“ä¸­ã€‚æ‰€æœ‰æ—¶åŒºIDä¿æŒä¸å˜ï¼Œä½†åˆå¹¶çš„æ—¶åŒºå°†æŒ‡å‘å…±äº«åŒºåŸŸæ•°æ®åº“ã€‚</li><li><strong>IdentityHashMapâ€™s Remove and Replace Methods Use Object Identity</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8178355">JDK-8178355</a>) : IdentityHashMapçš„è¿™ä¸¤ä¸ªæ–¹æ³•, å¯¹è±¡æ¯”è¾ƒç”± <code>equals</code> æ”¹ä¸º <code>==</code></li><li><strong>Support for CLDR Version 42</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8284840">JDK-8284840</a>) : åŸºäºUnicode Consortiumçš„CLDRçš„æœ¬åœ°æ•°æ®å·²å‡çº§åˆ°ç‰ˆæœ¬42</li><li><strong>Introduce LDAP and RMI Protocol Specific Object Factory Filters to JNDI Implementation</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8290368">JDK-8290368</a>) : å¼•å…¥äº†æ–°çš„ç³»ç»Ÿå’Œå®‰å…¨å±æ€§ï¼Œä»¥å…è®¸å¯¹å…è®¸ä»JNDI&#x2F;LDAPå’ŒJNDI&#x2F;RMIä¸Šä¸‹æ–‡é‡å»ºJavaå¯¹è±¡çš„JNDIå¯¹è±¡å·¥å‚é›†è¿›è¡Œæ›´ç²¾ç»†çš„æ§åˆ¶</li><li><strong>G1: Disable Preventive GCs by Default</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8293861">JDK-8293861</a>) : G1é»˜è®¤ç¦ç”¨Preventiveåƒåœ¾å›æ”¶å™¨</li><li><strong>appendToClassPathForInstrumentation Must Be Used in a Thread-Safe Manner</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8296472">JDK-8296472</a>) : å¦‚é¢˜, å½“æ—¶ç”¨java agentæ—¶,è‡ªå®šä¹‰ç±»åŠ è½½å™¨ä¸­çš„appendToClassPathForInstrumentationæ–¹æ³•å¿…é¡»ä»¥çº¿ç¨‹å®‰å…¨çš„æ–¹å¼æ·»åŠ åˆ°ç±»æœç´¢è·¯å¾„ä¸­ã€‚</li><li><strong>Deprecate and Disable Legacy Parallel Class Loading Workaround for Non-Parallel-Capable Class Loaders</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8295673">JDK-8295673</a>) :  ä¸€äº›ç”¨æˆ·å®šä¹‰çš„æ—§ç±»åŠ è½½å™¨ä¼šé€šè¿‡åœ¨åŠ è½½è¿‡ç¨‹ä¸­é‡Šæ”¾ç±»åŠ è½½å™¨é”æ¥è§£å†³æ­»é”é—®é¢˜ã€‚ä¸ºäº†é˜²æ­¢è¿™äº›åŠ è½½ç¨‹åºåœ¨é€šè¿‡å¹¶è¡Œçº¿ç¨‹åŠ è½½åŒä¸€ç±»æ—¶é‡åˆ°â€œjava.lang.LinkageErrorï¼šå°è¯•é‡å¤ç±»å®šä¹‰â€ï¼ŒHotSpotè™šæ‹Ÿæœºåœ¨JDK 6ä¸­å¼•å…¥äº†ä¸€ç§å˜é€šæ–¹æ³•ï¼Œå°†åŠ è½½å°è¯•åºåˆ—åŒ–ï¼Œå¯¼è‡´éšåçš„å°è¯•ç­‰å¾…ç¬¬ä¸€ä¸ªå®Œæˆ. ç°åœ¨å°†è¿™ç§å˜é€š æ–¹æ³•åºŸå¼ƒäº†</li><li><strong>Disabled DTLS 1.0</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8256660">JDK-8256660</a>)  : åºŸå¼ƒ DTLS 1.0</li><li><strong>Remove Thread Text from Subject.current</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8297276">JDK-8297276</a>) : åœ¨æ­¤ç‰ˆæœ¬ä¸­ï¼ŒSubject.currentçš„è§„èŒƒå·²æ›´æ”¹ï¼Œä»¥é™ä½åˆ›å»ºçº¿ç¨‹æ—¶ç»§æ‰¿ä¸»é¢˜çš„æœŸæœ›ã€‚æ­¤æ—¶ï¼Œä¸»é¢˜å­˜å‚¨åœ¨AccessControlContextä¸­ï¼Œå¹¶åœ¨åˆ›å»ºå¹³å°çº¿ç¨‹æ—¶è¢«ç»§æ‰¿ã€‚è™šæ‹Ÿçº¿ç¨‹åœ¨çº¿ç¨‹åˆ›å»ºæ—¶ä¸ä¼šæ•è·è°ƒç”¨è€…ä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸”ä¸ä¼šç»§æ‰¿AccessControlContextã€‚åœ¨åˆ é™¤å¯¹SecurityManagerå’Œç»§æ‰¿çš„AccessControlContextçš„æ”¯æŒä¹‹å‰ï¼Œå°†åœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­é‡æ–°å®¡æŸ¥ç»§æ‰¿ã€‚</li><li><strong>Generalize â€˜seeâ€™ and â€˜linkâ€™ Tags for User-Defined Anchors</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8200337">JDK-8200337</a>) : {@link}ã€{@linkplain}å’Œ@seeæ ‡ç­¾å·²å¢å¼ºï¼Œå…è®¸é“¾æ¥åˆ°JavaDocç”Ÿæˆçš„å…ƒç´ æ–‡æ¡£ä¸­çš„ä»»æ„é”šç‚¹ã€‚ä¸ºäº†åŒºåˆ†è¿™äº›å¼•ç”¨å’Œæˆå‘˜å¼•ç”¨ï¼Œä½¿ç”¨åŒæ•£åˆ—æ ‡è®°ï¼ˆ<code>##</code>ï¼‰å°†å…ƒç´ åç§°ä¸URIç‰‡æ®µåˆ†å¼€ã€‚</li></ul><h2 id="åè¯è§£æ"><a href="#åè¯è§£æ" class="headerlink" title="åè¯è§£æ"></a>åè¯è§£æ</h2><ul><li><p>HarfBuzz: ä¸€ä¸ªå¼€æºçš„ç”¨äºæ–‡å­—å¡‘å½¢çš„è½¯ä»¶å¼€å‘åº“ï¼Œäº¦å³ç”¨äºè½¬æ¢Unicodeæ–‡æœ¬åˆ°å­—å½¢æŒ‡æ ‡åŠæ–¹ä½çš„è¿‡ç¨‹</p></li><li><p>FreeType:  åŒHarfBuzzä¸€æ ·, ä¹Ÿæ˜¯ä¸€ä¸ªå¼€æºå­—ä½“åº“. å®ƒæ˜¯ä¸€ä¸ªç”¨Cè¯­è¨€å®ç°çš„ä¸€ä¸ªå­—ä½“å…‰æ …åŒ–åº“ã€‚å®ƒå¯ä»¥ç”¨æ¥å°†å­—ç¬¦æ …æ ¼åŒ–å¹¶æ˜ å°„æˆä½å›¾ä»¥åŠæä¾›å…¶ä»–å­—ä½“ç›¸å…³ä¸šåŠ¡çš„æ”¯æŒ</p></li><li><p>Preview(é¢„è§ˆ): åŠŸèƒ½å·²ç»åŸºæœ¬å®Œæ•´, å¯ä»¥è¯•ç”¨äº†. å¯ä»¥ç®€å•ç†è§£ä¸ºbetaå…¬æµ‹ç‰ˆ. æ¥æºäº <a href="https://openjdk.org/jeps/12">JEP12</a></p><blockquote><p>åŠŸèƒ½ä»¥é¢„è§ˆç‰ˆçš„å½¢å¼å‘å¸ƒï¼Œä»¥æ”¶é›†æœ‰å…³å®ƒä»¬çš„åé¦ˆè€Œä¸æ‰¿è¯ºä¿æŒå…¶å‘åå…¼å®¹æ€§â€”â€”è¿™æ„å‘³ç€é¼“åŠ±æ¯ä¸ªäººå°è¯•å®ƒä»¬ï¼Œä½†åŒæ—¶ä¸é¼“åŠ±åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨å®ƒä»¬ã€‚</p><p>é¢„è§ˆåŠŸèƒ½ä¸æ˜¯å¼€ç®±å³ç”¨çš„ï¼Œä¸ºäº†è®¿é—®å®ƒä»¬ï¼Œéœ€è¦ä½¿ç”¨*â€“enable-preview*ç¼–è¯‘å™¨æ ‡å¿—ã€‚</p></blockquote></li><li><p>Incubator(å­µåŒ–) : å®éªŒæ€§ APIå·²ç»åˆ°äº†ä¸€å®šé˜¶æ®µ, å·²ç»è®¡åˆ’å¼€å‘å‡ºä¸€æ•´å¥—å®Œæ•´çš„åŠŸèƒ½.ä»¥ç‹¬ç«‹æ¨¡å—çš„å½¢å¼å‘å¸ƒ. æ¥æºäº <a href="https://openjdk.org/jeps/11">JEP11</a></p></li><li><p>Experimental(å®éªŒ) : vmçº§çš„æ—©æœŸåŠŸèƒ½, ä¸ç¨³å®š, åŠŸèƒ½ä¸å®Œæ•´. å®éªŒæ€§è´¨.</p><blockquote><p>å®éªŒæ€§åŠŸèƒ½ä»£è¡¨ï¼ˆä¸»è¦æ˜¯ï¼‰VM çº§åŠŸèƒ½çš„æ—©æœŸç‰ˆæœ¬ï¼Œè¿™äº›åŠŸèƒ½å¯èƒ½æ˜¯æœ‰é£é™©çš„ã€ä¸å®Œæ•´çš„ï¼Œç”šè‡³æ˜¯ä¸ç¨³å®šçš„ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œéœ€è¦ä½¿ç”¨ä¸“ç”¨æ ‡å¿—å¯ç”¨å®ƒä»¬</p><p>å‡ºäºæ¯”è¾ƒçš„ç›®çš„ï¼Œå¦‚æœä¸€ä¸ªå®éªŒåŠŸèƒ½è¢«è®¤ä¸ºæ˜¯ 25%â€œå®Œæˆâ€ï¼Œé‚£ä¹ˆä¸€ä¸ªé¢„è§ˆåŠŸèƒ½åº”è¯¥è‡³å°‘ 95%â€œå®Œæˆâ€ã€‚</p><p>é¢„è§ˆ,å­µåŒ–,å®éªŒä¸‰è€…çš„å…³ç³»å¤§è‡´: å®éªŒ &#x3D;&gt; å­µåŒ– &#x3D;&gt; é¢„è§ˆ &#x3D;&gt; åˆå¹¶jdkä¸»ä½“åŠŸèƒ½.</p></blockquote></li><li><p>JEP : JDK Enhancement Proposal , jdkå¢å¼ºå»ºè®®. ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„jdkæ–°ç‰¹æ€§çš„æ¥æº. <a href="https://openjdk.org/jeps/0">JEPå¤§å…¨</a></p></li></ul><h2 id="å¾€æœŸæ–‡ç« "><a href="#å¾€æœŸæ–‡ç« " class="headerlink" title="å¾€æœŸæ–‡ç« "></a>å¾€æœŸæ–‡ç« </h2><p><a href="jdk-v19">jdk19æ–°ç‰¹æ€§</a></p><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><p><a href="https://docs.oracle.com/en/java/javase/20/">jdk20å®˜æ–¹æ–‡æ¡£</a><br><a href="https://www.oracle.com/java/technologies/javase/20-relnote-issues.html">jdk20æ–°ç‰¹æ€§æ–‡æ¡£</a><br><a href="https://docs.oracle.com/en/java/javase/20/migrate/getting-started.html">jdk20å‡çº§æŒ‡å—</a><br><a href="https://docs.oracle.com/en/java/javase/20/install/index.html">jdk20å®‰è£…æŒ‡å—</a><br><a href="https://cr.openjdk.org/~iris/se/20/latestSpec/">jdk20çš„å¼€å‘è®¡åˆ’</a><br><a href="https://docs.oracle.com/en/java/javase/20/vm/index.html">jdk20è™šæ‹Ÿæœºç®€ä»‹</a><br><a href="https://docs.oracle.com/en/java/javase/20/gctuning/index.html">jdk20åƒåœ¾å›æ”¶æœºåˆ¶</a><br><a href="https://docs.oracle.com/en/java/javase/20/security/index.html">jdk20å®‰å…¨æœºåˆ¶</a></p><p><a href="https://bugs.openjdk.org/secure/Dashboard.jspa">openjdk bugåé¦ˆç³»ç»Ÿ</a><br><a href="https://openjdk.org/">openjdkå®˜ç½‘</a><br><a href="https://4comprehension.com/preview-experimental-and-incubating-features-in-java/">jdkä¸­é¢„è§ˆ,å®éªŒ,å­µåŒ–çš„å…³ç³»</a>  </p>]]></content>
    
    
    <categories>
      
      <category>java</category>
      
      <category>javaç‰ˆæœ¬ç‰¹æ€§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>javaç‰ˆæœ¬ç‰¹æ€§</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é€šè¿‡frpå®ç°å†…ç½‘ç©¿é€åŠŸèƒ½</title>
    <link href="/2023/03/26/net-intranet-frp/"/>
    <url>/2023/03/26/net-intranet-frp/</url>
    
    <content type="html"><![CDATA[<p>è®©æˆ‘ä»¬ä»0å¼€å§‹æ­å»ºä¸€ä¸ªå¾ˆé…·çš„å†…ç½‘ç©¿é€åŠŸèƒ½.</p><p>ä½œä¸ºä¸€åç¨‹åºå‘˜,è°ä¸æƒ³æ‹¥æœ‰ä¸€ä¸ªè‡ªå·±çš„äº‘æœåŠ¡å™¨å‘¢. ä½†æ˜¯å½“æˆ‘ä»¬çœ‹äº†å„å¤§äº‘æœåŠ¡å™¨å‚å•†çš„ä»·æ ¼å, ä¸ç¦é™·å…¥äº†æ²‰æ€:æˆ‘å¥½åƒå¯¹äº‘æœåŠ¡å™¨çš„è¯‰æ±‚ä¹Ÿæ²¡é‚£ä¹ˆå¤§!<br>ç­‰æˆ‘ä»¬å›å®¶çœ‹åˆ°å®¶é‡Œé—²ç½®çš„è€æ—§ç”µè„‘æ—¶,åˆä¼šæƒ³,æˆ‘ä¸ºå•¥è¦ç”¨äº‘æœåŠ¡å™¨å‘¢,å®¶é‡Œçš„ç”µè„‘æ”¹å§æ”¹å§, ä¸ä¹Ÿå°±å¯ä»¥ç”¨äº†. æˆ‘ä»¬åˆä¸ç”¨åšå¤§æµé‡çš„ç½‘ç«™,<br>æœ€å¤šææåšå®¢,è·‘è·‘çˆ¬è™«å•¥çš„,åªè¦èƒ½è®©æˆ‘ä»¬å¯ä»¥éšæ—¶åœ¨å¤–é¢è®¿é—®æˆ‘å®¶é‡Œçš„ç”µè„‘,æ§åˆ¶å®¶é‡Œçš„ç”µè„‘å°±è¡Œäº†.<br>å¥½çš„,è¯´å¹²å°±å¹², ç»è¿‡ä¸€ç•ªè°ƒç ”, æˆ‘ä»¬å‘ç°, å¥½åƒæ²¡è‡ªå·±æƒ³è±¡çš„é‚£ä¹ˆç®€å•. ä¸€ä¸ªæœ€ç›´æ¥çš„é—®é¢˜å°±æ˜¯, æˆ‘ä»¬æ²¡æœ‰ä¸€ä¸ªè‡ªå·±çš„ip,å› ä¸ºä¼—æ‰€å‘¨çŸ¥çš„ipv4èµ„æºè€—å°½çš„é—®é¢˜,<br>æˆ‘ä»¬å®¶é‡Œå®é™…ä¸Šç½‘çš„ipå…¶å®ä¸æ˜¯å›ºå®šçš„, è€Œæ˜¯å¤šå®¶ç”¨æˆ·å…±äº«ä¸€ä¸ªipåœ°å€,ä¹Ÿå°±æ˜¯NAT(Network Address Translation)æŠ€æœ¯. æ‰€ä»¥,ä»å¤–ç½‘æˆ‘ä»¬æ˜¯æ— æ³•ç›´æ¥è®¿é—®å®¶é‡Œçš„ç”µè„‘çš„.<br>è¿™ä¸ªé—®é¢˜æ€ä¹ˆè§£å†³å‘¢? å°±æ˜¯æˆ‘ä»¬ä»Šå¤©è¦èŠçš„è¯é¢˜, å†…ç½‘ç©¿é€æŠ€æœ¯.</p><h1 id="ä»€ä¹ˆæ˜¯å†…ç½‘ç©¿é€"><a href="#ä»€ä¹ˆæ˜¯å†…ç½‘ç©¿é€" class="headerlink" title="ä»€ä¹ˆæ˜¯å†…ç½‘ç©¿é€"></a>ä»€ä¹ˆæ˜¯å†…ç½‘ç©¿é€</h1><p>å†…ç½‘ç©¿é€ï¼Œä¹Ÿå³NATç©¿é€ï¼Œè¿›è¡ŒNATç©¿é€æ˜¯ä¸ºäº†ä½¿å…·æœ‰æŸä¸€ä¸ªç‰¹å®šæºIPåœ°å€å’Œæºç«¯å£å·çš„æ•°æ®åŒ…ä¸è¢«NATè®¾å¤‡å±è”½è€Œæ­£ç¡®è·¯ç”±åˆ°å†…ç½‘ä¸»æœº.<br>å¤§è‡´æµç¨‹å¦‚å›¾:<br><img src="/images/tech/net/nat-through.png" alt="å†…ç½‘ç©¿é€å›¾"></p><h1 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h1><ol><li>ä¸€å°äº‘æœåŠ¡å™¨, æœ€ä¾¿å®œçš„å³å¯,æˆ‘ä»¬ä¸»è¦ç”¨å…¶æ¥æ³¨å†Œå†…ç½‘æœåŠ¡å™¨, è½¬å‘è¯·æ±‚</li><li>frpå·¥å…·</li><li>å®¶ç”¨ç”µè„‘,å°å¼,ç¬”è®°æœ¬éƒ½è¡Œ,æ“ä½œç³»ç»Ÿä»»æ„.</li></ol><h1 id="å¼€å§‹å†…ç½‘ç©¿é€"><a href="#å¼€å§‹å†…ç½‘ç©¿é€" class="headerlink" title="å¼€å§‹å†…ç½‘ç©¿é€"></a>å¼€å§‹å†…ç½‘ç©¿é€</h1><h2 id="äº‘æœåŠ¡å™¨æ­å»ºfrpæœåŠ¡"><a href="#äº‘æœåŠ¡å™¨æ­å»ºfrpæœåŠ¡" class="headerlink" title="äº‘æœåŠ¡å™¨æ­å»ºfrpæœåŠ¡"></a>äº‘æœåŠ¡å™¨æ­å»ºfrpæœåŠ¡</h2><p>å‚è€ƒ<a href="https://gofrp.org/docs/setup/">å®˜æ–¹å®‰è£…frpè¯´æ˜</a>, ä¸‹è½½åˆé€‚è‡ªå·±æœåŠ¡å™¨çš„frpç‰ˆæœ¬, è§£å‹åˆ°è‡ªå®šä¹‰çš„frpæœåŠ¡ç›®å½•.<br>å› ä¸ºæ˜¯æœåŠ¡å™¨éƒ¨åˆ†, æˆ‘ä»¬ç›´æ¥å¯ç”¨frps å³å¯å¯åŠ¨æˆåŠŸfrpçš„æœåŠ¡éƒ¨åˆ†. </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># å¯åŠ¨frps, å¹¶æŒ‡å®šé…ç½®æ–‡ä»¶ä¸ºfrps.ini </span><br>./frps -c ./frps.ini<br></code></pre></td></tr></table></figure><p>é…ç½®éƒ¨åˆ†å‚è€ƒ<a href="https://gofrp.org/docs/examples/">å®˜æ–¹é…ç½®æ ·ä¾‹</a>. æˆ‘ä»¬demoæ ·ä¾‹åªä½¿ç”¨sshåŸºæœ¬æœåŠ¡, å°±ç”¨äº†é»˜è®¤é…ç½®.</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[common]</span><br><span class="hljs-attr">bind_port</span> = <span class="hljs-number">7000</span><br></code></pre></td></tr></table></figure><h4 id="é…ç½®frpsä¸ºç³»ç»ŸæœåŠ¡-é€‰åš"><a href="#é…ç½®frpsä¸ºç³»ç»ŸæœåŠ¡-é€‰åš" class="headerlink" title="é…ç½®frpsä¸ºç³»ç»ŸæœåŠ¡(é€‰åš)"></a>é…ç½®frpsä¸ºç³»ç»ŸæœåŠ¡(é€‰åš)</h4><p>ä¸ºäº†æ–¹ä¾¿, æˆ‘ä»¬ä¸€èˆ¬ä¼šå°†frpsé…ç½®æˆç³»ç»Ÿé‡å¯è‡ªåŠ¨åŠ è½½. è¿™æ ·æˆ‘ä»¬å°±ä¸ç”¨æ‹…å¿ƒæœåŠ¡å™¨ç³»ç»Ÿé‡å¯å¯¼è‡´å†…ç½‘ç©¿é€æœåŠ¡æ‰çº¿äº†.<br>æ–¹æ³•å¦‚ä¸‹:</p><ol><li>å…ˆç¡®è®¤ç³»ç»Ÿæ”¯æŒ<code>systemd</code>, å¦‚æœä¸æ”¯æŒè¯·å®‰è£…</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># yum</span><br>yum install systemd<br><span class="hljs-comment"># apt</span><br>apt install systemd<br></code></pre></td></tr></table></figure><ol start="2"><li>é…ç½®frps.serviceæœåŠ¡</li></ol><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">vim <span class="hljs-regexp">/etc/</span>systemd<span class="hljs-regexp">/system/</span>frps.service<br></code></pre></td></tr></table></figure><p>å†™å…¥ä¸‹é¢å†…å®¹</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[Unit]</span><br><span class="hljs-comment"># æœåŠ¡åç§°ï¼Œå¯è‡ªå®šä¹‰</span><br><span class="hljs-attr">Description</span> = frp server<br><span class="hljs-attr">After</span> = network.target syslog.target<br><span class="hljs-attr">Wants</span> = network.target<br><br><span class="hljs-section">[Service]</span><br><span class="hljs-attr">Type</span> = simple<br><span class="hljs-comment"># å¯åŠ¨frpsçš„å‘½ä»¤ï¼Œéœ€ä¿®æ”¹ä¸ºæ‚¨çš„frpsçš„å®‰è£…è·¯å¾„</span><br><span class="hljs-attr">ExecStart</span> = /path/to/frps -c /path/to/frps.ini<br><br><span class="hljs-section">[Install]</span><br><span class="hljs-attr">WantedBy</span> = multi-user.target<br></code></pre></td></tr></table></figure><ol start="3"><li>å¼€æœºè‡ªåŠ¨å¯åŠ¨</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">systemctl <span class="hljs-built_in">enable</span> frps<br></code></pre></td></tr></table></figure><h2 id="å®¶ç”¨ç”µè„‘å®‰è£…frpå®¢æˆ·ç«¯"><a href="#å®¶ç”¨ç”µè„‘å®‰è£…frpå®¢æˆ·ç«¯" class="headerlink" title="å®¶ç”¨ç”µè„‘å®‰è£…frpå®¢æˆ·ç«¯"></a>å®¶ç”¨ç”µè„‘å®‰è£…frpå®¢æˆ·ç«¯</h2><p>æˆ‘å®¶é‡Œçš„ç”µè„‘æ˜¯windows10, å½“ç„¶, Linuxæ›´å¥½. æœ¬æ¬¡å†…ç½‘ç©¿é€çš„ç›®çš„æ˜¯å¯ä»¥é€šè¿‡è¿œç¨‹sshæ§åˆ¶æˆ‘çš„å®¶ç”¨ç”µè„‘.</p><h4 id="win10çš„ä¸€äº›å‡†å¤‡åŠŸèƒ½"><a href="#win10çš„ä¸€äº›å‡†å¤‡åŠŸèƒ½" class="headerlink" title="win10çš„ä¸€äº›å‡†å¤‡åŠŸèƒ½"></a>win10çš„ä¸€äº›å‡†å¤‡åŠŸèƒ½</h4><p>windowsç³»ç»Ÿä½œä¸ºå®¶ç”¨æœ¬, å¯¹ç½‘ç»œæƒé™é™åˆ¶çš„æ¯”è¾ƒå¤š, éœ€è¦æˆ‘ä»¬é¢å¤–åšä¸€äº›æ“ä½œ.<br>a. å®‰è£…windowsçš„sshæœåŠ¡ç«¯<br>win10é»˜è®¤æ˜¯ä¸æ”¯æŒsshçš„æœåŠ¡ç«¯çš„, éœ€è¦æˆ‘ä»¬å®‰è£…ç›¸åº”çš„OpenSSHæœåŠ¡å™¨.<br>æ“ä½œæ­¥éª¤: è®¾ç½®-&gt;åº”ç”¨-&gt; åº”ç”¨ä¸åŠŸèƒ½ -&gt; å¯é€‰åŠŸèƒ½ -&gt; æ·»åŠ OpenSSHæœåŠ¡å™¨<br><img src="/images/tech/windows/windows_openssh_step1.png" alt="openssh-s1"><br><img src="/images/tech/windows/windows_openssh_step2.png" alt="openssh-s2"><br><img src="/images/tech/windows/windows_openssh_step3.png" alt="openssh-s3"><br>æœ€åå¼€å¯sshæœåŠ¡,ä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€cmdç»ˆç«¯,æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤    </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">net start sshd<br></code></pre></td></tr></table></figure><p>b. é˜²ç«å¢™å¯èƒ½ä¼šå°†frpcè¯†åˆ«ä¸ºå±é™©æ–‡ä»¶, è®°å¾—å»é˜²ç«å¢™é‚£é‡Œå°†å·¥å…·æ¢å¤. </p><h4 id="é…ç½®frpå®¢æˆ·ç«¯"><a href="#é…ç½®frpå®¢æˆ·ç«¯" class="headerlink" title="é…ç½®frpå®¢æˆ·ç«¯"></a>é…ç½®frpå®¢æˆ·ç«¯</h4><p>ä»å®˜ç½‘ä¸‹è½½ä¸‹frpcå®¢æˆ·ç«¯å,ä¸”æˆåŠŸä»é˜²ç«å¢™é‚£é‡Œé€ƒç”Ÿ, å°±å¯ä»¥ç»§ç»­åé¢çš„æ“ä½œäº†<br>é¦–å…ˆåŒæ ·å…ˆä¿®æ”¹é…ç½®æ–‡ä»¶</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[common]</span><br><span class="hljs-comment"># ä½ çš„äº‘æœåŠ¡å™¨å®é™…ip</span><br><span class="hljs-attr">server_addr</span> = x.x.x.x <br><span class="hljs-comment"># äº‘æœåŠ¡é…ç½®çš„ç«¯å£</span><br><span class="hljs-attr">server_port</span> = <span class="hljs-number">7000</span><br><br><span class="hljs-section">[ssh]</span><br><span class="hljs-attr">type</span> = tcp<br><span class="hljs-attr">local_ip</span> = <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><br><span class="hljs-comment"># æœ¬åœ°è¦æš´éœ²çš„ç«¯å£, windowsç½‘ç»œé™åˆ¶æ¯”è¾ƒä¸¥æ ¼,è®°å¾—å»é˜²ç«å¢™æ‰“å¼€ç›¸åº”ç«¯å£</span><br><span class="hljs-attr">local_port</span> = <span class="hljs-number">22</span><br><span class="hljs-comment"># è¿œç¨‹æœåŠ¡å™¨ç›‘å¬çš„ç«¯å£. æ„æ€å°±æ˜¯frpsæœåŠ¡å™¨ç›‘å¬6000çš„ç«¯å£, ç„¶åæŠŠè¯·æ±‚è½¬å‘çš„æœ¬åœ°çš„22ç«¯å£ä¸Š.</span><br><span class="hljs-attr">remote_port</span> = <span class="hljs-number">6000</span><br></code></pre></td></tr></table></figure><p>ç„¶åæ‰“å¼€cmdç»ˆç«¯ä½¿ç”¨å‘½ä»¤è¡Œçš„æ–¹å¼å¯åŠ¨frpcå·¥å…·<br>æœ€åå°±å¯ä»¥åœ¨å¤–ç½‘ä½¿ç”¨sshå‘½ä»¤è®¿é—®ä½ çš„ç³»ç»Ÿäº†</p><figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gml">ssh -oPort=<span class="hljs-number">6000</span> ä½ çš„ç³»ç»Ÿç”¨æˆ·å@<span class="hljs-variable language_">x</span>.<span class="hljs-variable language_">x</span>.<span class="hljs-variable language_">x</span>.<span class="hljs-variable language_">x</span><br></code></pre></td></tr></table></figure><p>frp ä¼šå°†è¯·æ±‚ x.x.x.x:6000 çš„æµé‡è½¬å‘åˆ°å†…ç½‘æœºå™¨çš„ 22 ç«¯å£</p><h4 id="ä¿®æ”¹windowé»˜è®¤ç»ˆç«¯ä¸ºpowerShell-é€‰åš"><a href="#ä¿®æ”¹windowé»˜è®¤ç»ˆç«¯ä¸ºpowerShell-é€‰åš" class="headerlink" title="ä¿®æ”¹windowé»˜è®¤ç»ˆç«¯ä¸ºpowerShell(é€‰åš)"></a>ä¿®æ”¹windowé»˜è®¤ç»ˆç«¯ä¸ºpowerShell(é€‰åš)</h4><p>windowsçš„é»˜è®¤ç»ˆç«¯ä¸ºcmd, å¾ˆå¤šå‘½ä»¤ä¸ä¸linuxå…¼å®¹. æ‰€ä»¥å»ºè®®å°†windowsçš„é»˜è®¤ç»ˆç«¯æ”¹ä¸ºpowerShell, æ›´æ–¹ä¾¿.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">New-ItemProperty -Path <span class="hljs-string">&quot;HKLM:\SOFTWARE\OpenSSH&quot;</span> -Name DefaultShell -Value <span class="hljs-string">&quot;C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe&quot;</span> -PropertyType String -Force<br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://gofrp.org/">frpå®˜ç½‘</a>  </li><li><a href="https://learn.microsoft.com/zh-cn/windows-server/administration/openssh/openssh_server_configuration?source=recommendations">windowsé…ç½®é»˜è®¤ shell</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹äººç”Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å†…ç½‘ç©¿é€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>macç³»ç»Ÿé€šè¿‡homebrewå®‰è£…nginx</title>
    <link href="/2023/03/24/homebrew-install-nginx/"/>
    <url>/2023/03/24/homebrew-install-nginx/</url>
    
    <content type="html"><![CDATA[<h1 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h1><ul><li>macç³»ç»Ÿ</li><li>homebrew ç¯å¢ƒå·²ç»é…ç½®å¥½</li></ul><h1 id="æ“ä½œæ­¥éª¤"><a href="#æ“ä½œæ­¥éª¤" class="headerlink" title="æ“ä½œæ­¥éª¤"></a>æ“ä½œæ­¥éª¤</h1><ol><li>æŸ¥çœ‹æœ¬åœ°æ˜¯å¦å®‰è£…nginx</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">brew search nginx<br></code></pre></td></tr></table></figure><p><img src="/images/tech/nginx/brew-search-nginx-not-find.png" alt="brew-search-nginx-not-find"><br>nginxä¸Šé¢æ²¡æœ‰æ˜¾ç¤ºâœ“,è¡¨ç¤ºnginxæ²¡æœ‰å®‰è£…</p><ol start="2"><li>æŸ¥çœ‹nginxä¿¡æ¯</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">brew info nginx<br></code></pre></td></tr></table></figure><p><img src="/images/tech/nginx/brew-info-nginx-not-find.png" alt="brew-info-nginx-not-find"><br>å¦‚å›¾æ‰€ç¤º,æ˜¾ç¤ºäº†nginxçš„ç‰ˆæœ¬. ä¹Ÿæ˜ç¡®è¯´æ˜äº†ç³»ç»Ÿæ²¡æœ‰å®‰è£…nginx<br>3. å®‰è£…nginx</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">brew install nginx<br></code></pre></td></tr></table></figure><p><img src="/images/tech/nginx/brew-install-nginx-success.png" alt="brew-install-nginx-success"><br>å®‰è£…nginxæˆåŠŸ.<br>nginxé»˜è®¤ç›‘å¬8080ç«¯å£, é…ç½®æ–‡ä»¶è·¯å¾„ä¹Ÿç»™å‡ºæ¥äº† <em>&#x2F;opt&#x2F;homebrew&#x2F;etc&#x2F;nginx&#x2F;nginx.conf</em><br>åŒæ—¶ä¹Ÿç»™äº†å¯åŠ¨nginxçš„å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">brew services start nginx<br></code></pre></td></tr></table></figure><p>4.éªŒè¯å®‰è£…æˆåŠŸ<br>æ­¤æ—¶,nginxå‘½ä»¤å·²ç»ç”Ÿæ•ˆäº†.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nginx -v<br></code></pre></td></tr></table></figure><p><img src="/images/tech/nginx/nginx-version.png" alt="nginx-version"></p><p>å½“ç„¶, ä¹Ÿå¯ä»¥æ‰§è¡Œä¸‹é¢å‘½ä»¤æŸ¥çœ‹æ›´è¯¦ç»†çš„ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nginx -V<br></code></pre></td></tr></table></figure><p>è‡³æ­¤,nginxå·²ç»å®‰è£…æˆåŠŸäº†. å¯ä»¥é€šè¿‡å»é…ç½®æ–‡ä»¶ä¿®æ”¹ç›¸åº”é…ç½®, å¯åŠ¨nginxäº†</p><h1 id="å¯åŠ¨nginx"><a href="#å¯åŠ¨nginx" class="headerlink" title="å¯åŠ¨nginx"></a>å¯åŠ¨nginx</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># å¯åŠ¨</span><br>nginx<br>brew services start nginx<br></code></pre></td></tr></table></figure><p>å¯åŠ¨æˆåŠŸäº†,æ­¤æ—¶å¯ä»¥é€šè¿‡ <a href="http://localhost:8080/">http://localhost:8080</a> éªŒè¯ä¸€ä¸‹<br><img src="/images/tech/nginx/nginx-http-success.png" alt="nginx-http"></p><h1 id="è¡¥å……nginxçš„å¸¸ç”¨å‘½ä»¤"><a href="#è¡¥å……nginxçš„å¸¸ç”¨å‘½ä»¤" class="headerlink" title="è¡¥å……nginxçš„å¸¸ç”¨å‘½ä»¤"></a>è¡¥å……nginxçš„å¸¸ç”¨å‘½ä»¤</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æŸ¥çœ‹ç‰ˆæœ¬</span><br>nginx -v<br>nginx -V<br><br><span class="hljs-comment"># å¯åŠ¨</span><br>nginx <span class="hljs-comment"># åŠ è½½é»˜è®¤é…ç½®</span><br>nginx -c é…ç½®æ–‡ä»¶è·¯å¾„ <span class="hljs-comment"># åŠ è½½æŒ‡å®šé…ç½®æ–‡ä»¶</span><br>brew services start nginx<br><br><br><span class="hljs-comment"># åœæ­¢</span><br>nginx -s stop <span class="hljs-comment"># å¿«é€Ÿåœæ­¢</span><br>nginx -s quit <span class="hljs-comment"># å®‰å…¨åœæ­¢</span><br><br><span class="hljs-comment"># ä¸é‡å¯åŠ è½½é…ç½®</span><br>nginx -s reload <br><br><span class="hljs-comment"># éªŒè¯é…ç½®</span><br>nginx -t <br><br></code></pre></td></tr></table></figure><p>å¥½çš„, æ¥ä¸‹æ¥å°½æƒ…ä½¿ç”¨è‡ªå·±çš„nginxæœåŠ¡å™¨å§!</p>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹äººç”Ÿ</category>
      
      <category>nginx</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nginx</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é¢è¯•æ—¶åˆ»</title>
    <link href="/2023/01/12/favorite-show-your-time/"/>
    <url>/2023/01/12/favorite-show-your-time/</url>
    
    <content type="html"><![CDATA[<h2 id="æ¯”è¾ƒå¥½çš„åˆ·é¢˜ç½‘ç«™"><a href="#æ¯”è¾ƒå¥½çš„åˆ·é¢˜ç½‘ç«™" class="headerlink" title="æ¯”è¾ƒå¥½çš„åˆ·é¢˜ç½‘ç«™"></a>æ¯”è¾ƒå¥½çš„åˆ·é¢˜ç½‘ç«™</h2><ol><li><p><a href="https://leetcode.cn/">leetcode</a> : å¦‚æœæ˜¯é¢å‘é¢è¯•åˆ·é¢˜çš„è¯,å»ºè®®ç›´æ¥åˆ·top100. ä¸ªäººæ„Ÿè§‰æ²¡å¿…è¦èŠ±é’±.</p></li><li><p><a href="https://codetop.cc/home">codetop</a> : ä¸€ä½å¤§ä½¬æœé›†çš„çƒ­é—¨ç¬”è¯•é¢˜, ä¹Ÿä¸é”™.</p></li></ol><h2 id="æ¯”è¾ƒå¥½çš„å­¦ä¹ ç½‘ç«™"><a href="#æ¯”è¾ƒå¥½çš„å­¦ä¹ ç½‘ç«™" class="headerlink" title="æ¯”è¾ƒå¥½çš„å­¦ä¹ ç½‘ç«™"></a>æ¯”è¾ƒå¥½çš„å­¦ä¹ ç½‘ç«™</h2><ol><li><a href="https://www.pdai.tech/">Java å…¨æ ˆçŸ¥è¯†ä½“ç³»</a> : å¾ˆä¸é”™</li><li><a href="https://www.cmsblogs.com/">JavaæŠ€æœ¯é©¿ç«™</a> : çœ‹æ–‡ç« éœ€è¦å…³æ³¨å…¬ä¼—å·</li><li><a href="https://github.com/xuchengsheng/spring-reading/blob/master/README.md">github springæºç é˜…è¯»</a></li></ol><h2 id="å¤§å‚æŠ€æœ¯æ–‡ç« "><a href="#å¤§å‚æŠ€æœ¯æ–‡ç« " class="headerlink" title="å¤§å‚æŠ€æœ¯æ–‡ç« "></a>å¤§å‚æŠ€æœ¯æ–‡ç« </h2><ol><li><a href="https://tech.meituan.com/">ç¾å›¢æŠ€æœ¯</a> : javaä½“ç³», æœ€è¿‘aiçš„æ–‡ç« å¤šèµ·æ¥äº†.</li><li><a href="http://mysql.taobao.org/monthly/">é˜¿é‡Œå·´å·´æ•°æ®åº“å†…æ ¸æœˆæŠ¥</a></li></ol><h2 id="ç®—æ³•ä¸æ•°æ®ç»“æ„"><a href="#ç®—æ³•ä¸æ•°æ®ç»“æ„" class="headerlink" title="ç®—æ³•ä¸æ•°æ®ç»“æ„"></a>ç®—æ³•ä¸æ•°æ®ç»“æ„</h2><ol><li><a href="https://www.cs.usfca.edu/~galles/visualization/about.html">å¯è§†åŒ–æ•°æ®ç»“æ„</a></li></ol><h2 id="å·¥å…·ç½‘ç«™"><a href="#å·¥å…·ç½‘ç«™" class="headerlink" title="å·¥å…·ç½‘ç«™"></a>å·¥å…·ç½‘ç«™</h2><ol><li><a href="https://devhints.io/bash">bashå‘½ä»¤æŸ¥çœ‹</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹äººç”Ÿ</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>esåœ¨javaå·¥ç¨‹ä¸­å¦‚ä½•æ”¯æŒè‡ªå®šä¹‰çš„jsonæ ¼å¼çš„DSL</title>
    <link href="/2022/11/17/es-query-dsl-wrapper/"/>
    <url>/2022/11/17/es-query-dsl-wrapper/</url>
    
    <content type="html"><![CDATA[<h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><h3 id="ç‰ˆæœ¬"><a href="#ç‰ˆæœ¬" class="headerlink" title="ç‰ˆæœ¬"></a>ç‰ˆæœ¬</h3><ul><li>Elasticsearch : v 6.6</li><li>elasticsearch-rest-high-level-client.jar : v 6.6.2</li></ul><h3 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h3><p>æƒ³æä¾›ä¸€ä¸ªwebæ¥å£, å…¥å‚å°±æ˜¯esçš„æŸ¥è¯¢DSL json. ç„¶åæœåŠ¡å™¨ç”¨è¿™ä¸ªDSLé€ä¼ è½¬å‘åˆ°ElasticsearchæœåŠ¡æœŸ, å°†æ•°æ®è¿”å›ç»™æ¥å£.<br>ç®€å•æ¥è¯´, å°±æ˜¯æƒ³åœ¨è‡ªå·±æœåŠ¡å™¨ä¸Šå®ç°ç±»ä¼¼kibanaä¸ŠæŸ¥è¯¢Elasticsearchæ•°æ®çš„åŠŸèƒ½.   </p><p>æ¯”å¦‚, æˆ‘ä»¬æ­£å¸¸çš„æŸ¥è¯¢DSLå¦‚ä¸‹:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;size&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;query&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;bool&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;filter&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><br>                <span class="hljs-punctuation">&#123;</span><br>                    <span class="hljs-attr">&quot;terms&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>                        <span class="hljs-attr">&quot;userCode&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><br>                            <span class="hljs-string">&quot;110111&quot;</span><br>                        <span class="hljs-punctuation">]</span><br>                    <span class="hljs-punctuation">&#125;</span><br>                <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-punctuation">&#123;</span><br>                    <span class="hljs-attr">&quot;term&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>                        <span class="hljs-attr">&quot;address&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>                            <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;beijing&quot;</span><br>                        <span class="hljs-punctuation">&#125;</span><br>                    <span class="hljs-punctuation">&#125;</span><br>                <span class="hljs-punctuation">&#125;</span><br>            <span class="hljs-punctuation">]</span><br>        <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h1 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h1><h3 id="æŸ¥è¯¢"><a href="#æŸ¥è¯¢" class="headerlink" title="æŸ¥è¯¢"></a>æŸ¥è¯¢</h3><p>å¦‚æœæ˜¯å•çº¯çš„æŸ¥è¯¢, å®˜æ–¹æä¾›äº†ä¸€ä¸ªé€ä¼ æŸ¥è¯¢DSLçš„å®ç°ç±» <code>QueryBuilders.wrapperQuery()</code>, å¯ä»¥é€šè¿‡è¿™ä¸ªQueryBuildersæ¥å®ç°æˆ‘ä»¬è‡ªå®šä¹‰DSLçš„é€ä¼ .<br>è®©æˆ‘ä»¬å…ˆçœ‹çœ‹å®˜æ–¹æ€ä¹ˆè¯´</p><blockquote><p>A query that accepts any other query as base64 encoded string.<br>This query is more useful in the context of the Java high-level REST client or transport client to also accept queries as json formatted string. In these cases queries can be specified as a json or yaml formatted string or as a query builder (which is a available in the Java high-level REST client).</p></blockquote><p>å®˜æ–¹ç¤ºä¾‹:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -X GET <span class="hljs-string">&quot;localhost:9200/_search?pretty&quot;</span> -H <span class="hljs-string">&#x27;Content-Type: application/json&#x27;</span> -d<span class="hljs-string">&#x27;</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">    &quot;query&quot; : &#123;</span><br><span class="hljs-string">        &quot;wrapper&quot;: &#123;</span><br><span class="hljs-string">            &quot;query&quot; : &quot;eyJ0ZXJtIiA6IHsgInVzZXIiIDogIktpbWNoeSIgfX0=&quot; </span><br><span class="hljs-string">        &#125;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">&#x27;</span><br></code></pre></td></tr></table></figure><p>ç”±æ­¤å¯è§, å®˜æ–¹æ˜¯å°†wrapperå½“åšä¸€ä¸ªå…³é”®å­—ç±»å‹æ¥å¤„ç†çš„, å°†æˆ‘ä»¬çš„æŸ¥è¯¢DSLè½¬æˆbase64,äº¤ç»™esæœåŠ¡å™¨è§£æå¤„ç†.<br>å¥½,ä¸‹é¢å°±æ˜¯æˆ‘ä»¬å°†ä¸Šè¿°DSL é€šè¿‡<code>QueryBuilders.wrapperQuery()</code>å¤„ç†åçš„sql.</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;wrapper&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;query&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;eyJzaXplIjoxLCJxdWVyeSI6eyJib29sIjp7ImZpbHRlciI6W3sidGVybXMiOnsidXNlckNvZGUiOlsiMTEwMTExIl19fSx7InRlcm0iOnsiYWRkcmVzcyI6eyJ2YWx1ZSI6ImJlaWppbmcifX19XX19fQ==&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>å¤§å®¶å¯ä»¥æ‰¾ä¸ªbase64è§£ç ç½‘ç«™å¤„ç†ä¸€ä¸‹, å‘ç°å’Œæˆ‘ä»¬çš„DSLä¸€æ ·. ç„¶åç”¨å®˜æ–¹çš„æ–¹å¼å¤„ç†ä¸‹</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;query&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;wrapper&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;query&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;eyJzaXplIjoxLCJxdWVyeSI6eyJib29sIjp7ImZpbHRlciI6W3sidGVybXMiOnsidXNlckNvZGUiOlsiMTEwMTExIl19fSx7InRlcm0iOnsiYWRkcmVzcyI6eyJ2YWx1ZSI6ImJlaWppbmcifX19XX19fQ==&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>å”‰, å‘ç°æŸ¥è¯¢æŠ¥é”™äº†, ä¸ºä»€ä¹ˆå‘¢?<br><img src="/images/tech/es/es_size_query_malformed.png" alt="size malformed"></p><p>å…¶å®ä»”ç»†åˆ†æä¸€ä¸‹,å¾ˆå®¹æ˜“å‘ç°é—®é¢˜. æˆ‘ä»¬å°†base64è¿˜åŸ,çœ‹çœ‹æœ€åçš„æŸ¥è¯¢DSLçš„æ ·å­</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;query&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;wrapper&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;query&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;size&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;query&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>          <span class="hljs-attr">&quot;bool&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;filter&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;terms&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;userCode&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-string">&quot;110111&quot;</span><span class="hljs-punctuation">]</span><br>                <span class="hljs-punctuation">&#125;</span><br>              <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>              <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;term&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>                  <span class="hljs-attr">&quot;address&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;beijing&quot;</span><span class="hljs-punctuation">&#125;</span><br>                <span class="hljs-punctuation">&#125;</span><br>              <span class="hljs-punctuation">&#125;</span><br>            <span class="hljs-punctuation">]</span><br>          <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>å‘ç°æ²¡, queryé‡Œå¥—query, æ˜æ˜¾æŸ¥è¯¢æœ‰é—®é¢˜. å…¶å®è¿™é‡Œesè§£æçš„æ—¶å€™, å‘ç°wrapperå…³é”®å­—, å°±ä¼šå°†ä¸‹é¢çš„queryæŸ¥è¯¢æ›¿æ¢åŸå§‹query.    </p><p>æ‰€ä»¥æˆ‘ä»¬è¦å°†wrapperçš„ä¸æ˜¯åŸå§‹å®Œæ•´çš„DSL,è€Œæ˜¯queryä¸‹é¢çš„DSL. æˆ‘ä»¬å°†boolå…³é”®å­—çš„JSONé‡æ–°å•ç‹¬æ‹¿å‡ºæ¥å¤„ç†ä¸‹</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;query&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;wrapper&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;query&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;eyJib29sIjp7ImZpbHRlciI6W3sidGVybXMiOnsidXNlckNvZGUiOlsiMTEwMTExIl19fSx7InRlcm0iOnsiYWRkcmVzcyI6eyJ2YWx1ZSI6ImJlaWppbmcifX19XX19&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>æå®š, æŠŠä¸Šè¿°DSLæ”¾åˆ°ä»»ä½•ä¸€ä¸ªesçš„webå®¢æˆ·ç«¯æŸ¥è¯¢, éƒ½æœ‰æ•ˆ.  </p><h3 id="èšåˆ"><a href="#èšåˆ" class="headerlink" title="èšåˆ"></a>èšåˆ</h3><p>å…³äºèšåˆçš„åŠŸèƒ½, å®˜æ–¹æ²¡æœ‰æä¾›ç°æˆçš„è§£ææ–¹æ³•.<br>ä¸è¿‡æˆ‘è§‰å¾—, æ—¢ç„¶esçš„webç«¯å¯ä»¥è°ƒç”¨ä»»æ„DSL, é€šè¿‡javaè‚¯å®šèƒ½, å¤§ä¸äº†å°±è·³è¿‡<em>RestHighLevelClient</em>, <em>åœ¨RestLowLevelClient</em>ä¸Šæƒ³åŠæ³•.  </p><p>&#x2F;&#x2F; todo ç­‰æˆ‘æ‰¾åˆ°åˆé€‚çš„åŠæ³•å†è¡¥å…….</p><h3 id="javaæºç "><a href="#javaæºç " class="headerlink" title="javaæºç "></a>javaæºç </h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">search</span><span class="hljs-params">(String boolJson)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br><br>        <span class="hljs-type">SearchSourceBuilder</span> <span class="hljs-variable">searchSourceBuilder</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SearchSourceBuilder</span>();<br>        <span class="hljs-comment">// query dsl åŒ…è£…</span><br>        searchSourceBuilder.query(QueryBuilders.wrapperQuery(boolJson));<br>        searchSourceBuilder.size(<span class="hljs-number">1</span>);<br>        <br>        Optional&lt;SearchResponse&gt; response = restHighLevelClient.search(searchSourceBuilder);<br>    &#125;   <br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://www.elastic.co/guide/en/elasticsearch/client/java-rest/6.6/java-rest-overview.html">java-rest-client 6.6</a></li><li><a href="https://www.elastic.co/guide/en/elasticsearch/client/java-rest/6.6/java-rest-high-query-builders.html">java-rest-high-query-builders 6.6</a></li><li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.6/query-dsl-wrapper-query.html">query-dsl-wrapper-query 6.6</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹äººç”Ÿ</category>
      
      <category>Elasticsearch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>elasticsearch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>macOSå‡çº§13 venturaågitæ— æ³•ä½¿ç”¨çš„è§£å†³åŠæ³•</title>
    <link href="/2022/11/01/git-in-mac13-invalid/"/>
    <url>/2022/11/01/git-in-mac13-invalid/</url>
    
    <content type="html"><![CDATA[<h1 id="ç°è±¡"><a href="#ç°è±¡" class="headerlink" title="ç°è±¡"></a>ç°è±¡</h1><p>æœ€è¿‘, macæ¨é€äº†æ–°ç‰ˆæœ¬ç³»ç»Ÿ, macOS 13 venturaç‰ˆæœ¬. ç„¶åå¿ä¸ä½å‡çº§äº†. å‡çº§è¿‡ç¨‹ä¸èµ˜è¿°, ç­‰ç€å°±è¡Œäº†.</p><p>å‡çº§å®Œæˆå, æ‰“å¼€idea, å‘ç°<code>git</code>æ— æ³•ä½¿ç”¨äº†, æç¤ºå¦‚ä¸‹:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">xcrun: error: invalid active developer path (<span class="hljs-regexp">/Library/</span>Developer<span class="hljs-regexp">/CommandLineTools), missing xcrun at: /</span>Library<span class="hljs-regexp">/Developer/</span>CommandLineTools<span class="hljs-regexp">/usr/</span>bin/xcrun<br></code></pre></td></tr></table></figure><p>ä¸ç”¨è¯´, ä¸€å®šæ˜¯å‡çº§å¯¼è‡´çš„é—®é¢˜.</p><h1 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h1><p>ç»è¿‡ä¸€ç•ªæ’æŸ¥, å‘ç°æ˜¯macçš„å¼€å‘å·¥å…·Xcodeéœ€è¦å‡çº§åˆ°14æ‰è¡Œ. å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è§£å†³, å®æµ‹æœ‰æ•ˆ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">xcode-select --install<br></code></pre></td></tr></table></figure><p>åŸºæœ¬åˆ°è¿™é‡Œ, é—®é¢˜å°±è§£å†³äº†.<br>å¦‚ä½•è¿˜ä¸è¡Œ, å¯ä»¥è‡ªè¡Œåˆ°<a href="https://developer.apple.com/download/more/">å®˜ç½‘</a>ä¸‹è½½è½¯ä»¶å®‰è£…å³å¯.<br><img src="/images/others/mac_xcode14.png" alt="xcode14å›¾ç‰‡"></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æ²¡äº‹åˆ«ä¹±å‡çº§ç³»ç»Ÿ</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://stackoverflow.com/questions/52522565/git-is-not-working-after-macos-update-xcrun-error-invalid-active-developer-pa">è§£å†³æ–¹æ¡ˆ</a></p>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹äººç”Ÿ</category>
      
      <category>git</category>
      
    </categories>
    
    
    <tags>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JDK 19æ–°ç‰¹æ€§ç®€ä»‹</title>
    <link href="/2022/10/20/java-jdk-v19/"/>
    <url>/2022/10/20/java-jdk-v19/</url>
    
    <content type="html"><![CDATA[<p>JDK 19åœ¨2022å¹´10æœˆ18æ—¥å‘å¸ƒäº†, æœ¬æ–‡å°±æ˜¯ç®€å•ä»‹ç»ä¸€ä¸‹è¿™æ¬¡æ›´æ–°çš„æ–°ç‰¹æ€§ä¸æ”¹åŠ¨. </p><p>ä¸€å¥è¯æ€»ç»“, è¿™ä»ç„¶æ˜¯jdkçš„ä¸€ä¸ªçŸ­æœŸæ”¯æŒç‰ˆæœ¬,  è€Œä¸”å®˜æ–¹æ‰¿è¯º,è¿™æ¬¡å‡çº§å°†å°½å¯èƒ½çš„ä¿è¯ç‰ˆæœ¬çš„å‘ä¸‹å…¼å®¹.</p><h2 id="æ–°ç‰¹æ€§æ±‡æ€»"><a href="#æ–°ç‰¹æ€§æ±‡æ€»" class="headerlink" title="æ–°ç‰¹æ€§æ±‡æ€»"></a>æ–°ç‰¹æ€§æ±‡æ€»</h2><h3 id="æ–°ç‰¹æ€§"><a href="#æ–°ç‰¹æ€§" class="headerlink" title="æ–°ç‰¹æ€§"></a>æ–°ç‰¹æ€§</h3><h4 id="1-é¢„è§ˆç‰ˆ"><a href="#1-é¢„è§ˆç‰ˆ" class="headerlink" title="1 é¢„è§ˆç‰ˆ"></a>1 é¢„è§ˆç‰ˆ</h4><ul><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8277131">JEP 425</a> Virtual Threads</strong>(è™šæ‹Ÿçº¿ç¨‹) :  ç±»ä¼¼goçš„åç¨‹. å°±æ˜¯åœ¨çº¿ç¨‹ä¸Šé¢åœ¨å¼€è¾Ÿå‡ºä¸€ä¸ªæ›´ç»†ç²’åº¦ç‹¬ç«‹è¿è¡Œçš„å•å…ƒ. è¿™ä¸ªæ–°å•å…ƒå°±æ˜¯è™šæ‹Ÿçº¿ç¨‹, è¿™ä¸ªçº¿ç¨‹å®˜æ–¹å«carrier thead(æ‰¿è½½çº¿ç¨‹?)</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8260244">JEP 405</a> Record Patterns</strong> (è®°å½•æ¨¡å¼) : Record Patterns å¯å¯¹ record çš„å€¼è¿›è¡Œè§£æ„ï¼ŒRecord patterns å’Œ Type patterns é€šè¿‡åµŒå¥—èƒ½å¤Ÿå®ç°å¼ºå¤§çš„ã€å£°æ˜æ€§çš„ã€å¯ç»„åˆçš„æ•°æ®å¯¼èˆªå’Œå¤„ç†å½¢å¼. </li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8282272">JEP 427</a> Pattern Matching for switch</strong> (switchæ¨¡å¼åŒ¹é…) : ç¬¬ä¸‰æ¬¡é¢„è§ˆ. ç”¨ switch è¡¨è¾¾å¼å’Œè¯­å¥çš„æ¨¡å¼åŒ¹é…ï¼Œä»¥åŠå¯¹æ¨¡å¼è¯­è¨€çš„æ‰©å±•æ¥å¢å¼º Java ç¼–ç¨‹è¯­è¨€ã€‚å°†æ¨¡å¼åŒ¹é…æ‰©å±•åˆ° switch ä¸­ï¼Œå…è®¸é’ˆå¯¹ä¸€äº›æ¨¡å¼æµ‹è¯•è¡¨è¾¾å¼ï¼Œè¿™æ ·å°±å¯ä»¥ç®€æ˜è€Œå®‰å…¨åœ°è¡¨è¾¾å¤æ‚çš„é¢å‘æ•°æ®çš„æŸ¥è¯¢ã€‚</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8282048">JEP 424</a> Foreign Function &amp; Memory API</strong> (å¤–è¾¹å‡½æ•°&amp;å†…å­˜è°ƒç”¨API):  æä¾›äº†ä¸€å¥—API æ–¹ä¾¿çš„è°ƒç”¨ Java è¿è¡Œæ—¶ä¹‹å¤–çš„ä»£ç æˆ–å†…å­˜ã€‚é€šè¿‡é«˜æ•ˆåœ°è°ƒç”¨å¤–éƒ¨å‡½æ•°ï¼ˆå³ JVM ä¹‹å¤–çš„ä»£ç ï¼‰å’Œå®‰å…¨åœ°è®¿é—®å¤–éƒ¨å†…å­˜ï¼ˆå³ä¸å— JVM ç®¡ç†çš„å†…å­˜ï¼‰ï¼Œè¯¥ API ä½¿ Java ç¨‹åºèƒ½å¤Ÿè°ƒç”¨æœ¬æœºåº“å¹¶å¤„ç†æœ¬æœºæ•°æ®ï¼Œè€Œä¸ä¼šåƒ JNI é‚£æ ·å±é™©å’Œè„†å¼±. (Java åœ¨å †å¤–å†…å­˜ä½¿ç”¨çš„è·¯ä¸Šè¶Šèµ°è¶Šè¿œ ğŸ¤ª)</li></ul><h4 id="2-å­µåŒ–å™¨"><a href="#2-å­µåŒ–å™¨" class="headerlink" title="2 å­µåŒ–å™¨"></a>2 å­µåŒ–å™¨</h4><ul><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8277129">JEP 428</a> Structured Concurrency</strong>(ç»“æ„åŒ–å¹¶å‘) : ç”¨æ¥ç®€åŒ–å¹¶å‘çš„åŠŸèƒ½. å¯ä»¥å°†åº•å±‚å¤šä¸ªçº¿ç¨‹è§†ä¸ºä¸€ä¸ªå·¥ä½œå•å…ƒ, ä»è€Œå®ç°åƒå•çº¿ç¨‹é‚£æ ·çš„å¼‚å¸¸å¤„ç†, ç»“æœæ”¶é›†.</li><li><strong><a href="https://bugs.openjdk.org/browse/JDK-8280173">JEP 426</a> Vector API</strong> (å‘é‡API) : ç¬¬å››å­µåŒ–é˜¶æ®µ. å‘é‡è®¡ç®—ç”±å¯¹å‘é‡çš„ä¸€ç³»åˆ—æ“ä½œç»„æˆã€‚å‘é‡ API ç”¨æ¥è¡¨è¾¾å‘é‡è®¡ç®—ï¼Œè¯¥è®¡ç®—å¯ä»¥åœ¨è¿è¡Œæ—¶å¯é åœ°ç¼–è¯‘ä¸ºæ”¯æŒçš„ CPU æ¶æ„ä¸Šçš„æœ€ä½³å‘é‡æŒ‡ä»¤ï¼Œä»è€Œå®ç°ä¼˜äºç­‰æ•ˆæ ‡é‡è®¡ç®—çš„æ€§èƒ½ã€‚å‘é‡ API çš„ç›®æ ‡æ˜¯ä¸ºç”¨æˆ·æä¾›ç®€æ´æ˜“ç”¨ä¸”ä¸å¹³å°æ— å…³çš„è¡¨è¾¾èŒƒå›´å¹¿æ³›çš„å‘é‡è®¡ç®—</li></ul><h4 id="3-ä¸»è¦ç‰¹æ€§"><a href="#3-ä¸»è¦ç‰¹æ€§" class="headerlink" title="3 ä¸»è¦ç‰¹æ€§"></a>3 ä¸»è¦ç‰¹æ€§</h4><ul><li><p><strong>Support Unicode 14.0</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8268081">JDK-8268081</a>) : æ”¯æŒUnicode14.0 .</p></li><li><p><strong>New system properties for <code>System.out</code> and <code>System.err</code></strong> (<a href="https://bugs.openjdk.org/browse/JDK-8283620">JDK-8283620</a>) : æ–°å¢äº†<code>stdout.encoding</code>å’Œ <code>stderr.encoding</code> ä¸¤ä¸ªå±æ€§æ¥æ”¯æŒæ ‡å‡†è¾“å‡ºå’Œé”™è¯¯è¾“å‡ºçš„å­—ç¬¦é›†ç¼–ç . å¯ä»¥æœ‰æ•ˆè§£å†³æ ‡å‡†è¾“å‡ºçš„ä¹±ç é—®é¢˜.</p></li><li><p><strong>HTTPS Channel Binding Support for Java GSS&#x2F;Kerberos</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8279842">JDK-8279842</a>) : åœ¨httpsè¿æ¥çš„æ—¶å€™, æ”¯æŒç»‘å®štokenæ¥å¢å¼ºå®‰å…¨.</p></li><li><p><strong>Additional Date-Time Formats</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8176706">JDK-8176706</a>) : <code>java.time.format.DateTimeFormatter</code> å¢åŠ äº†ä¸€äº›æ–°çš„é»˜è®¤æ ¼å¼</p></li><li><p><strong>New Methods to Create Preallocated HashMaps and HashSets</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8186958">JDK-8186958</a>) : HashMap, HashSetæ–°å¢äº†ä¸€äº›é™æ€åˆ›å»ºæ–¹æ³•. æ¯”å¦‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">HashMap.newHashMap<br>LinkedHashMap.newLinkedHashMap<br>WeakHashMap.newWeakHashMap<br>HashSet.newHashSet<br>LinkedHashSet.newLinkedHashSet<br></code></pre></td></tr></table></figure></li><li><p><strong>upport for PAC-RET Protection on Linux&#x2F;AArch64</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8277204">JDK-8277204</a>) : é€šè¿‡æ”¯æŒARMv8.3 çš„PACåŠŸèƒ½æ¥é˜²å¾¡RETçš„æ”»å‡»</p><blockquote><p>When enabled, OpenJDK will use hardware features from the ARMv8.3 Pointer Authentication Code (PAC) extension to protect against Return Orientated Programming (ROP) attacks. For more information on the PAC extension see <a href="https://documentation-service.arm.com/static/602a81dbbc293d2cd05e6b09">â€œProviding protection for complex softwareâ€</a> or the â€œPointer authentication in AArch64 stateâ€ section in the <a href="https://developer.arm.com/documentation/ddi0487/latest/">Arm ARM</a>.</p></blockquote></li><li><p><strong>Automatic Generation of the CDS Archive</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8261455">JDK-8261455</a>) : CDSçš„è‡ªåŠ¨æ‰“åŒ…åŠŸèƒ½</p></li><li><p><strong>Windows KeyStore Updated to Include Access to the Local Machine Location</strong> (<a href="https://bugs.openjdk.org/browse/JDK-6782021">JDK-6782021</a>) : Windowsæ–°å¢äº†ä¸€äº›å¯†é’¥å‚¨åº“æ”¯æŒè®¿é—®æœ¬åœ°ä½ç½®.</p></li><li><p><strong>Break Up SEQUENCE in X509Certificate and X509Certificate in otherName</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8277976">JDK-8277976</a>) : å¦‚é¢˜, è¿™ä¸¤ä¸ªæ–¹æ³•çš„å¢å¼º.</p><blockquote><p>The JDK implementation of <code>X509Certificate::getSubjectAlternativeNames</code> and <code>X509Certificate::getIssuerAlternativeNames</code> has been enhanced to additionally return the <code>type-id</code> and <code>value</code> fields of an <code>otherName</code>. The <code>value</code> field is returned as a String if it is encoded as a character string or otherwise as a byte array, which is helpful as it avoids having to parse the ASN.1 DER encoded form of the name.</p></blockquote></li><li><p><strong>(D)TLS Signature Schemes</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8280494">JDK-8280494</a>): å¢åŠ äº†ä¸€å¥—æ–°çš„è·å–TLSç­¾åçš„æ–¹æ³•.</p></li><li><p><strong>Add a -providerPath Option to jarsigner</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8281175">JDK-8281175</a>) : jarsigneræ–°å¢äº†ä¸€ä¸ªé€‰é¡¹, ç”¨æ¥æŒ‡å®šå¤‡ç”¨å¯†é’¥åº“è·¯å¾„</p></li><li><p><strong>New Options for ktab to Provide Non-default Salt</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8279064">JDK-8279064</a>) : ktabå‘½ä»¤å¢åŠ äº†ä¸€äº›é€‰é¡¹æ¥æ”¯æŒè‡ªå®šä¹‰â€™ç›â€™å€¼.</p><blockquote><p>ktab -a username password -s altsalt</p></blockquote></li><li><p><strong>New XML Processing Limits</strong> (JDK-8270504 (not public)) : xmlåº“è§£ææ‰§è¡Œå¢åŠ äº†3ä¸ªé™åˆ¶</p><blockquote><p><code>jdk.xml.xpathExprOpLimit</code> :  XPathè¡¨è¾¾å¼ä¸­groupæ•°é‡çš„é™åˆ¶</p><p><code>jdk.xml.xpathExprOpLimit</code> :  XPathè¡¨è¾¾å¼ä¸­operatoræ•°é‡çš„é™åˆ¶</p><p><code>jdk.xml.xpathTotalOpLimit</code> :  XPathæ–‡ä»¶ä¸­operatoræ€»æ•°é‡çš„é™åˆ¶</p></blockquote></li></ul><h3 id="bugä¿®å¤"><a href="#bugä¿®å¤" class="headerlink" title="bugä¿®å¤"></a>bugä¿®å¤</h3><ul><li><a href="https://bugs.openjdk.org/browse/JDK-8289853">JDK-8289853</a> :   <a href="https://harfbuzz.github.io/">HarfBuzz</a>åº“å‡çº§ åˆ° to 4.4.1, æ”¯æŒæœ€æ–°çš„å­—ä½“</li><li><a href="https://bugs.openjdk.org/browse/JDK-8290334">JDK-8290334</a> :   <a href="https://freetype.org/">FreeType</a> å‡çº§åˆ° 2.12.1</li><li><a href="https://bugs.openjdk.org/browse/JDK-8291897">JDK-8291897</a> :  è§£å†³TerminatingThreadLocalåœ¨virtual thread(è™šæ‹Ÿçº¿ç¨‹)æŸäº›åœºæ™¯ä¸‹æ— æ³•æ³¨å†Œçš„é—®é¢˜</li><li><a href="https://bugs.openjdk.org/browse/JDK-8292240">JDK-8292240</a> :  è™šæ‹Ÿçº¿ç¨‹çš„æ‰¿è½½çº¿ç¨‹, æŸäº›æƒ…å†µä¸‹é˜»å¡æ—¶æ— æ³•é‡ç½®çŠ¶æ€çš„é—®é¢˜</li><li><a href="https://bugs.openjdk.org/browse/JDK-8287917">JDK-8287917</a> : macOS SDK 10.15 åŠæ›´æ—©ç‰ˆæœ¬ä¸‹System.loadLibraryä¸ç”Ÿæ•ˆçš„é—®é¢˜</li><li><a href="https://bugs.openjdk.org/browse/JDK-8292654">JDK-8292654</a> : JDK-8286115é—®é¢˜ä¿®å¤å¯¼è‡´çš„G1åƒåœ¾å›æ”¶å™¨ remembered set memory footprinté—®é¢˜</li></ul><h3 id="ç§»å‡ºåŠŸèƒ½"><a href="#ç§»å‡ºåŠŸèƒ½" class="headerlink" title="ç§»å‡ºåŠŸèƒ½"></a>ç§»å‡ºåŠŸèƒ½</h3><ul><li><strong>Diagnostic Flag GCParallelVerificationEnabled</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8286304">JDK-8286304</a>) : è¿™ä¸ªå¼€å…³è¢«ç§»å‡ºäº†. å› ä¸ºè‡ªä»åˆ›å»ºä»¥æ¥ä¸€ç›´éƒ½æ˜¯é»˜è®¤å¼€å¯, ä¸”å¹¶å‘æ•ˆç‡æ¯”å…³é—­é«˜å¾ˆå¤š.</li><li><strong>Finalizer Implementation in SSLSocketImpl</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8212136">JDK-8212136</a>) : SSLSocketçš„finalizerè¢«ç§»é™¤, å› ä¸ºåŸºç¡€æ–¹æ³•(native)å·²ç»å®ç°ç›¸å…³åŠŸèƒ½.</li><li><strong>Alternate ThreadLocal Implementation of the Subject::current and Subject::callAs APIs</strong> (JDK-8282676 (not public)) : æ‰€è¿°ç±»é‡Œçš„ç›¸åº”æ–¹æ³•çš„å¤‡ç”¨threadlocalå®ç°è¢«ç§»é™¤.</li></ul><h3 id="åºŸå¼ƒåŠŸèƒ½"><a href="#åºŸå¼ƒåŠŸèƒ½" class="headerlink" title="åºŸå¼ƒåŠŸèƒ½"></a>åºŸå¼ƒåŠŸèƒ½</h3><ul><li><strong>java.lang.ThreadGroup</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8284161">JDK-8284161</a>) : çº¿ç¨‹ç»„è¢«æ ‡è®°ä¸ºåºŸå¼ƒ. æœ€å¤§çš„åŸå› æ˜¯è™šæ‹Ÿçº¿ç¨‹æ¥äº†.</li><li><strong>Locale Class Constructors</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8282819">JDK-8282819</a>) : Localeçš„æ„é€ å™¨è¢« <code>Locale.of()</code> æ–¹æ³•æ›¿ä»£</li><li><strong>PSSParameterSpec(int) Constructor and DEFAULT Static Constant</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8254935">JDK-8254935</a>)</li><li><strong>OAEPParameterSpec.DEFAULT Static Constant</strong> (<a href="https://bugs.openjdk.org/browse/JDK-8284553">JDK-8284553</a>) : å› ä¸ºå¯†ç å­¦çš„è¿›æ­¥, è¿™ä¸ªDefaultå¸¸é‡å·²ç»è½åäº†.</li></ul><h2 id="å°ä¼˜åŒ–"><a href="#å°ä¼˜åŒ–" class="headerlink" title="å°ä¼˜åŒ–"></a>å°ä¼˜åŒ–</h2><p>è¿™é‡Œä¸»è¦ä»‹ç»ä¸€äº›å°çš„ä¼˜åŒ–, å¤ªé•¿å¯ä»¥ä¸çœ‹.</p><ol><li><p>JDK19ä¸­, åœ¨macOSä¸Šå°†Metalä½œä¸ºå›¾å½¢æ¸²æŸ“çš„é»˜è®¤é…ç½®.</p></li><li><p>åƒmacæˆ–linuxç³»ç»Ÿä¸­,  <code>user.home</code> å­˜åœ¨å°±ç”¨ç³»ç»Ÿæä¾›çš„é…ç½® , å¦‚æœä¸å­˜åœ¨, åˆ™ä½¿ç”¨<code>$HOME</code>çš„é…ç½®è®¾ç½®è¿™ä¸ªç³»ç»Ÿå±æ€§.</p></li><li><p>çº¿ç¨‹çš„ClassLoader è¢«å¤„ç†ä¸ºä¸€ä¸ªç‰¹æ®Šçš„å¯ç»§æ‰¿çš„Thread-local</p></li><li><p><strong>java.lang.Thread</strong> æ–°å¢äº†ä¸€äº›æ–¹æ³•,  å¦‚æœç°åœ¨ä»£ç ç»§æ‰¿äº†Thread, å¯èƒ½ä¼šå¯¼è‡´ä¸å…¼å®¹.</p><blockquote><p>Thread.Builderæ¨¡å¼</p><p>Thread.isVirtual()</p><p>Thread.threadId()</p><p>Thread.join(Duration)</p></blockquote></li><li><p>Double.toString(double) and Float.toString(float) é’ˆå¯¹ç§‘å­¦è®°æ•°æ³•çš„ä¸€äº›ä¼˜åŒ–</p></li><li><p>æ³¨è§£çš„toStringæ–¹æ³•é’ˆå¯¹å¸¸é‡å’Œæšä¸¾, åšäº†ä¸€äº›ä¼˜åŒ–, è¾“å‡ºæ›´å‹å¥½.</p></li><li><p>HTTPç­¾åé‰´æƒæ—¶, MD5å’ŒSHA-1 å› ä¸ºä¸å¤ªå®‰å…¨é»˜è®¤è¢«ç¦ç”¨.</p></li><li><p>Windows ä¸Šhttpå¤šä»£ç†é€‰æ‹©çš„ä¼˜åŒ–</p></li><li><p><strong>java.net.InetAddress</strong> é’ˆå¯¹ä¸€äº›æœ‰æ­§ä¹‰çš„IPv4è¾“å…¥, ç²¾ç»†äº†å¼‚å¸¸æç¤º.</p></li><li><p><strong>HttpURLConnection</strong> çš„é»˜è®¤keep alive å¯é…ç½®</p></li><li><p><strong>FileChannel.transferFrom</strong> è¿”å›çš„bytes å¯èƒ½ä¼šå°äºé¢„è®¢å€¼, è¿™æ˜¯å…è®¸çš„.</p><blockquote><p>FileChannel.transferFrom()çš„æ€§èƒ½åœ¨Linuxå†…æ ¸4.5åŠæ›´é«˜ç‰ˆæœ¬ä¸Šå¾—åˆ°äº†æ˜¾è‘—æé«˜</p></blockquote></li><li><p><strong>InputStream and FilterInputStream</strong> çš„markå’Œreset ç§»å‡ºäº† synchronized å…³é”®å­—</p></li><li><p><strong>Files.copy</strong> æ–¹æ³•æ”¯æŒå°† <code>POSIX</code>å±æ€§è·¨æ–‡ä»¶ç³»ç»Ÿå¤åˆ¶, å‰ææ˜¯ä¸¤ä¸ªç³»ç»Ÿéƒ½æ”¯æŒ <code>POSIX</code></p></li><li><p><strong>FileChannel.lock(long position, long size, boolean shared)</strong> å½“sizeæŒ‡å®šä¸º0æ—¶, è¡¨ç¤ºé”å®š æ•´ä¸ªæ–‡ä»¶, æ— è®ºè¿™ä¸ªæ–‡ä»¶æµè¢«æ‰©å±•æˆ–ç»§æ‰¿</p></li><li><p>java.time.chrono æ–°å¢äº†3ä¸ªæ ‡å‡†æ—¶é—´</p></li><li><p><strong>ForkJoinPool</strong> å’Œ <strong>ThreadPoolExecutor</strong> çº¿ç¨‹æ± ä¸å†ä½¿ç”¨Thread.startæ¥å¯åŠ¨å·¥ä½œçº¿ç¨‹.</p></li><li><p>æ­£åˆ™ <code>\b</code>  å¯ä»¥åŒ¹é…ASCII å­—ç¬¦, åƒ  <code>\w</code> ä¸€æ ·.</p></li><li><p>æ”¯æŒ  CLDR Version 41</p></li><li><p>LDAP, DNS, å’Œ RMI çš„URLè§£ææ›´åŠ ä¸¥æ ¼</p></li></ol><pre><code class="hljs">&gt;    -Dcom.sun.jndi.ldapURLParsing=&quot;legacy&quot; | &quot;compat&quot; | &quot;strict&quot;    (to control &quot;ldap:&quot; URLs)&gt;&gt;    -Dcom.sun.jndi.dnsURLParsing=&quot;legacy&quot; | &quot;compat&quot; | &quot;strict&quot;     (to control &quot;dns:&quot; URLs)&gt;    -Dcom.sun.jndi.rmiURLParsing=&quot;legacy&quot; | &quot;compat&quot; | &quot;strict&quot;     (to control &quot;rmi:&quot; URLs)</code></pre><ol start="20"><li><p>VM Tool Interface (JVM TI) æ”¯æŒè™šæ‹Ÿçº¿ç¨‹</p></li><li><p>cpuè®¡ç®—æ—¶ä¸å†è€ƒè™‘<code>cpu.share</code> , å› ä¸ºä¼šå¯¼è‡´jvmå¯¹å½“å‰cpuä½¿ç”¨æƒ…å†µçš„è¯¯ç®—, è¿›è€Œå½±å“cpuä½¿ç”¨ç‡.</p><blockquote><p>ä¹‹å‰çš„JDKç‰ˆæœ¬å¯¹Linux cgroupså‚æ•°â€œcpu.sharesâ€ä½¿ç”¨äº†é”™è¯¯çš„è§£é‡Šã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´JVMä½¿ç”¨çš„CPUå°‘äºå¯ç”¨ï¼Œå¯¼è‡´JVMåœ¨å®¹å™¨å†…ä½¿ç”¨æ—¶CPUèµ„æºåˆ©ç”¨ç‡ä¸è¶³ã€‚</p><p>ä»æ­¤JDKç‰ˆæœ¬å¼€å§‹ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒJVMåœ¨å†³å®šå„ç§çº¿ç¨‹æ± ä½¿ç”¨çš„çº¿ç¨‹æ•°é‡æ—¶ä¸å†è€ƒè™‘â€œcpu.sharesâ€ã€‚-XX:+UseContainerCpuShareså‘½ä»¤è¡Œé€‰é¡¹å¯ç”¨äºæ¢å¤åˆ°ä¹‹å‰çš„è¡Œä¸ºã€‚æ­¤é€‰é¡¹å·²è¢«å¼ƒç”¨ï¼Œå¯èƒ½ä¼šåœ¨æœªæ¥çš„JDKç‰ˆæœ¬ä¸­åˆ é™¤ã€‚</p></blockquote></li><li><p>æ­¤å, macOSä¸­,ç›¸åŒå¤§ç‰ˆæœ¬çš„jdkå°†é»˜è®¤å®‰è£…åˆ°åŒä¸€ç›®å½•</p><blockquote><p>  Oracle JDKå®‰è£…ç›®å½•ä»</p><p><code>/Library/Java/JavaVirtualMachines/jdk-$&#123;VERSION&#125;.jdk</code> è¿ç§»åˆ°</p><p> <code>/Library/Java/JavaVirtualMachines/jdk-$&#123;FEATURE&#125;.jdk</code></p><p>æ¯”å¦‚:  19.0.1 and 19.0.2 ç‰ˆæœ¬éƒ½å°†å®‰è£…åˆ° <code>/Library/Java/JavaVirtualMachines/jdk-19.jdk</code> ä¸­</p></blockquote></li><li><p>åœ¨macOSä¸Šï¼Œåªæœ‰ç”¨æˆ·é’¥åŒ™ä¸²ä¸­å…·æœ‰æ­£ç¡®ä¿¡ä»»è®¾ç½®çš„è¯ä¹¦æ‰ä¼šåœ¨é’¥åŒ™ä¸²ç±»å‹çš„é’¥åŒ™åº“ä¸­ä½œä¸ºå—ä¿¡ä»»è¯ä¹¦æ¡ç›®å…¬å¼€</p></li><li><p>RC2å’ŒARCFOURï¼ˆRC4ï¼‰ç®—æ³•å·²æ·»åŠ åˆ°java.securityé…ç½®æ–‡ä»¶ä¸­çš„jdk.security.legacyAlgorithmså®‰å…¨å±æ€§ä¸­ã€‚å½“å¼±RC2æˆ–ARCFOURç®—æ³•ç”¨äºä¸å¯†é’¥å­˜å‚¨ä¸­çš„ç§˜å¯†å¯†é’¥æ¡ç›®å…³è”çš„å‘½ä»¤æ—¶ï¼Œå¯†é’¥å·¥å…·ä¼šå‘å‡ºè­¦å‘Šã€‚</p></li><li><p>åŠ å¯†ç®—æ³•ä½æ•°å¢å¼º</p></li></ol><blockquote><p>RSA, RSASSA-PSS, DH: from 2048 to 3072</p><p>EC: from 256 to 384</p><p>AES: from 128 to 256 (if permitted by crypto policy), falls back to 128 otherwise.</p></blockquote><ol start="26"><li>ECDSA ç®—æ³•çš„ Signature::getParameters æ°¸è¿œè¿”å›<code>null</code> . å‚è€ƒ <a href="https://datatracker.ietf.org/doc/html/rfc5758#section-3.2">RFC 5758 Section 3.2</a></li><li>DESã€DESedeå’ŒMD5ç®—æ³•å·²æ·»åŠ åˆ°java.securityé…ç½®æ–‡ä»¶ä¸­çš„jdk.security.legacyAlgorithmså®‰å…¨å±æ€§ä¸­ã€‚å½“å¼±DESæˆ–DESedeç®—æ³•ç”¨äºä¸å¯†é’¥åº“ä¸­çš„ç§˜å¯†å¯†é’¥æ¡ç›®å…³è”çš„å‘½ä»¤æ—¶ï¼Œkeytoolå·¥å…·ä¼šå‘å‡ºè­¦å‘Šã€‚</li><li>åŠ å¯†ç®—æ³•å®Œæˆæ”¯æŒ RFC 6125</li><li>ç§»å‡ºäº†ä¸€äº›è¿‡æ—¶çš„3DESåŠ å¯†ç»„ä»¶</li></ol><blockquote><p>TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA</p><p>TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA</p><p>SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA</p><p>SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA</p><p>TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA</p><p>TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA</p><p>SSL_RSA_WITH_3DES_EDE_CBC_SHA</p></blockquote><p>30 ä¿®å¤äº†ä¸€ä¸ªStringBuilder bug. ä¾‹å¦‚, ä¸‹é¢ä»£ç è¾“å‡ºâ€foofoobarâ€ è€Œä¸æ˜¯ â€œfoobarfoobarâ€</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">StringBuilder</span> <span class="hljs-variable">builder</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>(<span class="hljs-string">&quot;foo&quot;</span>);<br>System.err.println(<span class="hljs-string">&quot;&quot;</span> + builder + builder.append(<span class="hljs-string">&quot;bar&quot;</span>));<br></code></pre></td></tr></table></figure><ol start="31"><li><p>JavaDocç”Ÿæˆçš„APIæ–‡æ¡£ç°åœ¨æä¾›äº†ä¸€ä¸ªç‹¬ç«‹çš„æœç´¢é¡µé¢ï¼Œæœç´¢è¯­æ³•å·²å¾—åˆ°å¢å¼ºï¼Œå…è®¸å¤šä¸ªæœç´¢è¯ã€‚</p></li><li><p>JShellç°åœ¨æ ‡è®°ä¸å»ºè®®ä½¿ç”¨çš„å…ƒç´ ï¼Œå¹¶åœ¨æ§åˆ¶å°ä¸­çªå‡ºæ˜¾ç¤ºå˜é‡å’Œå…³é”®å­—ã€‚</p></li><li><p>å®é™…çš„javaçº¿ç¨‹å †æ ˆå¤§å°å¯èƒ½ä¸-Xsså‘½ä»¤è¡Œé€‰é¡¹æŒ‡å®šçš„å€¼ä¸åŒï¼›å½“æ“ä½œç³»ç»Ÿè¦æ±‚æ—¶ï¼Œå®ƒå¯ä»¥å››èˆäº”å…¥åˆ°ç³»ç»Ÿé¡µé¢å¤§å°çš„å€æ•°ã€‚</p></li></ol><h2 id="åè¯è§£æ"><a href="#åè¯è§£æ" class="headerlink" title="åè¯è§£æ"></a>åè¯è§£æ</h2><ul><li><p>HarfBuzz: ä¸€ä¸ªå¼€æºçš„ç”¨äºæ–‡å­—å¡‘å½¢çš„è½¯ä»¶å¼€å‘åº“ï¼Œäº¦å³ç”¨äºè½¬æ¢Unicodeæ–‡æœ¬åˆ°å­—å½¢æŒ‡æ ‡åŠæ–¹ä½çš„è¿‡ç¨‹</p></li><li><p>FreeType:  åŒHarfBuzzä¸€æ ·, ä¹Ÿæ˜¯ä¸€ä¸ªå¼€æºå­—ä½“åº“. å®ƒæ˜¯ä¸€ä¸ªç”¨Cè¯­è¨€å®ç°çš„ä¸€ä¸ªå­—ä½“å…‰æ …åŒ–åº“ã€‚å®ƒå¯ä»¥ç”¨æ¥å°†å­—ç¬¦æ …æ ¼åŒ–å¹¶æ˜ å°„æˆä½å›¾ä»¥åŠæä¾›å…¶ä»–å­—ä½“ç›¸å…³ä¸šåŠ¡çš„æ”¯æŒ</p></li><li><p>Preview(é¢„è§ˆ): åŠŸèƒ½å·²ç»åŸºæœ¬å®Œæ•´, å¯ä»¥è¯•ç”¨äº†. å¯ä»¥ç®€å•ç†è§£ä¸ºbetaå…¬æµ‹ç‰ˆ. æ¥æºäº <a href="https://openjdk.org/jeps/12">JEP12</a></p><blockquote><p>åŠŸèƒ½ä»¥é¢„è§ˆç‰ˆçš„å½¢å¼å‘å¸ƒï¼Œä»¥æ”¶é›†æœ‰å…³å®ƒä»¬çš„åé¦ˆè€Œä¸æ‰¿è¯ºä¿æŒå…¶å‘åå…¼å®¹æ€§â€”â€”è¿™æ„å‘³ç€é¼“åŠ±æ¯ä¸ªäººå°è¯•å®ƒä»¬ï¼Œä½†åŒæ—¶ä¸é¼“åŠ±åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨å®ƒä»¬ã€‚</p><p>é¢„è§ˆåŠŸèƒ½ä¸æ˜¯å¼€ç®±å³ç”¨çš„ï¼Œä¸ºäº†è®¿é—®å®ƒä»¬ï¼Œéœ€è¦ä½¿ç”¨*â€“enable-preview*ç¼–è¯‘å™¨æ ‡å¿—ã€‚</p></blockquote></li><li><p>Incubator(å­µåŒ–) : å®éªŒæ€§ APIå·²ç»åˆ°äº†ä¸€å®šé˜¶æ®µ, å·²ç»è®¡åˆ’å¼€å‘å‡ºä¸€æ•´å¥—å®Œæ•´çš„åŠŸèƒ½.ä»¥ç‹¬ç«‹æ¨¡å—çš„å½¢å¼å‘å¸ƒ. æ¥æºäº <a href="https://openjdk.org/jeps/11">JEP11</a></p></li><li><p>Experimental(å®éªŒ) : vmçº§çš„æ—©æœŸåŠŸèƒ½, ä¸ç¨³å®š, åŠŸèƒ½ä¸å®Œæ•´. å®éªŒæ€§è´¨.</p><blockquote><p>å®éªŒæ€§åŠŸèƒ½ä»£è¡¨ï¼ˆä¸»è¦æ˜¯ï¼‰VM çº§åŠŸèƒ½çš„æ—©æœŸç‰ˆæœ¬ï¼Œè¿™äº›åŠŸèƒ½å¯èƒ½æ˜¯æœ‰é£é™©çš„ã€ä¸å®Œæ•´çš„ï¼Œç”šè‡³æ˜¯ä¸ç¨³å®šçš„ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œéœ€è¦ä½¿ç”¨ä¸“ç”¨æ ‡å¿—å¯ç”¨å®ƒä»¬</p><p>å‡ºäºæ¯”è¾ƒçš„ç›®çš„ï¼Œå¦‚æœä¸€ä¸ªå®éªŒåŠŸèƒ½è¢«è®¤ä¸ºæ˜¯ 25%â€œå®Œæˆâ€ï¼Œé‚£ä¹ˆä¸€ä¸ªé¢„è§ˆåŠŸèƒ½åº”è¯¥è‡³å°‘ 95%â€œå®Œæˆâ€ã€‚</p><p>é¢„è§ˆ,å­µåŒ–,å®éªŒä¸‰è€…çš„å…³ç³»å¤§è‡´: å®éªŒ &#x3D;&gt; å­µåŒ– &#x3D;&gt; é¢„è§ˆ &#x3D;&gt; åˆå¹¶jdkä¸»ä½“åŠŸèƒ½.</p></blockquote></li><li><p>JEP : JDK Enhancement Proposal , jdkå¢å¼ºå»ºè®®. ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„jdkæ–°ç‰¹æ€§çš„æ¥æº. <a href="https://openjdk.org/jeps/0">JEPå¤§å…¨</a></p></li></ul><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><p><a href="https://docs.oracle.com/en/java/javase/19/">jdk19å®˜æ–¹æ–‡æ¡£</a></p><p><a href="https://www.oracle.com/java/technologies/javase/19-relnote-issues.html#NewFeature">jdk19 æ–°ç‰¹æ€§æ–‡æ¡£</a></p><p><a href="https://docs.oracle.com/en/java/javase/19/migrate/preface.html#GUID-DFC2A9CB-070F-4880-9069-BD7FA8606EA2">jdk19å‡çº§æŒ‡å—</a></p><p><a href="https://cr.openjdk.java.net/~iris/se/19/latestSpec/">jdk19çš„å¼€å‘è®¡åˆ’</a></p><p><a href="https://bugs.openjdk.org/secure/Dashboard.jspa">openjdk bugåé¦ˆç³»ç»Ÿ</a></p><p><a href="https://openjdk.org/">openjdkå®˜ç½‘</a></p><p><a href="https://4comprehension.com/preview-experimental-and-incubating-features-in-java/">jdkä¸­é¢„è§ˆ,å®éªŒ,å­µåŒ–çš„å…³ç³»</a></p><p><a href="https://www.oschina.net/p/freetype">FreeTypeå¼€æºä¸­å›½</a></p><p><a href="https://www.oschina.net/p/harfbuzz?hmsr=aladdin1e1">HarfBuzzå¼€æºä¸­å›½</a></p>]]></content>
    
    
    <categories>
      
      <category>java</category>
      
      <category>javaç‰ˆæœ¬ç‰¹æ€§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>javaç‰ˆæœ¬ç‰¹æ€§</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>dubbo åœ¨çº¿å¹³æ»‘å˜æ›´zookeeper</title>
    <link href="/2022/10/06/dubbo-zk-change/"/>
    <url>/2022/10/06/dubbo-zk-change/</url>
    
    <content type="html"><![CDATA[<p>è®°ä¸€æ¬¡dubbo zké›†ç¾¤å¹³æ»‘è¿ç§»çš„æ“ä½œæ–¹æ¡ˆï¼Œä¹Ÿå¯ä»¥ç”¨æˆ·dubboåŒæ³¨å†Œä¸­å¿ƒçš„å®ç°æ–¹æ¡ˆã€‚</p><h2 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h2><ol><li>zk æœåŠ¡å™¨ç‰ˆæœ¬ï¼š3.4.6</li><li>dubbo ç‰ˆæœ¬ï¼š2.7.3</li><li>dubbo-spring-boot-starter ç‰ˆæœ¬ï¼š2.7.3</li></ol><h2 id="æŠ€æœ¯æ–¹æ¡ˆ"><a href="#æŠ€æœ¯æ–¹æ¡ˆ" class="headerlink" title="æŠ€æœ¯æ–¹æ¡ˆ"></a>æŠ€æœ¯æ–¹æ¡ˆ</h2><ol><li>è¿ç»´åŒå­¦æ­å»ºå¥½æ–°çš„zké›†ç¾¤ï¼Œä¿è¯é«˜å¯ç”¨</li><li>dubbo æœåŠ¡æä¾›è€…é€šè¿‡åŒæ³¨å†Œä¸­å¿ƒçš„æ–¹å¼ï¼Œå°†æœåŠ¡æ³¨å†Œåˆ°newï¼Œold ä¸¤å¥—é›†ç¾¤ä¸Š</li><li>dubbo æ¶ˆè´¹è€… é€šè¿‡é…ç½®åŒæ³¨å†Œä¸­å¿ƒçš„æ–¹å¼ï¼ŒåŒæ—¶æ¶ˆè´¹ä¸¤ä¸ªæ³¨å†Œä¸­å¿ƒçš„æœåŠ¡</li><li>æ­¥éª¤2ï¼Œæ­¥éª¤3å¯ä»¥åŒæ—¶è¿›è¡Œï¼Œç›´åˆ°å…¨éƒ¨æœåŠ¡å¹³æ»‘æ³¨å†Œåˆ°åŒæ³¨å†Œä¸­å¿ƒ</li><li>ç­‰å…¨éƒ¨åˆ°åŒä¸­å¿ƒåï¼ˆéœ€è¦è¿ç»´åŒå­¦ç¡®è®¤ï¼‰ï¼Œå†æ¬¡æ›´æ”¹æ¶ˆè´¹è€…é…ç½®ï¼Œæ”¹ä¸ºnew æ³¨å†Œä¸­å¿ƒ</li><li>å…³äºå³æ˜¯ç”Ÿäº§è€…ï¼Œåˆæ˜¯æ¶ˆè´¹è€…çš„é¡¹ç›®ï¼Œæœ‰ä¸¤ç§æ–¹æ¡ˆï¼š<ul><li>ç­‰ä¾èµ–ä¸Šæ¸¸åˆ‡æ¢åå†åˆ‡æ¢ï¼Œæˆ–è€…æœ€ååˆ‡æ¢</li><li>å·®å¼‚åŒ–é…ç½®ï¼Œæ¶ˆè´¹è€…å•æ³¨å†Œä¸­å¿ƒï¼Œç”Ÿäº§è€…åŒæ³¨å†Œä¸­å¿ƒ</li></ul></li><li>æ¶ˆè´¹è€…å…¨éƒ¨åˆ‡æ¢åˆ°æ–°çš„zk é›†ç¾¤åï¼Œç”Ÿäº§è€…é€æ­¥å…¨éƒ¨æ”¹ä¸ºæ–°çš„zké›†ç¾¤</li><li>å…³é—­ä¸‹çº¿old zk é›†ç¾¤</li></ol><h2 id="å…³é”®é…ç½®"><a href="#å…³é”®é…ç½®" class="headerlink" title="å…³é”®é…ç½®"></a>å…³é”®é…ç½®</h2><p>pom ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.dubbo<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>dubbo-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.7.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.curator<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>curator-framework<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.2.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>zookeeper<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.zookeeper<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.curator<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>curator-recipes<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.2.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.zookeeper<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>zookeeper<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.4.13<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slf4j-log4j12<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>dubboé…ç½®ï¼š</p><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><span class="hljs-attribute">dubbo</span><span class="hljs-punctuation">:</span><br>  <span class="hljs-attribute">application</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-attribute">name</span><span class="hljs-punctuation">:</span> <span class="hljs-string">zk-move-test</span><br>  <span class="hljs-attribute">consumer</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-attribute">registries</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">id: oldzk</span><br>        <span class="hljs-attribute">protocol</span><span class="hljs-punctuation">:</span> <span class="hljs-string">zookeeper</span><br>        <span class="hljs-attribute">address</span><span class="hljs-punctuation">:</span> <span class="hljs-string">127.0.0.1:2181(æ­¤å¤„éšæ„é…)</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">id: newzk</span><br>        <span class="hljs-attribute">protocol</span><span class="hljs-punctuation">:</span> <span class="hljs-string">zookeeper</span><br>        <span class="hljs-attribute">address</span><span class="hljs-punctuation">:</span> <span class="hljs-string">127.1.1.1:2181,127.2.2.2:2181(æ­¤å¤„éšæ„é…)</span><br><br></code></pre></td></tr></table></figure><p>ç„¶åå°±èƒ½æ­£å¸¸å¯åŠ¨äº†ï¼Œé€šè¿‡æ—¥å¿—ï¼Œä¼šå‘ç°æ­£å¸¸æ³¨å†Œäº†ä¸¤ä¸ªzkä¸­å¿ƒï¼Œå¹¶ä¸”zkä¸Šä¹Ÿèƒ½å‘ç°æ³¨å†Œçš„æœåŠ¡ã€‚</p><h2 id="æŠ€æœ¯éªŒè¯ç‚¹"><a href="#æŠ€æœ¯éªŒè¯ç‚¹" class="headerlink" title="æŠ€æœ¯éªŒè¯ç‚¹"></a>æŠ€æœ¯éªŒè¯ç‚¹</h2><ol><li>æŸæœåŠ¡æ³¨å†Œåˆ°oldä¸­å¿ƒï¼Œnew ä¸­å¿ƒæ²¡æœ‰ï¼Œæ¶ˆè´¹è€…åŒæ³¨å†Œä¸­å¿ƒæ˜¯å¦èƒ½å‘ç°ï¼Ÿç­”ï¼šå¯ä»¥</li><li>æŸæœåŠ¡æ³¨å†Œåˆ°new ä¸­å¿ƒï¼Œoldä¸­å¿ƒæ²¡æœ‰ï¼Œæ¶ˆè´¹è€…åŒæ³¨å†Œä¸­å¿ƒæ˜¯å¦èƒ½å‘ç°ï¼Ÿç­”ï¼šå¯ä»¥</li><li>æŸæœåŠ¡åŒæ³¨å†Œä¸­å¿ƒï¼Œç„¶åä¸‹çº¿æŸæ³¨å†Œä¸­å¿ƒï¼Œæ¶ˆè´¹è€…åŒæ³¨å†Œä¸­å¿ƒæ˜¯å¦æ”¶å½±å“ï¼Œèƒ½å¦è‡ªåŠ¨è½¬ç§»ï¼Ÿ<br>ç­”ï¼šç»æµ‹è¯•ï¼Œnewä¸­å¿ƒå…¨éƒ¨æŒ‚æ‰åï¼ŒæœåŠ¡ä¾æ—§ä¼šä»oldæœåŠ¡å‘ç°ï¼ŒåŠŸèƒ½ä¸å—å½±å“ã€‚<br>ä½†æ˜¯ï¼Œdubboå®¢æˆ·ç«¯ä¼šä¸€ç›´å°è¯•é‡æ–°è¿æ¥zkä¸­å¿ƒï¼ˆå¯é…ç½®ï¼‰ï¼Œç›´åˆ°newä¸­å¿ƒé‡å¯åï¼Œzkèƒ½å¤Ÿè‡ªåŠ¨é‡è¿æˆåŠŸä¸ºæ­¢ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¿™ä¸ªåœºæ™¯ï¼Œéœ€è¦ç”Ÿäº§ã€æ¶ˆè´¹è€…å…¨éƒ¨è¿ç§»åˆ°new zk ä¸Šåæ‰èƒ½ä¸‹çº¿old zkã€‚</li></ol><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><p><a href="http://dubbo.apache.org/zh-cn/docs/user/references/registry/zookeeper.html">http://dubbo.apache.org/zh-cn/docs/user/references/registry/zookeeper.html</a></p>]]></content>
    
    
    <categories>
      
      <category>dubbo</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>dubbo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é¸¿è’™åº”ç”¨å¼€å‘:&quot;request data error&quot;é—®é¢˜è§£å†³</title>
    <link href="/2022/10/05/exception-harmony-qa-http-request-err/"/>
    <url>/2022/10/05/exception-harmony-qa-http-request-err/</url>
    
    <content type="html"><![CDATA[<h1 id="èƒŒæ™¯ä»‹ç»"><a href="#èƒŒæ™¯ä»‹ç»" class="headerlink" title="èƒŒæ™¯ä»‹ç»"></a>èƒŒæ™¯ä»‹ç»</h1><p>æœ¬äººåˆæ¬¡æ¥è§¦é¸¿è’™ç³»ç»Ÿ, æƒ³ç€è‡ªå·±åœ¨æ‰‹æœºä¸Šå¼€å‘ä¸ªappç©ç©, ç»“æœç¬¬ä¸€æ­¥å°±é‡åˆ°å‘äº†~~</p><h1 id="å¼€å‘ç¯å¢ƒ"><a href="#å¼€å‘ç¯å¢ƒ" class="headerlink" title="å¼€å‘ç¯å¢ƒ"></a>å¼€å‘ç¯å¢ƒ</h1><ul><li>ide: DevEco Studio 3.0 Release</li><li>harmony SDK: 8</li><li>è¯­è¨€: ets&#x2F;ts</li><li>è°ƒè¯•: æœ¬åœ°çœŸæœºè°ƒè¯•</li></ul><h1 id="è¯·æ±‚æºç "><a href="#è¯·æ±‚æºç " class="headerlink" title="è¯·æ±‚æºç "></a>è¯·æ±‚æºç </h1><p>å› ä¸ºæ˜¯ä¸ªdemo, å…¶å®å°±æ˜¯ä»å®˜æ–¹demoä¸­copyè¿‡æ¥çš„, ç„¶åæ¢æˆè‡ªå·±çš„åŸŸååœ°å€</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> http <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@ohos.net.http&#x27;</span>;<br><br><span class="hljs-comment">// æ¯ä¸€ä¸ªhttpRequestå¯¹åº”ä¸€ä¸ªhttpè¯·æ±‚ä»»åŠ¡ï¼Œä¸å¯å¤ç”¨</span><br><span class="hljs-keyword">let</span> httpRequest = http.<span class="hljs-title function_">createHttp</span>();<br><span class="hljs-comment">// ç”¨äºè®¢é˜…httpå“åº”å¤´ï¼Œæ­¤æ¥å£ä¼šæ¯”requestè¯·æ±‚å…ˆè¿”å›ã€‚å¯ä»¥æ ¹æ®ä¸šåŠ¡éœ€è¦è®¢é˜…æ­¤æ¶ˆæ¯</span><br><span class="hljs-comment">// ä»API 8å¼€å§‹ï¼Œä½¿ç”¨on(&#x27;headersReceive&#x27;, Callback)æ›¿ä»£on(&#x27;headerReceive&#x27;, AsyncCallback)ã€‚ 8+</span><br>httpRequest.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;headersReceive&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">header</span>) =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">&#x27;header: &#x27;</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(header));<br>&#125;);<br>httpRequest.<span class="hljs-title function_">request</span>(<br>    <span class="hljs-comment">// å¡«å†™httpè¯·æ±‚çš„urlåœ°å€ï¼Œå¯ä»¥å¸¦å‚æ•°ä¹Ÿå¯ä»¥ä¸å¸¦å‚æ•°ã€‚URLåœ°å€éœ€è¦å¼€å‘è€…è‡ªå®šä¹‰ã€‚è¯·æ±‚çš„å‚æ•°å¯ä»¥åœ¨extraDataä¸­æŒ‡å®š</span><br>    <span class="hljs-string">&quot;http://hancher.top/xxx/xxx&quot;</span>,<br>    &#123;<br>        <span class="hljs-attr">method</span>: http.<span class="hljs-property">RequestMethod</span>.<span class="hljs-property">POST</span>, <span class="hljs-comment">// å¯é€‰ï¼Œé»˜è®¤ä¸ºhttp.RequestMethod.GET</span><br>        <span class="hljs-comment">// å¼€å‘è€…æ ¹æ®è‡ªèº«ä¸šåŠ¡éœ€è¦æ·»åŠ headerå­—æ®µ</span><br>        <span class="hljs-attr">header</span>: &#123;<br>            <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json&#x27;</span><br>        &#125;,<br>        <span class="hljs-comment">// å½“ä½¿ç”¨POSTè¯·æ±‚æ—¶æ­¤å­—æ®µç”¨äºä¼ é€’å†…å®¹</span><br>        <span class="hljs-attr">extraData</span>: &#123;<br>            <span class="hljs-string">&quot;data&quot;</span>: <span class="hljs-string">&quot;data to send&quot;</span>,<br>        &#125;,<br>        <span class="hljs-attr">connectTimeout</span>: <span class="hljs-number">60000</span>, <span class="hljs-comment">// å¯é€‰ï¼Œé»˜è®¤ä¸º60s</span><br>        <span class="hljs-attr">readTimeout</span>: <span class="hljs-number">60000</span>, <span class="hljs-comment">// å¯é€‰ï¼Œé»˜è®¤ä¸º60s</span><br>    &#125;, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> &#123;<br>        <span class="hljs-keyword">if</span> (!err) &#123;<br>            <span class="hljs-comment">// data.resultä¸ºhttpå“åº”å†…å®¹ï¼Œå¯æ ¹æ®ä¸šåŠ¡éœ€è¦è¿›è¡Œè§£æ</span><br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">&#x27;httpè¯·æ±‚ç»“æœ:&#x27;</span> + data.<span class="hljs-property">result</span>);<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">&#x27;code:&#x27;</span> + data.<span class="hljs-property">responseCode</span>);<br>            <span class="hljs-comment">// data.headerä¸ºhttpå“åº”å¤´ï¼Œå¯æ ¹æ®ä¸šåŠ¡éœ€è¦è¿›è¡Œè§£æ</span><br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">&#x27;header:&#x27;</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data.<span class="hljs-property">header</span>));<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">&#x27;cookies:&#x27;</span> + data.<span class="hljs-property">cookies</span>); <span class="hljs-comment">// 8+</span><br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">&#x27;httpè¯·æ±‚å¼‚å¸¸:&#x27;</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));<br>            <span class="hljs-comment">// å½“è¯¥è¯·æ±‚ä½¿ç”¨å®Œæ¯•æ—¶ï¼Œè°ƒç”¨destroyæ–¹æ³•ä¸»åŠ¨é”€æ¯ã€‚</span><br>            httpRequest.<span class="hljs-title function_">destroy</span>();<br>        &#125;<br>    &#125;<br>);<br></code></pre></td></tr></table></figure><p>å¤§å®¶å¯ä»¥ä»å‚è€ƒé‡Œçš„å®˜æ–¹demoé‡Œæ¯”å¯¹ä¸€ä¸‹, å•¥éƒ½æ²¡å˜, ç„¶åæœ¬åœ°è°ƒè¯•, æŠ¥</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima"><span class="hljs-number">03B00</span>/JSApp:  app Log: httpè¯·æ±‚å¼‚å¸¸:&#123;<span class="hljs-string">&quot;code&quot;</span>:<span class="hljs-number">200</span>,<span class="hljs-string">&quot;data&quot;</span>:<span class="hljs-string">&quot;request data error&quot;</span>&#125;<br></code></pre></td></tr></table></figure><p>å¤šè¯´ä¸€å¥, å› ä¸ºæ˜¯åˆæ¬¡ä½¿ç”¨è¿™ä¸ªide, æ—¥å¿—çš„æ‰“å°å…¥å£éƒ½æ‰¾äº†åŠå¤©. ä¸‹é¢æ˜¯æ—¥å¿—çš„è·¯å¾„  </p><blockquote><p>åº•éƒ¨å¯¼èˆªlog-&gt; HiLog -&gt; é€‰ä¸­è‡ªå·±çš„è®¾å¤‡ -&gt; é€‰æ‹©æ—¥å¿—çº§åˆ«<br><img src="/images/tech/harmony/HiLog-position.png" alt="HiLog å…¥å£"></p></blockquote><h1 id="é—®é¢˜å®šä½"><a href="#é—®é¢˜å®šä½" class="headerlink" title="é—®é¢˜å®šä½"></a>é—®é¢˜å®šä½</h1><ol><li>é¦–å…ˆ, è¯·æ±‚è‚¯å®šæ²¡æœ‰å‘å‡ºå». å› ä¸ºæˆ‘æ²¡æœ‰åœ¨æˆ‘çš„åå°é‡Œå‘ç°å¯¹åº”çš„è¯·æ±‚</li><li>æœ‰æ²¡æœ‰å¯èƒ½æ˜¯è¯·æ±‚å‚æ•°ä½“çš„é—®é¢˜å‘¢?<br>è¿™ä¸ªæˆ‘æŸ¥äº†åŠå¤©å®˜æ–¹æ–‡æ¡£, ä»¥åŠè‡ªå·±è¯•äº†å­—ç¬¦ä¸², å¯¹åº”, æ•°ç»„ç­‰å„ç§æ–¹å¼, éƒ½ä¸è¡Œ. æ„Ÿè§‰åº”è¯¥ä¸æ˜¯è¿™ä¸ªé—®é¢˜.</li><li>æ˜¯ä¸æ˜¯æƒé™çš„é—®é¢˜å‘¢?<br>ä¹‹æ‰€ä»¥ä¼šæ€€ç–‘åˆ°æƒé™çš„é—®é¢˜ä¸Š, å› ä¸ºåœ¨æŸ¥çœ‹<a href="https://developer.harmonyos.com/cn/docs/documentation/doc-references/js-apis-http-0000001281201030">æ¥å£æ–‡æ¡£</a>çš„æ—¶å€™å‘ç°äº†è¿™ä¹ˆä¸€å¥è¯<blockquote><p>éœ€è¦æƒé™ï¼šohos.permission.INTERNET</p></blockquote></li></ol><p>ç„¶åå°±å»æŸ¥<a href="https://developer.harmonyos.com/cn/docs/documentation/doc-guides/package-structure-0000001333321033#ZH-CN_TOPIC_0000001333321033__deviceconfig%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%86%85%E9%83%A8%E7%BB%93%E6%9E%84">æƒé™ç›¸å…³çš„æ–‡æ¡£</a>, åœ¨æ¨¡å—çš„config.jsonä¸‹é¢æŠŠæƒé™åŠ ä¸Š, è¿˜æ˜¯ä¸è¡Œ. é…ç½®å¦‚ä¸‹:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;module&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;reqPermissions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>      <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ohos.permission.GET_NETWORK_INFO&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;reason&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æµé‡ç½‘ç»œè¯·æ±‚&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ohos.permission.INTERNET&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;reason&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æµé‡ç½‘ç»œè¯·æ±‚&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ohos.permission.SET_NETWORK_INFO&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;reason&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æµé‡ç½‘ç»œè¯·æ±‚&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ohos.permission.MANAGE_WIFI_CONNECTION&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;reason&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;WLANç½‘ç»œè¯·æ±‚&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ohos.permission.SET_WIFI_INFO&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;reason&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;WLANç½‘ç»œè¯·æ±‚&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ohos.permission.GET_WIFI_INFO&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;reason&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;WLANç½‘ç»œè¯·æ±‚&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">]</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br><br></code></pre></td></tr></table></figure><p>è¯·æ±‚ç»“æœè¿˜æ˜¯è€æ ·å­.<br>4. æœ€ç»ˆå®šä½: httpæ˜æ–‡è¯·æ±‚è¢«é™åˆ¶äº†<br>è¿™æ˜¯æˆ‘åœ¨ä¸€ä½<a href="https://developer.huawei.com/consumer/cn/forum/topic/0202749465240950831?fid=0101587866109860105">è€å“¥çš„å¸–å­</a>é‡Œå‘ç°çš„ä¸€ä¸ªå…³é”®èŠ‚ç‚¹.<br>åŸæ¥æ­£å¸¸çš„httpè¯·æ±‚ä¼šè¢«ç³»ç»Ÿé»˜è®¤ç¦æ‰, è€Œä¸”å®˜æ–¹è¿˜ä¸ç»™ä¸ªæç¤º, å¤ªå‘äº†. å®˜æ–¹æ›´æ¨èä½¿ç”¨httpsçš„è¯·æ±‚æ–¹å¼.<br><img src="/images/tech/harmony/http_cleartextTraffic_disable.png" alt="httpè¢«ç¦ç”¨"><br>çŸ¥é“äº†é—®é¢˜æ‰€åœ¨, è§£å†³é—®é¢˜å°±å¥½äº†.config.jsonæ·»åŠ å¦‚ä¸‹é…ç½®å³å¯</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;deviceConfig&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;default&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;network&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;cleartextTraffic&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>æ³¨æ„, 3é‡Œçš„ç½‘ç»œæƒé™ä¹Ÿè¦é…ç½®å“ˆ, ä¸ç„¶ä¼šæŠ¥æ²¡æœ‰æƒé™çš„é”™è¯¯. ä¸è¿‡è¿™ä¸ªè¿˜å¥½, å®˜æ–¹æœ‰å¼‚å¸¸æç¤ºäº†, å°±å¾ˆå¥½å®šä½äº†.</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://developer.harmonyos.com/cn/docs/documentation/doc-references/js-apis-http-0000001281201030">httpè¯·æ±‚å®˜æ–¹æ–‡æ¡£</a><br><a href="https://developer.harmonyos.com/cn/docs/documentation/doc-guides/package-structure-0000001333321033#ZH-CN_TOPIC_0000001333321033__deviceconfig%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%86%85%E9%83%A8%E7%BB%93%E6%9E%84">åº”ç”¨é…ç½®å®˜æ–¹æ–‡æ¡£</a><br><a href="https://developer.huawei.com/consumer/cn/forum/topic/0202749465240950831?fid=0101587866109860105">æ„Ÿè°¢è€å“¥</a>   </p>]]></content>
    
    
    <categories>
      
      <category>é¸¿è’™</category>
      
      <category>app</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¼‚å¸¸</tag>
      
      <tag>é¸¿è’™</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>rediså¸¸ç”¨å‘½ä»¤æ€»ç»“</title>
    <link href="/2022/09/30/db-redis-common-cmd/"/>
    <url>/2022/09/30/db-redis-common-cmd/</url>
    
    <content type="html"><![CDATA[<h2 id="k-væ“ä½œ"><a href="#k-væ“ä½œ" class="headerlink" title="k-væ“ä½œ"></a>k-væ“ä½œ</h2><p>æ™®é€šçš„k-væ“ä½œ</p><h3 id="æ‰¹é‡æ“ä½œ"><a href="#æ‰¹é‡æ“ä½œ" class="headerlink" title="æ‰¹é‡æ“ä½œ"></a>æ‰¹é‡æ“ä½œ</h3><h4 id="1-é€šè¿‡luaåœ¨rediså®¢æˆ·ç«¯æ‰¹é‡åˆ é™¤key"><a href="#1-é€šè¿‡luaåœ¨rediså®¢æˆ·ç«¯æ‰¹é‡åˆ é™¤key" class="headerlink" title="1.é€šè¿‡luaåœ¨rediså®¢æˆ·ç«¯æ‰¹é‡åˆ é™¤key"></a>1.é€šè¿‡luaåœ¨rediså®¢æˆ·ç«¯æ‰¹é‡åˆ é™¤key</h4><p>redisæ˜¯ä¸æ”¯æŒæ‰¹é‡åˆ é™¤æŒ‡ä»¤çš„, å› ä¸ºredisæ˜¯å•çº¿ç¨‹çš„. æ‰¹é‡åˆ é™¤ä¼šå ç”¨redisçš„ä¸»çº¿ç¨‹.å½±å“æ€§èƒ½.</p><p>ä½†æ˜¯æˆ‘è®¤ä¸ºç°åœ¨redisæ—¢ç„¶å·²ç»æ”¯æŒå¼‚æ­¥çº¿ç¨‹æ“ä½œä¸€äº›åå°æ•°æ®äº†, ä¹Ÿå°±å¯ä»¥æ”¯æŒåœ¨ä¸å½±å“ä¸»çº¿ç¨‹æ€§èƒ½çš„æƒ…å†µä¸‹å®ç° æ­£åˆ™æ‰¹é‡åˆ é™¤æ•°æ®çš„å‘½ä»¤äº†. ä¸çŸ¥ä¸ºä½•è¿˜æ˜¯æ²¡æœ‰.</p><p>è¿™é‡Œè®°å½•ä¸€ä¸‹ä½¿ç”¨luaè„šæœ¬, åœ¨rediså‘½ä»¤è¡Œé‡Œ é€šè¿‡æ­£åˆ™æ‰¹é‡åˆ é™¤ç¼“å­˜çš„åŠŸèƒ½. æ ¸å¿ƒæ˜¯ä½¿ç”¨ keyså‘½ä»¤. è¿™ä¸ªä¼šé˜»å¡ä¸»çº¿ç¨‹, å¦‚æœé‡æ¯”è¾ƒå¤§, æ…ç”¨.</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lua">eval <span class="hljs-string">&quot;local keys=redis.call(&#x27;keys&#x27;,KEYS[1]);local count=0;for i,v in ipairs(keys) do redis.call(&#x27;del&#x27;,v); count=i end; return count&quot;</span> <span class="hljs-number">1</span> keyæ­£åˆ™è¡¨è¾¾å¼<br></code></pre></td></tr></table></figure><p>å°†æœ€åçš„â€™keyæ­£åˆ™è¡¨è¾¾å¼â€™æ¢æˆè‡ªå·±æƒ³åˆ é™¤çš„keysçš„è¡¨è¾¾å¼å³å¯.</p><p>å…³äºé‡çš„é—®é¢˜, æˆ‘åˆ é™¤çº¿ä¸Š5wæ¡ç¼“å­˜,ç§’åˆ ,æ— ä»»ä½•å½±å“.å„ä½åŒå­¦è‡ªè¡Œå‚è€ƒé‡çº§.</p><p>ä¸å®šæœŸæ›´æ–°ä¸­â€¦</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://redis.io/commands/eval/">rediså®˜ç½‘</a></p>]]></content>
    
    
    <categories>
      
      <category>redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>redisè„šæœ¬å‘½ä»¤</title>
    <link href="/2022/09/29/db-redis-cmd-script/"/>
    <url>/2022/09/29/db-redis-cmd-script/</url>
    
    <content type="html"><![CDATA[<p>rediså†…ç½®äº†<a href="https://redis.io/docs/manual/programmability/lua-api/">Lua 5.1</a>å¼•æ“. å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ‰§è¡Œluaè„šæœ¬.<br>æœ‰äº†è¿™ä¸ªåˆ©å™¨, æˆ‘ä»¬å°±å¯ä»¥åœ¨rediså‘½ä»¤çš„åŸºç¡€ä¸Šè‡ªå·±ç»„åˆå‘½ä»¤å¹¶åŸå­æ€§æ‰§è¡Œäº†.</p><h2 id="evalå‘½ä»¤æ‰§è¡Œluaè„šæœ¬"><a href="#evalå‘½ä»¤æ‰§è¡Œluaè„šæœ¬" class="headerlink" title="evalå‘½ä»¤æ‰§è¡Œluaè„šæœ¬"></a>evalå‘½ä»¤æ‰§è¡Œluaè„šæœ¬</h2><p>å¦‚æœè¦è°ƒç”¨</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs lua">EVAL script numkeys [key [key ...]] [<span class="hljs-built_in">arg</span> [<span class="hljs-built_in">arg</span> ...]]<br><br></code></pre></td></tr></table></figure><ul><li>script luaè„šæœ¬, å­—ç¬¦ä¸²</li><li>numkeys åç½®keysçš„æ•°é‡. 0è¡¨ç¤ºæ²¡æœ‰å‚æ•°</li><li>key çš„å‚æ•°. å¯ä»¥åœ¨luaè„šæœ¬é‡Œé€šè¿‡ â€œKEYS[index]â€æ¥æŒ‡å®škey. ä¼šåœ¨è„šæœ¬æ‰§è¡Œå‰æ›¿æ¢</li><li>arg å‚æ•°. å’Œkeysç±»ä¼¼. keysæ•°é‡ä¹‹åçš„å‚æ•°éƒ½æ˜¯args. å¯ä»¥ç”¨ARGV[index]æŒ‡å®š.</li></ul><p>demo</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs redis"># æ‰§è¡Œä¸€æ®µluaè„šæœ¬, è¿”å›è¾“å…¥çš„å„ä¸ªå‚æ•°. å‰2ä¸ªæ˜¯key, åé¢çš„éƒ½æ˜¯args<br>redis&gt; EVAL &quot;return &#123; KEYS[1], KEYS[2], ARGV[1], ARGV[2], ARGV[3] &#125;&quot; 2 key1 key2 arg1 arg2 arg3<br>1) &quot;key1&quot;<br>2) &quot;key2&quot;<br>3) &quot;arg1&quot;<br>4) &quot;arg2&quot;<br>5) &quot;arg3&quot;<br></code></pre></td></tr></table></figure><h2 id="luaè„šæœ¬"><a href="#luaè„šæœ¬" class="headerlink" title="luaè„šæœ¬"></a>luaè„šæœ¬</h2><h3 id="luaè„šæœ¬è°ƒredisæŒ‡ä»¤"><a href="#luaè„šæœ¬è°ƒredisæŒ‡ä»¤" class="headerlink" title="luaè„šæœ¬è°ƒredisæŒ‡ä»¤"></a>luaè„šæœ¬è°ƒredisæŒ‡ä»¤</h3><p>æœ€å¸¸ç”¨çš„å¾ˆæ˜¯å°±æ˜¯callæ–¹æ³•äº†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">redis.call(<span class="hljs-built_in">command</span> [,arg...])<br><br></code></pre></td></tr></table></figure><ul><li>command rediså‘½ä»¤</li><li>args rediså‘½ä»¤æ‰€éœ€å‚æ•°</li></ul><p>demo</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æ‰§è¡Œluaè„šæœ¬, è®¾ç½®key=a , v = 1</span><br>redis&gt; <span class="hljs-built_in">eval</span> <span class="hljs-string">&quot;redis.call(&#x27;set&#x27;,&#x27;a&#x27;,1)&quot;</span> 0<br><br><span class="hljs-comment"># éªŒè¯</span><br>redis&gt; get a  <span class="hljs-comment"># ç»“æœ 1</span><br></code></pre></td></tr></table></figure><p>ä¸å®šæœŸæ›´æ–°ä¸­â€¦</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://redis.io/docs/manual/programmability/eval-intro/">redis lua</a></p>]]></content>
    
    
    <categories>
      
      <category>redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æœ‰æ„æ€çš„å°é—®é¢˜,javaä»£ç è¿‡é•¿</title>
    <link href="/2022/09/22/exception-java-method-too-big/"/>
    <url>/2022/09/22/exception-java-method-too-big/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨ç»ƒä¹ ç¼–ç¨‹çš„æ—¶å€™,å‘ç°ä¸€ä¸ªé—®é¢˜. å°±æ˜¯åœ¨æµ‹è¯•ä¸€ä¸ªæ’åºåŠŸèƒ½æ—¶, å¦‚æœå†™å…¥å¤§æ‰¹é‡çš„å‚æ•°, ä¼šæŠ¥ â€œjava: ä»£ç è¿‡é•¿â€ çš„é—®é¢˜. </p><p>ç¼–ç¨‹è¿™ä¹ˆå¤šå¹´äº†, ç¬¬ä¸€æ¬¡é‡åˆ°è¿™ç§é—®é¢˜, è¿˜æŒºç¥å¥‡çš„. è®°å½•å’Œæ€»ç»“ä¸€ä¸‹.</p><h1 id="ç°è±¡é‡ç°"><a href="#ç°è±¡é‡ç°" class="headerlink" title="ç°è±¡é‡ç°"></a>ç°è±¡é‡ç°</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        a = <span class="hljs-string">&quot;2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2&quot;</span>;<br>        <span class="hljs-comment">// ä¸Šé¢çš„a å¤šå¤åˆ¶å‡ é</span><br><br>        System.out.println(a);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¾ˆç®€å•çš„ä»£ç , æ²¡äº‹èµ°ä¸¤æ­¥</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">java:</span> ä»£ç è¿‡é•¿<br></code></pre></td></tr></table></figure><h1 id="é—®é¢˜åˆ†æ"><a href="#é—®é¢˜åˆ†æ" class="headerlink" title="é—®é¢˜åˆ†æ"></a>é—®é¢˜åˆ†æ</h1><p>é¦–å…ˆ, é¡¾åæ€ä¹‰, å¾ˆæ˜ç»†å°±æ˜¯å­—ç¬¦é•¿åº¦è¶…è¿‡äº†java ä¸€ä¸ªç±»æ–‡ä»¶çš„æœ€å¤§é•¿åº¦é™åˆ¶å¯¼è‡´çš„.</p><p>é‚£ä¹ˆjavaç±»æ–‡ä»¶çš„é•¿åº¦æ˜¯å¤šå°‘å‘¢?<br>ç»è¿‡ä¸€ç•ªä¸æ˜¯å¾ˆè¾›è‹¦çš„æŸ¥è¯¢, å®šä½åˆ°äº†åŸå› : </p><blockquote><p>There is a 64K byte-code size limit on a method<br>javaä¸­ä¸€ä¸ªæ–¹æ³•çš„æœ€å¤§é•¿åº¦æ˜¯64Kb</p></blockquote><p>å¾ˆæ˜ç»†, æˆ‘ä»¬çš„è¿™ä¸ªæ–¹æ³•é•¿åº¦è¶…äº†.</p><h1 id="é—®é¢˜è§£å†³"><a href="#é—®é¢˜è§£å†³" class="headerlink" title="é—®é¢˜è§£å†³"></a>é—®é¢˜è§£å†³</h1><p>åŸå› æ‰¾åˆ°äº†, è¦è§£å†³ä¹Ÿå°±å¾ˆç®€å•äº†. åªè¦åšåˆ°è§„é¿æ–¹æ³•çš„æœ€å¤§é•¿åº¦å°±è¡Œäº†. </p><ul><li>æ–¹æ³•1 : å°†ä¸€ä¸ªå¤§æ–¹æ³•æ‹†æˆå¤šä¸ªå°æ–¹æ³•, å°†ä¸€ä¸ªå¤§ç±»æ‹†æˆå¤šä¸ªå°ç±». è¯´å®è¯, ä¸€ä¸ª64kbçš„ç±»ç¡®å®æœ‰ç‚¹å¤§äº†.</li><li>æ–¹æ³•2 : å°†æµ‹è¯•æ•°æ®ä¸è¦æ”¾åˆ°javaç±»é‡Œ, è€Œæ˜¯æ”¾åˆ°é…ç½®æ–‡ä»¶ä¸­, ä½¿ç”¨çš„æ—¶å€™é€šè¿‡æµåŠ è½½åˆ°å†…å­˜ä¸­. æ–‡ä»¶çš„å­˜å‚¨é‡æ˜¯æ— é™çš„</li></ul><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å…¶å®åªè¦ç¬¦åˆæ­£å¸¸çš„javaç¼–ç è§„èŒƒ, æˆ‘ä»¬åŸºæœ¬ä¸Šæ˜¯é‡ä¸åˆ°ä¸Šé¢çš„é—®é¢˜çš„.<br>åªæœ‰åœ¨ä¸€äº›æé™æµ‹è¯•çš„æ—¶å€™, æˆ‘ä»¬é€šå¸¸ä¼šå°†æµ‹è¯•å†…å®¹æ”¾åˆ°ä»£ç é‡Œ, æ‰å¯èƒ½ç¢°åˆ°. </p><p>åªèƒ½è¯´: æ²¡ç”¨çš„å°çŸ¥è¯†åˆå¢å¤šäº†ğŸ¶</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://stackoverflow.com/questions/2407912/code-too-large-compilation-error-in-java">java code too large</a></p>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹äººç”Ÿ</category>
      
      <category>javaå¼‚å¸¸</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>å¼‚å¸¸</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä½¿ç”¨ç§æœ‰ä»“åº“å‘å¸ƒ GitHub Pages</title>
    <link href="/2022/09/13/site-github-repo-private/"/>
    <url>/2022/09/13/site-github-repo-private/</url>
    
    <content type="html"><![CDATA[<h2 id="éªŒè¯ç§æœ‰åº“å‘å¸ƒæ–‡ç« "><a href="#éªŒè¯ç§æœ‰åº“å‘å¸ƒæ–‡ç« " class="headerlink" title="éªŒè¯ç§æœ‰åº“å‘å¸ƒæ–‡ç« "></a>éªŒè¯ç§æœ‰åº“å‘å¸ƒæ–‡ç« </h2><p>ç›¸ä¿¡å·²ç»æˆåŠŸä½¿ç”¨githubå»ºç«™çš„æœ‹å‹ä»¬è‚¯å®šä¼šæœ‰ä¸€ä¸ªæƒ³æ³•, å°±æ˜¯å¯ä¸å¯ä»¥å°†æ–‡ç« ä»“åº“ç§æœ‰ä¹Ÿèƒ½å®ç°å»ºç«™çš„åŠŸèƒ½å‘¢?</p><p>ç­”æ¡ˆæ˜¯å¯ä»¥çš„, æœ¬æ–‡å°±æ˜¯ä¸€ä¸ªå°†ä¸€ä¸ªå…¬å…±ä»“åº“ç«™ç‚¹ç§æœ‰åŒ–åçš„ä¾‹å­. å¹¶å°†è¿‡ç¨‹æ€»ç»“ä¸€ä¸‹, æ–¹ä¾¿å¤§å®¶å‚è€ƒä½¿ç”¨.</p><h2 id="ç«™ç‚¹ç§æœ‰åŒ–è¿‡ç¨‹çš„çš„å˜ä¸ä¸å˜"><a href="#ç«™ç‚¹ç§æœ‰åŒ–è¿‡ç¨‹çš„çš„å˜ä¸ä¸å˜" class="headerlink" title="ç«™ç‚¹ç§æœ‰åŒ–è¿‡ç¨‹çš„çš„å˜ä¸ä¸å˜"></a>ç«™ç‚¹ç§æœ‰åŒ–è¿‡ç¨‹çš„çš„å˜ä¸ä¸å˜</h2><p>é¦–å…ˆ,ä½¿ç”¨github pageså»ºç«™, é¡¹ç›®åå°±å›ºå®šæ­»äº†,å¿…ç„¶æ˜¯&lt;ç”¨æˆ·å&gt;.github.io<br>å…¶æ¬¡,å¦‚æœæœ‰åŸŸåçš„è¯,åƒåŸŸåé…ç½®ç­‰ä¸€äº›é…ç½®ä¹Ÿæ˜¯éœ€è¦æ”¾åˆ° å¤–éœ²ç«™ç‚¹ä¸‹çš„.</p><p>é™¤æ­¤ä¹‹å¤–, å…¶ä»–çš„å†…å®¹å°±å°±æ˜¯å¯ä»¥å˜çš„äº†.å› ä¸ºgithub.ioç«™ç‚¹æœ€ç»ˆæš´éœ²çš„å°±æ˜¯ä¸€ä¸ªç¼–è¯‘å¥½çš„webé™æ€ç½‘ç«™.<br>è‡³äºæºç æ˜¯ä¸æ˜¯åœ¨è¿™é‡Œ,æ— æ‰€è°“çš„.ä¹‹æ‰€ä»¥æºç ä¸é™æ€ç«™ç‚¹æ”¾åˆ°ä¸€èµ·,æ ¸å¿ƒè¿˜æ˜¯æ–¹ä¾¿githubçš„ actionè‡ªåŠ¨ç¼–è¯‘.</p><p>å¥½äº†, äº†è§£äº†è¿™äº›æ ¸å¿ƒè¦ç´ , æˆ‘ä»¬å¯ä»¥æ“ä½œçš„éƒ¨åˆ†ä¹Ÿå°±æœ‰äº†.<br>å°±åƒæˆ‘ä»¬æ­£å¸¸çš„å¼€å‘æµç¨‹ä¸€æ ·,æˆ‘ä»¬å¯ä»¥æŠŠæ•´ä¸ªç½‘ç«™çš„å‘å¸ƒæµç¨‹æ‹†åˆ†ä¸ºä¸¤éƒ¨åˆ†: <strong>æ‰“åŒ…</strong> ä¸ <strong>å‘å¸ƒ</strong>.</p><p>å…¶ä¸­æ‰“åŒ…å¯ä»¥åœ¨æˆ‘ä»¬çš„ç§æœ‰ä»“åº“ä¸­è¿›è¡Œ, ç„¶åå°†æ‰“åŒ…åçš„é™æ€ç½‘ç«™ å‘å¸ƒåˆ°github.ioå…¬ä»“ä¸­.<br>è¿™é‡Œå°±ç”¨åˆ°äº†githubçš„ action è‡ªåŠ¨ç¼–è¯‘åŠŸèƒ½. å…¶ä¼šåœ¨æˆ‘ä»¬æäº¤ä»£ç çš„æ—¶å€™è§¦å‘ä¸€ä¸ªæ“ä½œ,<br>è°ƒç”¨ä¸€æ®µè„šæœ¬å‘½ä»¤æ‰§è¡Œ.</p><p>è€Œè¿™æ®µè„šæœ¬çš„æ ¸å¿ƒå°±æ˜¯é€šè¿‡git å°†ç¼–è¯‘åçš„é™æ€ç«™ç‚¹push åˆ°github.ioå…¬ä»“ä¸­.</p><p>æµç¨‹å¦‚ä¸‹:<br><img src="/images/site/private_repo_flow.png" alt="å‘å¸ƒæµç¨‹å›¾"></p><h2 id="æ“ä½œæ­¥éª¤"><a href="#æ“ä½œæ­¥éª¤" class="headerlink" title="æ“ä½œæ­¥éª¤"></a>æ“ä½œæ­¥éª¤</h2><ol><li>å…ˆåœ¨githubä¸Šåˆ›å»ºä¸€ä¸ªç§æœ‰ä»“åº“: private_repo.</li><li>å°†github.ioçš„æºç è¿ç§»åˆ°æ–°çš„ä»“åº“ä¸­.</li><li>å‡†å¤‡githubè·¨ä»“åº“git æäº¤ä»£ç æƒé™, å‚è€ƒä¸‹ä¸€èŠ‚githubç”³è¯·person token</li><li>åœ¨private_repo çš„action ä¸­åˆ›å»ºæ‰“åŒ…è„šæœ¬, è„šæœ¬å†…å®¹å‚è€ƒé™„å½•1<br><img src="/images/site/private_repo_new_action.png" alt="åˆ›å»ºæ–°action"></li></ol><h2 id="githubç”³è¯·person-token"><a href="#githubç”³è¯·person-token" class="headerlink" title="githubç”³è¯·person token"></a>githubç”³è¯·person token</h2><h3 id="ç¬¬ä¸€æ­¥-è·å–token"><a href="#ç¬¬ä¸€æ­¥-è·å–token" class="headerlink" title="ç¬¬ä¸€æ­¥, è·å–token"></a>ç¬¬ä¸€æ­¥, è·å–token</h3><ol><li>ä¸ªäººè®¾ç½®é‡Œæ‰¾åˆ°å…¥å£<br><img src="/images/site/github_person_token_1.png" alt="person token 1"></li><li>æ‰¾åˆ°å¼€å‘è€…è®¾ç½®<br><img src="/images/site/github_person_token_2.png" alt="person token 2"></li><li>åˆ›å»ºtoken<br><img src="/images/site/github_person_token_3.png" alt="person token 3"></li></ol><p><strong>è¿™ä¸€æ­¥ä¸€å®šè¦è®°ä½åˆ›å»ºå¥½çš„token, å› ä¸ºåé¢è¦ç”¨,è€Œä¸”è¿™ä¸ªé¡µé¢åˆ·æ–°åå°±æ²¡äº†</strong>.</p><p>å…¶å®æœ‰è¿‡ä½¿ç”¨sshç»éªŒçš„æœ‹å‹ä»¬åº”è¯¥å·²ç»æ„è¯†åˆ°äº†, è¿™ä¸€æ­¥å…¶å®å°±æ˜¯ä¸€ä¸ªåˆ›å»ºsshå…¬é’¥çš„è¿‡ç¨‹. åªä¸è¿‡è¿™ä¸ªå…¬é’¥æ˜¯æ”¾åˆ°githubæœåŠ¡å™¨ä¸Šäº†.</p><h3 id="ç¬¬äºŒæ­¥-ç§æœ‰åº“é…ç½®"><a href="#ç¬¬äºŒæ­¥-ç§æœ‰åº“é…ç½®" class="headerlink" title="ç¬¬äºŒæ­¥, ç§æœ‰åº“é…ç½®"></a>ç¬¬äºŒæ­¥, ç§æœ‰åº“é…ç½®</h3><p>æœ‰äº†token, æ­£å¸¸æ¥è¯´å°±èƒ½æäº¤ä»£ç äº†. ä½†æ˜¯è¦çŸ¥é“è¿™ä¸ªä¸œè¥¿æ˜¯æ”¾åˆ°è„šæœ¬é‡Œçš„, æ˜æ–‡æš´éœ²è¿˜æ˜¯ä¸å¤ªå®‰å…¨.<br>æ‰€ä»¥æˆ‘ä»¬è¦åœ¨ç§æœ‰åº“é‡Œå°†è¿™ä¸ªtokené…ç½®æˆä¸€ä¸ªç¯å¢ƒå˜é‡,é€šè¿‡ç¯å¢ƒå˜é‡å¼•ç”¨çš„æ–¹å¼ä½¿ç”¨,è¿™æ ·å°±å®‰å…¨å¤šäº†.</p><ol><li>æ‰¾åˆ°private_repo, é…ç½®tokenç¯å¢ƒå˜é‡<br><img src="/images/site/github_person_token_4.png" alt="person token 4"><br><img src="/images/site/github_person_token_5.png" alt="person token 5">  </li><li>é…ç½®å®Œå, æˆ‘ä»¬å°±å¯ä»¥åœ¨è„šæœ¬é‡Œé€šè¿‡ç¯å¢ƒå˜é‡æ¥ä½¿ç”¨tokenäº†.</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs doc">$&#123; &#123; secrets.YOUR_REPO_SECRET_NAME &#125; &#125;<br></code></pre></td></tr></table></figure><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>å¯ä»¥å°è¯•åœ¨ç§æœ‰åº“private_repoé‡Œæäº¤æ–‡ç« äº†.</p><p>åŒæ—¶ä½ ä¼šå‘ç°, github.ioå…¬ä»“é‡Œçš„å†…éƒ¨å…¨éƒ¨è¢«é™æ€ç½‘ç«™å†…å®¹è¦†ç›–äº†. ä¸ç”¨æ‹…å¿ƒ,è¿™æ˜¯æ­£å¸¸çš„.</p><h2 id="é™„å½•1-å®Œæ•´è„šæœ¬"><a href="#é™„å½•1-å®Œæ•´è„šæœ¬" class="headerlink" title="é™„å½•1 : å®Œæ•´è„šæœ¬"></a>é™„å½•1 : å®Œæ•´è„šæœ¬</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment"># ci name</span><br><span class="hljs-comment"># ci è„šæœ¬åç§°</span><br>name: Deploy Jekyll site to public github repos<br><br>on:<br>  <span class="hljs-comment"># Runs on pushes targeting the default branch</span><br>  <span class="hljs-comment"># å½“ä»£ç  push åˆ° main åˆ†æ”¯æ—¶, æ‰§è¡Œè¯¥è„šæœ¬</span><br>  push:<br>    branches: [<span class="hljs-string">&quot;main&quot;</span>]<br><br>  <span class="hljs-comment"># Allows you to run this workflow manually from the Actions tab</span><br>  <span class="hljs-comment"># å…è®¸ä½  æ‰‹åŠ¨æ‰§è¡Œ è¿™ä¸ªè„šæœ¬</span><br>  workflow_dispatch:<br><br><span class="hljs-comment"># Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages</span><br><span class="hljs-comment"># GITHUB_TOKEN çš„æ“ä½œæƒé™</span><br>permissions:<br>  contents: read<br>  pages: write<br>  id-token: write<br><br><span class="hljs-comment"># Allow one concurrent deployment</span><br>concurrency:<br>  group: <span class="hljs-string">&quot;pages&quot;</span><br>  cancel-in-progress: true<br><br><span class="hljs-comment"># job æ‰§è¡Œä»»åŠ¡, å¯ä»¥æœ‰å¤šä¸ª, é»˜è®¤å¹¶è¡Œè¿è¡Œ, å¯ä»¥é€šè¿‡ needs å…³é”®å­—æ¥è®¾ç½®ä¾èµ–çš„å…¶ä»– jobs</span><br><span class="hljs-comment"># step : ä»»åŠ¡ä¸‹çš„æ‰§è¡Œæ­¥éª¤, ä¸€ä¸ªjob ä¼šæœ‰å¤šä¸ªæ­¥éª¤</span><br><span class="hljs-comment"># æ“ä½œ:  ä¸€ä¸ªstep ä¸‹å¯ä»¥æ‰§è¡Œå¤šä¸ªæ“ä½œ, é€šå¸¸ä¸€è¡Œè„šæœ¬ä¸ºä¸€ä¸ªæ“ä½œ</span><br>jobs:<br>  <span class="hljs-comment"># Build job</span><br>  build:<br>    runs-on: ubuntu-latest<br>    steps:<br>      - name: Checkout<br>        uses: actions/checkout@v3<br>      <span class="hljs-comment"># å‡†å¤‡ruby ç¯å¢ƒ</span><br>      - name: Setup Ruby<br>        uses: ruby/setup-ruby@<span class="hljs-number">0</span>a29871fe2b0200a17a4497bae54fe5df0d973aa <span class="hljs-comment"># v1.115.3</span><br>        with:<br>          ruby-version: <span class="hljs-string">&#x27;3.0&#x27;</span> <span class="hljs-comment"># Not needed with a .ruby-version file</span><br>          bundler-cache: true <span class="hljs-comment"># runs &#x27;bundle install&#x27; and caches installed gems automatically</span><br>          cache-version: <span class="hljs-number">0</span> <span class="hljs-comment"># Increment this number if you need to re-download cached gems</span><br><span class="hljs-comment">#      - name: Setup Pages</span><br><span class="hljs-comment">#        id: pages</span><br><span class="hljs-comment">#        uses: actions/configure-pages@v2</span><br>      <span class="hljs-comment"># æ‰“åŒ… jekyll</span><br>      - name: Build with Jekyll<br>        <span class="hljs-comment"># Outputs to the &#x27;./_site&#x27; directory by default</span><br><span class="hljs-comment">#        run: bundle exec jekyll build --baseurl &quot;$&#123;&#123; steps.pages.outputs.base_path &#125;&#125;&quot;</span><br>        <span class="hljs-keyword">run</span><span class="language-bash">: bundle <span class="hljs-built_in">exec</span> jekyll build --verbose</span><br>        <span class="hljs-keyword">env</span>:<br>          JEKYLL_ENV: production<br>       <span class="hljs-comment"># æ›´æ–° æ‰“taråŒ…</span><br><span class="hljs-comment">#      - name: Upload artifact</span><br><span class="hljs-comment">#        # Automatically uploads an artifact from the &#x27;./_site&#x27; directory by default</span><br><span class="hljs-comment">#        uses: actions/upload-pages-artifact@v1</span><br><br>      - name: å¢åŠ å¤–éœ²githubæ–‡ä»¶<br>        working-directory: ./_site  <span class="hljs-comment"># jekyll é»˜è®¤ build åˆ° _site ç›®å½•ï¼Œå› æ­¤è®¾ç½®å‘½ä»¤æ‰§è¡Œçš„ç›®å½•ä¸º ./_site</span><br>        <span class="hljs-keyword">run</span><span class="language-bash">: |  <span class="hljs-comment"># run åé¢åŠ ä¸ª â€˜|â€™ ç„¶åæ¢è¡Œå¯ä»¥åŒæ—¶æ‰§è¡Œå¤šä¸ªå‘½ä»¤ï¼Œæ¯è¡Œä¸€ä¸ª</span></span><br>          cp ../README.md .<br> <br>      - name: éƒ¨ç½²_siteåˆ°åšå®¢ç½‘ç«™ä»“åº“<br>        working-directory: ./_site<br>        <span class="hljs-keyword">run</span><span class="language-bash">: |</span><br>          git init<br>          git checkout -b main<br>          git <span class="hljs-keyword">add</span><span class="language-bash"> -A</span><br>          git -c <span class="hljs-keyword">user</span>.name=<span class="hljs-string">&#x27;your_name&#x27;</span> -c <span class="hljs-keyword">user</span>.email=<span class="hljs-string">&#x27;your_email&#x27;</span> commit -m <span class="hljs-string">&#x27;anything&#x27;</span> <br>          git push <span class="hljs-string">&quot;https://$&#123; &#123; github.actor &#125; &#125;:$&#123; &#123; secrets.YOUR_REPO_SECRET_NAME &#125; &#125;@github.com/YOUR_GITHUB_IO_REPO&quot;</span> HEAD:main -f -q<br></code></pre></td></tr></table></figure><ul><li>å°†ä¸Šé¢çš„your_name,your_email,anything æ›¿æ¢æˆè‡ªå·±çš„å†…å®¹</li><li>YOUR_REPO_SECRET_NAME æ›¿æ¢æˆprivat_repoçš„secret_token_name</li><li>YOUR_GITHUB_IO_REPO æ›¿æ¢æˆè‡ªå·±çš„github.ioå…¬ä»“</li></ul><h2 id="é™„å½•2-github-action-è„šæœ¬ç®€ä»‹"><a href="#é™„å½•2-github-action-è„šæœ¬ç®€ä»‹" class="headerlink" title="é™„å½•2 : github action è„šæœ¬ç®€ä»‹"></a>é™„å½•2 : github action è„šæœ¬ç®€ä»‹</h2><p>åœ¨githubçš„actionæ¨¡å—é‡Œåˆ›å»ºäº†ä¸€ä¸ªè„šæœ¬å, å°±ä¼šåœ¨é¡¹ç›®çš„.github&#x2F;workflowsé‡Œåˆ›å»ºä¸€ä¸ªå¯¹åº”çš„æ–‡ä»¶.</p><p>é€šè¿‡workflow å¤§è‡´å¯ä»¥ç†è§£è¿™ä¸ªæ¨¡å—çš„åŠŸèƒ½, å°±æ˜¯ä¸€ä¸ªå·¥ä½œæµ.<br>åœ¨ä¸€äº›æ“ä½œæ‰§è¡Œ(é€šå¸¸æ˜¯æäº¤ä»£ç )å, è§¦å‘ä¸€ç³»åˆ—çš„åç»­è‡ªåŠ¨åŒ–æ“ä½œ, è¿™äº›æ“ä½œå¯ä»¥æ˜¯å¹¶è¡Œçš„,ä¹Ÿå¯ä»¥æ˜¯ä¸²è¡Œçš„. </p><p>è€Œè¿™äº›åç»­æ“ä½œæ˜¯é€šè¿‡ä¸€äº›actionè„šæœ¬ç»„ç»‡èµ·æ¥çš„. æ•´ä½“ä¸Šçœ‹,ä¸€ä¸ªactionç”±ä»¥ä¸‹éƒ¨åˆ†ç»„æˆ.</p><ul><li>jobs: ä»»åŠ¡. æœ€å¤§çš„é€»è¾‘å•å…ƒ. å¯ä»¥æœ‰å¤šä¸ª. jobs é»˜è®¤æ˜¯å¹¶è¡Œè¿è¡Œï¼Œå¯ä»¥é€šè¿‡ needs å…³é”®å­—æ¥è®¾ç½®ä¾èµ–çš„å…¶ä»– jobsã€‚</li><li>steps: æ­¥éª¤. jobçš„æ‰§è¡Œæ­¥éª¤. é¡ºåºæ‰§è¡Œ. å¯ä»¥jobå¯ä»¥æœ‰å¤šä¸ªæ­¥éª¤.</li><li>runs: æ“ä½œ. ä¹Ÿå¯ä»¥ç†è§£ä¸ºæŒ‡ä»¤(bashå‘½ä»¤ç­‰). é€šå¸¸ä¸€è¡Œè„šæœ¬å°±æ˜¯ä¸€ä¸ªæ“ä½œ. å¹¶éæ‰€æœ‰æ­¥éª¤éƒ½ä¼šè¿è¡Œæ“ä½œï¼Œä½†æ˜¯æ“ä½œéƒ½æ˜¯åœ¨æ­¥éª¤ä¸­è¿è¡Œçš„</li></ul><p>æ— è®ºæ˜¯job,è¿˜æ˜¯step, éƒ½å¯ä»¥ç†è§£ä¸€ç»„æŒ‡ä»¤é›†åˆ. ä»–ä»¬éƒ½æ˜¯å¯ä»¥é…ç½®idçš„. å¯ä»¥é€šè¿‡idæ¥äº’ç›¸ä¾èµ–, äº’ç›¸è°ƒç”¨.</p><p>å…¶ä»–çš„å¯ä»¥å‚è€ƒé‡Œçš„å®˜æ–¹æ–‡æ¡£.</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://github.com/peaceiris/actions-gh-pages">å¸¸è§è„šæœ¬</a></p><p><a href="https://docs.github.com/cn/actions/learn-github-actions/contexts#github-context">github action å®˜æ–¹æ–‡æ¡£</a></p><p><a href="https://www.xheldon.com/tech/the-using-of-github-pages.html">å…è´¹ä½¿ç”¨ç§æœ‰ä»“åº“å‘å¸ƒ GitHub Pages</a></p><p><a href="https://juejin.cn/post/7008847699919241229">é€šè¿‡ GitHub Actions å®ç°ç§æœ‰ä»“åº“çš„å…è´¹ Github Pages éƒ¨ç½²</a></p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç«™</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å»ºç«™</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Elasticsearché‡å»ºç´¢å¼•</title>
    <link href="/2022/09/12/es-reindex/"/>
    <url>/2022/09/12/es-reindex/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸ºä»€ä¹ˆè¦é‡å»ºç´¢å¼•"><a href="#ä¸ºä»€ä¹ˆè¦é‡å»ºç´¢å¼•" class="headerlink" title="ä¸ºä»€ä¹ˆè¦é‡å»ºç´¢å¼•"></a>ä¸ºä»€ä¹ˆè¦é‡å»ºç´¢å¼•</h2><p>ä¼—æ‰€å‘¨çŸ¥, esæ˜¯ä¸€ç§é«˜æ•ˆçš„æ•°æ®æŸ¥è¯¢,æ£€ç´¢å¼•æ“ã€‚ å¯ä»¥å¯¹æµ·é‡çš„æ•°æ®è¿›è¡Œå¿«é€Ÿçš„æŸ¥è¯¢ã€‚ä½†æ˜¯åœ¨ä½¿ç”¨esçš„æ—¶å€™ï¼Œç»å¸¸ä¼šé‡åˆ°ä¸€ä¸ªæ¯”è¾ƒå°´å°¬çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯esç´¢å¼•é‡Œçš„å­—æ®µç±»å‹æ˜¯å›ºå®šçš„ï¼Œä¸å¯ä¿®æ”¹çš„ã€‚è€Œesçš„ç´¢å¼•åˆæ˜¯å¯ä»¥è‡ªåŠ¨æ‰©å±•å­—æ®µçš„ã€‚ è¿™ä¸ªæ—¶å€™è‡ªåŠ¨æ‰©å±•å‡ºæ¥çš„å­—æ®µå°±æ˜¯ä½¿ç”¨äº†é»˜è®¤çš„å­—æ®µç±»å‹(é€šå¸¸æ˜¯textç±»å‹)ã€‚</p><p>æƒŠä¸æƒŠå–œï¼</p><p>æŸ¥çœ‹ç´¢å¼•å­—æ®µçš„æ–¹æ³•:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs json">GET /my_index<br><br><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;my_index&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;mappings&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;_doc&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;dynamic_templates&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><br>                    <span class="hljs-punctuation">&#123;</span><br>                        <span class="hljs-attr">&quot;string_fields&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>                            <span class="hljs-attr">&quot;match_mapping_type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;string&quot;</span><span class="hljs-punctuation">,</span><br>                            <span class="hljs-attr">&quot;mapping&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>                                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;keyword&quot;</span><br>                            <span class="hljs-punctuation">&#125;</span><br>                        <span class="hljs-punctuation">&#125;</span><br>                    <span class="hljs-punctuation">&#125;</span><br>                <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>                    <span class="hljs-attr">&quot;field_a&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>                        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;keyword&quot;</span><br>                    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>                    <span class="hljs-attr">&quot;field_b&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>                        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;date&quot;</span><span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;format&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><br>                    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>                    <span class="hljs-attr">&quot;field_c&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>                        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;norms&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br>                        <span class="hljs-attr">&quot;fields&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>                            <span class="hljs-attr">&quot;keyword&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>                                <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;keyword&quot;</span><span class="hljs-punctuation">,</span><br>                                <span class="hljs-attr">&quot;ignore_above&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">256</span><br>                            <span class="hljs-punctuation">&#125;</span><br>                        <span class="hljs-punctuation">&#125;</span><br>                    <span class="hljs-punctuation">&#125;</span><br>                <span class="hljs-punctuation">&#125;</span><br>            <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br><br></code></pre></td></tr></table></figure><p>èªæ˜çš„ä½ è‚¯å®šæƒ³åˆ°äº†, å¦‚æœæˆ‘ä»¬å¿˜è®°åŠ å­—æ®µäº†, æˆ–è€…å­—æ®µåŠ é”™äº†è¦ä¿®æ”¹å­—æ®µç±»å‹å’‹åŠ? è¿™ä¸ªæ—¶å€™åœºæ™¯çš„åŠæ³•å°±åªæœ‰ä¸€ä¸ªäº†:</p><p>é‡å»ºç´¢å¼•!</p><p>ä»æ•°æ®åº“è§’åº¦æ¥çœ‹,ä¹Ÿå°±æ˜¯æ–°å¢æ–°è¡¨, è¿ç§»æ•°æ®, åˆ é™¤è€è¡¨.</p><h2 id="èƒŒæ™¯-ä¸-ç›®æ ‡"><a href="#èƒŒæ™¯-ä¸-ç›®æ ‡" class="headerlink" title="èƒŒæ™¯ ä¸ ç›®æ ‡"></a>èƒŒæ™¯ ä¸ ç›®æ ‡</h2><p>Elasticsearch ç‰ˆæœ¬ : v 6.6<br>ç›®æ ‡: åœ¨my_index ç´¢å¼•ä¸Šæ–°å¢ä¸€ä¸ªintegerå­—æ®µ. ä¸”ä¸­é—´ä¸é—´æ–­æœåŠ¡.</p><h2 id="S1-ä½¿ç”¨åˆ«åä»£æ›¿å®ä½“ç´¢å¼•"><a href="#S1-ä½¿ç”¨åˆ«åä»£æ›¿å®ä½“ç´¢å¼•" class="headerlink" title="S1: ä½¿ç”¨åˆ«åä»£æ›¿å®ä½“ç´¢å¼•"></a>S1: ä½¿ç”¨åˆ«åä»£æ›¿å®ä½“ç´¢å¼•</h2><p>ä½¿ç”¨<a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.6/indices-aliases.html">aliases api</a><br>åˆ›å»ºä¸€ä¸ªåˆ«åmy_index æŒ‡å‘å®é™…çš„ç´¢å¼•my_idex.<br>è¿™æ ·,æˆ‘ä»¬é€šè¿‡my_indexè®¿é—®æ•°æ®æ—¶, å°±ä¸ä¼šç›´æ¥è®¿é—®my_indexç´¢å¼•äº†, è€Œæ˜¯é€šè¿‡åˆ«åæŒ‡å‘å¯¹åº”çš„ç´¢å¼•.</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ada">POST /_aliases<br>&#123;<br>    <span class="hljs-string">&quot;actions&quot;</span> : [<br>        &#123; <span class="hljs-string">&quot;add&quot;</span> : &#123; &quot;<span class="hljs-type">index</span><span class="hljs-string">&quot; : &quot;</span>my_index<span class="hljs-string">&quot;, &quot;</span>alias<span class="hljs-string">&quot; : &quot;</span>my_index<span class="hljs-string">&quot; &#125; &#125;</span><br><span class="hljs-string">    ]</span><br><span class="hljs-string">&#125;</span><br></code></pre></td></tr></table></figure><h2 id="S2-åˆ›å»ºæ–°çš„ç´¢å¼•"><a href="#S2-åˆ›å»ºæ–°çš„ç´¢å¼•" class="headerlink" title="S2: åˆ›å»ºæ–°çš„ç´¢å¼•"></a>S2: åˆ›å»ºæ–°çš„ç´¢å¼•</h2><p>ä½¿ç”¨ <a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.6/indices-put-mapping.html">put mapping api</a><br>æ‰“ç®—æ–°å¢ä¸€ä¸ªå­—æ®µ <strong>fiedl_d</strong>, æ•°æ®ç±»å‹.</p><p>å› ä¸ºé»˜è®¤çš„stringç±»å‹æ˜¯keyword (å‡è®¾, æ„ä¼šå³å¯), æ‰€ä»¥å¦‚æœæƒ³è¦æ–°å¢ä¸€ä¸ªæ•´å‹ç±»å‹, å°±ä¸èƒ½é€šè¿‡è‡ªåŠ¨çš„æ‰©å±•å­—æ®µä½¿ç”¨é»˜è®¤ç±»å‹çš„æ–¹å¼. æ‰€ä»¥å¿…é¡»æ˜¾å¼çš„æŒ‡å®šå­—æ®µç±»å‹.</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-keyword">put</span> my_index2<br><br>&#123;<br>    <span class="hljs-string">&quot;_doc&quot;</span>:&#123;<br>        <span class="hljs-string">&quot;dynamic_templates&quot;</span>:[<br>            &#123;<br>                <span class="hljs-string">&quot;string_fields&quot;</span>:&#123;<br>                    <span class="hljs-string">&quot;match_mapping_type&quot;</span>:<span class="hljs-string">&quot;string&quot;</span>,<br>                    <span class="hljs-string">&quot;mapping&quot;</span>:&#123;<br>                        <span class="hljs-string">&quot;type&quot;</span>:<span class="hljs-string">&quot;keyword&quot;</span><br>                    &#125;<br>                &#125;<br>            &#125;<br>        ],<br>        <span class="hljs-string">&quot;properties&quot;</span>:&#123;<br>            <span class="hljs-string">&quot;field_a&quot;</span>:&#123;<br>                <span class="hljs-string">&quot;type&quot;</span>:<span class="hljs-string">&quot;keyword&quot;</span><br>            &#125;,<br>            <span class="hljs-string">&quot;field_b&quot;</span>:&#123;<br>                <span class="hljs-string">&quot;type&quot;</span>:<span class="hljs-string">&quot;date&quot;</span>,<br>                <span class="hljs-string">&quot;format&quot;</span>:<span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><br>            &#125;,<br>            <span class="hljs-string">&quot;field_c&quot;</span>:&#123;<br>                <span class="hljs-string">&quot;type&quot;</span>:<span class="hljs-string">&quot;text&quot;</span>,<br>                <span class="hljs-string">&quot;norms&quot;</span>:<span class="hljs-literal">false</span>,<br>                <span class="hljs-string">&quot;fields&quot;</span>:&#123;<br>                    <span class="hljs-string">&quot;keyword&quot;</span>:&#123;<br>                        <span class="hljs-string">&quot;type&quot;</span>:<span class="hljs-string">&quot;keyword&quot;</span>,<br>                        <span class="hljs-string">&quot;ignore_above&quot;</span>:<span class="hljs-number">256</span><br>                    &#125;<br>                &#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;field_d&quot;</span>:&#123;<br>                <span class="hljs-string">&quot;type&quot;</span>:<span class="hljs-string">&quot;integer&quot;</span><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="S3-è¿ç§»æ•°æ®"><a href="#S3-è¿ç§»æ•°æ®" class="headerlink" title="S3: è¿ç§»æ•°æ®"></a>S3: è¿ç§»æ•°æ®</h2><p>ä½¿ç”¨ <a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.6/docs-reindex.html">Reindex api</a><br>å°†è€çš„my_index æ•°æ®è¿ç§»åˆ°æ–°çš„my_index2ä¸Š.<br>è¿™ä¸€æ­¥æ¯”è¾ƒè€—æ—¶, åšå¥½å¿ƒç†å‡†å¤‡.</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs css">POST _reindex<br>&#123;<br>  &quot;<span class="hljs-selector-tag">source</span>&quot;: &#123;<br>    &quot;index&quot;: <span class="hljs-string">&quot;my_index&quot;</span><br>  &#125;,<br>  &quot;dest&quot;: &#123;<br>    &quot;index&quot;: <span class="hljs-string">&quot;my_index2&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="S4-å˜æ›´åˆ«å"><a href="#S4-å˜æ›´åˆ«å" class="headerlink" title="S4: å˜æ›´åˆ«å"></a>S4: å˜æ›´åˆ«å</h2><p>ä½¿ç”¨<a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.6/indices-aliases.html">aliases api</a><br>å°†åˆ«åä»è€çš„index, æŒ‡å‘æ–°çš„index</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ada">POST /_aliases<br>&#123;<br>    <span class="hljs-string">&quot;actions&quot;</span> : [<br>        &#123; <span class="hljs-string">&quot;remove&quot;</span> : &#123; &quot;<span class="hljs-type">index</span><span class="hljs-string">&quot; : &quot;</span>my_index<span class="hljs-string">&quot;, &quot;</span>alias<span class="hljs-string">&quot; : &quot;</span>my_index<span class="hljs-string">&quot; &#125; &#125;,</span><br><span class="hljs-string">        &#123; &quot;</span>add<span class="hljs-string">&quot; : &#123; &quot;</span>index<span class="hljs-string">&quot; : &quot;</span>my_index2<span class="hljs-string">&quot;, &quot;</span>alias<span class="hljs-string">&quot; : &quot;</span>my_index<span class="hljs-string">&quot; &#125; &#125;</span><br><span class="hljs-string">    ]</span><br><span class="hljs-string">&#125;</span><br></code></pre></td></tr></table></figure><h2 id="S5-å°†è€ç´¢å¼•çš„å¢é‡æ•°æ®è¿ç§»åˆ°æ–°ç´¢å¼•ä¸Š"><a href="#S5-å°†è€ç´¢å¼•çš„å¢é‡æ•°æ®è¿ç§»åˆ°æ–°ç´¢å¼•ä¸Š" class="headerlink" title="S5: å°†è€ç´¢å¼•çš„å¢é‡æ•°æ®è¿ç§»åˆ°æ–°ç´¢å¼•ä¸Š"></a>S5: å°†è€ç´¢å¼•çš„å¢é‡æ•°æ®è¿ç§»åˆ°æ–°ç´¢å¼•ä¸Š</h2><p>å¤„ç†è¿ç§»æœŸé—´my_index å‘ç”Ÿçš„å¢é‡æ•°æ®</p><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs fsharp">POST <span class="hljs-keyword">_reindex</span><br>&#123;<br>  <span class="hljs-string">&quot;size&quot;</span><span class="hljs-operator">:</span> 10000,<br>  <span class="hljs-string">&quot;source&quot;</span><span class="hljs-operator">:</span> &#123;<br>    <span class="hljs-string">&quot;index&quot;</span><span class="hljs-operator">:</span> <span class="hljs-string">&quot;my_index&quot;</span>,<br>    <span class="hljs-string">&quot;sort&quot;</span><span class="hljs-operator">:</span> &#123; <span class="hljs-string">&quot;date&quot;</span><span class="hljs-operator">:</span> <span class="hljs-string">&quot;desc&quot;</span> &#125;<br>  &#125;,<br>  <span class="hljs-string">&quot;dest&quot;</span><span class="hljs-operator">:</span> &#123;<br>    <span class="hljs-string">&quot;index&quot;</span><span class="hljs-operator">:</span> <span class="hljs-string">&quot;my_index2&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="S6-åˆ é™¤è€ç´¢å¼•"><a href="#S6-åˆ é™¤è€ç´¢å¼•" class="headerlink" title="S6: åˆ é™¤è€ç´¢å¼•"></a>S6: åˆ é™¤è€ç´¢å¼•</h2><p>ä½¿ç”¨ <a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.6/indices-delete-index.html">delete api</a></p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs actionscript"><span class="hljs-keyword">delete</span> my_index<br></code></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è‡³æ­¤, æ•´ä¸ªé‡å»ºç´¢å¼•è¿‡ç¨‹å®Œæ¯•.<br>å¾ˆéº»çƒ¦å§.<br>ä¸ºäº†ä¸è¿™ä¹ˆéº»çƒ¦, ä»¥åè¦ç»™es å¢åŠ æ–°å­—æ®µæ—¶, ä¸€å®šè¦å…ˆé€šè¿‡mapingçš„æ–¹å¼å…ˆæ–°å¢å­—æ®µ. ç„¶åå†åœ¨ä»£ç é‡Œå¤„ç†ç›¸å¯¹åº”çš„é€»è¾‘.</p><p>over!</p><h2 id="è¡¥å……è¯´æ˜"><a href="#è¡¥å……è¯´æ˜" class="headerlink" title="è¡¥å……è¯´æ˜"></a>è¡¥å……è¯´æ˜</h2><p>å¯ä»¥é€šè¿‡put mappingçš„æ–¹å¼, å¢é‡è¡¥å……ç´¢å¼•çš„å­—æ®µ</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs json">PUT my_index<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;mappings&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;_doc&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;manager&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>          <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;age&quot;</span><span class="hljs-punctuation">:</span>  <span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;integer&quot;</span> <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span>  <span class="hljs-punctuation">&#125;</span><br>          <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;employees&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>          <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;nested&quot;</span><span class="hljs-punctuation">,</span><br>          <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;age&quot;</span><span class="hljs-punctuation">:</span>  <span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;integer&quot;</span> <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span>  <span class="hljs-punctuation">&#125;</span><br>          <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.6/docs.html">å®˜æ–¹æ–‡æ¡£-api</a><br><a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.6/indices.html">å®˜æ–¹æ–‡æ¡£-api2</a></p>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹äººç”Ÿ</category>
      
      <category>Elasticsearch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>elasticsearch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>beaudarè¯„è®ºæ’ä»¶åŠå¸¸è§é—®é¢˜è§£å†³</title>
    <link href="/2022/09/09/site-beaudar-error/"/>
    <url>/2022/09/09/site-beaudar-error/</url>
    
    <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯beaudar"><a href="#ä»€ä¹ˆæ˜¯beaudar" class="headerlink" title="ä»€ä¹ˆæ˜¯beaudar"></a>ä»€ä¹ˆæ˜¯beaudar</h2><blockquote><p>Beaudar åç§°æºäºç²¤è¯­â€œè¡¨è¾¾â€çš„å‘éŸ³ï¼Œæ˜¯ Utterances çš„ä¸­æ–‡ç‰ˆæœ¬,æ˜¯ä¸€æ¬¾åŸºäºgithub issue çš„ä¸€ä¸ªè¯„è®ºæ’ä»¶</p></blockquote><ul><li>å¼€æº</li><li>æ²¡æœ‰è¿½è¸ªï¼Œæ²¡æœ‰å¹¿å‘Šï¼Œæ°¸ä¹…å…è´¹</li><li>ä¸ä¿ç•™æ•°æ®ï¼Œæ‰€æœ‰æ•°æ®ä¿å­˜åœ¨ç”¨æˆ· GitHub issue ä¸­</li><li>æœ‰æºäº GitHub primer çš„å¤šä¸ªä¸»é¢˜</li><li>è½»é‡åŒ–ï¼Œæ²¡æœ‰å­—ä½“ä¸‹è½½ï¼Œæ²¡æœ‰ JS æ¡†æ¶åŠ è½½</li></ul><p>æœ¬ç«™çš„è¯„è®ºæ¨¡å—å°±æ˜¯ä½¿ç”¨çš„ <a href="https://beaudar.lipk.org/">beaudar</a></p><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>é€‰æ‹© Beaudar å°†è¦è¿æ¥çš„ä»“åº“, ä¹Ÿå°±æ˜¯ç½‘ç«™å¯¹åº”çš„githubä»“åº“ã€‚</p><ol><li>ç¡®ä¿ä»“åº“æ˜¯å…¬å¼€çš„ï¼Œå¦åˆ™æ‚¨çš„è¯»è€…å°†æ— æ³•æŸ¥çœ‹ Issue(è¯„è®º)ã€‚</li><li>å®‰è£…å¹¶ç¡®ä¿ Beaudar app å·²åœ¨ä»“åº“ä¸­å®‰è£…ï¼Œå¦åˆ™ç”¨æˆ·å°†æ— æ³•å‘è¡¨è¯„è®ºã€‚</li></ol><p><a href="https://github.com/apps/beaudar">ç‚¹å‡»è¿™é‡Œå®‰è£…beaudar</a></p><p><img src="/images/site/comment/beaudar-app-install.png" alt="å®‰è£…beaudar"><br>3. å°†ç½‘ç«™å¯¹åº”çš„åˆ†æ”¯é…ç½®åˆ°é…ç½®ä¸­ï¼Œå¹¶ç¡®ä¿ Issues åŠŸèƒ½å·²æ‰“å¼€ã€‚<br>4. å°†ä»¥ä¸‹è„šæœ¬æ ‡è®°æ·»åŠ åˆ°åšå®¢çš„æ¨¡æ¿ä¸­ã€‚ å°†å…¶æ”¾ç½®åœ¨è¦æ˜¾ç¤ºæ³¨é‡Šçš„ä½ç½®ã€‚ ä½¿ç”¨ .beaudar å’Œ .beaudar-frame é€‰æ‹©å™¨è‡ªå®šä¹‰å¸ƒå±€ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script src=<span class="hljs-string">&quot;https://beaudar.lipk.org/client.js&quot;</span><br>        repo=<span class="hljs-string">&quot;åœ¨æ­¤å¤„è¾“å…¥ä»“åº“&quot;</span><br>        branch=<span class="hljs-string">&quot;main&quot;</span><br>        issue-term=<span class="hljs-string">&quot;pathname&quot;</span><br>        label=<span class="hljs-string">&quot;tag&quot;</span><br>        theme=<span class="hljs-string">&quot;github-light&quot;</span><br>        keep-theme=<span class="hljs-string">&quot;false&quot;</span><br>        loading=<span class="hljs-string">&quot;false&quot;</span><br>        comment-order=<span class="hljs-string">&quot;desc&quot;</span><br>        input-position=<span class="hljs-string">&quot;top&quot;</span><br>        crossorigin=<span class="hljs-string">&quot;anonymous&quot;</span><br>        <span class="hljs-keyword">async</span>&gt;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>é…ç½®è§£è¯»</p><ul><li>src : è¯„è®ºæ’ä»¶å®¢æˆ·ç«¯åœ°å€,ä¸èƒ½åŠ¨</li><li>repo : ç½‘ç«™ä»“åº“</li><li>branch : ç½‘ç«™éƒ¨ç½²åˆ†æ”¯</li><li>issue-term : åšå®¢æ–‡ç«  ä¸ Issue çš„æ˜ å°„<ul><li>pathname : Beaudar å°†æœç´¢æ ‡é¢˜åŒ…å«åšå®¢æ–‡ç«  URL è·¯å¾„çš„ Issueã€‚å¦‚æœæœªæ‰¾åˆ°åŒ¹é…çš„ Issueï¼Œåˆ™å½“æœ‰äººé¦–æ¬¡å¯¹æ‚¨çš„ä¿¡æ¯å‘è¡¨è¯„è®ºæ—¶ï¼ŒBeaudar ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª Issueã€‚</li><li>url : Beaudar å°†æœç´¢æ ‡é¢˜åŒ…å«åšå®¢æ–‡ç«  URL çš„ Issueã€‚ å¦‚æœæœªæ‰¾åˆ°åŒ¹é…çš„ Issueï¼Œåˆ™å½“æœ‰äººé¦–æ¬¡å¯¹æ‚¨çš„ä¿¡æ¯å‘è¡¨è¯„è®ºæ—¶ï¼ŒBeaudar ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª Issue</li><li>title: Beaudar å°†æœç´¢æ ‡é¢˜åŒ…å«åšå®¢æ–‡ç« æ ‡é¢˜çš„ Issueã€‚ å¦‚æœæœªæ‰¾åˆ°åŒ¹é…çš„ Issueï¼Œåˆ™å½“æœ‰äººé¦–æ¬¡å¯¹æ‚¨çš„ä¿¡æ¯å‘è¡¨è¯„è®ºæ—¶ï¼ŒBeaudar ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª Issue</li><li>og:title : Beaudar å°†æœç´¢æ ‡é¢˜åŒ…å«åšå®¢æ–‡ç« é¡µé¢ meta å…ƒç´  og:title çš„ Issueã€‚ å¦‚æœæœªæ‰¾åˆ°åŒ¹é…çš„ Issueï¼Œåˆ™å½“æœ‰äººé¦–æ¬¡å¯¹æ‚¨çš„ä¿¡æ¯å‘è¡¨è¯„è®ºæ—¶ï¼ŒBeaudar ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª Issue</li><li>preferred-color-scheme:æ‚¨å¯ä»¥é…ç½® Beaudar ä»¥æŒ‰ç¼–å·åŠ è½½ç‰¹å®šçš„ Issueã€‚ é—®é¢˜ä¸ä¼šè‡ªåŠ¨åˆ›å»º</li><li>å¯ä»¥æŒ‡å®šè‡ªå·±çš„åç§°: å°† Beaudar é…ç½®ä¸ºæœç´¢æ ‡é¢˜åŒ…å«æ‚¨é€‰æ‹©çš„ç‰¹å®šåç§°çš„é—®é¢˜ã€‚å¦‚æœæœªæ‰¾åˆ°åŒ¹é…é—®é¢˜ï¼ŒBeaudar å°†è‡ªåŠ¨åˆ›å»ºç¬¬ä¸€æ¬¡æœ‰äººè¯„è®ºæ‚¨çš„å¸–å­æ—¶ã€‚Issue çš„æ ‡é¢˜å°†æ˜¯æ‚¨é€‰æ‹©çš„åç§°</li></ul></li><li>theme: ä¸»é¢˜</li><li>keep-theme: å°†ä¸»é¢˜è®¾ç½®ä¿å­˜åˆ°é¡µé¢çš„ sessionStorageï¼Œä¿®æ”¹ä¸»é¢˜ååˆ·æ–°ï¼Œä¸»é¢˜è®¾ç½®ä¸ä¼šä¸¢å¤±</li><li>label: å°†åˆ†é…ç»™ Beaudar åˆ›å»ºçš„é—®é¢˜çš„æ ‡ç­¾,æ ‡ç­¾åç§°åŒºåˆ†å¤§å°å†™ã€‚è¯¥æ ‡ç­¾å¿…é¡»å­˜åœ¨äºæ‚¨çš„ä»“åº“ä¸­ï¼Œæ— æ³•é™„åŠ ä¸å­˜åœ¨çš„æ ‡ç­¾ã€‚æ ‡ç­¾åç§°æ”¯æŒæ·»åŠ è¡¨æƒ…ç¬¦å·</li><li>loading: ç‚¹å‡»åŠ è½½å›¾æ ‡å¯è·³è½¬è‡³å®˜æ–¹é¡µé¢ã€‚</li><li>comment-order: è¯„è®ºçš„å‘è¡¨æ—¶é—´æ’åº</li><li>input-position: è¯„è®ºæ¡†ä½ç½®,å½“é€‰æ‹©å°†è¯„è®ºé¡ºåºè®¾ç½®ä¸ºâ€œé™åºâ€æ—¶ï¼Œå»ºè®®å°†è¯„è®ºæ¡†æ”¾ç½®åœ¨â€œé¡¶éƒ¨â€ã€‚å› ä¸ºå½“è¯„è®ºæ•°é‡å¾ˆå¤šæ—¶å€™ï¼Œå‘è¡¨è¯„è®ºåå¯ä»¥ç¬¬ä¸€æ—¶é—´çœ‹åˆ°è¯„è®ºå‘è¡¨æˆåŠŸ</li><li>crossorigin: è·¨åŸŸ</li></ul><h2 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h2><h3 id="ç¼ºå°‘-â€œbeaudar-jsonâ€-é…ç½®"><a href="#ç¼ºå°‘-â€œbeaudar-jsonâ€-é…ç½®" class="headerlink" title="ç¼ºå°‘ â€œbeaudar.jsonâ€ é…ç½®"></a>ç¼ºå°‘ â€œbeaudar.jsonâ€ é…ç½®</h3><p><img src="/images/site/comment/beaudar-error.png" alt="ç¼ºå°‘ &quot;beaudar.json&quot; é…ç½®"><br>åŸå› : ç°åœ¨githubçš„é»˜è®¤ä¸»åˆ†æ”¯æ˜¯main, ä¸åœ¨æ˜¯master. æ‰€ä»¥åˆ†æ”¯æ‰¾ä¸åˆ°.<br>é…ç½®çš„æ—¶å€™æŒ‡å®šåˆ†æ”¯ä¸ºmainå°±å¯ä»¥äº†.</p><h3 id="hexo-fluidä¸»é¢˜ä¸‹çš„ä½¿ç”¨"><a href="#hexo-fluidä¸»é¢˜ä¸‹çš„ä½¿ç”¨" class="headerlink" title="hexo-fluidä¸»é¢˜ä¸‹çš„ä½¿ç”¨"></a>hexo-fluidä¸»é¢˜ä¸‹çš„ä½¿ç”¨</h3><p>å°†ä¸Šè¿°çš„ scriptè„šæœ¬ åœ¨<code>_config.yml</code>ä¸­æŒ‰å¦‚ä¸‹æ–¹å¼æ·»åŠ å³å¯</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># è‡ªå®šä¹‰åº•éƒ¨ HTML å†…å®¹ï¼ˆä½äº footer ä¸Šæ–¹ï¼‰ï¼Œä¹Ÿå¯ç”¨äºå¤–éƒ¨å¼•å…¥ js css è¿™äº›æ“ä½œï¼Œæ³¨æ„ä¸è¦å’Œ post.custom é…ç½®å†²çª</span><br><span class="hljs-attr">custom_html:</span> <span class="hljs-string">&#x27;</span><br><span class="hljs-string">&lt;script src=&quot;https://beaudar.lipk.org/client.js&quot;</span><br><span class="hljs-string">        repo=&quot;Hanchers/hanchers.github.io&quot;</span><br><span class="hljs-string">        branch=&quot;main&quot;</span><br><span class="hljs-string">        issue-term=&quot;pathname&quot;</span><br><span class="hljs-string">        label=&quot;tag&quot;</span><br><span class="hljs-string">        theme=&quot;github-light&quot;</span><br><span class="hljs-string">        keep-theme=&quot;false&quot;</span><br><span class="hljs-string">        loading=&quot;false&quot;</span><br><span class="hljs-string">        comment-order=&quot;desc&quot;</span><br><span class="hljs-string">        input-position=&quot;top&quot;</span><br><span class="hljs-string">        crossorigin=&quot;anonymous&quot;</span><br><span class="hljs-string">        async&gt;</span><br><span class="hljs-string">&lt;/script&gt;</span><br><span class="hljs-string">&#x27;</span><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯æ•ˆæœæ¯”è¾ƒä¸‘ï¼Œéœ€è¦è‡ªå·±å»è°ƒæ•´ä¸€ä¸‹cssæ‰ä¸æ•´ä¸ªä¸»é¢˜é€‚é…, å»ºè®®ä½¿ç”¨fluidä¸»é¢˜å·²ç»é›†æˆå¥½çš„ç»„ä»¶ã€‚<br><img src="/images/site/comment/beaudar_in_fluid.png" alt="fluidä¸»é¢˜ä¸‹çš„beaudar è¯„è®ºæ’ä»¶æ•ˆæœ"></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://githubhelp.com/beaudar/beaudar">beaudar Q&amp;A</a></p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç«™</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å»ºç«™</tag>
      
      <tag>beaudar</tag>
      
      <tag>è¯„è®ºæ’ä»¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¦‚ä½•å†™å¥½javaæ³¨é‡Š</title>
    <link href="/2022/09/01/java-java-doc-skill/"/>
    <url>/2022/09/01/java-java-doc-skill/</url>
    
    <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯javaæ³¨é‡Š"><a href="#ä»€ä¹ˆæ˜¯javaæ³¨é‡Š" class="headerlink" title="ä»€ä¹ˆæ˜¯javaæ³¨é‡Š"></a>ä»€ä¹ˆæ˜¯javaæ³¨é‡Š</h2><p>è¦å›ç­”è¿™ä¸ªé—®é¢˜,å…ˆæå‡ºä¸€ä¸ªè¯´æ³•:æˆ‘ä»¬å†™çš„ä»£ç æ˜¯ç»™äººçœ‹çš„,ä¸æ˜¯ç»™æœºå™¨çœ‹çš„.<br>å¦‚æœä½ ä¸è®¤å¯è¿™ä¸ªè¯´æ³•,ä¸‹é¢å…³äºä»£ç æ³¨é‡Šçš„ä¸€äº›æ€»ç»“æƒ³å¿…å¯¹ä½ ä¹Ÿæ²¡å•¥å¸®åŠ©.<br>å¦‚æœä½ è®¤å¯è¿™ä¸ªè¯´æ³•, é‚£ä¹ˆä¸‹é¢çš„æ–‡ç« å¸Œæœ›ä¼šç»™ä½ ä¸€äº›å¸®åŠ©.</p><p>å›åˆ°æœ¬æ®µçš„ä¸»é¢˜,ä»€ä¹ˆæ˜¯javaæ³¨é‡Šå‘¢?</p><ol><li><p>é¦–å…ˆ,æ³¨é‡Šæ˜¯é¢å‘ä»£ç ç»´æŠ¤è€…çš„: æ³¨é‡Šæ˜¯å¯¹ä»£ç é€»è¾‘çš„ä¸€æ®µè¯´æ˜, æ–¹ä¾¿åç»­çš„ä»£ç ç»´æŠ¤è€…èƒ½å¤Ÿå¿«é€Ÿçš„äº†è§£è¿™æ®µä»£ç çš„å«ä¹‰,å¹¶ä¾æ¬¡ä¸ºåŸºç¡€èƒ½å¤Ÿåœ¨ç°æœ‰ä»£ç çš„åŸºç¡€ä¸Šåšä¿®æ”¹ä¸ç»´æŠ¤.</p></li><li><p>å…¶æ¬¡,æ³¨é‡Šæ˜¯é¢å‘ç³»ç»Ÿä½¿ç”¨è€…çš„: è¦çŸ¥é“ç±»ä¼¼äºjava,æˆ–è€…springè¿™æ ·åå‘äºåº•å±‚,æ¡†æ¶ç±»çš„ä»£ç .å…¨ä¸–ç•Œæœ‰æ•°ä»¥ä¸‡è®¡çš„ä½¿ç”¨è€…çš„,è¿™äº›äººæ²¡ç²¾åŠ›ä¹Ÿæ²¡æœ‰å¿…è¦åœ¨è°ƒç”¨apiçš„æ—¶å€™å»äº†è§£è¿™æ®µä»£ç çš„åº•å±‚å®ç°é€»è¾‘,æ‰€ä»¥è¿™æ®µä»£ç çš„apiè¯´æ˜æ–‡æ¡£å°±æ˜¾å¾—å¾ˆé‡è¦äº†.è€Œä»£ç ä¸Šçš„æ³¨é‡Šå°±æ˜¯ç›¸å…³apiæ–‡æ¡£çš„ä¸»è¦æ¥æº.</p></li><li><p>é€šè¿‡javadocå‘½ä»¤,å¯ä»¥å°†æ³¨é‡ŠæŠ½ç¦»ç”Ÿæˆhtmlæ–‡æ¡£,æ¯”å¦‚å®˜æ–¹çš„<a href="https://docs.oracle.com/en/java/javase/16/docs/api/index.html">java16APIæ–‡æ¡£</a></p></li></ol><h2 id="å¦‚ä½•å†™å¥½javaæ³¨é‡Š"><a href="#å¦‚ä½•å†™å¥½javaæ³¨é‡Š" class="headerlink" title="å¦‚ä½•å†™å¥½javaæ³¨é‡Š"></a>å¦‚ä½•å†™å¥½javaæ³¨é‡Š</h2><p>æƒ³è¦å†™å¥½ä»£ç çš„æ³¨é‡Š,æˆ‘ä»¬è¦ä»æ³¨é‡Šçš„é¢å‘ç”¨æˆ·æ¥è€ƒè™‘.ä¸åŒçš„ç”¨æˆ·å…³æ³¨ç‚¹è¿˜æ˜¯æœ‰ç‚¹å·®å¼‚çš„.</p><h4 id="é¢å‘ä»£ç ç»´æŠ¤è€…"><a href="#é¢å‘ä»£ç ç»´æŠ¤è€…" class="headerlink" title="é¢å‘ä»£ç ç»´æŠ¤è€…"></a>é¢å‘ä»£ç ç»´æŠ¤è€…</h4><p>ä½œä¸ºä¸€åä»£ç çš„ç»´æŠ¤è€…,å½“æˆ‘ä»¬æ‹¿åˆ°ä¸€ä»½æ²¡æœ‰ä»»ä½•æ³¨é‡Šçš„ä»£ç çš„æ—¶å€™,ç›¸ä¿¡å¤§å®¶å†…å¿ƒçš„æ„Ÿå—æ˜¯ç›¸åŒçš„.æ¯•ç«Ÿäººç±»çš„æ‚²æ¬¢å¹¶ä¸ç›¸é€š, é™¤éçœ‹åˆ°æ²¡æœ‰æ³¨é‡Šçš„ä»£ç .</p><p>å¦‚æœæœ‰äº†è§£è®¾è®¡æ¨¡å¼çš„æœ‹å‹,ç›¸ä¿¡ä¸€å®šå¬è¯´è¿‡ä¸€ä¸ªè®¾è®¡åŸåˆ™:<strong>å¼€é—­åŸåˆ™</strong>, å¯¹æ‰©å±•å¼€å‘,å¯¹ä¿®æ”¹å…³é—­. é‚£ä¹ˆå¤§å®¶æœ‰æ²¡æœ‰æƒ³è¿‡ä¸ºå•¥ä¼šæœ‰è¿™ä¸ªåŸåˆ™å‘¢?</p><p>ç¿»è¯‘ä¸€ä¸‹: ä¿®æ”¹ç°æœ‰çš„ä»£ç æ˜¯æœ‰é£é™©çš„,ä½†æ˜¯å¦‚æœæ˜¯æ‰©å±•å†™æ–°ä»£ç çš„è¯,ä½œä¸ºå¼€å‘è€…çš„ä½ ,æ˜¯äº†è§£å½“å‰åŠŸèƒ½çš„å‰åèƒŒæ™¯çš„,è€Œä¸”ä½ æ— è®ºæ€ä¹ˆå†™éƒ½ä¸ä¼šå¯¹å†å²åŠŸèƒ½äº§ç”Ÿå½±å“.æ‰€ä»¥å¯¹æˆ‘ä»¬çš„ä»£ç è®¾è®¡èƒ½åŠ›æå‡ºæ¥è¦æ±‚.</p><p>å†ç¿»è¯‘ä¸€ä¸‹: åŸæ¥çš„ä»£ç æ—¢ç„¶è·‘çš„å¥½å¥½çš„,ä¸ºå•¥è¦ä¿®æ”¹å®ƒå‘¢, æ”¹å‡ºé—®é¢˜æ¥ç®—è°çš„?</p><p>å†ç¿»è¯‘ä¸€ä¸‹: ä¸ºå•¥æˆ‘ä»¬ä¸æ•¢æ”¹ä»¥å‰çš„ä»£ç å‘¢?è°çŸ¥é“å½“æ—¶ä¸ºå•¥è¦å†™è¿™æ®µé€»è¾‘,è°çŸ¥é“è¿™æ®µé€»è¾‘æœ‰è°åœ¨ç”¨?æ”¹å¥½äº†æ²¡æœ‰å¤¸, æ”¹å´©äº†æœ‰é”…èƒŒ.</p><p>è¿™å°±æ˜¯æˆ‘ä»¬ç»´æŠ¤è€ä»£ç çš„å›°å¢ƒ!</p><p>ä½œä¸ºä¸€åç¨‹åºå‘˜,æˆ‘ä»¬è¦æœ‰ä¸€ä¸ªæ¦‚å¿µ,æˆ‘ä»¬çš„ä»£ç æ˜¯æˆ‘ä»¬æŸä¸ªæ—¶åˆ»çš„æ€ç»´é€»è¾‘çš„å›ºåŒ–.<br>å¦‚æœæ˜¯ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„é€»è¾‘,æ³¨é‡Šå¯ä»¥ç®€å•å†™å†™.<br>å¦‚æœæ˜¯ä¸€æ®µæ¯”è¾ƒå¤æ‚çš„é€»è¾‘,é‚£ä¹ˆæˆ‘ä»¬çš„æ³¨é‡Šè¦èƒ½å¤Ÿæè¿°æ¸…æ¥šæˆ‘ä»¬å½“æ—¶çš„è¿™æ®µé€»è¾‘çš„èƒŒæ™¯(ä¸ºä»€ä¹ˆè¦å†™è¿™æ®µé€»è¾‘), æ„å›¾(è¿™æ®µé€»è¾‘è¦å®ç°ä»€ä¹ˆæ•ˆæœ), ç”¨æ³•(è¿™æ®µé€»è¾‘æ”¹å¦‚ä½•ä½¿ç”¨,ä»¥åŠè°åœ¨ç”¨), æœ€å¥½èƒ½æœ‰ä¿®æ”¹å»ºè®®.</p><p>åœ¨ä¸šç•Œå¼€æºçš„ä»£ç é‡Œæœ‰å¾ˆå¤šæ¯”è¾ƒå¥½çš„ä¾‹å­,æ¥ä¸ªspringçš„:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * AOP Alliance MethodInterceptor for declarative transaction</span><br><span class="hljs-comment"> * management using the common Spring transaction infrastructure</span><br><span class="hljs-comment"> * (&#123;<span class="hljs-doctag">@link</span> org.springframework.transaction.PlatformTransactionManager&#125;/</span><br><span class="hljs-comment"> * &#123;<span class="hljs-doctag">@link</span> org.springframework.transaction.ReactiveTransactionManager&#125;).</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * &lt;p&gt;Derives from the &#123;<span class="hljs-doctag">@link</span> TransactionAspectSupport&#125; class which</span><br><span class="hljs-comment"> * contains the integration with Spring&#x27;s underlying transaction API.</span><br><span class="hljs-comment"> * TransactionInterceptor simply calls the relevant superclass methods</span><br><span class="hljs-comment"> * such as &#123;<span class="hljs-doctag">@link</span> #invokeWithinTransaction&#125; in the correct order.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * &lt;p&gt;TransactionInterceptors are thread-safe.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> Rod Johnson</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> Juergen Hoeller</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@see</span> TransactionProxyFactoryBean</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@see</span> org.springframework.aop.framework.ProxyFactoryBean</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@see</span> org.springframework.aop.framework.ProxyFactory</span><br><span class="hljs-comment"> */</span><br></code></pre></td></tr></table></figure><h4 id="é¢å‘apiä½¿ç”¨è€…"><a href="#é¢å‘apiä½¿ç”¨è€…" class="headerlink" title="é¢å‘apiä½¿ç”¨è€…"></a>é¢å‘apiä½¿ç”¨è€…</h4><p>å¯¹äºapiçš„ä½¿ç”¨è€…,æ³¨é‡Šæ–‡æ¡£çš„è¦æ±‚ç›¸å¯¹ç®€å•äº›.</p><p>ä»–ä»¬åªå…³å¿ƒè¿™ä¸ªæ–¹æ³•çš„åŠŸèƒ½æ˜¯ä»€ä¹ˆ, ä»¥åŠå…¥å‚æœ‰å“ªäº›,å‡ºå‚ä¼šæœ‰å“ªäº›, ä¼šä¸ä¼šæŠ›å¼‚å¸¸ç­‰, ä¼šä¸ä¼šè¿”å›nullç­‰.  ä»–ä»¬ä¸å…³å¿ƒè¿™ä¸ªæ–¹æ³•çš„å†…éƒ¨å®ç°é€»è¾‘æ˜¯å•¥, æ¯”å¦‚ä¸€ä¸ªæ’åºæ–¹æ³•, ä½¿ç”¨è€…ä¸å…³å¿ƒè¿™ä¸ªæ–¹æ³•å†…éƒ¨ä½¿ç”¨å†’æ³¡æ’åº,è¿˜æ˜¯å¿«æ’, åªè¦èƒ½å®Œæˆè¯‰æ±‚å°±è¡Œ.</p><p>æ‰€ä»¥,é¢å‘apiçš„ä½¿ç”¨è€…çš„æ³¨é‡Š,åŸåˆ™å°±æ˜¯è®©ä»–çŸ¥é“è¿™ä¸ªæ–¹æ³•æ€ä¹ˆä½¿ç”¨å°±è¡Œäº†.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">* Returns an Image object that can then be painted on the screen. </span><br><span class="hljs-comment">* The url argument must specify an absolute &lt;a href=&quot;#&#123;<span class="hljs-doctag">@link</span>&#125;&quot;&gt;&#123;<span class="hljs-doctag">@link</span> URL&#125;&lt;/a&gt;. The name</span><br><span class="hljs-comment">* argument is a specifier that is relative to the url argument. </span><br><span class="hljs-comment">* &lt;p&gt;</span><br><span class="hljs-comment">* This method always returns immediately, whether or not the </span><br><span class="hljs-comment">* image exists. When this applet attempts to draw the image on</span><br><span class="hljs-comment">* the screen, the data will be loaded. The graphics primitives </span><br><span class="hljs-comment">* that draw the image will incrementally paint on the screen. </span><br><span class="hljs-comment">*</span><br><span class="hljs-comment">* <span class="hljs-doctag">@param</span>  url  an absolute URL giving the base location of the image</span><br><span class="hljs-comment">* <span class="hljs-doctag">@param</span>  name the location of the image, relative to the url argument</span><br><span class="hljs-comment">* <span class="hljs-doctag">@return</span>      the image at the specified URL</span><br><span class="hljs-comment">* <span class="hljs-doctag">@see</span>         Image</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">public</span> Image <span class="hljs-title function_">getImage</span><span class="hljs-params">(URL url, String name)</span> &#123;<br><span class="hljs-keyword">try</span> &#123;<br><span class="hljs-keyword">return</span> getImage(<span class="hljs-keyword">new</span> <span class="hljs-title class_">URL</span>(url, name));<br>&#125; <span class="hljs-keyword">catch</span> (MalformedURLException e) &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å†™å¥½javaæ³¨é‡Šå¸¸ç”¨çš„æŠ€å·§"><a href="#å†™å¥½javaæ³¨é‡Šå¸¸ç”¨çš„æŠ€å·§" class="headerlink" title="å†™å¥½javaæ³¨é‡Šå¸¸ç”¨çš„æŠ€å·§"></a>å†™å¥½javaæ³¨é‡Šå¸¸ç”¨çš„æŠ€å·§</h2><h4 id="å¸¸ç”¨çš„æ³¨é‡Štag"><a href="#å¸¸ç”¨çš„æ³¨é‡Štag" class="headerlink" title="å¸¸ç”¨çš„æ³¨é‡Štag"></a>å¸¸ç”¨çš„æ³¨é‡Štag</h4><ol><li>@param æ–¹æ³•å‚æ•°</li><li>@return æ–¹æ³•è¿”å›å€¼</li><li>@throws æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸, java1.2åæ·»åŠ </li><li>@exception åŒ@throws</li><li>@see æŸ¥çœ‹å‚è€ƒä»£ç </li><li>@author æ ‡è¯†ä½œè€…</li><li>@version ä»£ç ç‰ˆæœ¬</li><li>@since ä»æŸä¸ªç‰ˆæœ¬å¼€å§‹å¼•å…¥</li><li>@serial( @serialField  @serialData)</li><li>@deprecated åºŸå¼ƒæŸä¸ªç‰ˆæœ¬çš„ä»£ç </li></ol><h4 id="å¸¸ç”¨çš„å†…è”tag"><a href="#å¸¸ç”¨çš„å†…è”tag" class="headerlink" title="å¸¸ç”¨çš„å†…è”tag"></a>å¸¸ç”¨çš„å†…è”tag</h4><ol><li>{@code} : ä»£ç é«˜äº®,ç­‰åŒäº <code>&#123;@literal&#125;</code></li></ol><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span></span><span class="hljs-template-variable">&#123;@literal&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span></span><br></code></pre></td></tr></table></figure><ol start="2"><li>{@docRoot} : æ ‡è®°æ–‡æ¡£çš„æ ¹è·¯å¾„,ç”¨æ¥å®ç°ç›¸å¯¹è·¯å¾„</li></ol><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs perl">/**<br>* See the &lt;ahref=<span class="hljs-string">&quot;&#123;<span class="hljs-variable">@docRoot</span>&#125;/copyright.html&quot;</span>&gt;Copyright&lt;<span class="hljs-regexp">/a&gt;.</span><br><span class="hljs-regexp">*/</span><br></code></pre></td></tr></table></figure><ol start="3"><li>{@inheritDoc} : ç»§æ‰¿æŸä¸ªæ–‡æ¡£,åµŒå¥—æ–‡æ¡£ä½¿ç”¨</li><li>{@link url} : åœ¨æ³¨é‡Šæ–‡æœ¬åŒºåŸŸå†…, å†…è”ä¸€ä¸ªé“¾æ¥</li></ol><figure class="highlight leaf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs leaf">Use the &#123;@link <span class="hljs-punctuation">#</span><span class="hljs-keyword">getComponentAt</span><span class="hljs-params">(<span class="hljs-keyword">in</span><span class="hljs-variable">t</span>, <span class="hljs-keyword">in</span><span class="hljs-variable">t</span>)</span> getComponentAt&#125; method.<br><br></code></pre></td></tr></table></figure><ol start="5"><li>{@linkplain url label} ç›¸å¯¹äº{@link}, æ”¯æŒè‡ªå®šä¹‰labelæ–‡æ¡ˆæ¥ä»£æŒ‡è¿™æ®µurl</li></ol><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">Refer <span class="hljs-keyword">to</span> &#123;@linkplain <span class="hljs-keyword">add</span>() the overridden <span class="hljs-keyword">method</span>&#125;.<br>ä¼šæ˜¾ç¤ºä¸º<br>Refer <span class="hljs-keyword">to</span> <span class="hljs-string">&#x27;the overridden method&#x27;</span>.<br><br></code></pre></td></tr></table></figure><ol start="6"><li>{@literal} è½¬ä¹‰ç”¨, æ–¹ä¾¿æ˜¾ç¤ºä¸€äº›ç‰¹æ®Šå­—ç¬¦</li><li>{@value} å¸¸é‡æ—¶, ä¼šç›´æ¥æ˜¾ç¤ºæ ‡æ³¨ä»£ç çš„å€¼</li></ol><h3 id="æ³¨é‡Šè¯­å¥ä¸­çš„å°æŠ€å·§"><a href="#æ³¨é‡Šè¯­å¥ä¸­çš„å°æŠ€å·§" class="headerlink" title="æ³¨é‡Šè¯­å¥ä¸­çš„å°æŠ€å·§"></a>æ³¨é‡Šè¯­å¥ä¸­çš„å°æŠ€å·§</h3><h4 id="param-return-throws"><a href="#param-return-throws" class="headerlink" title="@param @return @throws"></a>@param @return @throws</h4><p>ä¸€ä¸ªæ­£å¸¸æ–¹æ³•å¿…ç„¶ä¼šç”¨åˆ°çš„æ³¨é‡Štag,<br>@param ä»£è¡¨æ–¹æ³•çš„å…¥å‚,<br>@return ä»£è¡¨æ–¹æ³•çš„è¿”å›å€¼.<br>@throws ä»£è¡¨å¯èƒ½å¼•å‘æ–¹æ³•ä¸­æ–­çš„å¼‚å¸¸. ç­‰åŒä¸ @exception<br>è¿™é‡Œéœ€è¦ç‰¹åˆ«è¯´æ˜ä¸€ä¸‹, æœ‰äº›äººå¯èƒ½è§‰å¾—åªæœ‰é‚£äº›å—æ£€å¼‚å¸¸(ä¹Ÿå°±æ˜¯å¿…é¡»åœ¨æ–¹æ³•ç­¾åé‡Œå£°æ˜çš„å¼‚å¸¸)æ‰éœ€è¦åœ¨æ³¨é‡Šé‡Œå£°æ˜@throws. å…¶å®ä¸æ˜¯çš„. æ‰€æœ‰å¼•å‘ç¨‹åºä¸­æ–­çš„å¼‚å¸¸, åŒ…æ‹¬è¿è¡Œæ—¶å¼‚å¸¸éƒ½å¯ä»¥åœ¨æ³¨é‡Šé‡Œè¯´æ˜, ä¹Ÿå¯ä»¥åœ¨æ–¹æ³•ç­¾åé‡Œæ·»åŠ . å°¤å…¶æ˜¯è‡ªå®šä¹‰çš„å¼‚å¸¸.<br>ä¸¾ä¸ªä¾‹å­:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Return the underlying ThreadPoolExecutor for native access.</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> the underlying ThreadPoolExecutor (never &#123;<span class="hljs-doctag">@code</span> null&#125;)</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> IllegalStateException if the ThreadPoolTaskExecutor hasn&#x27;t been initialized yet</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> ThreadPoolExecutor <span class="hljs-title function_">getThreadPoolExecutor</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IllegalStateException &#123;<br>Assert.state(<span class="hljs-built_in">this</span>.threadPoolExecutor != <span class="hljs-literal">null</span>, <span class="hljs-string">&quot;ThreadPoolTaskExecutor not initialized&quot;</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.threadPoolExecutor;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œçš„IllegalStateException æ˜¯ä¸€ä¸ªRuntimeExceptionå¼‚å¸¸, æˆ‘ä»¬åœ¨æ–¹æ³•é‡Œå¯èƒ½æŠ›å‡ºè¿™ä¸ªå¼‚å¸¸, æœ€å¥½æ˜¯åœ¨æ–¹æ³•ç­¾åé‡Œå£°æ˜ä¸€ä¸‹, ç„¶ååœ¨ä»£ç æ³¨é‡Šé‡Œè¯´æ˜ä¸€ä¸‹.</p><h4 id="see"><a href="#see" class="headerlink" title="@see"></a>@see</h4><p>å½“å‰ä»£ç å¯ä»¥å‚è€ƒçš„å…¶ä»–ä»£ç , åé¢è·Ÿä»£ç çš„å…¨è·¯å¾„,å¯ä»¥æ˜¯ç±»,æ–¹æ³•,å±æ€§ç­‰.å…·ä½“å‚è€ƒå¦‚ä¸‹:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@see</span> #field<br><span class="hljs-meta">@see</span> #Constructor(Type, Type...)<br><span class="hljs-meta">@see</span> #Constructor(Type id, Type id...)<br><span class="hljs-meta">@see</span> #method(Type, Type,...)<br><span class="hljs-meta">@see</span> #method(Type id, Type, id...)<br><span class="hljs-meta">@see</span> Class<br><span class="hljs-meta">@see</span> Class#field<br><span class="hljs-meta">@see</span> Class#Constructor(Type, Type...)<br><span class="hljs-meta">@see</span> Class#Constructor(Type id, Type id)<br><span class="hljs-meta">@see</span> Class#method(Type, Type,...)<br><span class="hljs-meta">@see</span> Class#method(Type id, Type id,...)<br><span class="hljs-meta">@see</span> <span class="hljs-keyword">package</span>.Class<br><span class="hljs-meta">@see</span> <span class="hljs-keyword">package</span>.Class#field<br><span class="hljs-meta">@see</span> <span class="hljs-keyword">package</span>.Class#Constructor(Type, Type...)<br><span class="hljs-meta">@see</span> <span class="hljs-keyword">package</span>.Class#Constructor(Type id, Type id)<br><span class="hljs-meta">@see</span> <span class="hljs-keyword">package</span>.Class#method(Type, Type,...)<br><span class="hljs-meta">@see</span> <span class="hljs-keyword">package</span>.Class#method(Type id, Type, id)<br><span class="hljs-meta">@see</span> <span class="hljs-keyword">package</span><br></code></pre></td></tr></table></figure><h4 id="author"><a href="#author" class="headerlink" title="@author"></a>@author</h4><p>æ ‡è¯†å½“å‰ä»£ç çš„ä½œè€…æ˜¯è°, å¯ä»¥ä¸€ä¸ª,ä¹Ÿå¯ä»¥æœ‰å¤šä¸ª.</p><h4 id="version-since"><a href="#version-since" class="headerlink" title="@version @since"></a>@version @since</h4><p>éƒ½æ˜¯ç‰ˆæœ¬ç›¸å…³çš„tag<br>@version æ ‡è¯†å½“å‰ç‰ˆæœ¬å¥½, ç¼–è¯‘çš„æ—¶å€™ä¼šç”¨åˆ°. ç¬¦åˆSCCSè§„èŒƒ.<br>@since æ ‡è¯†è¿™æ®µä»£ç çš„å¼•å…¥ç‰ˆæœ¬</p><h4 id="serial-serialField-serialData"><a href="#serial-serialField-serialData" class="headerlink" title="@serial @serialField  @serialData"></a>@serial @serialField  @serialData</h4><p>åºåˆ—åŒ–ç›¸å…³çš„å±æ€§, æ ‡è¯†å“ªäº›å­—æ®µå¯ä»¥åºåˆ—åŒ–,å“ªäº›ä¸è¡Œ.</p><h4 id="deprecated"><a href="#deprecated" class="headerlink" title="@deprecated"></a>@deprecated</h4><p>åºŸå¼ƒæŸæ®µä»£ç ,è¡¨ç¤ºä¸å†ç»´æŠ¤,å¹¶åœ¨ä¸€æ®µæ—¶é—´åä¼šè¢«åˆ é™¤. æ ‡è®°å, ç›¸å…³çš„å¼•ç”¨ä½ç½®ä¼šè¢«æ ‡è®°ä¸ºåˆ é™¤çº¿.<br>ä¸ªäººè®¤ä¸ºè¿™ä¸ªtagè¿˜æ˜¯å¾ˆæœ‰ç”¨çš„:</p><ol><li>åˆ›å»ºä»£ç å®¹æ˜“åˆ é™¤éš¾, è¿™ä¸ªtagèƒ½å¤Ÿå¾ˆå¥½çš„å¸®å¿™æˆ‘ä»¬å»ä¸‹çº¿ä¸å†ç»´æŠ¤çš„ä»£ç ,å‡è½»ç»´æŠ¤å‹åŠ›.(æ„¿ä¸–ç•Œä¸Šå±å±±è¶Šæ¥è¶Šå°‘)</li><li>æ–¹ä¾¿æˆ‘ä»¬ä»£ç å‡çº§. å¦‚æœæˆ‘ä»¬è¦å‡çº§ä¸€æ®µä»£ç ,å…ˆå°†è€ä»£ç åºŸå¼ƒ,ç„¶åé€šè¿‡@see,å¼•å¯¼ç”¨æˆ·ä½¿ç”¨æ–°çš„æ–¹æ³•.</li></ol><figure class="highlight leaf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs leaf">/**<br>* @deprecated  As of JDK 1.1, replaced by <br>*               <br> setBounds<br>* @see <span class="hljs-punctuation">#</span><span class="hljs-keyword">setBounds</span><span class="hljs-params">(<span class="hljs-keyword">in</span><span class="hljs-variable">t</span>,<span class="hljs-keyword">in</span><span class="hljs-variable">t</span>,<span class="hljs-keyword">in</span><span class="hljs-variable">t</span>,<span class="hljs-keyword">in</span><span class="hljs-variable">t</span>)</span><br>*/<br></code></pre></td></tr></table></figure><h4 id="htmlæ ‡ç­¾æ¥æ’ç‰ˆ"><a href="#htmlæ ‡ç­¾æ¥æ’ç‰ˆ" class="headerlink" title="htmlæ ‡ç­¾æ¥æ’ç‰ˆ"></a>htmlæ ‡ç­¾æ¥æ’ç‰ˆ</h4><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ada">&lt;p&gt; : æ–°èµ·ä¸€æ®µ<br>&lt;br&gt; : æ¢è¡Œ<br></code></pre></td></tr></table></figure><h4 id="ä»£ç å—æ ·å¼"><a href="#ä»£ç å—æ ·å¼" class="headerlink" title="ä»£ç å—æ ·å¼"></a>ä»£ç å—æ ·å¼</h4><p>æƒ³åœ¨JAVAçš„æ³¨é‡Šä¸­æ·»åŠ ä¸€æ®µä»£ç ,å¹¶ä¸”å¯ä»¥ä¼˜é›…çš„ç¼–è¯‘å‡ºæ¥è¿˜æ˜¯æŒºéº»çƒ¦çš„.ä¸‹é¢æä¾›ä¸€ç§æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">  * ä¸‹é¢çš„ä»£ç æ³¨é‡Šå¯ä»¥æŒ‰ä»£ç æ ¼å¼ç¼–è¯‘</span><br><span class="hljs-comment">  * &lt;pre class=code&gt;</span><br><span class="hljs-comment">  *     citys : [</span><br><span class="hljs-comment">  *         beijing,</span><br><span class="hljs-comment">  *         shanghai</span><br><span class="hljs-comment">  *      ]</span><br><span class="hljs-comment">  * &lt;/pre&gt;</span><br><span class="hljs-comment">  *</span><br><span class="hljs-comment">  */</span><br> <span class="hljs-keyword">private</span> List&lt;String&gt;&gt; citys;<br><br></code></pre></td></tr></table></figure><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a href="https://www.oracle.com/technical-resources/articles/java/javadoc-tool.html">å®˜æ–¹æ–‡æ¡£</a><br><a href="https://docs.oracle.com/javase/7/docs/technotes/tools/windows/javadoc.html">javadoc - The Java API Documentation Generator</a><br><a href="https://docs.oracle.com/javase/7/docs/technotes/guides/javadoc/deprecation/deprecation.html">How and When To Deprecate APIs</a></p>]]></content>
    
    
    <categories>
      
      <category>ç¼–ç¨‹äººç”Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç®—æ³•å¥—è·¯</title>
    <link href="/2022/08/23/algorithm-skill/"/>
    <url>/2022/08/23/algorithm-skill/</url>
    
    <content type="html"><![CDATA[<p>å¹³æ—¶åœ¨åˆ·ç®—æ³•é¢˜çš„æ—¶å€™ç»å¸¸ä¼šé‡åˆ°ä¸€äº›å¥—è·¯, ä¹Ÿå°±æ˜¯ä¸€äº›ç±»ä¼¼çš„å°æŠ€å·§. è¿™ç±»æŠ€å·§èƒ½å¤Ÿå¿«é€Ÿçš„å¸®æˆ‘ä»¬è§£å†³æŸä¸€ç±»çš„ç®—æ³•é—®é¢˜. è¿™é‡Œå°±æ˜¯æ•´ç†ä¸€ä¸‹è‡ªå·±é‡åˆ°çš„,æ€»ç»“çš„ç®—æ³•æŠ€å·§, ä»¥åŠè¿™äº›æŠ€å·§å¯ä»¥åº”ç”¨ä¸å“ªäº›åœºæ™¯.</p><h2 id="1-æ»‘åŠ¨çª—å£-åŒæŒ‡é’ˆ"><a href="#1-æ»‘åŠ¨çª—å£-åŒæŒ‡é’ˆ" class="headerlink" title="1 æ»‘åŠ¨çª—å£(åŒæŒ‡é’ˆ)"></a>1 æ»‘åŠ¨çª—å£(åŒæŒ‡é’ˆ)</h2><p>ä¸ªäººç†è§£,æ»‘åŠ¨çª—å£ çš„åŸºç¡€å°±æ˜¯åŒæŒ‡é’ˆ. å³ä¸€ä¸ªå¿«æŒ‡é’ˆä»£æŒ‡çª—å£çš„å¤´éƒ¨, ä¸€ä¸ªæ…¢æŒ‡é’ˆä»£æŒ‡çª—å£çš„å°¾éƒ¨. æ»‘åŠ¨çª—å£ç»è¿‡çš„åœ°æ–¹å°±æ˜¯æˆ‘ä»¬è¦å¤„ç†çš„æ•°æ®. </p><p><img src="/images/tech/algorithm/move-window.png" alt="æ»‘åŠ¨çª—å£ç¤ºæ„å›¾"></p><p>å¦‚å›¾æ‰€ç¤º,æˆ‘ä»¬çš„æ»‘åŠ¨åˆ›å»ºè¿åŠ¨æ–¹å‘ä»å·¦å¾€å³, å·²ç»ç»è¿‡äº†åŒºåŸŸ1,æ­£åœ¨ç»å†åŒºåŸŸ2,3,4. è¿˜æ²¡æœ‰ç»å†åŒºåŸŸ5.</p><h3 id="1-1-æ»‘åŠ¨çª—å£çš„ç‰¹æ€§"><a href="#1-1-æ»‘åŠ¨çª—å£çš„ç‰¹æ€§" class="headerlink" title="1.1 æ»‘åŠ¨çª—å£çš„ç‰¹æ€§"></a>1.1 æ»‘åŠ¨çª—å£çš„ç‰¹æ€§</h3><p>é€šè¿‡ä¸Šé¢åˆ†æå¯çŸ¥, æ»‘åŠ¨çª—å£æ˜¯ä¸€ä¸ªçª—å£ç»è¿‡ä¸€æ®µè¿ç»­çš„åŒºåŸŸ,å¹¶å®æ—¶è®¡ç®—ç»Ÿè®¡ç»è¿‡åŒºåŸŸå†…çš„ä¸€äº›å€¼. æ‰€ä»¥æ»‘åŠ¨çª—å£å¾ˆé€‚ç”¨çš„åœºæ™¯ç‰¹ç‚¹ä¹Ÿå°±å‡ºæ¥äº†:</p><ol><li>å•ç»´åº¦æ•°æ®,æ¯”å¦‚å­—ç¬¦ä¸², æ¯”å¦‚ä¸€ç»´æ•°ç»„.</li><li>ç»“æœå€¼æœ‰è¿ç»­ç‰¹æ€§è¦æ±‚çš„. å› ä¸ºæ»‘åŠ¨çª—å£å¿…ç„¶æ˜¯è¿ç»­ç»è¿‡è®¡ç®—åŒºåŸŸçš„.æ‰€é‡åˆ°çš„å€¼ä¹Ÿå¿…ç„¶æ˜¯è¿ç»­çš„.</li></ol><h3 id="1-2-å¸¸è§åœºæ™¯"><a href="#1-2-å¸¸è§åœºæ™¯" class="headerlink" title="1.2 å¸¸è§åœºæ™¯"></a>1.2 å¸¸è§åœºæ™¯</h3><ol><li><a href="https://leetcode.cn/problems/longest-substring-without-repeating-characters/">è®¡ç®—ä¸€ä¸ªå­—ç¬¦ä¸²å†…ä¸å«æœ‰é‡å¤å­—ç¬¦çš„</a></li></ol><h2 id="æœªå®Œå¾…ç»­"><a href="#æœªå®Œå¾…ç»­" class="headerlink" title="æœªå®Œå¾…ç»­"></a>æœªå®Œå¾…ç»­</h2>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>javaä¸­å¸¸ç”¨çš„å·¥å…·ç±»(2) System</title>
    <link href="/2022/08/20/java-java-utils-2-system/"/>
    <url>/2022/08/20/java-java-utils-2-system/</url>
    
    <content type="html"><![CDATA[<p>Systemå·¥å…·ç±»ä¹Ÿæ˜¯javaä¸­å¸¸ç”¨çš„ä¸€ä¸ªå·¥å…·ç±»ï¼Œå¹¶ä¸”ä»java 1.0 æ—¶ä»£å°±å­˜åœ¨äº†ã€‚å®ƒæ˜¯ä¸èƒ½è¢«å®ä¾‹åŒ–çš„ã€‚æˆ‘ä»¬è¿™é‡Œä»‹ç»ä¸€ä¸‹å®ƒçš„ç®€å•ç”¨æ³•.  </p><p>ä¸‹é¢æ˜¯å®˜æ–¹ä»‹ç»</p><blockquote><p>The System class contains several useful class fields and methods. It cannot be instantiated.<br>Among the facilities provided by the System class are standard input, standard output, and error output streams; access to externally defined properties and environment variables; a means of loading files and libraries; and a utility method for quickly copying a portion of an array.</p></blockquote><p>ä»¥ä¸‹ä»‹ç»Systemçš„å¸¸ç”¨æ–¹æ³•</p><h3 id="æµç›¸å…³"><a href="#æµç›¸å…³" class="headerlink" title="æµç›¸å…³"></a>æµç›¸å…³</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è®¾ç½®æ ‡å‡†è¾“å…¥æµ</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setIn</span><span class="hljs-params">(InputStream in)</span>;<br><span class="hljs-comment">// è®¾ç½®æ ‡å‡†è¾“å‡ºæµ</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setOut</span><span class="hljs-params">(PrintStream out)</span>;<br><span class="hljs-comment">// è®¾ç½®æ ‡å‡†é”™è¯¯è¾“å‡ºæµ</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setErr</span><span class="hljs-params">(PrintStream err)</span>;<br></code></pre></td></tr></table></figure><p>ä»¥ä¸Šçš„æµå°±ä¼šåœ¨Systemçš„æ ‡å‡†æµä¸­ä½¿ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">System.in.read();<br>System.out.println();<br>System.err.println();<br></code></pre></td></tr></table></figure><p>è·å–ä¸€ä¸ªåŸºç¡€è™šæ‹Ÿæœºçš„æµé€šé“</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// Returns the channel inherited from the entity that created this Java virtual machine.</span><br><span class="hljs-comment">// This method returns the channel obtained by invoking the inheritedChannel method of the system-wide default SelectorProvider object.</span><br><span class="hljs-comment">// In addition to the network-oriented channels described in inheritedChannel, this method may return other kinds of channels in the future.</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Channel <span class="hljs-title function_">inheritedChannel</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException<br><br>System.out.println(System.inheritedChannel());<span class="hljs-comment">//null</span><br></code></pre></td></tr></table></figure><h3 id="å®‰å…¨ç›¸å…³"><a href="#å®‰å…¨ç›¸å…³" class="headerlink" title="å®‰å…¨ç›¸å…³"></a>å®‰å…¨ç›¸å…³</h3><p>è®¾ç½®æˆ–è·å– javaè™šæ‹Ÿæœºçš„å®‰å…¨ç®¡ç†å™¨ã€‚è¿™ä¸ªæˆ‘ç”¨çš„æ¯”è¾ƒå°‘ï¼Œå¤§å®¶çœ‹æ³¨é‡Šå§ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// Sets the System security.</span><br><span class="hljs-comment">// If there is a security manager already installed, this method first calls the security manager&#x27;s checkPermission method with a RuntimePermission(&quot;setSecurityManager&quot;) permission to ensure it&#x27;s ok to replace the existing security manager. This may result in throwing a SecurityException.</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setSecurityManager</span><span class="hljs-params">(<span class="hljs-keyword">final</span> SecurityManager s)</span>;<br><br><span class="hljs-comment">// if a security manager has already been established for the current application, then that security manager is returned; otherwise, null is returned.</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> SecurityManager <span class="hljs-title function_">getSecurityManager</span><span class="hljs-params">()</span>;<br><br><span class="hljs-comment">// é»˜è®¤</span><br>System.out.println(System.getSecurityManager());<span class="hljs-comment">// null</span><br></code></pre></td></tr></table></figure><h3 id="æ§åˆ¶å°"><a href="#æ§åˆ¶å°" class="headerlink" title="æ§åˆ¶å°"></a>æ§åˆ¶å°</h3><p>è·å–javaçš„æ§åˆ¶å°å¯¹è±¡ï¼Œå…³äºæ§åˆ¶å°å‘½ä»¤äº¤äº’å¯ä»¥é€šè¿‡è¿™é‡Œè·å–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// Returns the unique Console object associated with the current Java virtual machine, if any.</span><br><span class="hljs-comment">// Returns: The system console, if any, otherwise null. </span><br><span class="hljs-comment">// Since: 1.6</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Console <span class="hljs-title function_">console</span><span class="hljs-params">()</span><br></code></pre></td></tr></table></figure><h3 id="æ—¶é—´ç›¸å…³"><a href="#æ—¶é—´ç›¸å…³" class="headerlink" title="æ—¶é—´ç›¸å…³"></a>æ—¶é—´ç›¸å…³</h3><p>è¿™åº”è¯¥æ˜¯å¤§å®¶ä½¿ç”¨æœ€é¢‘ç¹çš„å‡ ä¸ªæ¥å£ã€‚</p><ul><li>æ¯«ç§’</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è·å–å½“å‰ç³»ç»Ÿæ—¶é—´æˆ³ï¼ˆå…¬å…ƒ1970.1.1 å‡Œæ™¨åˆ°ç°åœ¨çš„æ¯«ç§’æ•°ï¼‰ï¼Œnativeè™šæ‹Ÿæœºå®ç°</span><br><span class="hljs-comment">// the difference, measured in milliseconds, between the current time and midnight, January 1, 1970 UTC.</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> <span class="hljs-type">long</span> <span class="hljs-title function_">currentTimeMillis</span><span class="hljs-params">()</span>;<br><br></code></pre></td></tr></table></figure><ul><li>çº³ç§’ç²¾åº¦æ•°</li></ul><p>è·å–å½“å‰ç³»ç»Ÿçš„çº³ç§’ç²¾åº¦çš„æ•°ï¼ˆåŸºäºå½“å‰è™šæ‹Ÿæœºï¼‰ã€‚è¿™ä¸ªæ•°æ˜¯ä¾æ®å½“å‰è™šæ‹Ÿæœºçš„ä¸€ä¸ªåŸç‚¹è®¡ç®—å‡ºæ¥çš„ä¸€ä¸ªé«˜ç²¾åº¦å€¼ï¼Œä¸å…·ä½“çš„æ—¶é—´æ— å…³ï¼ˆæ¯”å¦‚æ¯«ç§’æ–¹æ³•è·å–çš„æ˜¯1970åˆ°ä»Šå¤©çš„æ—¶é—´æˆ³ï¼Œä½†çº³ç§’çš„åŸç‚¹ä¸æ˜¯å…·ä½“çš„æŸä¸ªæ—¶é—´ç‚¹ï¼‰<br>æ‰€ä»¥ï¼Œè¿™ä¸ªæ–¹æ³•çš„ç”¨å¤„ä¹Ÿå°±æœ‰äº†ï¼Œå°±æ˜¯åŸºäºåŒä¸€ä¸ªè™šæ‹Ÿæœºçš„çº³ç§’çº§ç²¾åº¦çš„å‰åæ—¶é—´æ¯”è¾ƒã€‚<br>å› ä¸ºæ•°æ®æ¯”è¾ƒå¤§ï¼Œå¯ä»¥ä¼šæœ‰è¶Šç•Œé£é™©</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// Returns the current value of the running Java Virtual Machine&#x27;s high-resolution time source, in nanoseconds.</span><br><span class="hljs-comment">// This method can only be used to measure elapsed time and is not related to any other notion of system or wall-clock time. The value returned represents nanoseconds since some fixed but arbitrary origin time (perhaps in the future, so values may be negative). The same origin is used by all invocations of this method in an instance of a Java virtual machine; other virtual machine instances are likely to use a different origin.</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> <span class="hljs-type">long</span> <span class="hljs-title function_">nanoTime</span><span class="hljs-params">()</span>;<br></code></pre></td></tr></table></figure><h3 id="æ•°æ®æ‹·è´"><a href="#æ•°æ®æ‹·è´" class="headerlink" title="æ•°æ®æ‹·è´"></a>æ•°æ®æ‹·è´</h3><p>è¯´å®è¯ï¼Œä¸å¤ªç†è§£ä¸ºä»€ä¹ˆè¿™ä¸ªæ–¹æ³•ä¼šæ”¾åœ¨è¿™é‡Œã€‚å¯èƒ½åœ¨è™šæ‹Ÿæœºåº•å±‚é‡Œï¼Œæ•°ç»„copyæ˜¯ä¸€ä¸ªåŸºç¡€åŠŸèƒ½å§ã€‚<br>å¾ˆå¸¸ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å°†srcæ•°ç»„srcPosä½ç½®å¼€å§‹çš„lengthå…ƒç´ å¤åˆ¶åˆ°destæ•°ç»„ä¸­ï¼Œä»destæ•°ç»„ä¸­çš„destPoså¼€å§‹ã€‚</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">arraycopy</span><span class="hljs-params">(Object src,  <span class="hljs-type">int</span>  srcPos,Object dest, <span class="hljs-type">int</span> destPos, <span class="hljs-type">int</span> length)</span>;<br></code></pre></td></tr></table></figure><h3 id="hash"><a href="#hash" class="headerlink" title="hash"></a>hash</h3><p>è¿”å›å¯¹è±¡çš„é»˜è®¤hashcodeï¼ˆå³æ—¶è¢«è¦†ç›–ä¹Ÿä¸æ‰§è¡Œè¦†ç›–æ–¹æ³•ï¼‰<br>null è¿”å›0</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// Returns the same hash code for the given object as would be returned by the default method hashCode(), whether or not the given object&#x27;s class overrides hashCode(). The hash code for the null reference is zero.</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> <span class="hljs-type">int</span> <span class="hljs-title function_">identityHashCode</span><span class="hljs-params">(Object x)</span>;<br></code></pre></td></tr></table></figure><h3 id="ç³»ç»Ÿå±æ€§"><a href="#ç³»ç»Ÿå±æ€§" class="headerlink" title="ç³»ç»Ÿå±æ€§"></a>ç³»ç»Ÿå±æ€§</h3><ul><li>ç³»ç»Ÿå±æ€§åˆ—è¡¨</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// Key :  Description of Associated Value</span><br><span class="hljs-comment">// java.version :  Java Runtime Environment version</span><br><span class="hljs-comment">// java.vendor : Java Runtime Environment vendor</span><br><span class="hljs-comment">// java.vendor.url: Java vendor URL</span><br><span class="hljs-comment">// java.home:  Java installation directory</span><br><span class="hljs-comment">// java.vm.specification.version : Java Virtual Machine specification version</span><br><span class="hljs-comment">// java.vm.specification.vendor : Java Virtual Machine specification vendor</span><br><span class="hljs-comment">// java.vm.specification.name : Java Virtual Machine specification name</span><br><span class="hljs-comment">// java.vm.version : Java Virtual Machine implementation version</span><br><span class="hljs-comment">// java.vm.vendor : Java Virtual Machine implementation vendor</span><br><span class="hljs-comment">// java.vm.name : Java Virtual Machine implementation name</span><br><span class="hljs-comment">// java.specification.version : Java Runtime Environment specification version</span><br><span class="hljs-comment">// java.specification.vendor : Java Runtime Environment specification vendor</span><br><span class="hljs-comment">// java.specification.name : Java Runtime Environment specification name</span><br><span class="hljs-comment">// java.class.version : Java class format version number</span><br><span class="hljs-comment">// java.class.path : Java class path</span><br><span class="hljs-comment">// java.library.path : List of paths to search when loading libraries</span><br><span class="hljs-comment">// java.io.tmpdir : Default temp file path</span><br><span class="hljs-comment">// java.compiler : Name of JIT compiler to use</span><br><span class="hljs-comment">// java.ext.dirs : Path of extension directory or directories Deprecated. This property, and the mechanism which implements it, may be removed in a future release.</span><br><span class="hljs-comment">// os.name : Operating system name</span><br><span class="hljs-comment">// os.arch : Operating system architecture</span><br><span class="hljs-comment">// os.version : Operating system version</span><br><span class="hljs-comment">// file.separator : File separator (&quot;/&quot; on UNIX)</span><br><span class="hljs-comment">// path.separator : Path separator (&quot;:&quot; on UNIX)</span><br><span class="hljs-comment">// line.separator : Line separator (&quot;\n&quot; on UNIX)</span><br><span class="hljs-comment">// user.name : User&#x27;s account name</span><br><span class="hljs-comment">// user.home : User&#x27;s home directory</span><br><span class="hljs-comment">// user.dir : User&#x27;s current working directory</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Properties <span class="hljs-title function_">getProperties</span><span class="hljs-params">()</span><br><br><br></code></pre></td></tr></table></figure><ul><li>è®¾ç½®&#x2F;æ›¿æ¢ç³»ç»Ÿå±æ€§</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è®¾ç½®ç³»ç»Ÿå±æ€§ï¼šprops æ¢æ›¿æ¢åŸæ¥çš„ç³»ç»Ÿå±æ€§ï¼Œè€Œéæ–°å¢</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setProperties</span><span class="hljs-params">(Properties props)</span><br><br></code></pre></td></tr></table></figure><ul><li>è®¾ç½®keyå±æ€§</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è®¾ç½®keyçš„å±æ€§ï¼Œå¹¶è¿”å›ä¸Šä¸€ä¸ªvalueå€¼</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">setProperty</span><span class="hljs-params">(String key, String value)</span> <br><br></code></pre></td></tr></table></figure><ul><li>åˆ é™¤keyå±æ€§</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// åˆ é™¤key ï¼Œå¹¶è¿”å›ä¸Šä¸ªvalueå€¼</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">clearProperty</span><span class="hljs-params">(String key)</span><br><br></code></pre></td></tr></table></figure><ul><li>æŸ¥è¯¢keyå±æ€§</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ ¹æ®key æŸ¥å±æ€§å€¼</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">getProperty</span><span class="hljs-params">(String key)</span><br><span class="hljs-comment">// æ ¹æ®key æŸ¥å±æ€§å€¼ï¼ŒæŸ¥ä¸åˆ°è¿”å›é»˜è®¤å€¼</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">getProperty</span><span class="hljs-params">(String key, String def)</span><br><br></code></pre></td></tr></table></figure><ul><li>ç³»ç»Ÿæ¢è¡Œç¬¦</li></ul><p>linux&#x2F;unix : \n<br>windows: \r\n</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// On UNIX systems, it returns &quot;\n&quot;; on Microsoft Windows systems it returns &quot;\r\n&quot;.</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">lineSeparator</span><span class="hljs-params">()</span><br></code></pre></td></tr></table></figure><ul><li>ç³»ç»Ÿç¯å¢ƒå˜é‡</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å…¨éƒ¨ç¯å¢ƒå˜é‡ kï¼šv</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> java.util.Map&lt;String,String&gt; <span class="hljs-title function_">getenv</span><span class="hljs-params">()</span><br><br><span class="hljs-comment">// æŸä¸ªkçš„ç¯å¢ƒå˜é‡å€¼</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">getenv</span><span class="hljs-params">(String name)</span><br><br></code></pre></td></tr></table></figure><h3 id="ç³»ç»Ÿç›¸å…³"><a href="#ç³»ç»Ÿç›¸å…³" class="headerlink" title="ç³»ç»Ÿç›¸å…³"></a>ç³»ç»Ÿç›¸å…³</h3><ul><li>é€€å‡º</li></ul><p>ä»¥æŸä¸ªçŠ¶æ€ç»ˆæ­¢è™šæ‹Ÿæœºï¼šé0 code è¡¨ç¤ºéæ­£å¸¸ç»“æŸ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// Terminates the currently running Java Virtual Machine. The argument serves as a status code; by convention, a nonzero status code indicates abnormal termination.</span><br><span class="hljs-comment">// This method calls the exit method in class Runtime. This method never returns normally.</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">exit</span><span class="hljs-params">(<span class="hljs-type">int</span> status)</span> &#123;<br>    Runtime.getRuntime().exit(status);<br>&#125;<br><br></code></pre></td></tr></table></figure><ul><li>åƒåœ¾å›æ”¶</li></ul><p>æ‰§è¡Œåƒåœ¾å›æ”¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// Runs the garbage collector.</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">gc</span><span class="hljs-params">()</span> &#123;<br>    Runtime.getRuntime().gc();<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>æ‰§è¡ŒFinalization</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">runFinalization</span><span class="hljs-params">()</span> &#123;<br>    Runtime.getRuntime().runFinalization();<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>java</category>
      
      <category>å·¥å…·ç±»</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>javaä¸­å¸¸ç”¨çš„å·¥å…·ç±»(1) Objects</title>
    <link href="/2022/08/19/java-java-utils-1-Objects/"/>
    <url>/2022/08/19/java-java-utils-1-Objects/</url>
    
    <content type="html"><![CDATA[<p>åœ¨javaç”Ÿæ€ä¸­æœ‰ç€ä¼—å¤šçš„å·¥å…·ç±»ï¼Œè€Œæœ‰çš„å·¥å…·ç±»æ˜¯æˆ‘ä»¬å¸¸ç”¨è€Œä¸”å¦‚æœç”¨çš„å¥½ï¼Œä¼šæå¤§æé«˜ä»£ç çš„ä¼˜é›…æ€§ä¸æ•ˆç‡çš„ï¼ŒåŒæ—¶ä¹Ÿèƒ½é¿å…é‡å¤çš„é€ è½®å­ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ä¸€èµ·äº†è§£ä¸€ä¸‹è¿™äº›å·¥å…·ç±»ã€‚</p><p><strong>Objects</strong></p><p>Objectsæ˜¯jdkå®˜æ–¹è‡ªå¸¦çš„å·¥å…·ç±»ï¼Œé¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹Objectsçš„å®˜æ–¹ç®€ä»‹ï¼š</p><blockquote><p>This class consists of static utility methods for operating on objects. These utilities include null-safe or null-tolerant methods for computing the hash code of an object, returning a string for an object, and comparing two objects.Since: 1.7</p></blockquote><p>è¿™æ˜¯ä¸€ä¸ªç§æœ‰çš„å·¥å…·ç±»ï¼Œç”¨æ¥æä¾›ä¸€äº›å¯¹Objectçš„æ“ä½œæ–¹æ³•ï¼ŒåŒ…æ‹¬nullå€¼çš„å®‰å…¨æ“ä½œï¼Œä¸€çº§hashå€¼çš„è®¡ç®—ç­‰å®ç”¨æ–¹æ³•ã€‚jdk1.7 å°±æä¾›äº†ã€‚</p><p>Objectsçš„æä¾›çš„é™æ€æ–¹æ³•å¦‚ä¸‹ï¼š<br><img src="/images/tech/java/java-Objects-methods.png" alt="Objectsçš„å·¥å…·æ–¹æ³•"></p><p><strong>equals</strong></p><p>ç”¨æ¥æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„æ˜¯å¦ç›¸ç­‰ï¼Œnullå®‰å…¨çš„ï¼Œå¯ä»¥æ›¿æ¢ç¹ççš„åˆ¤ç©ºæ ¡éªŒã€‚å®ç°é€»è¾‘ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">equals</span><span class="hljs-params">(Object a, Object b)</span> &#123;<br>       <span class="hljs-keyword">return</span> (a == b) || (a != <span class="hljs-literal">null</span> &amp;&amp; a.equals(b));<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>deepEquals</strong></p><p>æ•°ç»„çš„æ·±åº¦æ¯”è¾ƒï¼ŒåŒæ ·nullå®‰å…¨çš„ã€‚å®ç°é€»è¾‘ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">deepEquals</span><span class="hljs-params">(Object a, Object b)</span> &#123;<br>        <span class="hljs-keyword">if</span> (a == b)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (a == <span class="hljs-literal">null</span> || b == <span class="hljs-literal">null</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        <span class="hljs-keyword">else</span><br>            <span class="hljs-keyword">return</span> Arrays.deepEquals0(a, b);<br>    &#125;       <br></code></pre></td></tr></table></figure><p><strong>hashCode</strong></p><p>è·å–ä¸€ä¸ªå¯¹è±¡çš„hashCodeï¼ŒåŒæ ·nullå®‰å…¨çš„ã€‚å®ç°é€»è¾‘ï¼š</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">hashCode</span><span class="hljs-params">(Object o)</span> &#123;<br>        <span class="hljs-keyword">return</span> o != <span class="hljs-literal">null</span> ? o.hashCode() : <span class="hljs-number">0</span>;<br>    &#125;<br></code></pre></td></tr></table></figure><p>â€‹        </p><p><strong>hash</strong></p><p>å¯¹ä¸€ä¸ªæ•°ç»„æ±‚hashå€¼ï¼ŒåŒæ ·nullå®‰å…¨çš„ã€‚å®ç°é€»è¾‘ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">hash</span><span class="hljs-params">(Object... values)</span> &#123;<br>      <span class="hljs-keyword">return</span> Arrays.hashCode(values);<br>  &#125; <br></code></pre></td></tr></table></figure><p><strong>toString</strong></p><p>è°ƒç”¨å¯¹è±¡oçš„toStringæ–¹æ³•ï¼ŒåŒæ ·nullå®‰å…¨çš„ã€‚ä¸è¿‡è¿™é‡Œè¦æ³¨æ„ä¸€ä¸‹ï¼Œå¦‚æœæ˜¯nullçš„è¯ï¼Œä¼šè¿”å›nullå­—ç¬¦ä¸²ã€‚</p><p>ç›¸å¯¹åº”çš„ï¼Œè¿˜æœ‰ä¸€ä¸ªé‡è½½æ–¹æ³•ï¼ŒtoString(Object o, String nullDefault) ã€‚ èƒ½å¤Ÿè‡ªå®šä¹‰nullå€¼çš„è¿”å›å€¼ï¼Œè¿™ä¸ªæŒºå®ç”¨çš„ã€‚</p><p>å®ç°é€»è¾‘ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java">  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">(Object o)</span> &#123;<br>      <span class="hljs-keyword">return</span> String.valueOf(o);<br>  &#125;<br><br># String.valueOf å®ç°<br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">valueOf</span><span class="hljs-params">(Object obj)</span> &#123;<br>      <span class="hljs-keyword">return</span> (obj == <span class="hljs-literal">null</span>) ? <span class="hljs-string">&quot;null&quot;</span> : obj.toString();<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">(Object o, String nullDefault)</span> &#123;<br>      <span class="hljs-keyword">return</span> (o != <span class="hljs-literal">null</span>) ? o.toString() : nullDefault;<br>  &#125;<br></code></pre></td></tr></table></figure><p><strong>compare</strong></p><p>è‡ªå®šä¹‰å®ç°å¤§å°æ¯”è¾ƒé€»è¾‘ï¼ŒåŒæ ·nullå®‰å…¨çš„ã€‚å®ç°é€»è¾‘ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-type">int</span> <span class="hljs-title function_">compare</span><span class="hljs-params">(T a, T b, Comparator&lt;? <span class="hljs-built_in">super</span> T&gt; c)</span> &#123;<br>        <span class="hljs-keyword">return</span> (a == b) ? <span class="hljs-number">0</span> :  c.compare(a, b);<br>    &#125;<br></code></pre></td></tr></table></figure><p><strong>isNull</strong></p><p>åˆ¤æ–­å¯¹è±¡æ˜¯null, å¯ä»¥ç”¨æ¥æ›¿æ¢ obj&#x3D;&#x3D;null çš„å†™æ³•ï¼Œæ›´ä¼˜é›…ã€‚ å®ç°é€»è¾‘ï¼š</p> <figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">isNull</span>(<span class="hljs-params"><span class="hljs-title class_">Object</span> obj</span>) &#123;<br>        <span class="hljs-keyword">return</span> obj == <span class="hljs-literal">null</span>;<br>    &#125;<br></code></pre></td></tr></table></figure><p>â€‹         </p><p><strong>nonNull</strong></p><p>åˆ¤æ–­å¯¹è±¡énull, å¯ä»¥ç”¨æ¥æ›¿æ¢ obj!&#x3D;null çš„å†™æ³•ï¼Œæ›´ä¼˜é›…ã€‚ å®ç°é€»è¾‘ï¼š</p> <figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">nonNull</span>(<span class="hljs-params"><span class="hljs-title class_">Object</span> obj</span>) &#123;<br>        <span class="hljs-keyword">return</span> obj != <span class="hljs-literal">null</span>;<br>    &#125;<br></code></pre></td></tr></table></figure><p>â€‹      </p><p><strong>requireNonNull</strong></p><p>æ–­è¨€åˆ¤æ–­ï¼Œè¦æ±‚ä¸€ä¸ªå¯¹è±¡æ˜¯éç©ºçš„ã€‚å¦‚æœä¸ºç©ºåˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œæœ‰ä¸‰ä¸ªé‡è½½æ–¹æ³•ï¼Œå¯ä»¥è‡ªå®šä¹‰ä¸åŒçš„å¼‚å¸¸messageã€‚</p><p>å®ç°é€»è¾‘ï¼š</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; T <span class="hljs-title function_">requireNonNull</span>(<span class="hljs-params">T obj</span>) &#123;<br>       <span class="hljs-keyword">if</span> (obj == <span class="hljs-literal">null</span>)<br>           <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>       <span class="hljs-keyword">return</span> obj;<br>   &#125;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; T <span class="hljs-title function_">requireNonNull</span>(<span class="hljs-params">T obj, <span class="hljs-title class_">String</span> message</span>) &#123;<br>       <span class="hljs-keyword">if</span> (obj == <span class="hljs-literal">null</span>)<br>           <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>(message);<br>       <span class="hljs-keyword">return</span> obj;<br>   &#125;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; T <span class="hljs-title function_">requireNonNull</span>(<span class="hljs-params">T obj, <span class="hljs-title class_">Supplier</span>&lt;<span class="hljs-title class_">String</span>&gt; messageSupplier</span>) &#123;<br>       <span class="hljs-keyword">if</span> (obj == <span class="hljs-literal">null</span>)<br>           <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>(messageSupplier.<span class="hljs-title function_">get</span>());<br>       <span class="hljs-keyword">return</span> obj;<br>   &#125;<br></code></pre></td></tr></table></figure><p> å¥½äº†ï¼Œjdkè‡ªåŠ¨çš„Objectsæ–¹æ³•å°±ä»‹ç»è¿™äº›ï¼Œæœ‰æ—¶é—´ æˆ‘ä»¬å†èŠèŠå…¶ä»–çš„å¸¸ç”¨å·¥å…·ç±»ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>java</category>
      
      <category>å·¥å…·ç±»</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>hello world</title>
    <link href="/2022/08/18/hello-world/"/>
    <url>/2022/08/18/hello-world/</url>
    
    <content type="html"><![CDATA[<p>æ¢¦å¼€å§‹çš„åœ°æ–¹</p>]]></content>
    
    
    <categories>
      
      <category>ç½‘ç«™</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å»ºç«™</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
